{"version":3,"sources":["main.js","config/config-overrides-generated.js","services/jean.service.js","services/loader.service.js","services/messages.service.js","services/popups.service.js","services/preloader.factory.js","services/user.js","directives/address-choice/address-choice.controller.js","directives/address-choice/address-choice.directive.js","directives/choosers/chooser.controller.js","directives/choosers/chooser.directive.js","directives/choosers/fabric-chooser.directive.js","directives/choosers/gender-chooser.directive.js","directives/choosers/style-chooser.directive.js","directives/image-stack/image-stack.controller.js","directives/image-stack/image-stack.directive.js","directives/jean-card/jean-card.directive.js","directives/jean-list/jean-list.directive.js","directives/login-form/login-form.controller.js","directives/login-form/login-form.directive.js","directives/navigation/navigation.controller.js","directives/navigation/navigation.directive.js","directives/register-form/register-form.controller.js","directives/register-form/register-form.directive.js","directives/slider/slider.controller.js","directives/slider/slider.directive.js","directives/social-actions/social-actions.controller.js","directives/social-actions/social-actions.directive.js","pages/admin/admin.controller.js","pages/closet/closet.controller.js","pages/customizer/customizer.controller.js","pages/fitmatch/fitmatch.controller.js","pages/home/home.controller.js","pages/order/order.controller.js","pages/pay/pay.controller.js","pages/thank-you/thank-you.controller.js","pages/auth/login/login.controller.js","pages/auth/register/register.controller.js"],"names":["config","$routeProvider","$locationProvider","apiData","api","$q","data","getData","loaded","defer","getAppData","result","resolve","promise","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","user","isLoggedIn","setup","$on","event","nextRoute","currentRoute","locked","lockedPage","i","length","path","includes","angular","module","filter","input","replace","min","max","key","ret","gender","name","window","onload","body","document","getElementById","bootstrap","element","configOverridesGenerated","REGION","PROFILE_IMAGES_S3_BUCKET","API_ENDPOINT","USER_POOL_ID","CLIENT_ID","IDENTITY_POOL_ID","jean","$routeParams","$window","$http","parseURLkey","jeanData","set","property","value","this","saved","createNew","constructor","Object","gender_option_id","style_option_id","fabric_id","accent_thread_id","top_thread_id","bottom_thread_id","reset","buildJeanData","copy","user_id","id","prop","hasOwnProperty","action","userProp","location","hostname","userId","parseInt","localStorage","getItem","makeCopy","undefined","isNaN","jeanObj","dataArr","split","d","call","err","reject","keys","get","deleter","jeanId","callback","testJeanForExistingImage","dataCode","errCallback","console","log","filename","imageUrl","success","image_url","jean_image_url","error","code","createThumb","then","blob","image","save","getDataCode","service","loader","loaderDefaults","message","type","icon","active","show","hide","messages","popups","pops","closeAll","pop","status","$broadcast","preloaderFunc","Preloader","imageLocations","imageCount","loadCount","errorCount","states","PENDING","LOADING","RESOLVED","REJECTED","state","deferred","preloadImages","preloader","load","prototype","isInitiated","isRejected","isResolved","loadImageLocation","handleImageError","imageLocation","handleImageLoad","notify","percent","Math","ceil","Image","bind","$apply","target","src","attr","factory","$inject","Nuser","userData","obKey","userDetails","login","username","password","response","setItem","access_token","logout","removeItem","addressChoiceCtrl","$scope","$filter","resetForm","close","editAdd","model","findAddressbyKey","primary","addresses","add","editing","addForm","choosePrimary","address","a","addressObject","startEditing","stopEditing","open","index","clear","dataObj","remove","addressId","splice","new_primary_id","newPrimary","newAdd","push","abbreviation","addressChoice","restrict","scope","directive","chooserCtrl","$element","$timeout","scrollToLeft","el","scrollTo","scrollDuration","offsetWidth","maxLeft","scrollWidth","stepNum","distance","scrollLeft","scrollStep","scrollTest","b","scrollInterval","setInterval","newScroll","clearInterval","chvm","breakPoint","touched","selectorCoords","top","left","$watch","newValue","oldValue","dataId","step","jeanKey","elementId","activeElement","querySelector","selector","css","width","height","innerWidth","chooser","selectAttr","$event","attrId","text","querySelectorAll","clientWidth","clientHeight","right","opacity","jeanSet","val","dataset","template","link","changeTemplate","screenWidth","viewUrl","onresize","weightFilter","fabric","weight","genderChooser","styleChooser","checkGenderFilter","style","g","istackCtrl","isvm","centerPan","zoom","pan","x","y","isMobile","toggleZoom","touchEnd","dragTracker","returnPan","images","setTimeout","transform-origin","touchStart","e","swipeStart","touches","clientX","clientY","swipe","zoomDrag","touchMove","preventDefault","touch","drag","bounds","bottom","move","dragPan","u","direction","frame","innerHeight","deltaX","deltaY","abs","isFinal","scanImage","fWidth","fHeight","rect","getBoundingClientRect","rootDoc","ownerDocument","documentElement","offsetT","pageYOffset","clientTop","offsetL","pageXOffset","clientLeft","xPosition","yPosition","trackMouse","pageX","pageY","imageStack","ele","attrs","ctrl","on","jeanCard","click","slug","templatePath","fields","defaultFields","findLabel","field","fieldLabels","fabric_type","dataLookup","indexOf","fabrics","dataMap","specialLabels","label","lookup","filterFields","matches","k","loginFormCtrl","validateEmail","email","re","test","validatePassword","search","logvm","credentials","loginEmail","loginPassword","validateLoginForm","redirect","forgotPassword","forgotPassword2","customerReset","getResetToken","validateForgot","resetPassword","validateForgot2","token","loginVerifcation","newPassword","newPasswordConfirm","loginFB","loginForm","forgot","navigationCtrl","vm","saver","drops","acct","mobileMenu","navigation","registerFormCtrl","$sce","regvm","first_name","last_name","validateRegistrationForm","match","passwordConfirm","registerUser","valid","register","registerForm","sliderCtrl","imagesLoaded","slides","currentIndex","setCurrentSlideIndex","isCurrentSlideIndex","nextSlide","prevSlide","slider","imageClick","socialCtrl","runShare","social","shareUrl","url","sharingUrls","sovm","shareImageUploaded","jeanToUrl","socialTitle","socialDescription","facebook","baseString","twitter","pinterest","share","display","savefunc","uploaded","adminCtrl","meanData","getOptions","closetCtrl","validatePhoneNumber","inputtxt","phoneno","findJeanbyId","j","jeans","results","orders","checkUrl","order","order_items","data_code","userForm","saving","feedback","changeOrderItemName","changeOrder","displayOrder","changeName","displayJean","jean_name","cancel","editField","formatDate","date","format","Date","validate","update","passForm","currentPass","newPass","newPassConfirm","validatePasswordForm","changePassword","passwordData","old_password","reOrder","orderCreateObj","price","shipping_phone","shipping_name","shipping_address_id","vendor_id","rep_id","payment_status_id","order_status_id","order_type_id","reorder_item_id","newOrder","copyJean","orderItem","selectJean","jeanProfile","selectOrder","orderProfile","deleteJean","orderJean","payInvoice","orderId","customizerCtrl","landscapeDetect","ua","navigator","userAgent","toLowerCase","isAndroid","orientation","current","original","displaySocial","displaySocialHelper","updateActiveItem","landscape","supportsOrientationChange","orientationEvent","addEventListener","activeItem","panel","panelStep","dataKey","panelTemplate","title","panelDir","changeStep","savingBar","newJeanName","authCallback","saveCallback","openSaveOpts","redirectToOrder","saveAndOrder","runSave","saveAndShowOpts","keepEditing","goToCloset","startOver","placeOrder","socialAuthCheck","saveJean","registerCallback","details","dispaly","fmCtrl","userLoggedIn","checkoutForm","formStep","fitMatch","orderDetails","cards","cardForm","addingCard","loadingCards","fire","phone","square_id","inputConfigOverrides","cardNumber","placeholder","cvv","expirationDate","inputStyles","backgroundColor","padding","fontSize","lineHeight","nonceReceived","nonce","card","orderFitMatch","card_id","ordering","validateFitMatch","fmObject","credit_card_id","requested_fabric_ids","JSON","stringify","truncateBrand","brand","truncated","fit_match_error","addCard","homeCtrl","orderCtrl","getPrimaryAddress","tailors","ordersLoaded","orderForm","editData","newV","comment","orderFound","order_from_url","copyItem","orderErr","jean_id","orderFormErr","orderPlaced","chooseOrderType","copyOrder","fitDate","fit_date","copy_order_item_id","tailor_id","measurementKeys","hasMeasurements","testCols","measurements","editText","revertField","payCtrl","paidDate","orderLoaded","initPage","chargeObject","customer_card_id","amount_money","customer_id","transactions","created_at","tyCtrl","loginCtrl","registerCtrl"],"mappings":"CAAA,WAME,QAASA,GAAQC,EAAgBC,GAE/B,GAAIC,IAAW,MAAO,KAAM,SAASC,EAAKC,GACxC,GAAIC,GAAOF,EAAIG,SACf,IAAGD,EAAKE,OAAQ,MAAOF,EAErB,IAAIG,GAAQJ,EAAGI,OAIf,OAHAL,GAAIM,WAAW,SAASC,GACtBF,EAAMG,QAAQD,KAETF,EAAMI,SAIjBZ,GACGa,KAAK,KACJC,YAAa,6BACbC,WAAY,WACZC,aAAc,OAEfH,KAAK,sBACJC,YAAa,2BACbC,WAAY,UACZC,aAAc,KACdL,SAAST,QAAQA,KAElBW,KAAK,2BACJC,YAAa,qCACbC,WAAY,SACZC,aAAc,KACdL,SAAST,QAAQA,KAElBW,KAAK,oBACJC,YAAa,uCACbC,WAAY,SACZC,aAAc,OAEfH,KAAK,aACJC,YAAa,0CACbC,WAAY,eACZC,aAAc,OAEfH,KAAK,UACJC,YAAa,oCACbC,WAAY,YACZC,aAAc,OAEfH,KAAK,8BACJC,YAAa,4DACbC,WAAY,YACZC,aAAc,OAEfH,KAAK,WACJC,YAAa,iCACbC,WAAY,aACZC,aAAc,KACdL,SAAST,QAAQA,KAElBW,KAAK,4BACJC,YAAa,+BACbC,WAAY,YACZC,aAAc,KACdL,SAAST,QAAQA,KAElBW,KAAK,iCACJC,YAAa,yCACbC,WAAY,iBACZC,aAAc,KACdL,SAAST,QAAQA,KAElBW,KAAK,UACJC,YAAa,+BACbC,WAAY,YACZC,aAAc,OAEfC,WAAWC,WAAY,MAG1BjB,EAAkBkB,WAAU,GAI9B,QAASC,GAAIC,EAAYC,EAAWC,GAC/BA,EAAKC,cAAcD,EAAKE,QAC3BJ,EAAWK,IAAI,oBAAqB,SAASC,EAAOC,EAAWC,GAO9D,IAAI,GALAC,IACH,UACA,UAEEC,GAAa,EACRC,EAAE,EAAGA,EAAEF,EAAOG,OAAQD,IACzBV,EAAUY,OAAOC,SAASL,EAAOE,MACpCD,GAAa,EAGbA,KAAeR,EAAKC,cACvBF,EAAUY,KAAK,YArGjBE,QAAQC,OAAO,SAAU,UAAW,YAAY,aAAc,YAAa,mBAAoB,OAAQ,MAAO,kBAkH/GD,QAAQC,OAAO,SACXtC,QAAQ,iBAAkB,oBAAqBA,IAC/CqB,KAAK,aAAc,YAAa,OAAQA,IAC1CkB,OAAO,YAAY,WACjB,MAAO,UAASC,GACd,GAAIA,EACH,MAAOA,GAAMC,QAAQ,OAAQ,QAIlCF,OAAO,eAAe,WACpB,MAAO,UAASC,GACd,GAAIA,EAAO,CACV,GAAIA,GAAQA,EAAMC,QAAS,WAAY,MACvC,OAAOD,GAAMC,QAAQ,MAAO,SAIjCF,OAAO,SAAS,SAASG,EAAKC,EAAKC,GACnC,MAAO,UAASJ,GACf,QAAIE,GAAOF,EAAMI,GAAOF,MACpBC,GAAOH,EAAMI,GAAOD,MAIzBJ,OAAO,cAAc,WACrB,MAAO,UAASC,GAEf,MADAK,KAAML,EAAMM,OAASN,EAAMM,OAASN,EAAMO,OACnCF,KAAMA,IAAIJ,QAAQ,aAAc,OAKzCO,OAAOC,OAAO,WACZ,GAAIC,GAAOC,SAASC,eAAe,QACnCf,SAAQgB,UAAUhB,QAAQiB,QAAQJ,IAAQ;CCrJ9C,WAEA,KAAMK,IACJC,OAAU,YACVC,yBAA4B,gEAC5BC,aAAgB,qEAChBC,aAAgB,sBAChBC,UAAa,6BACbC,iBAAoB,iDAGtB,OAAON;CCZP,WAME,QAASO,GAAKC,EAAcC,EAAS3D,EAAID,EAAK6D,GAwD9C,QAASC,GAAYtB,GACpB,OAAOA,GACN,IAAK,IACF,MAAO,kBAGP,KAAK,IACL,MAAO,iBAGP,KAAK,IACL,MAAO,WAGP,KAAK,KACL,MAAO,eAGP,KAAK,KACL,MAAO,kBAGP,KAAK,KACL,MAAO,kBAEP,SAAS,OAAO,GAxDpB,GAAIuB,KAELC,KAAM,SAASC,EAAUC,GACxBH,EAASE,GAAYC,EACrBC,KAAKC,OAAM,GAGZC,UAAY,SAASX,GACfA,GAAQA,EAAKY,aAAeC,OAWhCR,GACCS,iBAAqBd,EAAKc,iBAC1BC,gBAAoBf,EAAKe,gBACzBC,UAAchB,EAAKgB,UACnBC,iBAAqBjB,EAAKiB,iBAC1BC,cAAkBlB,EAAKkB,cACvBC,iBAAqBnB,EAAKmB,mBAhB3Bd,GACCS,iBAAqB,EACrBC,gBAAoB,EACpBC,UAAc,KACdC,iBAAoB,EACpBC,cAAkB,EAClBC,iBAAqB,GAEtBd,EAASK,OAAQ,IA8CnBU,MAAQ,WACPT,aAGDU,cAAgB,SAAS7E,EAAM8E,GAGrB,GAANA,UACK9E,GAAK+E,cACL/E,GAAKgF,GACThF,EAAKyC,OAAMzC,EAAKyC,KAAO,WAAWzC,EAAKyC,MAE3C,KAAIwC,OAAQjF,GACRA,EAAKkF,eAAeD,OACtBnB,IAAImB,KAAMjF,EAAKiF,OAMlB,IAAI7D,GAAQ,SAASpB,EAAMmF,GAE1B,GAAIhF,GAAQJ,EAAGI,QAEXiF,EAAuC,cAA5B1B,EAAQ2B,SAASC,SAAyB,eAAiB,WACtEC,EAASC,SAAS9B,EAAQ+B,aAAaC,QAAQN,IAC/CO,GAAWJ,CAIf,IAHAI,EAAqB,QAAVR,GAA0BQ,EAGxB,OAAT3F,GAAiC,gBAATA,GAEvBA,EAAK+E,SAAW/E,EAAK+E,UAAYQ,SAAevF,GAAKgF,GACzDH,cAAc7E,EAAM2F,GACpBxF,EAAMG,QAAQuD,OAIV,IAAa,OAAT7D,GAA0B4F,SAAT5F,GAAsB6F,MAAM7F,GAAM,CAC3D,GAAI8F,KACJC,SAAU/F,EAAKgG,MAAM,IACrB,KAAI,GAAIrE,GAAE,EAAGA,EAAEoE,QAAQnE,OAAQD,IAAI,CAClC,GAAIsE,GAAIF,QAAQpE,GAAGqE,MAAM,KACrB1D,EAAMsB,EAAYqC,EAAE,GACxBH,GAAQxD,GAAK2D,EAAE,GAEhBpB,cAAciB,GAAS,GACvB3F,EAAMG,QAAQuD,OAKG,QAAT7D,GAA0B4F,SAAT5F,EAEzBF,EAAIoG,KAAK,UAAWlG,EAAM,SAASK,GAC9BA,EAAO0E,UAAYQ,IAAQI,GAAW,GAE1Cd,cAAcxE,EAAQsF,GACtBxF,EAAMG,QAAQuD,IACZ,SAASsC,GACVhG,EAAMiG,OAAOD,KAKP9B,OAAOgC,KAAKxC,GAAUjC,OAAS,EACvCzB,EAAMG,QAAQuD,IAIdM,YACAhE,EAAMG,QAAQuD,GAoEf,OAAO1D,GAAMI,SAIV+F,EAAI,WACP,MAAOzC,IAKJ0C,EAAU,SAAUC,EAAQC,GAC/B3G,EAAIoG,KAAK,eAAgBM,EAAQ,SAASnG,GACrCoG,GAAUA,EAASpG,MAQrBqG,EAA2B,SAAS7C,EAAU8C,EAAUF,EAAUG,GACrEC,QAAQC,IAAI,oBACT,IAAIC,GAAWJ,EAAS,OACpBK,EAAW,iDAAiDD,CAEhEF,SAAQC,IAAIE,GAEZrD,EAAM2C,IAAIU,GACPC,QAAQ,SAAS5G,GACjBwG,QAAQC,IAAI,gBAEXjD,EAASqD,UAAYF,EACrBnD,EAASsD,eAAiBH,EACtBP,GAAUA,EAAS5C,KAIxBuD,MAAM,SAASjB,EAAKkB,GACpBR,QAAQC,IAAI,4BAEXhH,EAAIwH,YAAYzD,GAAU0D,KAAK,SAAUC,GACvC3D,EAAS4D,OAASzH,KAAKwH,EAAMT,SAASA,GAClCN,GAAUA,EAAS5C,IACtB,SAASsC,GACRS,GAAaA,EAAYT,QAOjCuB,EAAO,WACV,GAAIlE,GAAOS,KACPJ,EAAWL,EAAK8C,MACbnG,EAAQJ,EAAGI,QACXwG,EAAW7G,EAAI6H,YAAY9D,EAQ/B,OAPA6C,GAAyB7C,EAAU8C,EAAU,SAAS9C,GACpD/D,EAAIoG,KAAK,gBAAiBrC,EAAU,SAASxD,GAC3CF,EAAMG,QAAQD,IACb,SAAS8F,GACVhG,EAAMiG,OAAOD,OAGVhG,EAAMI,QAKjB,QAEGgG,QAAUA,EACVmB,KAAOA,EACPpB,IAAMA,EACNxC,IAAKA,IACL1C,MAAQA,EACRwD,MAAQA,MACPd,IAAMA,IACN4C,yBAAyBA,EACzBvC,UAAWA,UACXwD,YAAaA,aAtTjB5F,QACGC,OAAO,SACP4F,QAAQ,QAAS,eAAgB,UAAW,KAAM,MAAO,QAASpE;CCJvE,WAME,QAASqE,KAET,GAAIA,MAEEC,GACHC,QAAU,GACVC,KAAO,UACPC,KAAO,4BACPC,QAAS,GAaLC,EAAO,SAASJ,EAASC,EAAMC,GACnCJ,EAAOK,QAAS,EAChBL,EAAOE,QAAQA,GAAWD,EAAeC,QACzCF,EAAOG,KAAOA,GAAQF,EAAeE,KACrCH,EAAOI,KAAOA,GAAQH,EAAeG,MAGlCG,EAAO,WACVP,EAAOK,QAAO,GAGX5B,EAAM,WACT,MAAOuB,GAGR,QACCvB,IAAIA,EACJ6B,KAAKA,EACLC,KAAKA,GA3CRrG,QACGC,OAAO,SACP4F,QAAQ,UAAW,aAAcC;CCLtC,WAOE,QAASQ,KAET,GAAIrI,IACH+H,QAAU,GACVC,KAAM,IAGHlE,EAAM,SAASiE,EAASC,GAC3BhI,EAAK+H,QAAUA,EACf/H,EAAKgI,KAAOA,GAGTpD,EAAQ,WACX5E,EAAK+H,QAAU,GACf/H,EAAKgI,KAAO,IAGT1B,EAAM,WACT,MAAOtG,GAGN,QACCsG,IAAIA,EACJxC,IAAIA,EACJc,MAAMA,GA7BT7C,QACGC,OAAO,SACP4F,QAAQ,WAAYS;CCHzB,WAME,QAASC,GAAOtH,GAEd,GAAIuH,MAEFC,EAAW,WACd,IAAK,GAAIC,KAAOF,GACVA,EAAKrD,eAAeuD,KACtBF,EAAKE,IAAK,IAKT3E,EAAM,SAAS2E,EAAKC,GACvB,GAAKH,EAAKE,GAIN,CACJ,GAAIC,GAASA,GAAUH,EAAKE,EAC7BF,GAAKE,GAAOC,MALVH,GAAKE,IAAO,EACZzH,EAAW2H,WAAW,gBAQpBrC,EAAM,WACT,MAAOiC,GAGR,QACCjC,IAAIA,EACJxC,IAAIA,EACJ0E,SAASA,GAlCZzG,QACGC,OAAO,SACP4F,QAAQ,UAAW,aAAcU;ACDtC,QAASM,eAAe7I,EAAIiB,GAE1B,QAAS6H,GAAWC,GAEhB7E,KAAK6E,eAAiBA,EAGtB7E,KAAK8E,WAAa9E,KAAK6E,eAAelH,OACtCqC,KAAK+E,UAAY,EACjB/E,KAAKgF,WAAa,EAElBhF,KAAKiF,QACDC,QAAS,EACTC,QAAS,EACTC,SAAU,EACVC,SAAU,GAGdrF,KAAKsF,MAAQtF,KAAKiF,OAAOC,QAGzBlF,KAAKuF,SAAWzJ,EAAGI,QACnB8D,KAAK1D,QAAU0D,KAAKuF,SAASjJ,QA2HjC,MApHAsI,GAAUY,cAAgB,SAAUX,GAChC,GAAIY,GAAY,GAAIb,GAAWC,EAC/B,OAAQY,GAAUC,QAKtBd,EAAUe,WAENxF,YAAayE,EAKbgB,YAAa,WACT,MAAQ5F,MAAKsF,QAAUtF,KAAKiF,OAAOC,SAGvCW,WAAY,WACR,MAAQ7F,MAAKsF,QAAUtF,KAAKiF,OAAOI,UAGvCS,WAAY,WACR,MAAQ9F,MAAKsF,QAAUtF,KAAKiF,OAAOG,UAGvCM,KAAM,WAEF,GAAK1F,KAAK4F,cACN,MAAQ5F,MAAa,OAEzBA,MAAKsF,MAAQtF,KAAKiF,OAAOE,OACzB,KAAM,GAAIzH,GAAI,EAAIA,EAAIsC,KAAK8E,WAAapH,IACpCsC,KAAK+F,kBAAmB/F,KAAK6E,eAAgBnH,GAGjD,OAAQsC,MAAa,SAMzBgG,iBAAkB,SAA2BC,GACzCjG,KAAKgF,aAEAhF,KAAK6F,eAGV7F,KAAKsF,MAAQtF,KAAKiF,OAAOI,SACzBrF,KAAKuF,SAASpD,OAAQ8D,KAG1BC,gBAAiB,SAA0BD,GACvCjG,KAAK+E,YAEA/E,KAAK6F,eAMV7F,KAAKuF,SAASY,QACVC,QAASC,KAAKC,KAAMtG,KAAK+E,UAAY/E,KAAK8E,WAAa,KACvDmB,cAAeA,IAIdjG,KAAK+E,YAAc/E,KAAK8E,aACzB9E,KAAKsF,MAAQtF,KAAKiF,OAAOG,SACzBpF,KAAKuF,SAASlJ,QAAS2D,KAAK6E,mBAOpCkB,kBAAmB,SAA4BE,GAC3C,GAAIR,GAAYzF,KASZwD,EAAQ1F,QAAQiB,QAAS,GAAIwH,QAC5BC,KAAK,OAAQ,SAAUnJ,GAGpBN,EAAW0J,OACP,WACIhB,EAAUS,gBAAiB7I,EAAMqJ,OAAOC,KAGxClB,EAAYjC,EAAQnG,EAAQ,SAIvCmJ,KAAK,QAAS,SAAUnJ,GAGrBN,EAAW0J,OACP,WACIhB,EAAUO,iBAAkB3I,EAAMqJ,OAAOC,KAGzClB,EAAYjC,EAAQnG,EAAQ,SAIvCuJ,KAAM,MAAOX,KAKpB,EArJRnI,QAAQC,OAAO,SACd8I,QAAQ,YAAalC,eAEtBA,cAAcmC,SAAW,KAAM;CCF/B,WAOE,QAASC,GAAM/J,EAAWyC,EAAS5D,GAElC,GAAIoB,MAEDC,EAAa,WAEhB,MADA0F,SAAQC,IAAI,UACLpD,EAAQ+B,aAAaC,QAAQ,kBAGjC5B,EAAM,SAASxB,EAAKtC,GAEvB,GAAW,MAAPsC,EAAa,OAAO,CAExB,IAAmB,gBAARA,GAAiB,CAE3BuE,QAAQC,IAAI,qBACZ,IAAImE,GAAW3I,CACf,KAAK4I,QAASD,GACNA,EAAS/F,eAAegG,SAC/BhK,EAAKgK,OAAS5I,EAAI4I,YAIfhK,GAAKoB,GAAOtC,CACd,OAAOkB,IAGPE,EAAQ,WACXtB,EAAIoG,KAAK,oBAAsB,SAASiF,GACvCtE,QAAQC,IAAIqE,GACZrH,EAAIqH,GACJtE,QAAQC,IAAI5F,MAIVkK,EAAQ,SAASC,EAAUC,EAAUrE,EAASG,GACjDtH,EAAIsL,MAAMC,EAAUC,GACnBrE,QAAQ,SAASsE,GACjB1E,QAAQC,IAAIyE,GACZ7H,EAAQ+B,aAAa+F,QAAQ,gBAAiBD,EAASE,cACnDxE,GAASA,EAAQsE,KAErBnE,MAAM,SAASjB,GACfU,QAAQC,IAAIX,GACTiB,GAAOA,EAAMjB,MAIduF,EAAS,WACZhI,EAAQ+B,aAAakG,WAAW,iBAChCzK,KACA2F,QAAQC,IAAI,cACZ7F,EAAUY,KAAK,UAGf,QACGyE,IAAI,WAAY,MAAOpF,IACvBC,WAAaA,EACb2C,IAAKA,EACLsH,MAAMA,EACNM,OAAOA,EACPtK,MAAOA,GAlEXW,QACGC,OAAO,SACP4F,QAAQ,QAASoD,GAErBA,EAAMD,SAAW,YAAa,UAAW;CCP1C,WAQE,QAASa,GAAkBC,EAAQC,EAASzD,EAAUvI,EAAKoB,GAsD3D,QAAS6K,GAAUC,GAClBA,EAAQA,IAAS,EACjBH,EAAOI,WACPJ,EAAOK,SACHF,IAAOH,EAAO3D,QAAS,GAU5B,QAASiE,GAAiB7J,EAAK0B,GAC9B,GAAIoI,GAAUP,EAAO3K,KAAKmL,UAAUpK,OAAO,SAAUqK,GAClD,MAAQA,GAAIhK,IAAQ0B,GAEvB,OAAOoI,GAAQ,GAtEfP,EAAOU,SAAQ,EACfV,EAAO3D,QAAO,EACf2D,EAAOW,WACPX,EAAOK,SACPL,EAAO3K,KAAOA,EAAKoF,KAKnBuF,GAAOY,cAAgB,SAASC,GAC/B,IAAKC,EAAI,EAAGA,EAAGd,EAAO3K,KAAKmL,UAAUzK,OAAQ+K,IAAI,CAChD,GAAIL,GAAMT,EAAO3K,KAAKmL,UAAUM,EAChCL,GAAIF,QAAWE,EAAItH,IAAM0H,EAAQ1H,GAAK,EAAE,EAEzClF,EAAIoG,KAAK,gBAAiBwG,GAC1Bb,EAAOe,cAAgBF,GAGxBb,EAAOgB,aAAe,WAErBhB,EAAO3K,KAAKmL,UAAYP,EAAQ,WAAWD,EAAO3K,KAAKmL,UAAW,YAClER,EAAOU,SAAU,GAGlBV,EAAOiB,YAAc,WACpBjB,EAAOU,SAAU,GAGlBV,EAAOI,WAGPJ,EAAOkB,KAAO,SAASC,GAEtBnB,EAAO3D,QAAS,EACX2D,EAAO3K,KAAKmL,YAAWR,EAAO3K,KAAKmL,cAGnB,mBAAVW,IACVnB,EAAOK,SACPL,EAAOI,QAAQjM,KAAO,OAKtB6L,EAAOK,MAAQL,EAAO3K,KAAKmL,UAAUW,GACrCnB,EAAOI,QAAQe,MAAQA,EACvBnB,EAAOI,QAAQjM,KAAQ+B,QAAQ+C,KAAK+G,EAAOK,SAc7CL,EAAOoB,MAAQ,WACd,GAAIC,GAAUrB,EAAOI,QAAQjM,IACb,QAAZkN,IAAkBrB,EAAO3K,KAAKmL,UAAUR,EAAOI,QAAQe,OAASnB,EAAOI,QAAQjM,MACnF+L,KAYDF,EAAOsB,OAAS,SAASC,GAExB,MAAIvB,GAAO3K,KAAKmL,UAAUzK,OAAS,GAClCyG,EAASvE,IAAI,qCAAsC,UAC5C,OAERhE,GAAIoG,KAAK,kBAAmBkH,EAAW,SAAS/M,GAE/C,IAAIsB,EAAE,EAAGA,EAAEkK,EAAO3K,KAAKmL,UAAUzK,OAAQD,IAAI,CAC5C,GAAI2K,GAAMT,EAAO3K,KAAKmL,UAAU1K,EAC5B2K,GAAItH,IAAMoI,GAAWvB,EAAO3K,KAAKmL,UAAUgB,OAAO1L,EAAE,GAGzD,GAAGtB,EAAOiN,eAAe,CACxB,GAAIC,GAAalN,EAAOiN,cACxBZ,SAAUP,EAAiB,KAAMoB,GACjCb,QAAQN,QAAQ,MAMnBP,EAAOnE,KAAO,WACb,GAAI8F,IAAS3B,EAAOK,MAAMlH,EAE1B,IADA6B,QAAQC,IAAI+E,EAAOK,OAChBsB,EAEE,IADA3B,EAAOK,MAAME,QAAU,EAClBO,EAAI,EAAGA,EAAId,EAAO3K,KAAKmL,UAAUzK,OAAQ+K,IAAK,CACjD,GAAIL,GAAMT,EAAO3K,KAAKmL,UAAUM,EAChCL,GAAIF,QAAU,EAGrBtM,EAAIoG,KAAK,gBAAiB2F,EAAOK,MAAO,SAAS7L,GAC5CmN,GAAQ3B,EAAO3K,KAAKmL,UAAUoB,KAAKpN,GACvCwL,EAAO3D,QAAS,EAChB2D,EAAOK,YAMTL,EAAO3C,SAEJzG,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,SACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,aACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,cACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,uBACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,SACRiL,aAAgB,OAGhBjL,KAAQ,QACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,OACRiL,aAAgB,OAGhBjL,KAAQ,SACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,YACRiL,aAAgB,OAGhBjL,KAAQ,QACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,gBACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,YACRiL,aAAgB,OAGhBjL,KAAQ,cACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,SACRiL,aAAgB,OAGhBjL,KAAQ,gBACRiL,aAAgB,OAGhBjL,KAAQ,aACRiL,aAAgB,OAGhBjL,KAAQ,aACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,iBACRiL,aAAgB,OAGhBjL,KAAQ,eACRiL,aAAgB,OAGhBjL,KAAQ,OACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,SACRiL,aAAgB,OAGhBjL,KAAQ,eACRiL,aAAgB,OAGhBjL,KAAQ,eACRiL,aAAgB,OAGhBjL,KAAQ,iBACRiL,aAAgB,OAGhBjL,KAAQ,eACRiL,aAAgB,OAGhBjL,KAAQ,YACRiL,aAAgB,OAGhBjL,KAAQ,QACRiL,aAAgB,OAGhBjL,KAAQ,OACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAGhBjL,KAAQ,WACRiL,aAAgB,OAGhBjL,KAAQ,aACRiL,aAAgB,OAGhBjL,KAAQ,gBACRiL,aAAgB,OAGhBjL,KAAQ,YACRiL,aAAgB,OAGhBjL,KAAQ,UACRiL,aAAgB,OAvUnB3L,QACGC,OAAO,SACPtB,WAAW,oBAAqBkL,GAEnCA,EAAkBb,SAAW,SAAU,UAAW,WAAY,MAAO;CCNvE,WAQE,QAAS4C,KACP,OACEC,SAAU,KACVnN,YAAa,0DACbC,WAAY,6BACZmN,OACF3M,KAAO,IACH0L,cAAgB,OAbtB7K,QACGC,OAAO,SACP8L,UAAU,gBAAiBH;CCJhC,WASE,QAASI,GAAYlC,EAAQmC,EAAUC,EAAUvK,EAASF,EAAM8E,GAU/D,QAAS4F,GAAaC,EAAIC,EAAUC,GAGnCF,EAAKA,EAAG,GAERC,EAAWA,EAAUD,EAAGG,YAAY,EAAG,EAEvC,IAAIC,GAAUJ,EAAGK,YAAcL,EAAGG,WAE9BF,IAAYG,IAASH,EAAWG,EAAQ,GACxCH,GAAYG,IAASH,EAAWG,EAAQ,EAC5C,IAAIE,GAAUnE,KAAKC,KAAK8D,EAAiB,IACxCK,EAAWN,EAAWD,EAAGQ,WACzBC,EAAcF,EAAWD,EACzBI,EAAcV,EAAGQ,WAAaP,EAAW,SAASzB,EAAEmC,GAAG,MAAOnC,IAAGmC,EAAE,GAAM,SAASnC,EAAEmC,GAAG,MAAOnC,IAAGmC,EAAE,GAYhGC,EAAiBC,YAAY,WAEhC,GAAGH,EAAWV,EAAGQ,WAAYP,GAAW,CACvC,GAAIa,GAAYd,EAAGQ,WAAWC,CAC1BK,IAAaV,IAASU,EAAYV,EAAQ,GAC9CJ,EAAGQ,WAAaM,MAGZC,eAAcH,IAEjB,IA5CJ,GAAII,GAAOlL,IAGXkL,GAAK7G,OAASA,EAAOhC,MACrB6I,EAAKtL,SAAWL,EAAK8C,MACrB6I,EAAKC,WAAa,IAClBD,EAAKE,SAAU,EA0CfF,EAAKG,gBAAkBC,IAAM,EAAGC,KAAO,GAIvC3D,EAAO4D,OAAO,SAAU,SAASC,EAAUC,GAG1B,GAAZD,GAEHzB,EAAS,WAGR,GAAI2B,GAAST,EAAKtL,SAASgI,EAAOgE,KAAKC,SACnCC,EAAYlE,EAAOgE,KAAKC,QAAQ,IAAIF,CACxCG,GAAYA,EAAU5N,QAAQ,aAAc,GAC5C,IAAI6N,GAAgBjO,QAAQiB,QAAQH,SAASoN,cAAc,IAAIF,GAC/DZ,GAAKG,eAAeC,IAAMS,EAAc/K,KAAK,aAC7CkK,EAAKG,eAAeE,KAAOQ,EAAc/K,KAAK,aAG9C,IAAIiL,GAAWnO,QAAQiB,QAAQH,SAASoN,cAAc,IAAIpE,EAAOgE,KAAKC,QAAQ,aAI9E,IAHAI,EAASC,KAAKZ,IAAMJ,EAAKG,eAAeC,IAAI,KAAMC,KAAOL,EAAKG,eAAeE,KAAK,KAAMY,MAAQJ,EAAc/K,KAAK,SAAS,KAAMoL,OAASL,EAAc/K,KAAK,UAAU,OAGpKvB,EAAQ4M,WAAanB,EAAKC,WAAW,CACxC,GAAImB,GAAUxO,QAAQiB,QAAQgL,EAAS,GAAGiC,cAAc,kBACpDT,EAAQe,EAAQ,GAAKpB,EAAKG,eAAeE,KAAMe,EAAQ,GAAGjC,YAAY,EAAG,GAAK,CAClFiC,GAAQtL,KAAK,aAAcuK,OAK3B,IAAGL,EAAKE,QAAQ,CACf,GAAIkB,GAAUxO,QAAQiB,QAAQgL,EAAS,GACvCuC,GAAQtL,KAAK,YAAakK,EAAKG,eAAeC,IAAM,MAIpD,OAOLJ,EAAKqB,WAAa,SAASC,EAAQzL,EAAI6F,EAAMqF,GAC5CQ,OAAS7F,EAAK1I,QAAQ,aAAc,IAChB,GAAhBgN,EAAKE,UAAkBF,EAAKE,SAAU,EAC1C,IAAIkB,GAAUxO,QAAQiB,QAAQH,SAASoN,cAAc,IAAIS,OAAO,aAC5DR,EAAWnO,QAAQiB,QAAQH,SAASoN,cAAc,IAAIS,OAAO,cAC7DnB,EAAMxN,QAAQiB,QAAQyN,EAAO9F,QAAQ1F,KAAK,aAC1CuK,EAAOzN,QAAQiB,QAAQyN,EAAO9F,QAAQ1F,KAAK,cAC3C0L,EAAO5O,QAAQiB,QAAQH,SAAS+N,iBAAiB,gBAC7CR,EAAQrO,QAAQiB,QAAQyN,EAAO9F,QAAQ,GAAGkG,YAC1CR,EAAStO,QAAQiB,QAAQyN,EAAO9F,QAAQ,GAAGmG,YAKnDH,GAAKR,KAAKY,MAAQ,SAAUC,QAAU,IACtCd,EAASC,KAAKZ,IAAMA,EAAI,KAAMC,KAAOA,EAAK,KAAMY,MAAQA,EAAM,KAAMC,OAASA,EAAO,OAEpFlB,EAAKG,gBAAkBC,IAAMA,EAAIC,KAAOA,GACpC9L,EAAQ4M,WAAanB,EAAKC,YAAYlB,EAAaqC,EAASf,EAAM,KAEtEvB,EAAS,WACR0C,EAAKR,KAAKY,MAAQ,OAAQC,QAAU,IACpCxN,EAAKM,IAAI+G,EAAK7F,IACZ,MAIJmK,EAAK8B,QAAU,SAASpG,EAAMqG,GAC7B/B,EAAKtL,SAASgH,GAAQqG,GAlIxBnP,QACGC,OAAO,SACPtB,WAAW,cAAeqN,GAE7BA,EAAYhD,SAAW,SAAU,WAAW,WAAY,UAAW,OAAQ;CCN7E,WAME,QAASwF,KACP,OACE3C,SAAU,KACVnN,YAAa,6CACbC,WAAY,sBACZmN,OACEgC,KAAO,IACPsB,QAAS,IACTjJ,OAAQ,MAZdnG,QACGC,OAAO,SACP8L,UAAU,UAAWyC;CCJ1B,WAEExO,QACGC,OAAO,SACP8L,UAAU,iBAAkB,UAAW,SAASpK,GAElD,OAEIkK,SAAU,KACVwD,SAAU,oEACV1Q,WAAY,sBACZmN,OACEgC,KAAO,IACPsB,QAAS,IACbjJ,OAAQ,KAGNmJ,KAAM,SAASxF,GAYb,QAASyF,KACP,GAAIC,GAAc7N,EAAQ4M,UACtBiB,GAAc1F,EAAOuD,WACvBvD,EAAO2F,QAAU,2DACRD,GAAe1F,EAAOuD,aAC/BvD,EAAO2F,QAAU,0DAftB3F,EAAOuD,WAAa,IAGpB1L,EAAQ+N,SAAW,WAChBH,IACAzF,EAAOnB,UAGT4G,IAmBDzF,EAAO6F,aAAe,SAAStP,EAAKC,GACtC,MAAO,UAASsP,GACf,MAAqB,IAAjBA,EAAOC,WACPxP,GAAOuP,EAAOC,OAASxP,MACvBC,GAAOsP,EAAOC,OAASvP;CClDlC,WAME,QAASwP,KACP,OACEjE,SAAU,KACVnN,YAAa,oDACbC,WAAY,sBACZmN,OACEgC,KAAO,IACPsB,QAAS,IACTjJ,OAAQ,MAZdnG,QACGC,OAAO,SACP8L,UAAU,gBAAiB+D;CCJhC,WAME,QAASC,KACP,OACElE,SAAU,KACVnN,YAAa,mDACbC,WAAY,sBACZmN,OACEgC,KAAO,IACPsB,QAAS,IACTjJ,OAAQ,KAEVmJ,KAAM,SAASxF,GACdA,EAAOkG,kBAAoB,SAASvP,GACtC,MAAO,UAASwP,GAEf,MADAC,GAAc,GAAVzP,EAAc,OAAO,SAClBwP,EAAMC,OAlBjBlQ,QACGC,OAAO,SACP8L,UAAU,eAAgBgE;CCJ/B,WAUE,QAASI,GAAWxO,EAASmI,EAAQ9L,EAAIyD,GACxC,GAAI2O,GAAOlO,IAEZkO,GAAKC,WAAY,EACjBD,EAAKE,MAAO,EACZF,EAAKG,KAAOC,EAAI,GAAIC,EAAI,IACxBL,EAAKM,SAAW,WAAY,MAAO/O,GAAQ4M,WAAW,KAGtD6B,EAAKO,WAAa,WACjBP,EAAKE,MAAQF,EAAKE,MAGnBF,EAAKQ,SAAW,WACfR,EAAKS,aAAeL,EAAI,EAAEC,EAAI,GAC9B3G,EAAOnB,UAGRyH,EAAKU,UAAY,WAChB,OAAIV,EAAKM,aACTN,EAAKG,IAAM,YACXH,EAAKC,WAAY,EACjBU,OAAS/Q,QAAQiB,QAAQH,SAAS+N,iBAAiB,wBACnDmC,YAAW,WACVD,OAAO3C,KAAK6C,mBAAmBb,EAAKG,OAClC,OAGJH,EAAKc,WAAY,SAASC,GAEzBf,EAAKgB,YAAYZ,EAAIW,EAAEE,QAAQ,GAAGC,QAAQb,EAAIU,EAAEE,QAAQ,GAAGE,SAE3DnB,EAAKoB,UAGNpB,EAAKqB,UAAYjB,EAAI,EAAEC,EAAI,GAC1BL,EAAKS,aAAeL,EAAI,EAAEC,EAAI,GAE/BL,EAAKsB,UAAW,SAASP,GAExB,GAAIJ,GAAS/Q,QAAQiB,QAAQH,SAAS+N,iBAAiB,mBAEvD,KAAKuB,EAAKM,WAAY,OAAO,CAE7B,KAAKN,EAAKE,KAAM,OAAO,CAEvBa,GAAEQ,gBAGF,IAAIC,GAAQT,EAAEE,QAAQ,GACtBzI,EAASgJ,EAAMhJ,OACfiJ,GACCrB,EAAMoB,EAAMN,QAAQlB,EAAKgB,WAAWZ,EACpCC,EAAMmB,EAAML,QAAQnB,EAAKgB,WAAWX,GAIjCD,EAAIqB,EAAKrB,EAAEJ,EAAKS,YAAYL,EAChCC,EAAIoB,EAAKpB,EAAEL,EAAKS,YAAYJ,EAGxBD,EAAKA,EAAE5H,EAAOkG,YAAY,IAAKsB,EAAKqB,SAASjB,EACjDC,EAAKA,EAAE7H,EAAOmG,aAAa,IAAKqB,EAAKqB,SAAShB,EAG1CqB,GAAQrB,KAAOD,KACnBsB,GAAOrB,EAAEjD,IAAS,GAClBsE,EAAOrB,EAAEsB,WACTD,EAAOtB,EAAE/C,UACTqE,EAAOtB,EAAExB,MAAS,GAGdyB,EAAEqB,EAAOrB,EAAEjD,MAAKiD,EAAIqB,EAAOrB,EAAEjD,KAC7BiD,EAAEqB,EAAOrB,EAAEsB,SAAQtB,EAAIqB,EAAOrB,EAAEsB,QAChCvB,EAAEsB,EAAOtB,EAAE/C,OAAM+C,EAAIsB,EAAOtB,EAAE/C,MAC9B+C,EAAEsB,EAAOtB,EAAExB,QAAOwB,EAAIsB,EAAOtB,EAAExB,MAGnC,IAAIgD,IAAQxB,EAAIA,EAAEC,EAAIA,EACtBL,GAAKqB,SAAWO,CAGhB,IAAIzB,IAAOC,EAAI,MAAQC,EAAI,KAC3BM,GAAO3C,KAAK6C,mBAAmBV,IAE/BH,EAAKS,YAAcgB,EACnB/H,EAAOnB,UAORyH,EAAK6B,QAAU,SAASC,EAAG3S,GAM1B,GAJAuF,QAAQC,IAAIxF,EAAM4S,YAIb/B,EAAKM,WAAY,OAAO,CAG7B,KAAKN,EAAKE,KAAM,OAAO,CAEvB,IAAIS,GAAS/Q,QAAQiB,QAAQH,SAAS+N,iBAAiB,oBAIvDuD,GAHezR,OAAO0R,YACTtB,EAAO,GAAGzC,QAGtBD,MAAQ9O,EAAMqJ,OAAOkG,YACrBR,OAAS/O,EAAMqJ,OAAOmG,eAKnB8C,GACHrB,EAAMjR,EAAM+S,OACZ7B,EAAMlR,EAAMgT,QAMT/B,EAAIqB,EAAKrB,EAAEJ,EAAKS,YAAYL,EAChCC,EAAIoB,EAAKpB,EAAEL,EAAKS,YAAYJ,CAE5B3L,SAAQC,IAAIyL,EAAEC,EAGd,IAAID,GAAIjI,KAAKiK,IAAIhC,GAAG4B,EAAM/D,MAAM,GAChCmC,GAAKqB,EAAKrB,EAAE,GAAIA,EAAEA,CAClB,IAAIC,GAAIlI,KAAKiK,IAAI/B,GAAG2B,EAAM9D,OAAO,GACjCmC,GAAKoB,EAAKpB,EAAE,GAAIA,EAAEA,EAGlBD,GAAIJ,EAAKqB,SAASjB,EAClBC,GAAIL,EAAKqB,SAAShB,CAGlB,IAAIqB,IAAQrB,KAAOD,KASnBsB,GAAOrB,EAAEjD,IAAS,GAClBsE,EAAOrB,EAAEsB,WACTD,EAAOtB,EAAE/C,UACTqE,EAAOtB,EAAExB,MAAS,GAEdyB,EAAEqB,EAAOrB,EAAEjD,MAAKiD,EAAIqB,EAAOrB,EAAEjD,KAC7BiD,EAAEqB,EAAOrB,EAAEsB,SAAQtB,EAAIqB,EAAOrB,EAAEsB,QAChCvB,EAAEsB,EAAOtB,EAAE/C,OAAM+C,EAAIsB,EAAOtB,EAAE/C,MAC9B+C,EAAEsB,EAAOtB,EAAExB,QAAOwB,EAAIsB,EAAOtB,EAAExB,MAGnC,IAAIgD,IAAQxB,EAAIA,EAAEC,EAAIA,EAEtB3L,SAAQC,IAAIiN,GAEZ5B,EAAKqB,SAAWO,CAIhB,IAAIzB,IAAOC,EAAI,MAAQC,EAAI,KAC3BM,GAAO3C,KAAK6C,mBAAmBV,IAO/BH,EAAKS,YAActR,EAAMkT,SAAWjC,EAAI,EAAEC,EAAI,GAAKoB,GAUpDzB,EAAKsC,UAAY,SAASlC,EAAEC,GAE3BO,WAAW,WACVZ,EAAKC,WAAY,GACf,KAGH+B,MAAQpS,QAAQiB,QAAQH,SAASoN,cAAc,gBAAgB,GAC/DyE,OAASP,MAAMtD,YACf8D,QAAUR,MAAMrD,aAChB8D,KAAOT,MAAMU,wBACbC,QAAUX,MAAMY,cAAcC,gBAE9BC,QAAUL,KAAKrF,IAAM7L,EAAQwR,YAAcJ,QAAQK,UACnDC,QAAUR,KAAKpF,KAAO9L,EAAQ2R,YAAcP,QAAQQ,WAGpDC,WAAchD,EAAI6C,SAAWV,OAAU,IACvCc,WAAchD,EAAIyC,SAAWN,QAAW,IAUpCjR,EAAQ4M,WAAa6B,EAAK/C,WAAYkD,IAAO,IAAIiD,UAAa,MAAQ,IAAIC,WAAa,MACtFlD,IAAM,UAAc,KAAO,UAAc,MAC9CH,EAAKG,IAAIA,IACTQ,OAAS/Q,QAAQiB,QAAQH,SAAS+N,iBAAiB,oBACnDkC,OAAO3C,KAAK6C,mBAAmBV,OAGhCH,EAAKsD,WAAa,SAAShF,GAE1B0B,EAAKsC,UAAUhE,EAAOiF,MAAMjF,EAAOkF,QAtOpC5T,QACGC,OAAO,SACPtB,WAAW,aAAcwR,GAE5BA,EAAWnH,SAAW,UAAW,SAAU,KAAM;CCNnD,WAQE,QAAS6K,KACP,OACEhI,SAAU,KACVnN,YAAa,oDACbC,WAAY,qBACZmN,OACEhK,SAAW,KAEbwN,KAAM,SAASxD,EAAOgI,EAAKC,EAAOC,GAGlCF,EAAIG,GAAG,aAAc,SAAS9C,GAC/BrF,EAAMsE,KAAKc,WAAWC,KAGrB2C,EAAIG,GAAG,YAAa,SAAS9C,GAC9BrF,EAAMsE,KAAKsB,UAAUP,KAGpB2C,EAAIG,GAAG,WAAY,SAAS9C,GAC7BrF,EAAMsE,KAAKQ,SAASO,OA1BvBnR,QACGC,OAAO,SACP8L,UAAU,aAAc8H;CCJ7B,WAMG,QAASK,KACT,OAEIrI,SAAU,KACVzL,SAAQ,EACXiP,SAAU,mCACPvD,OACEqI,MAAQ,KACRlW,KAAM,KAERqR,KAAM,SAAcxD,EAAO7K,EAAS8S,GACnCjP,QAAQC,IAAIgP,EACf,IAAIK,GAAOL,EAAM1E,SAAW0E,EAAM1E,SAAW,WAC1CvD,GAAMuI,aAAa,yBAAyBD,EAAK,mBAjBvDpU,QACGC,OAAO,SACP8L,UAAU,WAAYmI;CCJ3B,WAEElU,QACGC,OAAO,SACP8L,UAAU,YAAa,OAAQ,MAAO,SAAStK,EAAM1D,GAEvD,OAEI8N,SAAU,KACbnN,YAAa,gDACVoN,OACEwI,OAAS,KACT7S,KAAM,MAGR6N,KAAM,SAASxF,GAEjBA,EAAO7L,KAAOF,EAAIG,UAClB4L,EAAOrI,KAAOqI,EAAOrI,MAAQA,EAAK8C,KAElC,IAAIgQ,IACH,YACA,cACA,gBACA,mBACA,mBACA,mBACA,kBAGDzK,GAAO0K,UAAY,SAASC,GAC3B,GAAIC,IACHjS,UAAc,SACdkS,YAAe,cACfjS,iBAAqB,gBACrBC,cAAkB,aAClBC,iBAAqB,gBACrBL,iBAAqB,SACrBC,gBAAoB,QAGpB,OAAOkS,GAAYD,IAIrB3K,EAAOwK,OAASxK,EAAOwK,QAAUC,EAEjCzK,EAAO8K,WAAa,SAASH,GAG5B,GAAIA,EAAMI,QAAQ,kBACjB,IAAK3Q,EAAE,EAAGA,EAAE4F,EAAO7L,KAAK6W,QAAQjV,OAAQqE,IACvC,GAAI4F,EAAO7L,KAAK6W,QAAQ5Q,GAAGjB,IAAM6G,EAAOrI,KAAKgB,UAC5C,MAAOqH,GAAO7L,KAAK6W,QAAQ5Q,GAAGyQ,WAMjC,IAAIF,EAAMI,QAAQ,MAAQ,EACzB,MAAO/K,GAAOrI,KAAKgT,EAIpB,IAAIM,IACHtS,UAAc,UACdC,iBAAqB,UACrBC,cAAkB,UAClBC,iBAAqB,UACrBL,iBAAqB,iBACrBC,gBAAoB,iBAGXwS,GACHzS,iBAAmB,UAGtB0S,EAAQD,EAAcP,IAAU,MAEpC,OAAO3K,GAAO7L,KAAKiX,OAAOH,EAAQN,GAAQ,KAAM3K,EAAOrI,KAAKgT,GAAQQ,IAIrEnL,EAAOqL,aAAe,SAASlX,GAC9BmX,UACA,KAAK,GAAIC,KAAKpX,GACLA,EAAKkF,eAAekS,IAAMvL,EAAOwK,OAAOO,QAAQQ,IAAI,IACzDD,QAAQC,GAAGpX,EAAKoX,GAGpB,OAAOD;CC1Fb,WAQE,QAASE,GAAcpW,EAAWC,EAAMmH,EAAUwD,EAAQ/L,GAWzD,QAASwX,GAAcC,GACrB,GAAIC,GAAK,wJACT,OAAOA,GAAGC,KAAKF,GAgDlB,QAASG,GAAiBpM,GAGvB,MAAOA,GAAS1J,OAAS,GAAK0J,EAAS1J,OAAS,IAAM0J,EAASqM,OAAO,UAAarM,EAASqM,OAAO,UA/DpG,GAAIC,GAAQ3T,IAEd2T,GAAMvP,SAASA,EAAS/B,MAExBsR,EAAMC,aACFC,WAAa,GACbC,cAAgB,IAiBpBH,EAAMxM,MAAQ,SAASmM,EAAOjM,GAC7BjD,EAASzD,QACHgT,EAAMI,sBACTnR,QAAQC,IAAI,SACX5F,EAAKkK,MAAMmM,EAAOjM,EAAU,WAC1BO,EAAOpF,UAAUoF,EAAOpF,WACxBoF,EAAOoM,UAAgC,SAApBpM,EAAOoM,UAAqBhX,EAAUY,KAAKgK,EAAOoM,UACpEpM,EAAOpF,UAAaoF,EAAOoM,UAAUhX,EAAUY,KAAK,YAE1D,SAASsE,GACW,mCAAfA,EAAI4B,UAA8C5B,EAAI4B,QAAU,wCACpEM,EAASvE,IAAIqC,EAAI4B,QAAQ,aAM5B6P,EAAMI,kBAAoB,WACzB,MAAIV,GAAcM,EAAMC,YAAYC,cAI/BF,EAAMC,YAAYE,gBACtB1P,EAASvE,IAAI,0BAA2B,UACjC,IALPuE,EAASvE,IAAI,qCAAsC,UAC5C,IAuBT8T,EAAMM,gBAAiB,EACvBN,EAAMO,iBAAkB,EACH,uBAAlBlX,EAAUY,SACZ+V,EAAMM,gBAAiB,EACvBN,EAAMQ,eAAgB,EACnBnX,EAAU0W,SAASJ,QACrBK,EAAMC,YAAYC,WAAa7W,EAAU0W,SAASJ,QAOpDK,EAAMS,cAAgB,WACrBhQ,EAASzD,QACHgT,EAAMU,mBACTzR,QAAQC,IAAI,0BACd5F,EAAKmX,cAAcT,EAAMC,YAAYC,WACpC,SAASzX,GAASuX,EAAMO,iBAAkB,GAC1C,SAAShS,GACRA,EAAI4B,QAAyB,4CAAf5B,EAAI4B,QAAwD,qDAAuD5B,EAAI4B,QACrIM,EAASvE,IAAIqC,EAAI4B,QAAQ,aAO7B6P,EAAMU,eAAiB,WACtB,QAAIhB,EAAcM,EAAMC,YAAYC,cACnCzP,EAASvE,IAAI,qCAAsC,UAC5C,IAMT8T,EAAMW,cAAgB,WACrBlQ,EAASzD,QACHgT,EAAMY,oBACXxY,MACCuX,MAAQK,EAAMC,YAAYC,WAC1BW,MAAQb,EAAMC,YAAYa,iBAC1BpN,SAAWsM,EAAMC,YAAYc,aAE5BzX,EAAKqX,cAAcvY,KACpB,SAASK,GACNwG,QAAQC,IAAIzG,GACdgI,EAASvE,IAAI,+CAAgD,WAC7D8T,EAAMM,gBAAiB,EACvBN,EAAMO,iBAAkB,GAEzB,SAAShS,GACRkC,EAASvE,IAAIqC,EAAI4B,QAAQ,aAO7B6P,EAAMY,gBAAkB,WACvB,MAAIlB,GAAcM,EAAMC,YAAYC,YAK/BF,EAAMC,YAAYa,kBAKlBhB,EAAiBE,EAAMC,YAAYc,cACnCtQ,EAASvE,IAAI,8IAGd8T,EAAMC,YAAYc,cAAgBf,EAAMC,YAAYe,qBACvDvQ,EAASvE,IAAI,yCAA0C,UAChD,KAVPuE,EAASvE,IAAI,qCAAsC,UAC5C,IANPuE,EAASvE,IAAI,qCAAsC,UAC5C,IAqBT8T,EAAMiB,QAAU,aA7JhB9W,QACGC,OAAO,SACPtB,WAAW,gBAAiB2W,GAE/BA,EAActM,SAAW,YAAa,OAAQ,WAAY,SAAS;CCNrE,WAQE,QAAS+N,KACP,OACElL,SAAU,KACVnN,YAAa,kDACbC,WAAY,yBACZmN,OACFoK,SAAW,KACRxR,SAAW,KACXsS,OAAS,OAddhX,QACGC,OAAO,SACP8L,UAAU,YAAagL;CCJ5B,WAOE,QAASE,GAAe9X,EAAM2G,EAAQrE,GACpC,GAAIyV,GAAKhV,IAEXgV,GAAGpR,OAASA,EAAOvB,IAAI,UACvB2S,EAAGC,MAAQrR,EAAOvB,IAAI,SACtB2S,EAAGE,SACHF,EAAGE,MAAMC,MAAK,EACdH,EAAGI,YAAa,EAEhBJ,EAAG9X,WAAaD,EAAKC,aAErB8X,EAAGvN,OAAS,WACXxK,EAAKwK,SACLlI,EAAKpC,MAAMoC,EAAKW,cAlBjBpC,QACGC,OAAO,SACPtB,WAAW,iBAAkBsY,GAEhCA,EAAejO,SAAW,OAAQ,SAAU;CCN9C,WAME,QAASuO,KACP,OACE1L,SAAU,KACVnN,YAAa,kDACbC,WAAY,2BARhBqB,QACGC,OAAO,SACP8L,UAAU,aAAcwL;CCJ7B,WAQE,QAASC,GAAiB1N,EAAQ5K,EAAWC,EAAMsY,EAAMnR,GACvD,GAAIoR,GAAQxV,IAEdwV,GAAMpR,SAASA,EAAS/B,MAExBmT,EAAM5B,aACF6B,WAAa,GACbC,UAAU,GACVpC,MAAQ,GACRjM,SAAW,IAIfmO,EAAMG,yBAA2B,WAEhC,QAASlC,GAAiBpM,GAYzB,MACCmO,GAAM5B,YAAYvM,SAAS1J,OAAS,GACpC6X,EAAM5B,YAAYvM,SAAS1J,OAAS,IACpC6X,EAAM5B,YAAYvM,SAASqM,OAAO,UAC9B8B,EAAM5B,YAAYvM,SAASuO,MAAM,UAIvC,QAASvC,GAAcC,GACpB,GAAIC,GAAK,wJACT,OAAOA,GAAGC,KAAKF,GAGlB,MAAKkC,GAAM5B,YAAYN,OAAUkC,EAAM5B,YAAY6B,YAAeD,EAAM5B,YAAY8B,WAAcF,EAAM5B,YAAYvM,UAAamO,EAAM5B,YAAYiC,gBAK9IpC,EAAiB+B,EAAM5B,YAAYvM,UAKpCmO,EAAM5B,YAAYvM,WAAamO,EAAM5B,YAAYiC,iBACpDzR,EAASvE,IAAI,yCAA0C,UAChD,KAGJwT,EAAcmC,EAAM5B,YAAYN,SACnClP,EAASvE,IAAI,sCAAuC,UAC7C,IAXPuE,EAASvE,IAAI,+IACN,IANPuE,EAASvE,IAAI,0BAA2B,UACjC,IAyBP2V,EAAMM,aAAe,WACpB1R,EAASzD,OACT,IAAIoV,GAAQP,EAAMG,0BAElB,OADA/S,SAAQC,IAAIkT,KACRA,OAEH9Y,GAAK+Y,SAASR,EAAM5B,YAAYN,MAAOkC,EAAM5B,YAAYvM,SAAUmO,EAAM5B,YAAY6B,WAAYD,EAAM5B,YAAY8B,UAAW,WAC3H9N,EAAOpF,UAAUoF,EAAOpF,SAASgT,EAAM5B,aACvChM,EAAOoM,UAAUhX,EAAUY,KAAKgK,EAAOoM,UACtCpM,EAAOpF,UAAaoF,EAAOoM,UAAUhX,EAAUY,KAAK,YAExD,SAASsE,IACJA,EAAI4B,QAAU,6BAA2B5B,EAAI4B,QAAU,oCAC5DM,EAASvE,IAAIqC,EAAI4B,QAAS,YAtF9BhG,QACGC,OAAO,SACPtB,WAAW,mBAAoB6Y,GAElCA,EAAiBxO,SAAW,SAAU,YAAa,OAAQ,OAAQ;CCNrE,WAQE,QAASmP,KACP,OACEtM,SAAU,KACVnN,YAAa,wDACbC,WAAY,4BACZmN,OACFoK,SAAW,KACRxR,SAAW,OAbhB1E,QACGC,OAAO,SACP8L,UAAU,eAAgBoM;CCJ/B,WAQE,QAASC,GAAWtO,EAAQnC,GAI3BmC,EAAOuO,cAAe,EAEtB1Q,EAAUD,cAAeoC,EAAOwO,QAC/B9S,KAAK,WACLsE,EAAOuO,cAAe,GAEvB,WACCvT,QAAQC,IAAI,6BAKb+E,EAAOyO,aAAe,EAEtBzO,EAAO0O,qBAAuB,SAAUvN,GACtCnB,EAAOyO,aAAetN,GAGxBnB,EAAO2O,oBAAsB,SAAUxN,GACrC,MAAOnB,GAAOyO,eAAiBtN,GAGjCnB,EAAO4O,UAAY,WACjB5O,EAAOyO,aAAgBzO,EAAOyO,aAAezO,EAAOwO,OAAOzY,OAAS,IAAOiK,EAAOyO,aAAe,GAGnGzO,EAAO6O,UAAY,WACjB7O,EAAOyO,aAAgBzO,EAAOyO,aAAe,IAAOzO,EAAOyO,aAAezO,EAAOwO,OAAOzY,OAAS,GArCpGG,QACGC,OAAO,SACPtB,WAAW,aAAcyZ,GAE5BA,EAAWpP,SAAW,SAAU;CCNlC,WAME,QAAS4P,KACP,OACE/M,SAAU,KACVnN,YAAa,0CACbC,WAAY,qBACZmN,OACEwM,OAAS,IACTO,WAAa,MAXnB7Y,QACGC,OAAO,SACP8L,UAAU,SAAU6M;CCJzB,WAQE,QAASE,GAAWhP,EAAQvD,EAAQxI,EAAK0D,GA0CrC,QAASsX,GAASC,EAAQC,GACxB,GAAIC,GAAMC,EAAYH,GAAQC,EAM9B,OALIC,MAAQ,EACI,SAAVF,EAAmBrY,OAAOqK,KAAKkO,EAAK,SACnCvY,OAAOqK,KAAKkO,EAAK,GAAI,2EAEvBpU,QAAQC,IAAI,+BACV,EA/CZ,GAAIqU,GAAOlX,IACXkX,GAAK3X,KAAOqI,EAAOrI,KACnB2X,EAAKC,mBAAsBvP,EAAOuP,mBAElCD,EAAKE,UAAY,WAChB,GAAIJ,GAAM,kCAEV,OADAA,IAAOnb,EAAI6H,YAAYkE,EAAOrI,MAI/B,IAAI0X,MAEAI,EAAc,6BACdC,EAAoB,2DAGxBL,GAAYM,SAAW,SAASP,GAC/B,IAAKA,EAAK,OAAO,CACjB,IAAIQ,GAAa,gDAAgDR,CACjE,OAAOQ,IAIRP,EAAYQ,QAAU,SAAST,GAC9B,QAAKA,GACE,yCAAyCK,EAAY,yBAAyBL,GAItFC,EAAY3D,MAAQ,SAAS0D,GAC5B,MAAO,oBAAoBK,EAAY,SAASC,EAAkB,MAAMN,GAIzEC,EAAYS,UAAY,SAAUV,GACjC,QAAIA,GACG,+DAA+DA,EAAI,gBAAgBK,EAAY,MAAMC,GAc7GJ,EAAKS,MAAQ,SAASb,GACjB,GAAIC,GAAWG,EAAKE,WACpBP,GAASC,EAAQC,IA5DvBjZ,QACGC,OAAO,SACPtB,WAAW,aAAcma,GAE5BA,EAAW9P,SAAW,SAAU,SAAU,MAAO;CCNnD,WAEEhJ,QACGC,OAAO,SACP8L,UAAU,iBAAkB,WAE9B,OAEIF,SAAU,KACVzL,SAAQ,EACX1B,YAAa,0DACVoN,OACErK,KAAO,IACPqY,QAAS,IACTC,SAAS,IACbC,SAAS,KAEPrb,WAAY;CCjBnB,WAOE,QAASsb,GAAU/a,EAAWgb,GAG5B,GAAIhD,GAAKhV,IAETgV,GAAG/X,QACH+a,EAASC,aACNjV,QAAQ,SAASjH,GACjB6G,QAAQC,IAAI,8BACXD,QAAQC,IAAI9G,KAEboH,MAAM,SAAU8L,GACfrM,QAAQC,IAAIoM,KAjBlBnR,QACGC,OAAO,SACPtB,WAAW,YAAasb,GAE3BA,EAAUjR,SAAW,YAAa;CCNpC,WAOE,QAASoR,GAAWrQ,EAAS7K,EAAWyC,EAASF,EAAM8E,EAAQuD,EAAQxD,EAAUR,EAAQ3G,EAAMpB,EAAK2D,EAAc5D,GAkGlH,QAASyX,GAAcC,GACpB,GAAIC,GAAK,wJACT,OAAOA,GAAGC,KAAKF,GAGlB,QAAS6E,GAAoBC,GAC3B,GAAIC,GAAU,oDACd,OAAOD,GAASxC,MAAMyC,GA6DxB,QAAS5E,GAAiBpM,GACzB,GAAIkM,GAAK,wDACT,OAAOA,GAAGC,KAAKnM,GAiFhB,QAASiR,GAAa/V,GACrB,IAAK,GAAIgW,GAAE,EAAGA,EAAIvD,EAAGwD,MAAM7a,OAAQ4a,IAC/B,GAAIvD,EAAGwD,MAAMD,GAAGxX,KAAOwB,EAAQ,MAAOgW,GAzPzC,GAAIvD,GAAKhV,IACXqE,GAAOE,WACPyQ,EAAG3Q,OAAOA,EAAOhC,MACjB2S,EAAG5Q,SAASA,EAAS/B,MACrB2S,EAAGjZ,KAAOH,EACVgH,QAAQC,IAAI,QACZD,QAAQC,IAAImS,EAAGjZ,KAAKiX,OAAO,iBAAkB,KAAM,EAAG,SAEtDgC,EAAGwD,MACH3c,EAAIoG,KAAK,aAAc,KAAM,SAASwW,GACrCzD,EAAGwD,MAAQC,IAIZzD,EAAG0D,UACD7c,EAAIoG,KAAK,cAAe,KAAM,SAAS7F,GACtC4Y,EAAG0D,OAAStc,CAEZ,KAAI,GAAIsB,GAAE,EAAGA,EAAEsX,EAAG0D,OAAO/a,OAAQD,IAChCsX,EAAG2D,SAAS3D,EAAG0D,OAAOhb,MAMxBsX,EAAG2D,SAAW,SAASC,GACrBhW,QAAQC,IAAI,kBACZ,IAAII,GAAY2V,EAAMC,YAAY,GAAG3V,cAGrC,IAAI,EAAYyP,QAAQ,eAAiB,EACvC,MAAOiG,GAAMC,YAAY,GAAG3V,cAK5B,IAAI4V,GAAYjd,EAAI6H,YAAYkV,EAAMC,YAAY,GAClDtZ,GAAKkD,yBAAyBmW,EAAMC,YAAY,GAAIC,EAAW,SAASlZ,GAEvEgD,QAAQC,IAAI,0BACZD,QAAQC,IAAIjD,GACZgD,QAAQC,IAAI+V,GAEZhZ,EAAS4D,OAAS5D,EAAS4D,MAAMzH,KAC9BF,EAAIoG,KAAK,kBAAmB2W,EAAMC,YAAY,GAAGrV,MAAO,SAAUpH,GAChEwc,EAAMC,YAAY,GAAG3V,eAAiB9G,EAAO4a,IAAM,eAEnDnb,EAAIoG,KAAK,gBAAiB2W,MAG5BA,EAAMC,YAAY,GAAG3V,eAAiBtD,EAASsD,eAAiB,eAEhErH,EAAIoG,KAAK,gBAAiB2W,OAMpC5D,EAAGtW,OAAO,WACTkJ,EAAOoN,GAAKA,GAIbA,EAAG+D,YACH/D,EAAG+D,SAASzQ,WACZ0M,EAAG+D,SAASC,UACZhE,EAAG+D,SAAShd,QACZiZ,EAAG+D,SAASE,UACXlV,KAAO,GACPD,QAAU,IAGXkR,EAAGkE,oBAAsB,WACxB,GAAIC,GAAcnE,EAAGoE,aAAaP,YAAY,GAAG9X,GAC7CsY,EAAarE,EAAGsE,YAAYC,SAChC1d,GAAIoG,KAAK,iBAAkBlB,GAAGoY,EAAaI,UAAUF,KAGtDrE,EAAG+D,SAASS,OAAS,SAASjH,GAC7ByC,EAAG+D,SAASzQ,QAAQiK,IAAS,EAC7ByC,EAAG/X,KAAKsV,GAASyC,EAAG+D,SAAShd,KAAKwW,IAGnCyC,EAAG+D,SAASU,UAAY,SAASlH,GAChCyC,EAAG+D,SAAShd,KAAKwW,GAASzU,QAAQ+C,KAAKmU,EAAG/X,KAAKsV,IAC/CyC,EAAG+D,SAASzQ,QAAQiK,IAAO,GAI5ByC,EAAG0E,WAAa,SAASC,EAAMC,GAC9B,GAAIA,GAASA,GAAU,aACnBD,EAAO,GAAIE,MAAKF,EACpB,OAAO9R,GAAQ,QAAQ8R,EAAMC,IAc9B5E,EAAG+D,SAASe,SAAW,SAASvH,EAAOxW,GAEtC,MAAa,SAATwW,IACCc,EAActX,KAEjBqI,EAASvE,IAAI,qCAAsC,UAC5C,GAIS,eAAT0S,MACJ4F,EAAoBpc,KAEvBqI,EAASvE,IAAI,oCAAqC,UAC3C,KAQVmV,EAAG+D,SAAStV,KAAO,SAAS8O,GAEvByC,EAAG+D,SAASe,SAASvH,EAAOyC,EAAG/X,KAAKsV,KACvCtV,EAAK8c,OAAO/E,EAAG/X,KAAM,SAASb,GAC7B4Y,EAAG+D,SAASC,OAAOzG,IAAS,EAC5ByC,EAAG+D,SAASzQ,QAAQiK,IAAS,KAShCyC,EAAG/X,KAAOA,EAAKoF,MAOf2S,EAAGgF,UACF1R,SAAY,EACZ2R,YAAgB,GAChBC,QAAW,GACXC,eAAmB,GACnBnR,MAAS,WACRgM,EAAGgF,SAAS1R,SAAU,EACtB0M,EAAGgF,SAASC,YAAc,GAC1BjF,EAAGgF,SAASE,QAAU,GACtBlF,EAAGgF,SAASG,eAAiB,GAC7B/V,EAASzD,UAUXqU,EAAGoF,qBAAuB,WAMzB,MAJK3G,GAAiBuB,EAAGgF,SAASE,UACjC9V,EAASvE,IAAI,6QAGVmV,EAAGgF,SAASE,UAAYlF,EAAGgF,SAASG,iBACvC/V,EAASvE,IAAI,6CAA8C,UACpD,IAOPmV,EAAGqF,eAAiB,WAEnB,GADAjW,EAASzD,QACLqU,EAAGoF,uBAAuB,CAC7B,GAAIE,IACHvZ,GAAGiU,EAAG/X,KAAK8D,GACXsG,SAAS2N,EAAGgF,SAASE,QACrBK,aAAavF,EAAGgF,SAASC,YAE5Bhd,GAAK8c,OAAOO,EAAc,SAASle,GAClC4Y,EAAGgF,SAAShR,QACZ5E,EAASvE,IAAI,iCAAkC,YAEhD,SAASqC,GACRkC,EAASvE,IAAIqC,EAAI4B,QAAS,aAU3BkR,EAAGwF,QAAU,SAASA,GACpB,GAAIC,IACHC,MAAMF,EAAQE,MACjBC,eAAeH,EAAQG,eACvBC,cAAcJ,EAAQI,cACtBC,oBAAoBL,EAAQK,oBAC5B/Z,QAAQ0Z,EAAQ1Z,QAChBga,UAAUN,EAAQM,UAClBC,OAAOP,EAAQO,OAGhBN,GAAeO,kBAAkB,EAC9BP,EAAeQ,gBAAgB,EAC/BR,EAAeS,cAAc,EAC7BT,EAAeU,gBAAkBX,EAAQ3B,YAAY,GAAG9X,GAExDlF,EAAIoG,KAAK,eAAgBwY,EAAgB,SAASW,GACjDpe,EAAUY,KAAK,QAAQwd,EAASra,OAKrCiU,EAAGqG,SAAW,SAASC,GACtB5Y,SAAW7G,EAAI6H,YAAY4X,GAC3B/b,EAAKpC,MAAMuF,UAAU,GACrB1F,EAAUY,KAAK,gBAGhBoX,EAAGsE,eACHtE,EAAGuG,WAAa,SAAShc,GACxByV,EAAG3Q,OAAOmX,aAAc,EACxBxG,EAAGsE,YAAY/Z,GAGhByV,EAAGyG,YAAc,SAAS7C,GACzB5D,EAAG3Q,OAAOqX,cAAe,EACzB1G,EAAGoE,aAAaR,EAChB5D,EAAGsE,YAAcV,EAAMC,YAAY,IASpC7D,EAAG2G,WAAa,SAASpZ,GACxB1G,EAAIoG,KAAK,eAAgBM,EAAQ,SAASnG,GACzC,GAAI2M,GAAQuP,EAAa/V,EACzByS,GAAGwD,MAAMpP,OAAOL,EAAO,MAIzBiM,EAAG4G,UAAY,SAASrZ,GACvBvF,EAAUY,KAAK,UAAU2E,IAGxByS,EAAG6G,WAAa,SAASC,GACvB9e,EAAUY,KAAK,QAAQke,IAhR3Bhe,QACGC,OAAO,SACPtB,WAAW,aAAcyb,GAE5BA,EAAWpR,SAAW,UAAW,YAAa,UAAW,OAAO,SAAU,SAAU,WAAY,SAAU,OAAQ,MAAO,eAAgB;CCN3I,WAOE,QAASiV,GAAelgB,EAAKoB,EAAM4K,EAAS7K,EAAWwC,EAAcD,EAAMqI,EAAQvD,EAAQD,EAAUR,EAAQhI,EAAS6D,GAyDtH,QAASuc,KACP,GAAIC,GAAKC,UAAUC,UAAUC,cACzBC,EAAYJ,EAAGtJ,QAAQ,aAC3B,IAAI0J,EAAW,CAEb,GAA0B,GAAtB5d,OAAO6d,aAA0C,KAAtB7d,OAAO6d,YACpC,OAAO,CAEJ,IAA0B,IAAtB7d,OAAO6d,aAAqB7d,OAAO6d,iBAC7C,OAAO,MAGH,CACH,GAA0B,IAAtB7d,OAAO6d,aAAqB7d,OAAO6d,iBACrC,OAAO,CAEJ,IAA0B,GAAtB7d,OAAO6d,aAA0C,KAAtB7d,OAAO6d,YACzC,OAAO,GAxEX,GAAItH,GAAKhV,IAGXgV,GAAGpR,OAASA,EAAOvB,MAGnB+B,EAASzD,QACTqU,EAAG5Q,SAASA,EAAS/B,MAGrBgC,EAAOE,WACPyQ,EAAG3Q,OAASA,EAAOhC,KAGnB,IAAIE,EACA/C,GAAa+C,SAAQA,EAAS/C,EAAa+C,OAC/C,IAAIrB,IAAS,CACT1B,GAAa0B,SAAQA,EAAS1B,EAAa0B,QAE/C3B,EAAKpC,MAAMoF,EAAQrB,GAAQoC,KAAK,SAASlH,GACxC4Y,EAAGpV,SAASL,EAAK8C,MAEjBuF,EAAO4D,OAAO,WACb,MAAOwJ,GAAGpV,UACR,SAAS2c,EAASC,GACpBxH,EAAGmC,oBAAmB,EACtBnC,EAAGyH,eAAc,EACbzH,EAAG0H,qBAAoB,EAC3B1H,EAAG2H,qBACD,GAEH/U,EAAO4D,OAAO,WACb,MAAOwJ,GAAGjZ,MACR,SAASwgB,EAASC,GACpBxH,EAAG2H,qBACD,IAKJ,SAASza,IAELA,EAAI4B,QAAU,oBAChBO,EAAOxE,IAAI,UAAS,KAkCpBmV,EAAG4H,UAAUZ,GACd,IAAIa,GAA4B,uBAAyBpe,QACxDqe,EAAmBD,EAA4B,oBAAsB,QAEvEpe,QAAOse,iBAAiBD,EAAkB,WAExC9H,EAAG4H,UAAUZ,IACbpU,EAAOnB,WACN,GAUHuO,EAAGjZ,KAAOH,EACVoZ,EAAGgI,cAEHhI,EAAG2H,iBAAmB,WACrB,IAAK3H,EAAGpV,SAAU,OAAO,CACzB,IAAI7D,GAAOiZ,EAAGjZ,KAAKiZ,EAAGiI,MAAMjI,EAAGkI,WAAWC,SACtCpc,EAAKiU,EAAGpV,SAASoV,EAAGiI,MAAMjI,EAAGkI,WAAWrR,SACxCvN,EAAMuJ,EAAQ,UAAU9L,GAAOgF,GAAIA,GACnCzC,KAAKA,EAAMA,EAAI,IACnB0W,EAAGgI,WAAa1e,GAAK,MAItB0W,EAAGiI,SAGHjI,EAAGiI,MAAMzT,MACR4T,cAAgB,iBAChBD,QAAU,iBACVE,MAAQ,SACRxR,QAAU,qBAIXmJ,EAAGiI,MAAMzT,MACR4T,cAAgB,gBAChBD,QAAU,gBACVE,MAAQ,QACRxR,QAAU,oBAIXmJ,EAAGiI,MAAMzT,MACR4T,cAAgB,iBAChBD,QAAU,UACVE,MAAQ,SACRxR,QAAU,cAIXmJ,EAAGiI,MAAMzT,MACR4T,cAAgB,UAChBD,QAAU,UACVE,MAAQ,aACRxR,QAAU,kBAIXmJ,EAAGiI,MAAMzT,MACR4T,cAAgB,UAChBD,QAAU,UACVE,MAAQ,gBACRxR,QAAU,qBAIXmJ,EAAGiI,MAAMzT,MACR4T,cAAgB,UAChBD,QAAU,UACVE,MAAQ,gBACRxR,QAAU,qBAIXmJ,EAAGiI,MAAMzT,MACR4T,cAAgB,OAChBC,MAAQ,aAGTrI,EAAGsI,SAAS,OACZtI,EAAGkI,UAAY,EACflI,EAAGuI,WAAa,SAAS3R,GACxB,QAAIA,GAAQoJ,EAAGiI,MAAMtf,YACjBiO,EAAO,KACAjK,SAAPiK,IACCoJ,EAAGkI,UAAYtR,OAGhBA,EAAK,GAAKoJ,EAAGiI,MAAMtf,QAAQqX,EAAG2H,wBAI7Bpa,GAAUA,EAAOoQ,QAAQ,SAAWlT,EAAQ4M,WAAa,MAAK2I,EAAGkI,UAAY,GAUnFlI,EAAGwI,WAAY,EACfxI,EAAGyI,YAAc,eACjBzI,EAAG0I,aACH1I,EAAG2I,YAEH,IAAIC,GAAe,WAClBvZ,EAAOxE,IAAI,YAAW,IAGnBge,EAAkB,SAASte,GAC9BvC,EAAUY,KAAK,UAAU2B,EAAKwB,IAG/BiU,GAAG8I,aAAe,WACjB9I,EAAG2I,aAAeE,EAClB7I,EAAG+I,WAGJ/I,EAAGgJ,gBAAkB,WACpBhJ,EAAG2I,aAAeC,EAClB5I,EAAG+I,WAGF/I,EAAGiJ,YAAc,WAChBrb,QAAQC,IAAI,aACZD,QAAQC,IAAImS,EAAGpV,SAASmB,IACxB6B,QAAQC,IAAItB,SAAS/B,EAAa+C,SACjChB,SAAS/B,EAAa+C,UAAYyS,EAAGpV,SAASmB,GAAI/D,EAAUY,KAAK,eAAeoX,EAAGpV,SAASmB,IAC1FsD,EAAOE,YAGXyQ,EAAGkJ,WAAa,WACflhB,EAAUY,KAAK,YAGhBoX,EAAGmJ,UAAY,WACd5e,EAAKoB,QACLqU,EAAGpV,SAASL,EAAK8C,MACjBgC,EAAOE,YAIVyQ,EAAG+I,QAAU,WACZ1Z,EAAOE,WAEHyQ,EAAGpV,SAASpB,MAGfwW,EAAGwI,WAAY,EACfje,EAAKkE,OAAOH,KACX,SAASlH,GACR4Y,EAAGpV,SAAWxD,EACd4Y,EAAGwI,WAAY,EACXxI,EAAG2I,cACN3I,EAAG2I,aAAavhB,MATEiI,EAAOxE,IAAI,SAAS,IAiBzCmV,EAAGoJ,WAAW,WACf,MAAInhB,GAAKC,iBAMR8X,GAAG8I,gBALH9I,EAAG0I,aAAe1I,EAAG8I,aACrBzZ,EAAOxE,IAAI,mBAAkB,IACtB,IAOTmV,EAAGqJ,gBAAkB,SAAS7b,GAC7B,MAAIvF,GAAKC,iBAMRsF,MALAwS,EAAG0I,aAAelb,EAClB6B,EAAOxE,IAAI,mBAAkB,IACtB,IAQPmV,EAAGsJ,SAAW,WACf,MAAIrhB,GAAKC,iBAKJ8X,GAAGgJ,mBAJPhJ,EAAG0I,aAAe1I,EAAGgJ,gBACrB3Z,EAAOxE,IAAI,mBAAkB,IACtB,IAOPmV,EAAGuJ,iBAAmB,SAASC,KAGhCxJ,EAAGmC,oBAAmB,EACtBnC,EAAGyH,eAAc,EAChBzH,EAAG0H,qBAAoB,EACvB1H,EAAG2C,MAAQ,SAASC,GAGnB,GAFAhV,QAAQC,IAAI,cACZD,QAAQC,IAAI+U,GACI,GAAb5C,EAAG4C,GACL5C,EAAGyJ,UAAS,MACT,CACDzJ,EAAG4C,IAAW,CACd,IAAIlV,GAAW7G,EAAI6H,YAAYsR,EAAGpV,UAC9BA,EAAW9B,QAAQ+C,KAAKmU,EAAGpV,gBACxBA,GAAS4D,YACT5D,GAASqD,UAChB1D,EAAKkD,yBAAyB7C,EAAU8C,EAAU,SAAU9C,GAErDA,EAASqD,UAQZ+R,EAAGmC,oBAAqB,EAPxBtb,EAAIoG,KAAK,kBAAmBrC,EAAS4D,MAAO,SAAUpH,GACpDwG,QAAQC,IAAI,4BAA8BzG,EAAO4a,KACjDhC,EAAGmC,oBAAqB,QAxTpCrZ,QACGC,OAAO,SACPtB,WAAW,iBAAkBsf,GAEhCA,EAAejV,SAAW,MAAO,OAAO,UAAU,YAAa,eAAgB,OAAQ,SAAU,SAAU,WAAY,SAAU,UAAW;CCN9I,WAQE,QAAS4X,GAAQta,EAAUwD,EAAQpI,EAAcvC,EAAMpB,EAAKD,EAASoB,GAEnE,GAAIgY,GAAKhV,IACTgV,GAAG5Q,SAASA,EAAS/B,MACrB2S,EAAG2J,aAAe1hB,EAAKC,aACvB8X,EAAG/X,MAAMhB,QAAO,GAChB+Y,EAAG/X,KAAOA,EAAKoF,MACf2S,EAAG/X,KAAKhB,QAAU+Y,EAAG2J,aACrB3J,EAAG4J,gBACH5J,EAAGjZ,KAAOH,EACVoZ,EAAG3M,OACH2M,EAAG6J,SAAS,EACZ7J,EAAG8J,SAAWtf,EAAauf,aAAahd,MAAM,KAC9CiT,EAAGgK,MAAQ,KACXhK,EAAGiK,UACDC,YAAW,EACXC,cAAa,GAGfnK,EAAG0I,aAAe,WAChB1I,EAAG/X,KAAKA,EAAKoF,MACb2S,EAAG2J,aAAe1hB,EAAKC,cAGzB8X,EAAGvN,OAAS,WACVxK,EAAKwK,OAAO,WACVuN,EAAG/X,QACH+X,EAAG/X,KAAKhB,QAAO,EACf+Y,EAAG2J,aAAe1hB,EAAKC,aACvB8X,EAAG3M,SACF,IAEL2M,EAAGoK,KAAO,aAGVxX,EAAO4D,OAAO,WACZ,MAAOwJ,GAAG/X,MACT,SAASsf,EAASC,GAEnB,IAAIxH,EAAG/X,KAAK8D,GAAI,OAAO,CAOvB,IAHAiU,EAAG/X,KAAKhB,QAAS,EAGd+Y,EAAG/X,KAAKmL,UAAUzK,OACnB,IAAI,GAAID,GAAE,EAAGA,EAAEsX,EAAG/X,KAAKmL,UAAUzK,OAAQD,IACvC,GAAGsX,EAAG/X,KAAKmL,UAAU1K,GAAGyK,QAAQ,CAC9B6M,EAAG3M,IAAM2M,EAAG/X,KAAKmL,UAAU1K,EAC3B,OAKHsX,EAAG/X,KAAKoiB,QAAOrK,EAAG2F,eAAiB3F,EAAG/X,KAAKoiB,OAG3C9C,EAAQ+C,WAETtK,EAAGiK,SAASE,cAAe,EAC3BtjB,EAAIoG,KAAK,mBAAoB,KAAM,SAAS+c,GACtCA,EAAMrhB,OAAO,EACfqX,EAAGiK,SAASC,YAAW,EAEvBlK,EAAGgK,MAAQA,EAEbhK,EAAGiK,SAASE,cAAe,KAGvB5C,EAAQxb,KAAOwb,EAAQ+C,WAE7B1c,QAAQC,IAAI,qBAGZmS,EAAGiK,SAASC,YAAW,EACvBlK,EAAGiK,SAASE,cAAa,IAGzBvc,QAAQC,IAAI,WAEZmS,EAAGiK,SAASE,cAAe,KAE5B,GAEHnK,EAAGuK,sBACDC,YAAaC,YAAa,IAC1BC,KAAMD,YAAa,IACnBE,gBAAiBF,YAAa,KAGhCzK,EAAG4K,cAECC,gBAAiB,UACjBC,QAAS,OACTC,SAAU,OACVC,WAAY,SAahBhL,EAAGiL,cAAiB,SAASC,EAAOhe,GAClCrG,EAAIoG,KAAK,sBAAuBie,MAAQA,GAAQ,SAASC,GACvDnL,EAAGoL,cAAcD,EAAKE,YAG1BrL,EAAGsL,UAAS,EACZtL,EAAGoL,cAAgB,SAASD,GAC1B,GAAInL,EAAGsL,SAAU,OAAO,CAExB,IADAtL,EAAGsL,UAAS,GACRtL,EAAGuL,mBAAoB,OAAO,CAClC,IAAIC,IACFC,eAAiBN,EACjBtF,oBAAsB7F,EAAG3M,IAAItH,GAC7B4Z,eAAiB3F,EAAG2F,eACpB+F,qBAAuBC,KAAKC,UAAU5L,EAAG8J,UAE3CjjB,GAAIoG,KAAK,mBAAoBue,EAAU,WACrCxjB,EAAUY,KAAK,0BAInBoX,EAAG6L,cAAe,SAASC,GAKzB,MAJY,oBAATA,EAA6BC,UAAa,OAC5B,YAATD,EAAqBC,UAAa,OACzB,cAATD,EAAuBC,UAAa,OACvCA,UAAYD,EACVC,WAGT/L,EAAGgM,iBAAkB,EACrBhM,EAAGuL,iBAAmB,WAEpB,MADAvL,GAAGgM,iBAAkB,EACjBhM,EAAG3M,IAAItH,KAIPiU,EAAG2F,iBACL3F,EAAGgM,gBAAkB,iCACd,IALPhM,EAAGgM,gBAAkB,qCACd,IAWXhM,EAAGiM,QAAU,WACPjM,EAAGuL,oBAAoBvL,EAAGoK,QAjKlCthB,QACGC,OAAO,SACPtB,WAAW,SAAUiiB,GAExBA,EAAO5X,SAAW,WAAW,SAAU,eAAgB,OAAQ,MAAO,UAAW;CCNnF,WASI,QAASoa,GAAUzhB,EAASxC,EAAMpB,GACnC,GAAImZ,GAAKhV,IACTgV,GAAG/X,KAAOA,EAAKoF,MACfO,QAAQC,IAAIpD,EAAQ+B,aAAaC,QAAQ,kBAV1C3D,QACGC,OAAO,SACPtB,WAAW,WAAYykB,GAE1BA,EAASpa,SAAW,UAAW,OAAQ;CCNzC,WAOE,QAASqa,GAAU1hB,EAASzC,EAAWuC,EAAM8E,EAAQwD,EAASrI,EAAcvC,EAAMpB,EAAK+L,EAAQhM,EAAS8D,GAkFtG,QAAS0hB,GAAkBhZ,GACzB,IAAIA,IAAcA,EAAUzK,OAAQ,OAAO,CAC3C,KAAK,GAAID,GAAE,EAAGA,EAAE0K,EAAUzK,OAAQD,IAChC,GAA4B,GAAxB0K,EAAU1K,GAAGyK,QAAiB,MAAOC,GAAU1K,GAAGqD,EAExD,OAAOqH,GAAU,GAAGrH,GArFtB,GAAIiU,GAAKhV,IAgCX,IA/BEgV,EAAG3Q,OAAOA,EAAOhC,MACjB2S,EAAGqM,QAAUzlB,EAAQylB,QACvBrM,EAAGsM,cAAe,EAClBtM,EAAGuM,aACHvM,EAAGyF,kBACDzF,EAAGwM,YACHxM,EAAGhC,OAASpX,EAAQoX,OAMpBgC,EAAG/X,QACH+X,EAAG/X,KAAOA,EAAKoF,MACfuF,EAAO4D,OAAO,UAAW,SAASiW,GACnCzM,EAAGyF,eAAeG,cAAgB6G,EAAKhM,WAAW,IAAIgM,EAAK/L,UAC3DV,EAAGyF,eAAeE,eAAiB8G,EAAKpC,MACxCrK,EAAGyF,eAAeI,oBAAsBuG,EAAkBK,EAAKrZ,aAC3D,GAMH4M,EAAG0D,UACH7c,EAAIoG,KAAK,cAAe,KAAM,SAAS7F,GACrC4Y,EAAG0D,OAAStc,EACZ4Y,EAAGsM,cAAa,IAIhB9hB,EAAamM,QAAiC,YAAvBnM,EAAa0B,OAEvC8T,EAAGyF,eAAeS,cAAc,EAC7BlG,EAAGyF,eAAeiH,QAAQ,sBAAsBliB,EAAamM,OAG7D/D,EAAO4D,OAAO,YAAa,SAASkN,GAClC,IAAKA,EAAO/a,OAAQ,OAAO,CAE3B,KAAI,GADAgkB,IAAa,EACTjkB,EAAE,EAAGA,EAAEgb,EAAO/a,OAAQD,IAC5B,GAAGgb,EAAOhb,GAAGqD,IAAMvB,EAAamM,OAAO,CACrC,GAAIiW,GAAiBlJ,EAAOhb,EAE5BsX,GAAGpV,SAAWgiB,EAAe/I,YAAY,GACzC7D,EAAG6M,SAAWD,EAAe/I,YAAY,GACzC7D,EAAGpV,SAASqD,UAAY+R,EAAGpV,SAASsD,eACpC8R,EAAGpV,SAASpB,KAAOwW,EAAGpV,SAAS2Z,UAC/BvE,EAAGyF,eAAeU,gBAAkByG,EAAe/I,YAAY,GAAG9X,GACxE4gB,GAAa,CACP,OAKAA,IAAY3M,EAAG8M,SAAW,sBAE7B,OAIF,IAAItiB,EAAamM,SAAWnM,EAAa0B,OAAO,CACpD,GAAIqB,GAAS/C,EAAamM,MAC1BpM,GAAKpC,MAAMoF,GAAQe,KAAK,WACvB0R,EAAGpV,SAASL,EAAK8C,MACjBO,QAAQC,IAAI,cACZD,QAAQC,IAAImS,EAAGpV,UACfoV,EAAGyF,eAAesH,QAAU/M,EAAGpV,SAASmB,GACxC6B,QAAQC,IAAImS,EAAGyF,kBAoBjBzF,EAAGkJ,WAAa,WAAYlhB,EAAUY,KAAK,YAE3CoX,EAAGmJ,UAAY,WACd5e,EAAKoB,QACL3D,EAAUY,KAAK,gBAEhBoX,EAAGoJ,WAAa,WAWf,MAVApJ,GAAGgN,cAAe,EACdhN,EAAGyF,eAAeG,gBACrB5F,EAAGgN,aAAe,iCACZhN,EAAGyF,eAAeE,iBACpB3F,EAAGgN,aAAe,yCAChBhN,EAAGyF,eAAeS,gBACpBlG,EAAGgN,aAAe,mCAChBhN,EAAGyF,eAAeI,sBACpB7F,EAAGgN,aAAe,sCAEpBhN,EAAGgN,kBAEHnmB,GAAIoG,KAAK,eAAgB+S,EAAGyF,eAAgB,SAAUre,GACpD4Y,EAAG3Q,OAAO4d,aAAc,KAI9BjN,EAAGkN,gBAAkB,SAASne,EAAMoe,GAInC,GAFAnN,EAAGyF,eAAeS,cAAcnX,EAE7Boe,EAAU,CACZ,GAAIN,GAAWM,EAAUtJ,YAAY,EACrC7D,GAAGyF,eAAe2H,QAAUD,EAAUE,SAI5B,GAARte,GACFiR,EAAGyF,eAAe6H,mBAAqBT,EAAS9gB,GAChDiU,EAAG6M,SAAWA,UAGP7M,GAAGyF,eAAe6H,mBACzBtN,EAAG6M,aAES,IAAP9d,GAAmB,IAAPA,SACViR,GAAGyF,eAAe8H,WAI3BvN,EAAGwN,iBACF,QACA,YACA,aACA,OACA,YACA,mBACA,oBACA,oBACA,qBACA,mBACA,oBACA,UACA,UACA,aACA,UACA,aACA,eAGDxN,EAAGyN,gBAAkB,SAAS7J,GAE7B,IAAKA,IAAUA,EAAMC,YAAYlb,OAAS,OAAO,CAEjD,IAAI2d,GAAY1C,EAAMC,YAAY,GAC9B6J,GACH,SAEGC,GAAe,CACnB,KAAKjlB,EAAE,EAAEA,EAAEglB,EAAS/kB,OAAQD,IAC3B,GAA8B,IAA1B4d,EAAUoH,EAAShlB,KAAuC,MAA1B4d,EAAUoH,EAAShlB,IAAY,CAClEilB,GAAe,CACf,OAIF,MAAOA,IAIR3N,EAAGyE,UAAY,SAASlH,GACvB,GAAIqQ,GAAW5N,EAAGyF,eAAelI,IAAU,GAC3CyC,GAAGwM,SAASjP,GAASzU,QAAQ+C,KAAK+hB,IAGnC5N,EAAG6N,YAAc,SAAStQ,GACzByC,EAAGyF,eAAelI,GAASzU,QAAQ+C,KAAKmU,EAAGwM,SAASjP,IACpDyC,EAAGwM,SAASjP,IAAS,GA9LtBzU,QACGC,OAAO,SACPtB,WAAW,YAAa0kB,GAE3BA,EAAUra,SAAW,UAAW,YAAa,OAAO,SAAU,UAAW,eAAgB,OAAQ,MAAO,SAAU,UAAW;CCN/H,WAWE,QAASgc,GAAS1e,EAAUwD,EAAQpI,EAAcvC,EAAMpB,EAAKD,EAASoB,GAGpE,GAAIgY,GAAKhV,IACTgV,GAAG5Q,SAAWA,EAAS/B,MACvB2S,EAAG2J,aAAe1hB,EAAKC,aACvB8X,EAAG/X,KAAOA,EAAKoF,MACf2S,EAAG/X,KAAKhB,QAAU+Y,EAAG2J,aACrB3J,EAAG8M,UAAW,EACd9M,EAAG4J,gBACH5J,EAAGjZ,KAAOH,EACVoZ,EAAG/X,KAAOA,EAAKoF,MACf2S,EAAG3M,OACH2M,EAAG6J,SAAS,EACZ7J,EAAG+N,UAAW,EACd/N,EAAGgK,MAAQ,KACXhK,EAAGiK,UACDC,YAAW,EACXC,cAAa,GAGfnK,EAAG0I,aAAe,WAChB9a,QAAQC,IAAI,QACZmS,EAAGgO,aAAc,EACjBhO,EAAG/X,KAAKA,EAAKoF,MACb2S,EAAG2J,aAAe1hB,EAAKC,aACvB8X,EAAGiO,YAGLjO,EAAGvN,OAAS,WACVxK,EAAKwK,OAAO,WACVuN,EAAG8M,UAAW,EACd9M,EAAG/X,QACH+X,EAAG/X,KAAKhB,QAAO,EACf+Y,EAAG2J,aAAe1hB,EAAKC,eACtB,IAGL8X,EAAGoK,KAAO,aAGVxX,EAAO4D,OAAO,WACZ,MAAOwJ,GAAG/X,MACT,SAASsf,EAASC,GAGnB,IAAIxH,EAAG/X,KAAK8D,GAAI,OAAO,CAEvB,IAAGiU,EAAG/X,KAAKhB,OAAQ,OAAO,CAG1B,IAFA+Y,EAAG/X,KAAKhB,QAAS,EAEd+Y,EAAG/X,KAAKmL,UAAUzK,OACnB,IAAID,EAAE,EAAGA,EAAEsX,EAAG/X,KAAKmL,UAAUzK,OAAQD,IACnC,GAAGsX,EAAG/X,KAAKmL,UAAU1K,GAAGyK,QAAQ,CAC9B6M,EAAG3M,IAAM2M,EAAG/X,KAAKmL,UAAU1K,EAC3B,OAMH6e,EAAQ+C,WACTtK,EAAGiK,SAASE,cAAe,EAC3BtjB,EAAIoG,KAAK,mBAAoB,KAAM,SAAS+c,GACtCA,EAAMrhB,OAAO,EACfqX,EAAGiK,SAASC,YAAW,EAEvBlK,EAAGgK,MAAQA,EAEbhK,EAAGiK,SAASE,cAAe,KAEtB5C,EAAQxb,KAAOwb,EAAQ+C,YAC9BtK,EAAGiK,SAASC,YAAW,EACvBlK,EAAGiK,SAASE,cAAa,KAE1B,GAKHnK,EAAGuK,sBACDC,YAAaC,YAAa,IAC1BC,KAAMD,YAAa,IACnBE,gBAAiBF,YAAa,KAGhCzK,EAAG4K,cAECC,gBAAiB,UACjBC,QAAS,OACTC,SAAU,OACVC,WAAY,SAMhBhL,EAAGiL,cAAiB,SAASC,EAAOhe,GAClCrG,EAAIoG,KAAK,sBAAuBie,MAAQA,GAAQ,SAASC,GACvDnL,EAAG6G,WAAWsE,EAAKE,YAMvBrL,EAAG6G,WAAa,SAASsE,GACvB,GAAI+C,IACFpH,QAAU9G,EAAG4D,MAAM7X,GACnBoiB,iBAAmBhD,EACnBiD,aAAepO,EAAG4J,aAAalE,MAC/B2I,YAAcrO,EAAG/X,KAAKqiB,UAExB1c,SAAQC,IAAIqgB,GACZrnB,EAAIoG,KAAK,eAAgBihB,EAAc,WACrClmB,EAAUY,KAAK,uBAInBoX,EAAGiO,SAAW,WACZjO,EAAG8G,QAAUtc,EAAauf,aAC1BljB,EAAIoG,KAAK,cAAezC,EAAauf,aAAc,SAAU3iB,GAC3D,GAAIA,EAAOse,MAAO,CAEhB,GADA1F,EAAG4D,MAAQxc,EACmB,GAA1BA,EAAO4e,kBACThG,EAAG8M,SAAW,6BACd9M,EAAGgO,aAAc,MAEd,IAAgC,IAA7B5mB,EAAO4e,mBAA2B5e,EAAOknB,aAC/C,IAAK,GAAI5lB,GAAI,EAAGA,EAAItB,EAAOknB,aAAa3lB,OAAQD,IAC9C,GAAsC,OAAlCtB,EAAOknB,aAAa5lB,GAAG+G,OAAiB,CAC1CuQ,EAAG+N,SAAW,GAAIlJ,MAAKzd,EAAOknB,aAAa5lB,GAAG6lB,WAC9C,OAINvO,EAAG4J,aAAalE,MAAQte,EAAOse,MAC/B1F,EAAGgO,aAAc,MAGjBhO,GAAG8M,SAAW,iDACd9M,EAAGgO,aAAc,GAElB,SAAU9gB,GACX8S,EAAGgO,aAAc,EACC,KAAd9gB,EAAIuC,SACNuQ,EAAG8M,SAAW,uCAAyCtiB,EAAauf,iBAKvE/J,EAAG2J,aACJ3J,EAAGiO,WAEHjO,EAAGgO,aAAc,EAlKrBllB,QACGC,OAAO,SACPtB,WAAW,UAAWqmB,GAEvBA,EAAQhc,SAAW,WAAW,SAAU,eAAgB,OAAQ,MAAO,UAAW;CCNtF,WAQE,QAAS0c,GAAQvmB,EAAMuC,EAAcxC,GACnC,GAAIgY,GAAKhV,IAELR,GAAauE,MACf/G,EAAUY,KAAK,UAEjBoX,EAAGjR,KAAKvE,EAAauE,KACrBiR,EAAG2J,aAAe1hB,EAAKC,aACvB8X,EAAG/X,KAAOA,EAAKoF,MAEf2S,EAAGvN,OAAS,WACVxK,EAAKwK,OAAO,WACVuN,EAAG8M,UAAW,EACd9M,EAAG/X,QACH+X,EAAG/X,KAAKhB,QAAO,EACf+Y,EAAG2J,aAAe1hB,EAAKC,aACvBF,EAAUY,KAAK,YACd,IAvBPE,QACGC,OAAO,SACPtB,WAAW,SAAU+mB,GAExBA,EAAO1c,SAAW,OAAQ,eAAgB;CCN5C,WAOE,QAAS2c,GAAUrf,GACjB,GAAI4Q,GAAKhV,IAEToE,GAASzD,QACTqU,EAAG5Q,SAAWA,EAAS/B,MATzBvE,QACCC,OAAO,SACPtB,WAAW,YAAagnB,GAE1BA,EAAU3c,SAAW;CCNtB,WAOE,QAAS4c,GAAatf,GACpB,GAAI4Q,GAAKhV,IAEXoE,GAASzD,QACPqU,EAAG5Q,SAAWA,EAAS/B,MACvB2S,EAAG6J,SAAS,EAVd/gB,QACGC,OAAO,SACPtB,WAAW,eAAgBinB,GAE9BA,EAAa5c,SAAW","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('bdApp', ['ngRoute', 'ngAnimate','ngSanitize', 'ngCookies', 'angular-gestures', 'user', 'api', 'sqPaymentForm']);\n  \n\n\n  function config ($routeProvider, $locationProvider) {\n    \n    var apiData = ['api', '$q', function(api, $q){\n      var data = api.getData();\n      if(data.loaded) return data;\n      else{\n        var defer = $q.defer();\n        api.getAppData(function(result){\n          defer.resolve(result);\n        });\n        return defer.promise;\n      }\n    }];\n    \n    $routeProvider\n      .when('/', {\n        templateUrl: '/pages/home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm',\n      })\n      .when('/pay/:orderDetails', {\n        templateUrl: '/pages/pay/pay.view.html',\n        controller: 'payCtrl',\n        controllerAs: 'vm',\n        resolve:{apiData:apiData}\n      })\n      .when('/fitmatch/:orderDetails', {\n        templateUrl: '/pages/fitmatch/fitmatch.view.html',\n        controller: 'fmCtrl',\n        controllerAs: 'vm',\n        resolve:{apiData:apiData}\n      })\n      .when('/thank-you/:type', {\n        templateUrl: '/pages/thank-you/thank-you.view.html',\n        controller: 'tyCtrl',\n        controllerAs: 'vm',\n      })\n      .when('/register', {\n        templateUrl: '/pages/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/pages/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/customer-register/:email?', {\n        templateUrl: '/pages/auth/customer-register/customer-register.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/closet', {\n        templateUrl: '/pages/closet/closet.view.html',\n        controller: 'closetCtrl',\n        controllerAs: 'vm',\n        resolve:{apiData:apiData}\n      })\n      .when('/order/:dataId?/:action?', {\n        templateUrl: '/pages/order/order.view.html',\n        controller: 'orderCtrl',\n        controllerAs: 'vm',\n        resolve:{apiData:apiData}\n      })\n      .when('/customizer/:jeanId?/:action?', {\n        templateUrl: '/pages/customizer/customizer.view.html',\n        controller: 'customizerCtrl',\n        controllerAs: 'vm',\n        resolve:{apiData:apiData}\n      })\n      .when('/admin', {\n        templateUrl: '/pages/admin/admin.view.html',\n        controller: 'adminCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n    \n  }\n\n  function run($rootScope, $location, user) {\n\t  if (user.isLoggedIn()) user.setup();\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n\t\t\t\n\t    var locked = [\n\t\t    '/closet',\n\t\t    '/order'\n\t    ];\n  \t\tvar lockedPage = false;\n\t    for(var i=0; i<locked.length; i++){\n\t    \tif ($location.path().includes(locked[i]))\n\t    \t\tlockedPage = true;\n\t\t\t}\n   \n\t\t\tif (lockedPage && !user.isLoggedIn() ){\n\t\t\t\t$location.path('/login');\n\t\t\t}\n\t  \t/* TODO\n\t  \t//If there's no jean on the order screen.... redirect to the customizer page.\n\t  \tif($location.path().indexOf(\"/order\") >= 0 && !Object.keys(jean.data).length){\n\t\t  \t$location.path('/customizer');\n\t\t  };\n\t\t  */\n\t\t  \n    });\n  }\n\t\n\n\tangular.module('bdApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'user', run])\n\t\t.filter('spaceless',function() {\n\t    return function(input) {\n\t      if (input) {\n\t      \treturn input.replace(/\\s+/g, '-');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('scoreToSpace',function() {\n\t    return function(input) {\n\t      if (input) {\n\t\t      var input = input.replace( /([A-Z])/g, \" $1\" );\n\t      \treturn input.replace(/_+/g, ' ');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('minMax',function(min, max, key) {\n\t\t\treturn function(input){\n\t\t\t\tif (min && input[key] < min) return false;\n\t\t\t\tif (max && input[key] > max) return false;\n\t\t    return true;\n\t\t  }  \n\t\t})\n\t\t.filter('displayName',function() {\n\t\t\treturn function(input){\t\n\t\t\t\tret = input.gender ? input.gender : input.name;\t\t\t\n\t\t\t\treturn ret ? ret.replace(/Raw Denim/g, \"\") : false;\n\t\t  }  \n\t\t});\n  \n  \n  window.onload=function() {\n    var body = document.getElementById('bdApp');\n    angular.bootstrap(angular.element(body), ['bdApp']);\n  }\n\t\t/*\n\t\n\t// Get Angular's $http module.\n\tvar initInjector = angular.injector(['ng']);\n\tvar $http = initInjector.get('$http');\n \n  \n\t\n\t$http.get(\"https://api.bluedeltajeans.com/api/data\").then(function(result){\n\n\t\tresult.data.lookup = function(data, key, value, retKey){\n\t\t\tvar dataSet = this[data];\n\t\t\tretKey = retKey || false;\n\t\t\tfor (i=0; i<dataSet.length; i++){\t\t\t\t\n\t\t\t\tif(dataSet[i][key] == value)\n\t\t\t\t\treturn retKey ? dataSet[i][retKey] : dataSet[i]\n\t\t\t}\n\t\t}\n\t\t\n\t\tangular.module('bdApp').constant('apiData', result.data);\n\t\tvar body = document.getElementById('bdApp');\n\t\tangular.bootstrap(angular.element(body), ['bdApp']);\t\t\n\t});\n\t\n\n\t\n*/\n\t\t\n\t\t\n\t\n\t\t\n})();","// Autogenerated file, do not modify directly\n\n(function() {\n\nconst configOverridesGenerated = {\n  \"REGION\": \"us-east-1\",\n  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n};\n\nreturn configOverridesGenerated;\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('jean', ['$routeParams', '$window', '$q', 'api', '$http', jean]);\n\n  function jean($routeParams, $window, $q, api, $http) {\n\n\n\t\t/*\n\t\t*   JSON Data lookup\n\t\t*/\n\t\t/*\n\t\tvar dataLookup = function(dataType, key){\n\n\t\t\tvar data = apiData[dataType];\n\t\t\tif (!data) return false;\n\t\t\t\n\t\t\tfor (i=0; i<data.length; i++) {\n\t\t\t\t//\tconsole.log(data[i][dataType+\"Id\"], key);\n\t\t\t\tif (data[i][dataType+\"Id\"] == key) \t\t\t\t\n\t\t\t\treturn data[i];\n  \t\t}\n\t\t}\n\t\t*/\n\n\t\t\n\t\t/*\n\t\t*  Jean Data\n\t\t*/\n\t\t\n  \tvar jeanData = {};\n  \t\n\t\tset = function(property, value){\n\t\t\tjeanData[property] = value;\n\t\t\tthis.saved=false;\n\t\t};\n\t\t\n\t\tcreateNew = function(jean){\n\t\t\tif (!jean || jean.constructor != Object){\n\t\t\t\tjeanData = {\n\t\t\t\t\t\"gender_option_id\" : 1,\n\t\t\t\t\t\"style_option_id\" : 1,\n\t\t\t\t\t\"fabric_id\" : 1704,\n\t\t\t\t\t\"accent_thread_id\" :1,\n\t\t\t\t\t\"top_thread_id\" : 1,\n\t\t\t\t\t\"bottom_thread_id\" : 1\n\t\t\t\t}\n\t\t\t\tjeanData.saved = false;\n\t\t\t}else{\n\t\t\t\tjeanData = {\n\t\t\t\t\t\"gender_option_id\" : jean.gender_option_id,\n\t\t\t\t\t\"style_option_id\" : jean.style_option_id,\n\t\t\t\t\t\"fabric_id\" : jean.fabric_id,\n\t\t\t\t\t\"accent_thread_id\" : jean.accent_thread_id,\n\t\t\t\t\t\"top_thread_id\" : jean.top_thread_id,\n\t\t\t\t\t\"bottom_thread_id\" : jean.bottom_thread_id\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t\t\t\n\t\tfunction parseURLkey(key){\n\t\t\tswitch(key){\n\t\t\t\tcase \"g\":\n\t      return \"gender_option_id\";\n\t      break;\n\t      \n\t      case \"s\":\n\t      return \"style_option_id\";\n\t      break;\n\t      \n\t      case \"f\":\n\t      return \"fabric_id\";\n\t      break;\n\t      \n\t      case \"tt\":\n\t      return \"top_thread_id\";\n\t      break;\n\t      \n\t      case \"tb\":\n\t      return \"bottom_thread_id\";\n\t      break;\n\t      \n\t      case \"ta\":\n\t      return \"accent_thread_id\";\n\t      \n\t      default: return false;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t\n\t\treset = function(){\n\t\t\tcreateNew();\n\t\t}\n\t\t\n\t\tbuildJeanData = function(data, copy){\n\n\t\t\t//Make a copy\n\t\t\tif(copy==true){\n\t\t\t\tdelete data.user_id;\n\t\t\t\tdelete data.id;\n\t\t\t\tif(data.name) data.name = \"Copy of \"+data.name;\n\t\t\t}\n\t\t\tfor(prop in data){\n\t\t\t\tif(data.hasOwnProperty(prop)){\n\t\t\t\t\tset(prop, data[prop]);\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//Set up jean data from parameter\n\t\tvar setup = function(data, action){\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\t//If we don't have a logged in user, we want to force a copy...\n\t\t\tvar userProp = $window.location.hostname==='localhost' ? \"bdUserId_dev\" : \"bdUserId\";\n\t\t\tvar userId = parseInt($window.localStorage.getItem(userProp));\n\t\t\tvar makeCopy = userId ? false : true;\n\t\t\tmakeCopy = action == \"copy\" ? true : makeCopy;\n\t\t\t\n\t\t\t//Set up jean from object data\n\t\t\tif (data !== null && typeof data === 'object'){\n\t\t\t\t\n\t\t\t\tif (data.user_id && data.user_id !== userId) delete data.id;\n\t\t\t\tbuildJeanData(data, makeCopy);\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t\n\t\t\t//Copy jean from data URL\n\t\t\telse if (data !== null && data !== undefined && isNaN(data)){\n\t\t\t\tvar jeanObj = {};\n\t\t\t\tdataArr = data.split('-');\n\t\t\t\tfor(var i=0; i<dataArr.length; i++){\n\t\t\t\t\tvar d = dataArr[i].split(\":\");\n\t\t\t\t\tvar key = parseURLkey(d[0]);\n\t\t\t\t\tjeanObj[key]=d[1];\n\t\t\t\t}\n\t\t\t\tbuildJeanData(jeanObj, true);\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\n\t\t\t//Copy or Edit Jean from Id\n\t\t\t\n\t\t\telse if (data !== null && data !== undefined){\n\t\t\t\t//First get Jean\n\t\t\t\tapi.call('getJean', data, function(result){\n\t\t\t\t\tif (result.user_id !== userId) makeCopy = true;\n\n\t\t\t\t\tbuildJeanData(result, makeCopy);\n\t\t\t\t\tdefer.resolve(jeanData);\n\t\t\t\t}, function(err){\n\t\t\t\t\t\tdefer.reject(err)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Jean Data already exists\n\t\t\telse if (Object.keys(jeanData).length > 0){\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t\n\t\t\telse{\n\t\t\t\tcreateNew();\t\t\t\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t\n\t\t\t//Data URL\n\t\t\t/*\n\t\t\telse if ($routeParams.jeanId && !$routeParams.userId){\n\t\t\t\tcreateNew();\n\t\t\t\tif ($routeParams.jeanId.indexOf(\":\")>0){\n\t\t\t\t\tjeanData = $routeParams.jeanId.split(\":\");\n\t\t\t\t\tfor(var d=0; d<jeanData.length; d++){\n\t\t\t\t\t\tvar parts= jeanData[d].match(/([A-Za-z]+)([0-9]+)/);\n\t\t\t\t\t\tif (!parts) continue;\n\t\t\t\t\t\tvar jeanKey = parseURLkey(parts[1]);\n\t\t\t\t\t\tif (jeanKey) jeanData[jeanKey] = parseInt(parts[2]);\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t*/\n\t\t\t\n\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t/*bdAPI.jeansGet($routeParams.userId, $routeParams.jeanId).then(\t\t\t\t\t\n\t\t\t\t\tfunction(result){\n\n\t\t\t\t\t\tvar newJean = result.data;\n\n\t\t\t\t\t\tvar userData = aws.getCurrentUserFromLocalStorage();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(userData){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar identityId = bdAPI.setupHeaders(userData);\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//Edit Jean\n\t\t\t\t\t\t\tif (identityId == $routeParams.userId){\n\t\t\t\t\t\t\t\tfor(prop in newJean){\n\t\t\t\t\t\t\t\t\tif(newJean.hasOwnProperty(prop)){\n\t\t\t\t\t\t\t\t\t\tset(prop, newJean[prop]);\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//Copy Jean\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tcreateNew(newJean);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Not logged in.. create new.\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcreateNew(newJean);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefer.resolve(jeanData);\n\t\t\t\t\t}, \n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\t//Jean or user not found.. just create a blank jean...\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tcreateNew();\n\t\t\t\t\t\tdefer.resolve(jeanData);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\t*/\n\t\t\n\t\t\t\t\t\n\t\t\t\n\n\t\t\t\n\t\t\treturn defer.promise;\n\t\t}\n\t\t\n\t\t\n\t\tvar get=function(){\n\t\t\treturn jeanData;\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tvar deleter = function (jeanId, callback){\n\t\t\tapi.call('deleteMyJean', jeanId, function(result){\n\t\t\t\tif (callback) callback(result);\n\t\t\t});\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t//Test jean for existing image in s3\n\t\tvar testJeanForExistingImage = function(jeanData, dataCode, callback, errCallback){\n\t\t\tconsole.log(\"testing for ex...\");\n      var filename = dataCode+\".jpg\";\n      var imageUrl = \"https://s3.amazonaws.com/bluedelta-data/jeans/\"+filename;\n\t\t\t\n      console.log(imageUrl);\n      //Thumbnail already exists..\n      $http.get(imageUrl)\n        .success(function(result){\n        \tconsole.log(\"IT EXISTS!!!\");\n          //We got the image... handle both orders and jeans... just to be safe\n          jeanData.image_url = imageUrl;\n          jeanData.jean_image_url = imageUrl;\n          if (callback) callback(jeanData);\n        })\n        \n        //Need to create a new Thumbnail\n        .error(function(err, code){\n        \tconsole.log(\"ERROR>.. create an image\");\n          //There was an error...\n          api.createThumb(jeanData).then(function (blob) {\n            jeanData.image = {data:blob, filename:filename};\n            if (callback) callback(jeanData)\n          }, function(err){\n          \tif(errCallback) errCallback(err);\n\t\t\t\t\t});\n        });\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\tvar save = function(){\n\t\t\tvar jean = this;\n\t\t\tvar jeanData = jean.get();\n      var defer = $q.defer();\n      var dataCode = api.getDataCode(jeanData);\n      testJeanForExistingImage(jeanData, dataCode, function(jeanData){\n        api.call('createMyJeans', jeanData, function(result){\n          defer.resolve(result);\n        }, function(err){\n          defer.reject(err);\n        });\n\t\t\t});\n      return defer.promise;\n\t\t};\n\t\t\n\t\t\n\t\t\t\n\t\treturn {\n\t    //dataLookup: api.lookup,\n\t    deleter : deleter,\n\t    save : save,\n\t    get : get,\n\t    set: set,\n\t    setup : setup,\n\t    reset : reset,\n      set : set,\n      testJeanForExistingImage:testJeanForExistingImage,\n      createNew :createNew,\n      getDataCode: getDataCode\n     }\n\t\t\t\n\t\t\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('loader', ['$rootScope', loader]);\n\n  function loader() {\n\t\t\n\t\tvar loader = {}\n    \n    var loaderDefaults = {\n\t    \"message\":\"\",\n\t    \"type\":\"loading\",\n\t    \"icon\":\"fa-circle-o-notch fa-spin\",\n\t    \"active\":false\n    };\n    \n  \n\t        \n\t\tvar closeAll = function(){\n\t\t\tfor (var pop in pops) {\n\t\t\t  if (pops.hasOwnProperty(pop)) {\n\t\t\t    pops[pop]=false;\n\t\t\t  }\n\t\t\t}\n\t\t}\n    \n    var  show = function(message, type, icon){\n\t    loader.active = true;\n\t    loader.message=message || loaderDefaults.message;\n\t    loader.type = type || loaderDefaults.type;\n\t    loader.icon = icon || loaderDefaults.icon;\n    }\n    \n    var hide = function(){\n\t    loader.active=false;\n    }\n    \n    var get = function(){\n\t    return loader;\n    }\n    \n    return {\n\t    get:get,\n\t    show:show,\n\t    hide:hide\n    }\n  }\n\n})();","(function() {\n\n  angular\n    .module('bdApp')\n    .service('messages', messages);\n\n\t//meanData.$inject = [];\n  function messages() {\n\t\n\t\tvar data = {\n\t\t\tmessage : \"\",\n\t\t\ttype: \"\"\n\t\t};\n\t\t\n\t\tvar set = function(message, type){\n\t\t\tdata.message = message;\n\t\t\tdata.type = type;\n\t\t}\n\t\t\t\n\t\tvar reset = function(){\n\t\t\tdata.message = \"\";\n\t\t\tdata.type = \"\";\t\n\t\t};\n\t\t\n\t\tvar get = function(){\n\t\t\treturn data;\n\t\t}\n\t\t\n    return {\n\t    get:get,\n\t    set:set,\n\t    reset:reset\n    };\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('popups', ['$rootScope', popups]);\n\n  function popups($rootScope) {\n\t\t\n    var pops = {};\n        \n\t\tvar closeAll = function(){\n\t\t\tfor (var pop in pops) {\n\t\t\t  if (pops.hasOwnProperty(pop)) {\n\t\t\t    pops[pop]=false;\n\t\t\t  }\n\t\t\t}\n\t\t}\n    \n    var set = function(pop, status){\n\t    if (!pops[pop]){\n\t\t    pops[pop] = true;\n\t\t    $rootScope.$broadcast('popupChange');\n\t    }\n\t    else{\n\t\t  \tvar status = status || pops[pop];\n\t\t\t\tpops[pop] = status;\n\t\t\t}\n    }\n    \n    var get = function(){\n\t    return pops;\n    }\n    \n    return {\n\t    get:get,\n\t    set:set,\n\t    closeAll:closeAll\n    }\n  }\n\n})();","angular.module('bdApp')\n.factory('preloader', preloaderFunc);\n\npreloaderFunc.$inject = ['$q', '$rootScope'];\nfunction preloaderFunc( $q, $rootScope ) {\n  // I manage the preloading of image objects. Accepts an array of image URLs.\n  function Preloader( imageLocations ) {\n      // I am the image SRC values to preload.\n      this.imageLocations = imageLocations;\n      // As the images load, we'll need to keep track of the load/error\n      // counts when announing the progress on the loading.\n      this.imageCount = this.imageLocations.length;\n      this.loadCount = 0;\n      this.errorCount = 0;\n      // I am the possible states that the preloader can be in.\n      this.states = {\n          PENDING: 1,\n          LOADING: 2,\n          RESOLVED: 3,\n          REJECTED: 4\n      };\n      // I keep track of the current state of the preloader.\n      this.state = this.states.PENDING;\n      // When loading the images, a promise will be returned to indicate\n      // when the loading has completed (and / or progressed).\n      this.deferred = $q.defer();\n      this.promise = this.deferred.promise;\n  }\n  // ---\n  // STATIC METHODS.\n  // ---\n  // I reload the given images [Array] and return a promise. The promise\n  // will be resolved with the array of image locations.\n  Preloader.preloadImages = function( imageLocations ) {\n      var preloader = new Preloader( imageLocations );\n      return( preloader.load() );\n  };\n  // ---\n  // INSTANCE METHODS.\n  // ---\n  Preloader.prototype = {\n      // Best practice for \"instnceof\" operator.\n      constructor: Preloader,\n      // ---\n      // PUBLIC METHODS.\n      // ---\n      // I determine if the preloader has started loading images yet.\n      isInitiated: function isInitiated() {\n          return( this.state !== this.states.PENDING );\n      },\n      // I determine if the preloader has failed to load all of the images.\n      isRejected: function isRejected() {\n          return( this.state === this.states.REJECTED );\n      },\n      // I determine if the preloader has successfully loaded all of the images.\n      isResolved: function isResolved() {\n          return( this.state === this.states.RESOLVED );\n      },\n      // I initiate the preload of the images. Returns a promise.\n      load: function load() {\n          // If the images are already loading, return the existing promise.\n          if ( this.isInitiated() ) {\n              return( this.promise );\n          }\n          this.state = this.states.LOADING;\n          for ( var i = 0 ; i < this.imageCount ; i++ ) {\n              this.loadImageLocation( this.imageLocations[ i ] );\n          }\n          // Return the deferred promise for the load event.\n          return( this.promise );\n      },\n      // ---\n      // PRIVATE METHODS.\n      // ---\n      // I handle the load-failure of the given image location.\n      handleImageError: function handleImageError( imageLocation ) {\n          this.errorCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          this.state = this.states.REJECTED;\n          this.deferred.reject( imageLocation );\n      },\n      // I handle the load-success of the given image location.\n      handleImageLoad: function handleImageLoad( imageLocation ) {\n          this.loadCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          // Notify the progress of the overall deferred. This is different\n          // than Resolving the deferred - you can call notify many times\n          // before the ultimate resolution (or rejection) of the deferred.\n          this.deferred.notify({\n              percent: Math.ceil( this.loadCount / this.imageCount * 100 ),\n              imageLocation: imageLocation\n          });\n          // If all of the images have loaded, we can resolve the deferred\n          // value that we returned to the calling context.\n          if ( this.loadCount === this.imageCount ) {\n              this.state = this.states.RESOLVED;\n              this.deferred.resolve( this.imageLocations );\n          }\n      },\n      // I load the given image location and then wire the load / error\n      // events back into the preloader instance.\n      // --\n      // NOTE: The load/error events trigger a $digest.\n      loadImageLocation: function loadImageLocation( imageLocation ) {\n          var preloader = this;\n          // When it comes to creating the image object, it is critical that\n          // we bind the event handlers BEFORE we actually set the image\n          // source. Failure to do so will prevent the events from proper\n          // triggering in some browsers.\n          // --\n          // The below removes a dependency on jQuery, based on a comment\n          // on Ben Nadel's original blog by user Adriaan:\n          // http://www.bennadel.com/members/11887-adriaan.htm\n          var image = angular.element( new Image() )\n              .bind('load', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageLoad( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .bind('error', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageError( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .attr( 'src', imageLocation )\n          ;\n      }\n  };\n  // Return the factory instance.\n  return( Preloader );\n};","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('Nuser', Nuser);\n\t\t\n\tNuser.$inject = ['$location', '$window', 'api'];\n  function Nuser($location, $window, api) {\n\t  \n\t  var user = {};\n\t  \n\t\tvar isLoggedIn = function(){\n\t\t\tconsole.log(\"Here\");\n\t\t\treturn $window.localStorage.getItem(\"bdAccessToken\") ? true : false;\n\t\t}\n\t  \n\t\tvar set = function(key, data){\n\t\t\t\n\t\t\tif (key == null) return false;\n\t\t\t\n\t\t\tif (typeof key === 'object'){\n\t\t\t\t\n\t\t\t\tconsole.log('setting whole user');\n\t\t\t\tvar userData = key;\n\t\t\t\tfor (obKey in userData){\n        if(!userData.hasOwnProperty(obKey)) continue;\n\t\t\t\t\tuser[obKey] = key[obKey]\n    \t\t}\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\telse user[key] = data; \n      return user;\n    };\n\t\t\n\t\tvar setup = function(){\n\t\t\tapi.call('getCurrentUser', {}, function(userDetails){\n\t\t\t\tconsole.log(userDetails);\n\t\t\t\tset(userDetails);\n\t\t\t\tconsole.log(user);\n\t\t\t});\n\t\t}\n\t\t\n\t\tvar login = function(username, password, success, error){\n\t\t\tapi.login(username, password)\n\t\t\t.success(function(response){\n\t\t\t\tconsole.log(response);\n\t\t\t\t$window.localStorage.setItem(\"bdAccessToken\", response.access_token);\n\t\t\t\tif (success) success(response);\n\t\t\t})\n\t\t\t.error(function(err){\n\t\t\t\tconsole.log(err);\n\t\t\t\tif(error) error(err);\n\t\t\t})\n\t\t}\n\t\t\n\t\tvar logout = function(){\n\t\t\t$window.localStorage.removeItem(\"bdAccessToken\");\n\t\t\tuser = {};\n\t\t\tconsole.log(\"logged out\");\n\t\t\t$location.path(\"/login\");\n\t\t}\n\t  \n\t  return {\n      get:function(){ return user;},\n      isLoggedIn : isLoggedIn,\n      set: set,\n      login:login,\n      logout:logout,\n      setup: setup\n    };\n    \n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('addressChoiceCtrl', addressChoiceCtrl);\n\n  addressChoiceCtrl.$inject = ['$scope', '$filter', 'messages', 'api', 'user'];\n  \n  function addressChoiceCtrl($scope, $filter, messages, api, user) {\n\t  \n\t  $scope.editing=false;\n\t  $scope.active=false;\n\t\t$scope.addForm = {};\n\t\t$scope.model = {};\n\t\t$scope.user = user.get();\n\t\tvar addFormFields = ['address_line_1','address_line_2','city','state','zip'];\n\t\t\n\t\t\n\t\t//Choose Primary Address\n\t\t$scope.choosePrimary = function(address){\n\t\t\tfor (a = 0; a< $scope.user.addresses.length; a++){\n\t\t\t\tvar add = $scope.user.addresses[a];\n\t\t\t\tadd.primary = (add.id == address.id ? 1:0);\n\t\t\t}\n\t\t\tapi.call('postMyAddress', address);\n\t\t\t$scope.addressObject = address;\n\t\t}\n\t\t\t\t\n\t\t$scope.startEditing = function(){\n\t\t\t//Bring Primary address to the top\n\t\t\t$scope.user.addresses = $filter('orderBy')($scope.user.addresses, '-primary');\n\t\t\t$scope.editing = true;\n\t\t}\n\t\t\n\t\t$scope.stopEditing = function(){\n\t\t\t$scope.editing = false;\n\t\t}\n\n\t\t$scope.editAdd = {};\n\t\t\n\t\t//Open Address Form\n\t\t$scope.open = function(index){\n\n\t\t\t$scope.active = true;\n\t\t\tif (!$scope.user.addresses) $scope.user.addresses = [];\n\t\t\t\n\t\t\t//New Address\n\t\t\tif (typeof index === 'undefined'){\n\t\t\t\t$scope.model = {};\n\t\t\t\t$scope.editAdd.data = null;\t\n\t\t\t}\n\t\t\t\n\t\t\t//Editing Existing...\n\t\t\telse{\n\t\t\t\t$scope.model = $scope.user.addresses[index];\n\t\t\t\t$scope.editAdd.index = index;\n\t\t\t\t$scope.editAdd.data =  angular.copy($scope.model);\n\t\t\t}\n\t\t\t\t\t\t\n\t\t}\n\t\t\n\n\t\tfunction resetForm(close){\n\t\t\tclose = close || true;\n\t\t\t$scope.editAdd = {};\n\t\t\t$scope.model = {};\n\t\t\tif (close) $scope.active = false;\n\t\t}\n\n\t\t//Clear Address Form\n\t\t$scope.clear = function(){\n\t\t\tvar dataObj = $scope.editAdd.data;\n\t\t\tif (dataObj !== null) $scope.user.addresses[$scope.editAdd.index] = $scope.editAdd.data;//Reset Address\n\t\t\tresetForm();\t\t\t\n\t\t}\n\t\t\n\t\tfunction findAddressbyKey(key, value){\n\t\t\tvar primary = $scope.user.addresses.filter(function (add) {\n\t\t\t   return (add[key] == value);\n\t\t\t});\n\t\t\treturn primary[0];\n\t\t}\n\t\t\n\t\t\n\t\t//Remove Address and save user\n\t\t$scope.remove = function(addressId){\n\t\t\t//Don't allow user to delete their last address..\n\t\t\tif ($scope.user.addresses.length < 2){\n\t\t\t\tmessages.set(\"You can't remove your last address\", \"error\");\n\t\t\t\treturn false;\t\n\t\t\t}\n\t\t\tapi.call('deleteMyAddress', addressId, function(result){\n\t\t\t\t//Remove deleted address...\n\t\t\t\tfor(i=0; i<$scope.user.addresses.length; i++){\n\t\t\t\t\tvar add = $scope.user.addresses[i];\n\t\t\t\t\tif (add.id == addressId) $scope.user.addresses.splice(i,1);\n\t\t\t\t}\n\t\t\t\t//Change to new primary if primary was delted...\n\t\t\t\tif(result.new_primary_id){\t\t\t\t\n\t\t\t\t\tvar newPrimary = result.new_primary_id;\n\t\t\t\t\taddress = findAddressbyKey(\"id\", newPrimary);\n\t\t\t\t\taddress.primary=1;\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\t\n\t\t//Save Form\n\t\t$scope.save = function(){\n\t\t\tvar newAdd = $scope.model.id ? false : true;\n\t\t\tconsole.log($scope.model);\n\t\t\tif(newAdd) {\n        $scope.model.primary = 1;\n        for (a = 0; a < $scope.user.addresses.length; a++) {\n          var add = $scope.user.addresses[a];\n          add.primary = 0;\n        }\n      }\n\t\t\tapi.call('postMyAddress', $scope.model, function(result){\t\n\t\t\t\tif (newAdd)\t$scope.user.addresses.push(result);\n\t\t\t\t$scope.active = false;\n\t\t\t\t$scope.model = {};\n\t\t\t});\n\t\t};\n\t\t\n\t\t\n\t\t//US States\n\t\t$scope.states = [\n\t\t\t{\n\t\t\t  \"name\": \"Alabama\",\n\t\t\t  \"abbreviation\": \"AL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Alaska\",\n\t\t\t  \"abbreviation\": \"AK\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Arizona\",\n\t\t\t  \"abbreviation\": \"AZ\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Arkansas\",\n\t\t\t  \"abbreviation\": \"AR\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"California\",\n\t\t\t  \"abbreviation\": \"CA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Colorado\",\n\t\t\t  \"abbreviation\": \"CO\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Connecticut\",\n\t\t\t  \"abbreviation\": \"CT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Delaware\",\n\t\t\t  \"abbreviation\": \"DE\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"District Of Columbia\",\n\t\t\t  \"abbreviation\": \"DC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Florida\",\n\t\t\t  \"abbreviation\": \"FL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Georgia\",\n\t\t\t  \"abbreviation\": \"GA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Hawaii\",\n\t\t\t  \"abbreviation\": \"HI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Idaho\",\n\t\t\t  \"abbreviation\": \"ID\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Illinois\",\n\t\t\t  \"abbreviation\": \"IL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Indiana\",\n\t\t\t  \"abbreviation\": \"IN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Iowa\",\n\t\t\t  \"abbreviation\": \"IA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Kansas\",\n\t\t\t  \"abbreviation\": \"KS\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Kentucky\",\n\t\t\t  \"abbreviation\": \"KY\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Louisiana\",\n\t\t\t  \"abbreviation\": \"LA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Maine\",\n\t\t\t  \"abbreviation\": \"ME\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Maryland\",\n\t\t\t  \"abbreviation\": \"MD\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Massachusetts\",\n\t\t\t  \"abbreviation\": \"MA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Michigan\",\n\t\t\t  \"abbreviation\": \"MI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Minnesota\",\n\t\t\t  \"abbreviation\": \"MN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Mississippi\",\n\t\t\t  \"abbreviation\": \"MS\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Missouri\",\n\t\t\t  \"abbreviation\": \"MO\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Montana\",\n\t\t\t  \"abbreviation\": \"MT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Nebraska\",\n\t\t\t  \"abbreviation\": \"NE\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Nevada\",\n\t\t\t  \"abbreviation\": \"NV\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Hampshire\",\n\t\t\t  \"abbreviation\": \"NH\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Jersey\",\n\t\t\t  \"abbreviation\": \"NJ\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Mexico\",\n\t\t\t  \"abbreviation\": \"NM\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New York\",\n\t\t\t  \"abbreviation\": \"NY\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"North Carolina\",\n\t\t\t  \"abbreviation\": \"NC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"North Dakota\",\n\t\t\t  \"abbreviation\": \"ND\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Ohio\",\n\t\t\t  \"abbreviation\": \"OH\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Oklahoma\",\n\t\t\t  \"abbreviation\": \"OK\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Oregon\",\n\t\t\t  \"abbreviation\": \"OR\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Pennsylvania\",\n\t\t\t  \"abbreviation\": \"PA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Rhode Island\",\n\t\t\t  \"abbreviation\": \"RI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"South Carolina\",\n\t\t\t  \"abbreviation\": \"SC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"South Dakota\",\n\t\t\t  \"abbreviation\": \"SD\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Tennessee\",\n\t\t\t  \"abbreviation\": \"TN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Texas\",\n\t\t\t  \"abbreviation\": \"TX\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Utah\",\n\t\t\t  \"abbreviation\": \"UT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Vermont\",\n\t\t\t  \"abbreviation\": \"VT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Virginia\",\n\t\t\t  \"abbreviation\": \"VA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Washington\",\n\t\t\t  \"abbreviation\": \"WA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"West Virginia\",\n\t\t\t  \"abbreviation\": \"WV\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Wisconsin\",\n\t\t\t  \"abbreviation\": \"WI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Wyoming\",\n\t\t\t  \"abbreviation\": \"WY\"\n\t\t\t}\n\t\t];\n    \n\t\t\n\t\t\t  \n\t}\n\t\n})();\n\t\t","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('addressChoice', addressChoice);\n\t\t\n\n\t\n  function addressChoice () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/address-choice/address-choice.template.html',\n      controller: 'addressChoiceCtrl as adcvm',\n      scope : {\n\t\t\t\tuser : '=',\n        addressObject : '=?'\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('chooserCtrl', chooserCtrl)\n\t\n\t\tchooserCtrl.$inject = ['$scope', '$element','$timeout', '$window', 'jean', 'popups'];\n\n\t\t\n\t\tfunction chooserCtrl($scope, $element, $timeout, $window, jean, popups) {\n\n\t\t\tvar chvm = this;\n\t\t\t\n\t\t\t//popups\n\t\t\tchvm.popups = popups.get();\n\t\t\tchvm.jeanData = jean.get();\n\t\t\tchvm.breakPoint = 800;\n\t\t\tchvm.touched = false;\n\n\t\t\tfunction scrollToLeft(el, scrollTo, scrollDuration) {\n\n\t\t\t\t//Select First Element\n\t\t\t\tel = el[0];\n\t\t\t\t//Center Scroll To\n\t\t\t\tscrollTo = scrollTo-(el.offsetWidth/2)+40;\n\t\t\t\t\n\t\t\t\tvar maxLeft = el.scrollWidth - el.offsetWidth;\n\t\t\t\t\n\t\t\t\tif (scrollTo >= maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tif (scrollTo == maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tvar stepNum = Math.ceil(scrollDuration / 15),\n\t\t\t\t\tdistance = scrollTo - el.scrollLeft,\n\t\t\t\t\tscrollStep = (distance / stepNum),\n\t\t\t\t\tscrollTest = (el.scrollLeft < scrollTo ? function(a,b){return a<=b-1;} : function(a,b){return a>=b+1;} );\n\t\t\t\t/*\n\t\t\t\tconsole.log(\"current Scoll pos: \"+el.scrollLeft);\n\t\t\t\tconsole.log(\"Scroll to \"+scrollTo);\n\t\t\t\tconsole.log(\"distance to go \"+distance);\n\t\t\t\tconsole.log(scrollStep);\n\t\t\t\tconsole.log(\"func: \"+scrollTest)\n\t\t\t\tconsole.log(\"eval\");\n\t\t\t\tconsole.log(scrollTest(el.scrollLeft, scrollTo ));\n\t\t\t\tconsole.log(\"done\");\n\t\t\t\t*/\n\t\t\t\t\t\t\n\t\t\t\tvar scrollInterval = setInterval(function(){    \n\t\t\t\t\n\t\t\t\t\tif(scrollTest(el.scrollLeft, scrollTo )){\n\t\t\t\t\t\tvar newScroll = el.scrollLeft+scrollStep;\n\t\t\t\t\t\tif (newScroll >= maxLeft) newScroll = maxLeft-1;\n\t\t\t\t\t\tel.scrollLeft = newScroll;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse clearInterval(scrollInterval); \n\t\t      \n\t  \t\t},15);\n\t\t\t  \n\t\t\t}\n\n\t\t\tchvm.selectorCoords = {\"top\":0, \"left\":0};\n\t\t\t\n\t\t\t\n\t\t\t//Center Selector on chooser change... Center on selected attr if edting preexisting jean...\n\t\t\t$scope.$watch('active', function(newValue, oldValue) {\n\t\t\t\t\n\t\t\t\t//Only on active choosers...\n\t\t\t\tif (newValue == true){\n\n\t\t\t\t\t$timeout(function(){\n\n\t\t\t\t\t\t//Get the data id \n\t\t\t\t\t\tvar dataId = chvm.jeanData[$scope.step.jeanKey];\n\t\t\t\t\t\tvar elementId = $scope.step.jeanKey+\"_\"+dataId;\n\t\t\t\t\t\telementId = elementId.replace(\"_option_id\", \"\");\n\t\t\t\t\t\tvar activeElement = angular.element(document.querySelector('#'+elementId));\n\t\t\t\t\t\tchvm.selectorCoords.top = activeElement.prop('offsetTop');\n\t\t\t\t\t\tchvm.selectorCoords.left = activeElement.prop('offsetLeft');\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+$scope.step.jeanKey+\"-selector\"));\n\t\t\t\t\t\tselector.css({'top':chvm.selectorCoords.top+'px', 'left':chvm.selectorCoords.left+'px', 'width':activeElement.prop('width')+'px', 'height':activeElement.prop('height')+'px',});\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Mobile Choosers\n\t\t\t\t\t\tif ($window.innerWidth < chvm.breakPoint){\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0].querySelector('.chooser-grid'));\n\t\t\t\t\t\t\tvar left = (chooser[0] ? chvm.selectorCoords.left-(chooser[0].offsetWidth/2)+40 : 0);\n\t\t\t\t\t\t\tchooser.prop('scrollLeft', left);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Desktop Choosers\n\t\t\t\t\t\telse{\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(chvm.touched){\n\t\t\t\t\t\t\t\tvar chooser = angular.element($element[0]);\t\n\t\t\t\t\t\t\t\tchooser.prop('scrollTop', chvm.selectorCoords.top - 15);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}, 200);\n\t\t\t\t\t\n\t\t\t\t}\t\t\n\t\t\t\t\n    \t});\n\n\n\t\t\tchvm.selectAttr = function($event, id, attr, selector){\n\t\t\t\tattrId = attr.replace(\"_option_id\", \"\");\n\t\t\t\tif (chvm.touched == false) chvm.touched = true;\n\t\t\t\tvar chooser = angular.element(document.querySelector(\"#\"+attrId+\"-chooser\"));\n\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+attrId+\"-selector\"));\n\t\t\t\tvar top = angular.element($event.target).prop('offsetTop');\n\t\t\t\tvar left = angular.element($event.target).prop('offsetLeft');\n\t\t\t\tvar text = angular.element(document.querySelectorAll('#item-title'));\n        var width = angular.element($event.target)[0].clientWidth;\n        var height = angular.element($event.target)[0].clientHeight;\n        \n        //Test logging\n        ////console.log(width,height,left,top);\n        \n\t\t\t\ttext.css({'right':'-400px', 'opacity':0});\n\t\t\t\tselector.css({'top':top+'px', 'left':left+'px', 'width':width+\"px\", 'height':height+\"px\"});\n\t\t\t\t\n\t\t\t\tchvm.selectorCoords = {\"top\":top,\"left\":left};\n\t\t\t\tif ($window.innerWidth < chvm.breakPoint) scrollToLeft(chooser, left, 200);\n\t\t\t\t\n\t\t\t\t$timeout(function(){\n\t\t\t\t\ttext.css({'right':'15px', 'opacity':1});\t\t\t\t\n\t\t\t\t\tjean.set(attr,id);\t\n\t\t\t\t}, 200);\n\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tchvm.jeanSet = function(attr, val){\n\t\t\t\tchvm.jeanData[attr] =\tval;\n\t\t\t}\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('chooser', chooser);\n\t\t\n  function chooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('fabricChooser', ['$window', function($window) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      template: '<div class=\"fabric-chooser-container\" ng-include=\"viewUrl\"></div>',\n\t      controller: 'chooserCtrl as chvm',\n\t      scope : {\n\t        step : '=',\n\t        dataset: '=',\n\t\t\t\t\tactive: '='\n\t      },\n\t      \n\t      link: function($scope){\n\t\t      \n\t\t      $scope.breakPoint = 800;\n\t\t      \n\t\t      //Template on window resize\n\t\t      $window.onresize = function() {\n\t          changeTemplate();\n\t          $scope.$apply();\n\t        };\n\t        \n\t        changeTemplate();\n\t            \n\t        function changeTemplate() {\n\t          var screenWidth = $window.innerWidth;\n\t          if (screenWidth < $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-mobile.html\";\n\t          } else if (screenWidth >= $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-desk.html\";\n\t          }\n\t        }\n\t\t      \n\t\t      \n\t\t      function positionChooser(){\n\t\t\t    \t//element.animate({scrollLeft: element.offset().left - 50}, \"slow\");\n\t\t\t    \t//var selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));  \n\t\t      }\n\t\t      \n\t\t      \n\t\t      //Weight Filter\n\t\t      $scope.weightFilter = function(min, max){\n\t\t\t\t\t\treturn function(fabric){\n\t\t\t\t\t\t\tif (fabric.weight == 0) return false;\n\t\t\t\t\t\t\tif (min && fabric.weight < min) return false;\n\t\t\t\t\t\t\tif (max && fabric.weight > max) return false;\n\t\t\t\t\t    return true;\n\t\t\t\t\t  }\n\t\t\t\t\t};\n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('genderChooser', genderChooser);\n\t\t\n  function genderChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/gender-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('styleChooser', styleChooser);\n\t\t\n  function styleChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/style-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      },\n      link: function($scope){\n\t      $scope.checkGenderFilter = function(gender){\n\t\t\t\t\treturn function(style){\n\t\t\t\t\t\tg = gender == 1 ? \"male\":\"female\";\n\t\t\t\t\t\treturn style[g];\n\t\t\t\t  }\n\t\t\t\t};\n\t    }\n     \n\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('istackCtrl', istackCtrl);\n\n  istackCtrl.$inject = ['$window', '$scope', '$q', 'jean'];\n  \n  \n  \n  function istackCtrl($window, $scope, $q, jean) {\n\t  var isvm = this;\n\n\t\tisvm.centerPan = false;\t\t\n\t\tisvm.zoom = false;\n\t\tisvm.pan = {\"x\":50, \"y\":30};\n\t\tisvm.isMobile = function(){ return $window.innerWidth<800 };\n\t\t\n\t\t\n\t\tisvm.toggleZoom = function(){\n\t\t\tisvm.zoom = !isvm.zoom\n\t\t}\n\t\t\n\t\tisvm.touchEnd = function(){\n\t\t\tisvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\t$scope.$apply();\n\t\t}\n\t\t\n\t\tisvm.returnPan = function(){\n\t\t\tif (isvm.isMobile()) return false;\n\t\t\tisvm.pan = \"50% 30% 0\";\t\n\t\t\tisvm.centerPan = true;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\tsetTimeout(function(){\n\t\t\t\timages.css({\"transform-origin\":isvm.pan});\n\t\t\t}, 200);\n\t\t}\n\t\t\t\t\n\t\tisvm.touchStart= function(e){\t\n\t\t\t//Setup Swipe starting point\n\t\t\tisvm.swipeStart={\"x\":e.touches[0].clientX,\"y\":e.touches[0].clientY};\n\t\t\t//Clear out Swipe Object\n\t\t\tisvm.swipe={};\n\t\t}\n\t\t\n\t\tisvm.zoomDrag = {\"x\":0,\"y\":0};\n\t  isvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\n\t\tisvm.touchMove= function(e){\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t//Prevent Scrolling?\n\t\t\te.preventDefault();\n\t\t\t\n\n\t\t\tvar touch = e.touches[0],\n\t\t\ttarget = touch.target,\n\t\t\tdrag = {\n\t\t\t\t\"x\" : touch.clientX-isvm.swipeStart.x,\n\t\t\t\t\"y\" : touch.clientY-isvm.swipeStart.y\n\t\t\t};\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = (x/target.clientWidth*100)+isvm.zoomDrag.x,      \n\t\t\ty = (y/target.clientHeight*100)+isvm.zoomDrag.y;\n\n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -120;\n\t\t\tbounds.x.right  = 90;\n\t\t\t\n\t\t\t//Apply Bounds\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y};\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\tisvm.dragTracker = drag;\t\n\t\t\t$scope.$apply();\n\n\t\t}\n\t\t\n\n\n\n\t\tisvm.dragPan = function(u, event) {\n\t\t\n\t\t\tconsole.log(event.direction);\n\t\t\t\n\t\t\t\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\")),\n\t\t\twindowHeight = window.innerHeight,\n\t\t\torigHeight = images[0].height,\n\t\t\tnewHeight = origHeight*1.7,\n\t\t\tframe={\n\t\t\t\t\"width\":event.target.clientWidth,\n\t\t\t\t\"height\":event.target.clientHeight\n\t\t\t};\n\t\t\t\n\n\t\t\t//Get drag length\n\t\t\tvar drag = {\n\t\t\t\t\"x\" : event.deltaX,\n\t\t\t\t\"y\" : event.deltaY\n\t\t\t}\n\t\t\t\n\t\t\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\n\t\t\tconsole.log(x,y);\n\t\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = Math.abs(x)/frame.width*100;      \n\t\t\tx = (drag.x<0)?-x:x;\t       \n\t\t\tvar y = Math.abs(y)/frame.height*100;\n\t\t\ty = (drag.y<0)?-y:y;\n\t\t\t\n\t\t\t//Add these values to the last drag. This essentially allows drag and drop\n\t\t\tx=x+isvm.zoomDrag.x;\n\t\t\ty=y+isvm.zoomDrag.y;\n\t\t\t\t \n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\n\t\t\t/*//Left/Right Bounds\n\t\t\tbounds.y.top =(newHeight/2)+175;\n\t\t\tbounds.y.bottom =-(newHeight*.225);\n\t\t\tbounds.x.left = -(event.target.clientWidth-(event.target.clientWidth*.05));\n\t\t\tbounds.x.right = event.target.clientWidth-(event.target.clientWidth*.05);*/\n\t\t\t\t\n\t\t\t//Transform Origin Bounds\n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -150;\n\t\t\tbounds.x.right  = 60;\n\t\t\t\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y}\n\t\t\t\n\t\t\tconsole.log(move);\n\t\t\t//Register Drag\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t       \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\t/*//Alter Left/Bottom\n\t\t\timages.css('left', move.x+\"px\");\n\t\t\timages.css('bottom', -move.y+\"px\");*/\n\t\t\t\n\t\t\t//When drag is over, reset drag tracker\t \n\t\t\tisvm.dragTracker = event.isFinal ? {\"x\":0,\"y\":0} : drag;\n\t\t\t\t \n\n\t\t}\n\t\t\n\n\t\t\n\n\t\t\n\n\t\tisvm.scanImage = function(x,y){\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tisvm.centerPan = false;\n\t\t\t}, 200);\n\t\t\t\n\t\t\t\n\t\t\tframe = angular.element(document.querySelector(\"#zoom-frame\"))[0];\n\t\t\tfWidth = frame.clientWidth;\n\t\t\tfHeight = frame.clientHeight;\n\t\t\trect = frame.getBoundingClientRect();\n\t\t\trootDoc = frame.ownerDocument.documentElement;\n\t\t\t\t//calculate the offset of the frame from the top and left of the document\n\t\t\toffsetT = rect.top + $window.pageYOffset - rootDoc.clientTop\n\t\t\toffsetL = rect.left + $window.pageXOffset - rootDoc.clientLeft\n\n\t\t\t//calculate current cursor position inside the frame, as a percentage\n\t\t\txPosition = ((x - offsetL) / fWidth) * 100\n\t\t\tyPosition = ((y - offsetT) / fHeight) * 100\n\t\t\t\n\t\t\t\n\t\t\t/*\n\t\t\tconsole.log(x,y);\n\t\t\tconsole.log(fWidth);\n\t\t\tconsole.log(offsetL);\n\t\t\tconsole.log(x-offsetL);\n\t\t\tconsole.log(xPosition, yPosition);\n\t\t\t*/\n\t\t\tif ($window.innerWidth < isvm.breakPoint) pan = (100-xPosition) + \"% \" + (100-yPosition) + \"% 0\";\n\t\t\telse pan = (xPosition) + \"% \" + (yPosition) + \"% 0\";\n\t\t\tisvm.pan=pan;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\timages.css({\"transform-origin\":pan});\n\t\t}\n\t\t\n\t\tisvm.trackMouse = function($event){\n\t\t\t//if (isvm.isMobile()) return false;\n\t\t\tisvm.scanImage($event.pageX,$event.pageY);\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('imageStack', imageStack);\n\t\t\n\n\t\n  function imageStack () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/image-stack/image-stack.template.html',\n      controller: 'istackCtrl as isvm',\n      scope : {\n        jeanData : '='\n      },\n      link: function(scope, ele, attrs, ctrl) {\n\t      \n\t     \n\t     ele.on('touchstart', function(e){\n\t\t\t \tscope.isvm.touchStart(e);\t\n\t     });\t\n\t     \n\t     ele.on('touchmove', function(e){\n\t\t\t \tscope.isvm.touchMove(e);\t\n\t     });\t\t\n\t     \n\t     ele.on('touchend', function(e){\n\t\t\t \tscope.isvm.touchEnd(e);\t\n\t     });\t\t\t\t\n\t\t\t\n       \n\t      /*\n\t      $swipe.bind(ele, {\n          'move': function(event) {\n\t\t\t\t\t\tscope.isvm.scanImage(coords.x,coords.y);\n          }\n\t      });\n\t     */\n\n\t    }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('jeanCard', jeanCard);\n    \n\t  function jeanCard () {\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      replace:true,\n\t\t\t\ttemplate: '<ng-include src=\"templatePath\"/>',\n\t      scope : {\n\t        click : '=?',\n\t        data: '=',\n\t      },\n\t      link: function link(scope, element, attrs) {\n\t\t      console.log(attrs);\n\t\t\t\t\tvar slug = attrs.template ? attrs.template : \"jean-card\";\n\t\t      scope.templatePath=\"/directives/jean-card/\"+slug+\".template.html\";\n\t\t\t\t}\n\t  \t} \n\t  }\n  \n    \n\n})();\n","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('jeanList', ['jean', 'api', function(jean, api) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t\t\t\ttemplateUrl: '/directives/jean-list/jean-list.template.html',\n\t      scope : {\n\t        fields : '=?',\n\t        jean: '=?'\n\t      },\n\t      \n\t      link: function($scope){\n\t\t\t\t\t\n\t\t\t\t\t$scope.data = api.getData();\n\t\t\t\t\t$scope.jean = $scope.jean || jean.get();\n\t\t\t\t\t\n\t\t\t\t\tvar defaultFields = [\n\t\t\t\t\t\t'fabric_id',\n\t\t\t\t\t\t'fabric_type',\n\t\t\t\t\t\t'top_thread_id',\n\t\t\t\t\t\t'bottom_thread_id',\n\t\t\t\t\t\t'accent_thread_id',\n\t\t\t\t\t\t'gender_option_id',\n\t\t\t\t\t\t'style_option_id'\n\t\t\t\t\t];\n\n\t\t\t\t\t$scope.findLabel = function(field){\n\t\t\t\t\t\tvar fieldLabels = {\n\t\t\t\t\t\t\t'fabric_id' : 'Fabric',\n\t\t\t\t\t\t\t'fabric_type': 'Fabric Type',\n\t\t\t\t\t\t\t'accent_thread_id' : 'Accent Thread',\n\t\t\t\t\t\t\t'top_thread_id' : 'Top Thread',\n\t\t\t\t\t\t\t'bottom_thread_id' : 'Bottom Thread',\n\t\t\t\t\t\t\t'gender_option_id' : 'Gender',\n\t\t\t\t\t\t\t'style_option_id' : 'Style'\n\t\t\t\t\t\t};\n\t\t\t\t\t\t\n\t\t\t\t\t  return fieldLabels[field]; // otherwise it won't be within the results\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t$scope.fields = $scope.fields || defaultFields;\n\t\t\t\t\t\n\t\t\t\t\t$scope.dataLookup = function(field){\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Special handling for fabric_type\n\t\t\t\t\t\tif (field.indexOf('fabric_type') > -1){\n\t\t\t\t\t\t\tfor (d=0; d<$scope.data.fabrics.length; d++){\n\t\t\t\t\t\t\t\tif ($scope.data.fabrics[d].id == $scope.jean.fabric_id){\n\t\t\t\t\t\t\t\t\treturn $scope.data.fabrics[d].fabric_type;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Fields on Jean that are not IDs\n\t\t\t\t\t\tif (field.indexOf('id') < 0){\n\t\t\t\t\t\t\treturn $scope.jean[field];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//If we're using an id.. let's look it up.\n\t\t\t\t\t\tvar dataMap = {\n\t\t\t\t\t\t\t'fabric_id' : 'fabrics',\n\t\t\t\t\t\t\t'accent_thread_id' : 'threads',\n\t\t\t\t\t\t\t'top_thread_id' : 'threads',\n\t\t\t\t\t\t\t'bottom_thread_id' : 'threads',\n\t\t\t\t\t\t\t'gender_option_id' : 'gender_options',\n\t\t\t\t\t\t\t'style_option_id' : 'style_options'\n\t\t\t\t\t\t};\n            \n            var specialLabels = {\n            \t'gender_option_id':'gender'\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tvar label = specialLabels[field] || \"name\";\n      \n\t\t\t\t\t\treturn $scope.data.lookup(dataMap[field], \"id\", $scope.jean[field], label);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t$scope.filterFields = function(data){\n\t\t\t\t\t\tmatches = {};\n\t\t\t\t\t\tfor (var k in data) {\n\t\t        \tif (data.hasOwnProperty(k) && $scope.fields.indexOf(k)>=0) {\n\t\t\t\t\t  \t  matches[k]=data[k];\n\t\t\t\t\t    }\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn matches;\n\t\t\t\t\t}\n\n\t\t   \n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('loginFormCtrl', loginFormCtrl);\n\n  loginFormCtrl.$inject = ['$location', 'user', 'messages', '$scope','api'];\n  \n  function loginFormCtrl($location, user, messages, $scope, api) {\n    var logvm = this;\n    \n\t\tlogvm.messages=messages.get();\n\t\t\n\t\tlogvm.credentials = {\n      loginEmail : \"\",\n      loginPassword : \"\"\n    };\n    \n    \n  \tfunction validateEmail(email) {\n\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t    return re.test(email);\n\t\t}\n\t\t\n\t\t\n    /*\n    *\n    * LOGGING IN\n    *\n    */\n   \n    //Log user in and send errors to \"messages\"\n\t\tlogvm.login = function(email, password){\n\t\t\tmessages.reset();\n\t    if (logvm.validateLoginForm()){\n\t\t    console.log('valid');\n\t      user.login(email, password, function(){\n\t\t\t\t\tif ($scope.callback) $scope.callback();\n\t\t\t\t\tif ($scope.redirect && $scope.redirect !== \"NULL\") $location.path($scope.redirect);\n\t\t\t\t\tif (!$scope.callback && !$scope.redirect)\t$location.path('/closet');\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tif (err.message == \"Incorrect username or password.\") err.message = \"Incorrect Email address or password.\"\n\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t});\n\t\t  }\n\t\t}\n\t\t\n\t\t//Login form validation\n\t\tlogvm.validateLoginForm = function(){\t\t\t\t\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!logvm.credentials.loginPassword){\n\t\t\t\tmessages.set(\"Please enter a password\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t/*\n\t\t*\n\t\t*  Forgot Password\n\t\t*\n\t\t*/\n\t\t\n\t\tfunction validatePassword(password){\n\t\t\t//var re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\t//return re.test(password);\n    \treturn password.length > 5 && password.length < 51 && password.search(/\\d/)>-1 &&  password.search(/[a-z]/i);\n  \t}\n\n\t\tlogvm.forgotPassword = false;\n\t\tlogvm.forgotPassword2 = false;\n\t\tif($location.path()==\"/customer-register/\"){\n\t\t\tlogvm.forgotPassword = true;\t\t\t\n\t\t\tlogvm.customerReset = true;\n\t\t\tif($location.search().email){\n\t\t\t\tlogvm.credentials.loginEmail = $location.search().email;\n\t\t\t}\n\t\t}\n\t\t\n\n\t\t\n\t\t/* STEP 1 */\n\t\tlogvm.getResetToken = function(){\t\n\t\t\tmessages.reset();\n\t    if (logvm.validateForgot()){\t\n\t\t    console.log(\"running func from user\");\t    \n\t\t\t\tuser.getResetToken(logvm.credentials.loginEmail, \n\t\t\t\t\tfunction(result){ logvm.forgotPassword2 = true; },\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\terr.message = err.message == \"Username/client id combination not found\" ? \"We don't have an account registered for that email\" : err.message;\n\t\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t  }\n\t\t};\n\t\t\n\t\t//Forgot password set 1 validation\n\t\tlogvm.validateForgot = function(){\t\t\t\t\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\t\n\t\t};\n\t\t\n\t\t/* STEP 2 */\t\n\t\tlogvm.resetPassword = function(){\n\t\t\tmessages.reset();\n\t    if (logvm.validateForgot2()){\n\t\t\t\tdata={\n\t\t\t\t\t\"email\":logvm.credentials.loginEmail, \n\t\t\t\t\t\"token\":logvm.credentials.loginVerifcation, \n\t\t\t\t\t\"password\":logvm.credentials.newPassword\n\t\t\t\t}\t\t    \n\t\t    user.resetPassword(data, \n\t\t\t\t\tfunction(result){\n\t\t    \t\tconsole.log(result);\n\t\t\t\t\t\tmessages.set(\"Password reset successfully. Try logging in.\", \"success\");\n\t\t\t\t\t\tlogvm.forgotPassword = false;\n\t\t\t\t\t\tlogvm.forgotPassword2 = false;\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t  }\n\t\t}\n\t\t\n\t\t//Forgot password set 1 validation\n\t\tlogvm.validateForgot2 = function(){\t\t\t\t\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (!logvm.credentials.loginVerifcation){\n\t\t\t\tmessages.set(\"Please enter your verifcation code\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!validatePassword(logvm.credentials.newPassword)){\n        messages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one letter</li>\");\n\t\t\t}\n\n\t\t\tif (logvm.credentials.newPassword !== logvm.credentials.newPasswordConfirm){\n\t\t\t\tmessages.set(\"Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\t\n\t\t}\n\t\n\t\t//Log in via Facebook\n\t\tlogvm.loginFB = function(){\n\t\t\t\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('loginForm', loginForm);\n\t\t\n\n\t\n  function loginForm () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/login-form/login-form.template.html',\n      controller: 'loginFormCtrl as logvm',\n      scope : {\n\t\t\t\tredirect : \"=?\",\n\t      callback : \"=?\",\n\t      forgot : \"=?\"\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['user', 'loader', 'jean'];\n  function navigationCtrl(user, loader, jean) {\n    var vm = this;\n\n\t\tvm.loader = loader.get('loader');\n\t\tvm.saver = loader.get('saver');\n\t\tvm.drops={};\n\t\tvm.drops.acct=false;\n\t\tvm.mobileMenu = false;\n\t\t\t\t\n\t\tvm.isLoggedIn = user.isLoggedIn();\n\n\t\tvm.logout = function(){\t\t\t\n\t\t\tuser.logout();\n\t\t\tjean.setup(jean.createNew());\n\t\t}\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerFormCtrl', registerFormCtrl);\n\n  registerFormCtrl.$inject = ['$scope', '$location', 'user', '$sce', 'messages'];\n  \n  function registerFormCtrl($scope, $location, user, $sce, messages) {\n    var regvm = this;\n    \n\t\tregvm.messages=messages.get();\n\t\t\n\t\tregvm.credentials = {\n      first_name : \"\",\n      last_name:\"\",\n      email : \"\",\n      password : \"\"\n    };\n\t\n\t\t//Validate Registration Form\n\t\tregvm.validateRegistrationForm = function () {\n\t\t\t\t\t\t\n\t\t\tfunction validatePassword(password){\n\t\t\t\t//console.log(regvm.credentials.password.length > 5);\n\t\t\t\t//contains numbers\n\t\t\t\t//console.log(regvm.credentials.password.search(/\\d/)>-1);\n\t\t\t\t//contains lowercase letters\n\t\t\t\t//console.log(regvm.credentials.password.search(/[a-z]/) > -1);\n\t\t\t\t//contains uppercase letters\n\t\t\t\t//console.log(regvm.credentials.password.search(/[A-Z]/) > -1);\n\t\t\t\t\n\t\t\t\t//RE to test all\n\t\t\t\t//var re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\t\n\t\t\t\treturn (\n\t\t\t\t\tregvm.credentials.password.length > 5 &&\n\t\t\t\t\tregvm.credentials.password.length < 51 &&\n\t\t\t\t\tregvm.credentials.password.search(/\\d/)>-1 &&\n        \tregvm.credentials.password.match(/[a-z]/i)\n\t\t\t\t);\n\t\t\t}\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\tfunction validateEmail(email) {\n\t\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t    return re.test(email);\n\t\t\t}\n\t\t\t\n\t\t\tif (!regvm.credentials.email || !regvm.credentials.first_name || !regvm.credentials.last_name || !regvm.credentials.password || !regvm.credentials.passwordConfirm){\n\t\t\t\tmessages.set(\"All fields are required\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (!validatePassword(regvm.credentials.password)){\n\t\t\t\tmessages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one letter</li>\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (regvm.credentials.password !== regvm.credentials.passwordConfirm){\n\t\t\t\tmessages.set(\"Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif(!validateEmail(regvm.credentials.email)){\n\t\t\t\tmessages.set(\"Please Enter a valid E-mail address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t//Register User\n    regvm.registerUser = function () {\n\t    messages.reset();\n\t    var valid = regvm.validateRegistrationForm();\n\t    console.log(valid);\n\t    if(!valid) return false;\n\t    else{\n\t\t    user.register(regvm.credentials.email, regvm.credentials.password, regvm.credentials.first_name, regvm.credentials.last_name, function(){\n\t\t\t\t\tif ($scope.callback) $scope.callback(regvm.credentials);\n\t\t\t\t\tif ($scope.redirect) $location.path($scope.redirect);\n\t\t\t\t\tif (!$scope.callback && !$scope.redirect)\t$location.path('/closet');    \n\t\t    },   \n\t\t    function(err){\n\t\t\t    if (err.message = \"Duplicate email address\") err.message = \"This user is already registered.\";\n\t\t\t\t  messages.set(err.message, \"error\");\n\t\t\t  });\t\t\t  \n\t\t  }\n    };\t\n    \n    \n    \t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('registerForm', registerForm);\n\t\t\n\n\t\n  function registerForm () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/register-form/register-form.template.html',\n      controller: 'registerFormCtrl as regvm',\n      scope : {\n\t\t\t\tredirect : \"=?\",\n\t      callback : \"=?\"\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('sliderCtrl', sliderCtrl)\n\t\n\t\tsliderCtrl.$inject = ['$scope', 'preloader'];\n\n\t\tfunction sliderCtrl($scope, preloader) {\n\t\t\tvar slvm = this;\n\n\t\t\t\n\t\t\t$scope.imagesLoaded = false;\n\t\t\t\n\t\t\tpreloader.preloadImages( $scope.slides )\n\t\t\t.then(function() {\n\t\t\t\t$scope.imagesLoaded = true;\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\tconsole.log(\"error loading imgaes...\");\n\t\t\t});\n\t\t \t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t$scope.currentIndex = 0;\n\t\t\t\n\t\t\t$scope.setCurrentSlideIndex = function (index) {\n\t\t\t  $scope.currentIndex = index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.isCurrentSlideIndex = function (index) {\n\t\t\t  return $scope.currentIndex === index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.nextSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex < $scope.slides.length - 1) ? ++$scope.currentIndex : 0;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.prevSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex > 0) ? --$scope.currentIndex : $scope.slides.length - 1;\n\t\t\t};\n\t\t\t\t\n\t\t}\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('slider', slider);\n\t\t\n  function slider () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/slider/slider.template.html',\n      controller: 'sliderCtrl as slvm',\n      scope : {\n        slides : '=',\n        imageClick : '&'\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('socialCtrl', socialCtrl);\n\t\n\t\tsocialCtrl.$inject = ['$scope', 'popups', 'api', 'jean'];\n\t\n\t\tfunction socialCtrl($scope, popups, api, jean) {\n\t\n\t\t\tvar sovm = this;\n\t\t\tsovm.jean = $scope.jean;\n\t\t\tsovm.shareImageUploaded =  $scope.shareImageUploaded;\n\t\t\t\n\t\t\tsovm.jeanToUrl = function(){\n\t\t\t\tvar url = \"http://share.bluedeltajeans.com/\";\n\t\t\t\turl += api.getDataCode($scope.jean);\n\t\t\t\treturn url;\n\t\t\t};\n\t\t\t\n\t\t\tvar sharingUrls = {};\n\t\t\t\n\t\t\tvar socialTitle = \"Custom Jeans by Blue Delta\";\n\t\t\tvar socialDescription = \"Check out the jeans I made at the Blue Delta Jean Builder\";\n\n\t\t\t//Facebook sharing URL\n\t\t\tsharingUrls.facebook = function(url){\n\t\t\t\tif (!url) return false;\n\t\t\t\tvar baseString = 'https://www.facebook.com/sharer/sharer.php?u='+url;\n\t\t\t\treturn baseString;\n\t\t\t};\n\t\t\t\n\t\t\t//Twitter sharing URL/\n\t\t\tsharingUrls.twitter = function(url){\n\t\t\t\tif (!url) return false;\n\t\t\t\treturn 'https://twitter.com/intent/tweet?text='+socialTitle+'&source=webclient&url='+url;\n\t\t\t};\n\t\t\t\n\t\t\t//Email sharing URL\n\t\t\tsharingUrls.email = function(url){\n\t\t\t\treturn \"mailto:?&subject=\"+socialTitle+\"&body=\"+socialDescription+\" - \"+url;\n\t\t\t};\n\t\t\t\n\t\t\t//Pinterest sharing URL\n\t\t\tsharingUrls.pinterest = function (url){\n\t\t\t\tif(!url) return false;\n\t\t\t\treturn 'https://www.pinterest.com/pin/find/?description=sharing&url='+url+'&description='+socialTitle+'%0A'+socialDescription;\n\t\t\t};\n      \n      \n      function runShare(social, shareUrl){\n        var url = sharingUrls[social](shareUrl);\n        if (url !== false) {\n          if (social == 'email') window.open(url, '_self');\n          else window.open(url, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');\n        }\n        else console.log(\"Error builiding social URL\");\n        return false;\n      }\n\t\t\t\n\t\t\tsovm.share = function(social){\n        var shareUrl = sovm.jeanToUrl();\n        runShare(social, shareUrl);\n\t\t\t};\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('socialActions', [function() {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      replace:true,\n\t\t\t\ttemplateUrl: '/directives/social-actions/social-actions.template.html',\n\t      scope : {\n\t        jean : '=',\n\t        display: '=',\n\t        savefunc:'=',\n\t\t\t\t\tuploaded:'='\n\t      },\n\t      controller: 'socialCtrl as sovm',\n\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('adminCtrl', adminCtrl);\n\n  adminCtrl.$inject = ['$location', 'meanData'];\n  function adminCtrl($location, meanData) {\n\t  \n\t  \n    var vm = this;\n\n    vm.user = {};\n    meanData.getOptions()\n      .success(function(data) {\n\t      console.log(\"admin.controller.jsln16:::\");\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('closetCtrl', closetCtrl);\n\n  closetCtrl.$inject = ['$filter', '$location', '$window', 'jean','popups', '$scope', 'messages', 'loader', 'user', 'api', '$routeParams', 'apiData'];\n  function closetCtrl($filter, $location, $window, jean, popups, $scope, messages, loader, user, api, $routeParams, apiData) {\n\t  \n    var vm = this;   \n\t\tpopups.closeAll();\n\t\tvm.popups=popups.get();\n\t\tvm.messages=messages.get();\n\t\tvm.data = apiData;\n\t\tconsole.log(\"LLLL\");\n\t\tconsole.log(vm.data.lookup('order_statuses', 'id', 5, 'name'));\n\t\t//Set up Jean\n\t\tvm.jeans;\n\t\tapi.call('getMyJeans', null, function(results){\n\t\t\tvm.jeans = results;\n\t\t});\n\t\t\n\t\t//Set up orders\n\t\tvm.orders = [];\t\t\n    api.call('getMyOrders', null, function(result){\n\t    vm.orders = result;\n\t    \n\t    for(var i=0; i<vm.orders.length; i++){\n\t    \tvm.checkUrl(vm.orders[i]);\n\t\t\t}\n    });\n  \n  \n    //For images... if we have the default images saved, see if a thumbnail exists for the jean... if not, try and create it.\n    vm.checkUrl = function(order){\n      console.log(\"CHECKING URL!!!\");\n      var image_url = order.order_items[0].jean_image_url;\n    \n      //image_url does not contain \"default\"... It's a good URL, let's use it.\n      if ((image_url).indexOf('default.jpg') < 0){\n        return order.order_items[0].jean_image_url;\n      }\n    \n      //image_url is set to the default. Let's build a data url and try to get a thumb.\n      else{\n        var data_code = api.getDataCode(order.order_items[0]);\n        jean.testJeanForExistingImage(order.order_items[0], data_code, function(jeanData){\n        \t\n        \tconsole.log(\"TEST FOR EXSIST RESULT\");\n        \tconsole.log(jeanData);\n        \tconsole.log(order);\n        \t\n\t\t\t\t\tif (jeanData.image && jeanData.image.data) {\n            api.call('uploadJeanThumb', order.order_items[0].image, function (result) {\n              order.order_items[0].jean_image_url = result.url + \"?tested=true\";\n              //save the order\n              api.call('updateMyOrder', order);\n            });\n          }else{\n            order.order_items[0].jean_image_url = jeanData.jean_image_url + \"?tested=true\";\n            //save the order\n            api.call('updateMyOrder', order);\n\t\t\t\t\t}\n        });\n      }\n    };\n    \n\t\tvm.onload=function(){\n\t\t\t$scope.vm = vm;\n\t\t};\n\t\t\n\t\t//Edit User\n\t\tvm.userForm = {};\n\t\tvm.userForm.editing={};\n\t\tvm.userForm.saving={};\n\t\tvm.userForm.data = {};\n\t\tvm.userForm.feedback={\n\t\t\t\"type\":\"\",\n\t\t\t\"message\":\"\",\n\t\t}\n\t\t\n\t\tvm.changeOrderItemName = function(){\n\t\t\tvar changeOrder = vm.displayOrder.order_items[0].id;\n\t\t\tvar changeName = vm.displayJean.jean_name;\n\t\t\tapi.call('postOrderItem', {id:changeOrder, jean_name:changeName});\n\t\t}\n\t\t\n\t\tvm.userForm.cancel = function(field){\n\t\t\tvm.userForm.editing[field] = false;\n\t\t\tvm.user[field] = vm.userForm.data[field];\n\t\t};\n\t\t\n\t\tvm.userForm.editField = function(field){\n\t\t\tvm.userForm.data[field] = angular.copy(vm.user[field]);\n\t\t\tvm.userForm.editing[field]=true;\n\t\t\t\n\t\t}\n\t\t\n\t\tvm.formatDate = function(date, format){\n\t\t\tvar format = format || \"MM/dd/yyyy\"\n\t\t\tvar date = new Date(date);\n\t\t\treturn $filter('date')(date, format);\n\t\t}\t\t\n\t\t\n\t\t//Validation functions\n\t\tfunction validateEmail(email) {\n\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t    return re.test(email);\n\t\t}\n\t\t\n\t\tfunction validatePhoneNumber(inputtxt) {\n\t\t  var phoneno = /^\\+?([0-9]{2})\\)?[-. ]?([0-9]{4})[-. ]?([0-9]{4})$/;\n\t\t  return inputtxt.match(phoneno);\n\t\t}\n\t\t\n\t\tvm.userForm.validate = function(field, data){\n\t\t\t\n\t\t\tif (field == 'email'){\n\t\t\t\tif (validateEmail(data)) return true;\n\t\t\t\telse {\n\t\t\t\t\tmessages.set(\"Please enter a valid email address\", \"error\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\telse if (field == 'phoneNumber'){\n\t\t\t\tif (validatePhoneNumber(data)) return true;\n\t\t\t\telse {\n\t\t\t\t\tmessages.set(\"Please enter a valid phone number\", \"error\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\telse return true;\n\t\t}\n\n\t\t\n\t\tvm.userForm.save = function(field){\n\t\t\t//if (vm.user[field] == \"\") vm.user[field] = null;\n\t\t\tif (vm.userForm.validate(field, vm.user[field])){\n\t\t\t\tuser.update(vm.user, function(result){\n\t\t\t\t\tvm.userForm.saving[field] = false;\n\t\t\t\t\tvm.userForm.editing[field] = false;\n\t\t\t\t\t//vm.userForm.data[field] = vm.user[field];\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\n    \n   \t\n\t vm.user = user.get();\t\n\n\t    \t\n\t\t\t\t\n\t\t/*\n\t\t* Password Form\n\t\t*/\n\t\tvm.passForm = {\n\t\t\t\"editing\" : false,\n\t\t\t\"currentPass\" : \"\",\n\t\t\t\"newPass\": \"\",\n\t\t\t\"newPassConfirm\" : \"\",\n\t\t\t\"clear\": function(){\n\t\t\t\tvm.passForm.editing = false;\n\t\t\t\tvm.passForm.currentPass = \"\";\n\t\t\t\tvm.passForm.newPass = \"\";\n\t\t\t\tvm.passForm.newPassConfirm = \"\";\n\t\t\t\tmessages.reset();\n\t\t\t}\n\t\t};\n\t\t\n\t\t\n\t\tfunction validatePassword(password){\n\t\t\tvar re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\treturn re.test(password);\n\t\t}\n\t\t\n\t\tvm.validatePasswordForm = function(){\n\t\t\n\t\t\tif (!validatePassword(vm.passForm.newPass)){\n\t\t\t\tmessages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one uppercase letter</li><li>Contain at least one lowercase letter</li><li>Contain at least one special character (\\\"!,@,#,$,%,^,&, or *\\\")</li>\");\t\n\t\t\t}\n\t\t\t\n\t\t\tif (vm.passForm.newPass !== vm.passForm.newPassConfirm){\n\t\t\t\tmessages.set(\"New Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\t\n\t\t};\n\t\t\n\t\t\n    vm.changePassword = function () {\n\t    messages.reset();\n\t    if (vm.validatePasswordForm()){\n\t\t    var passwordData ={\n\t\t\t    id:vm.user.id,\n\t\t\t    password:vm.passForm.newPass,\n\t\t\t    old_password:vm.passForm.currentPass\n\t\t\t  };\n\t\t\t\tuser.update(passwordData, function(result){\n\t\t\t\t\tvm.passForm.clear();\n\t\t\t\t\tmessages.set(\"Password successfully changed.\", \"success\");\n\t\t\t\t},\n\t\t\t\tfunction(err){\t\n\t\t\t\t\tmessages.set(err.message, \"error\");\n\t\t\t\t});\n\t\t  }\n    };\n\t\t\n    /*\n\t\tvm.reOrder = function(orderId){\n\t\t\t$location.path('/order/'+orderId+'/re-order');\n\t\t};\n\t\t*/\n    vm.reOrder = function(reOrder){\n      var orderCreateObj = {\n      \tprice:reOrder.price,\n\t\t\t\tshipping_phone:reOrder.shipping_phone,\n\t\t\t\tshipping_name:reOrder.shipping_name,\n\t\t\t\tshipping_address_id:reOrder.shipping_address_id,\n\t\t\t\tuser_id:reOrder.user_id,\n\t\t\t\tvendor_id:reOrder.vendor_id,\n\t\t\t\trep_id:reOrder.rep_id\n\t\t\t};\n\t\t\t\n\t\t\torderCreateObj.payment_status_id=1;\n      orderCreateObj.order_status_id=5;\n      orderCreateObj.order_type_id=5;\n      orderCreateObj.reorder_item_id = reOrder.order_items[0].id;\n  \n      api.call('placeMyOrder', orderCreateObj, function(newOrder){\n      \t$location.path('/pay/'+newOrder.id);\n      });\n      \n\t\t};\n\n\t\tvm.copyJean = function(orderItem){\n\t\t\tdataCode = api.getDataCode(orderItem);\n\t\t\tjean.setup(dataCode, true);\n\t\t\t$location.path('/customizer');\n\t\t};\n\t\t\n\t\tvm.displayJean={};\n\t\tvm.selectJean = function(jean){\n\t\t\tvm.popups.jeanProfile = true; \n\t\t\tvm.displayJean=jean\n\t\t};\n\t\t\n\t\tvm.selectOrder = function(order){\n\t\t\tvm.popups.orderProfile = true; \n\t\t\tvm.displayOrder=order;\n\t\t\tvm.displayJean = order.order_items[0];\n\t\t};\n\t\n\t\tfunction findJeanbyId(jeanId){\n\t\t\tfor (var j=0; j < vm.jeans.length; j++) {\n\t      if (vm.jeans[j].id === jeanId) return j;\n      }\n  \t}\n\n\t\tvm.deleteJean = function(jeanId){\n\t\t\tapi.call('deleteMyJean', jeanId, function(result){\n\t\t\t\tvar index = findJeanbyId(jeanId);\n\t\t\t\tvm.jeans.splice(index, 1);\n\t\t\t});\n\t\t};\n\t\t\n\t\tvm.orderJean = function(jeanId){\n\t\t\t$location.path('/order/'+jeanId);\n\t\t};\n  \n    vm.payInvoice = function(orderId){\n      $location.path('/pay/'+orderId);\n\t\t};\n\t\t//Get User\n\t\t\n\t\t\n\t\n  \n  \n  }\n  \n\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('customizerCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['api', 'user','$filter','$location', '$routeParams', 'jean', '$scope', 'popups', 'messages', 'loader', 'apiData', '$window'];\n  function customizerCtrl(api, user, $filter, $location, $routeParams, jean, $scope, popups, messages, loader, apiData, $window) {\n\t\t\n    var vm = this\n\t\t\n\t\t//Setup Loader\t\t\n\t\tvm.loader = loader.get();\n\t\t\n\t\t//Set up shared messages service\n\t\tmessages.reset();\n\t\tvm.messages=messages.get();\n\t\n\t\t//Set up shared popups service\n\t\tpopups.closeAll();\n\t\tvm.popups = popups.get();\n\n\t\t//Set up Jean\n\t\tvar jeanId;\n\t\tif ($routeParams.jeanId) jeanId = $routeParams.jeanId;\n\t\tvar action = false;\n\t\tif ($routeParams.action) action = $routeParams.action;\n\t\t\n\t\tjean.setup(jeanId, action).then(function(result){\n\t\t\tvm.jeanData=jean.get();\n\t\t\t\n\t\t\t$scope.$watch(function() {\n\t\t\t\treturn vm.jeanData;\n\t\t\t}, function(current, original) {\n\t\t\t\tvm.shareImageUploaded=false;\n\t\t\t\tvm.displaySocial=false;\n        vm.displaySocialHelper=false;\n\t\t\t\tvm.updateActiveItem();\n\t\t\t}, true);\n\t\t\t\n\t\t\t$scope.$watch(function() {\n\t\t\t\treturn vm.data;\n\t\t\t}, function(current, original) {\n\t\t\t\tvm.updateActiveItem();\n\t\t\t}, true);\n\n\t\t}, \n\t\t\n\t\t\n\t\tfunction(err){\n\t\t\t//Test for jean not found...\n\t\t\tif(err.message = \"Invalid Jean ID\"){\n\t\t\t\tpopups.set('noJean',true);\n\t\t\t}\n\n\t\t});\n\n\t\t\t\n\t\t\n\t\t\n\t\t\n\t\n\n\t\t//Detect Orientation\t\t\t\n\t\tfunction landscapeDetect() {\n\t\t  var ua = navigator.userAgent.toLowerCase();\n\t\t  var isAndroid = ua.indexOf(\"android\") > -1; // Detect Android devices\n\t\t  if (isAndroid) {\n\t\t    //window.orientation is different for iOS and Android\n\t\t    if (window.orientation == 0 || window.orientation == 180) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 90 || window.orientation == -90) { //Portrait Mode\n\t\t\t\t\treturn false;\n\t\t    }\n\t\t  }\n\t\t  else {\n\t\t    if (window.orientation == 90 || window.orientation == -90) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 0 || window.orientation == 180) { //Portrait Mode\n\t\t      return false;\n\t\t    }\n\t\t  }\n\t\t}\n    \n    vm.landscape=landscapeDetect();\n  \tvar supportsOrientationChange = \"onorientationchange\" in window,\n    orientationEvent = supportsOrientationChange ? \"orientationchange\" : \"resize\";\n\t\t\n\t\twindow.addEventListener(orientationEvent, function() {\t\n\t\t\t//Set a scope variable on orientation change. This will display a popup on the front end warning users that the customizer works best in protrait mode\n\t\t  vm.landscape=landscapeDetect();\n\t\t  $scope.$apply();\n\t\t}, false);\n\t\t\n\t\t\n\t\t\n\t\t\n    /*\n\t\t*\n\t\t* GET CUSTOMIZER DATA \n\t\t*\n\t\t*/\t\n\t\tvm.data = apiData;\n\t\tvm.activeItem={};\n\t\t\n\t\tvm.updateActiveItem = function(){\n\t\t\tif (!vm.jeanData) return false;\n\t\t\tvar data = vm.data[vm.panel[vm.panelStep].dataKey];\n\t\t\tvar id = vm.jeanData[vm.panel[vm.panelStep].jeanKey];\n\t\t\tvar ret = $filter('filter')(data, {id: id});\n\t\t\tif (ret) ret = ret[0];\n\t\t\tvm.activeItem = ret||null;\n\t\t}\n\n\t\t//Build Control Panel Steps\n\t\tvm.panel = [];\n\t\t\n\t\t//Gender\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"gender-chooser\",\n\t\t\t\"dataKey\":\"gender_options\",\n\t\t\t\"title\":\"Gender\",\n\t\t\t\"jeanKey\":\"gender_option_id\"\n\t\t});\n\t\t\n\t\t//Style\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"style-chooser\",\n\t\t\t\"dataKey\":\"style_options\",\n\t\t\t\"title\":\"Style\",\n\t\t\t\"jeanKey\":\"style_option_id\"\n\t\t});\n\t\t\n\t\t//Fabric\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"fabric-chooser\",\n\t\t\t\"dataKey\":\"fabrics\",\n\t\t\t\"title\":\"Fabric\",\n\t\t\t\"jeanKey\":\"fabric_id\"\n\t\t});\n\t\t\n\t\t//Top Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Top Thread\",\n\t\t\t\"jeanKey\":\"top_thread_id\"\n\t\t});\n\t\t\n\t\t//Bottom Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Bottom Thread\",\n\t\t\t\"jeanKey\":\"bottom_thread_id\"\n\t\t});\n\t\t\n\t\t//Accent Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Accent Thread\",\n\t\t\t\"jeanKey\":\"accent_thread_id\"\n\t\t});\n\t\t\n\t\t//Overview\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"list\",\n\t\t\t\"title\":\"Overview\"\n\t\t});\n\t\t\n\t\tvm.panelDir=\"next\";\t\t\n\t\tvm.panelStep = 0;\n\t\tvm.changeStep = function(step){\n\t\t\tif (step >= vm.panel.length) return false;\n\t\t\tif (step < 0) return false;\n\t\t\tif (step===undefined) return false;\n\t\t\telse vm.panelStep = step; \n\t\t\t\n\t\t\t//As long as we're not on the \"Overview\" Step, update active item...\n\t\t\tif (step+1 != vm.panel.length) vm.updateActiveItem();\n\t\t}\n  \n    //Working with data url...\n    if (jeanId && jeanId.indexOf(':')>-1 && $window.innerWidth < 800) vm.panelStep = 2;\n\t\t\n\t\t/*\n\t\t*\n\t\t* Control Panel actions\n\t\t**\n\t\t*/\n\t\n\t\t\n\n\t\tvm.savingBar = false;\n\t\tvm.newJeanName = \"My New Jeans\";\n\t\tvm.authCallback;\n\t\tvm.saveCallback;\n\t\t\n\t\tvar openSaveOpts = function(){\n\t\t\tpopups.set('saveOpts',true);\n\t\t};\n\t\t\n\t\tvar redirectToOrder = function(jean){\n\t\t\t$location.path('/order/'+jean.id);\n\t\t};\n\t\t\n\t\tvm.saveAndOrder = function(){\n\t\t\tvm.saveCallback = redirectToOrder;\n\t\t\tvm.runSave();\n\t\t};\n\t\t\n\t\tvm.saveAndShowOpts = function(){\n\t\t\tvm.saveCallback = openSaveOpts;\n\t\t\tvm.runSave();\n\t\t};\n\t\n    vm.keepEditing = function(){\n    \tconsole.log(\"KEEP ED..\");\n    \tconsole.log(vm.jeanData.id);\n    \tconsole.log(parseInt($routeParams.jeanId));\n\t\t\tif(parseInt($routeParams.jeanId) !== vm.jeanData.id) $location.path('/customizer/'+vm.jeanData.id);\n\t\t\telse popups.closeAll();\n    };\n    \n    vm.goToCloset = function(){\n\t    $location.path('/closet');\n    };\n    \n    vm.startOver = function(){\n\t    jean.reset();\n\t    vm.jeanData=jean.get();\n\t    popups.closeAll();\n    };\n    \n    //Check for jean name, run save, and ex callback\n\t\tvm.runSave = function(){\n\t\t\tpopups.closeAll();\n\t\t\t\n\t\t\tif(!vm.jeanData.name) popups.set('namer', true);\n\t\t\t\n\t\t\telse{\n\t\t\t\tvm.savingBar = true;\n\t\t\t\tjean.save().then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tvm.jeanData = result;\n\t\t\t\t\t\tvm.savingBar = false;\n\t\t\t\t\t\tif (vm.saveCallback){ \n\t\t\t\t\t\t\tvm.saveCallback(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} \n\t\t}\n    \n    //When Order is clicked...\n    vm.placeOrder=function(){\n\t\t\tif(!user.isLoggedIn()){\n\t\t\t\tvm.authCallback = vm.saveAndOrder;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvm.saveAndOrder();\n\t\t\t}\n\t\t}\n\n\t\tvm.socialAuthCheck = function(callback){\n\t\t\tif(!user.isLoggedIn()){\n\t\t\t\tvm.authCallback = callback;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\t\n    //When Save is clicked....\n    vm.saveJean = function(){\n\t\t\tif(!user.isLoggedIn()){\n\t\t\t\tvm.authCallback = vm.saveAndShowOpts;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse vm.saveAndShowOpts();\n  \t}\n    \n    \n    //Set default auth callback  \n    vm.registerCallback = function(details){\n\t  }\n   \n\t  vm.shareImageUploaded=false;\n\t  vm.displaySocial=false;\n    vm.displaySocialHelper=false;\n    vm.share = function(display){\n    \tconsole.log(\"here it is\");\n    \tconsole.log(display);\n    \tif(vm[display]==true){\n    \t\tvm[dispaly]=false;\n\t\t\t}else {\n        vm[display] = true;\n        var dataCode = api.getDataCode(vm.jeanData);\n        var jeanData = angular.copy(vm.jeanData);\n        delete jeanData.image;\n        delete jeanData.image_url;\n        jean.testJeanForExistingImage(jeanData, dataCode, function (jeanData) {\n          //Image doesn't exist.. create and upload\n          if (!jeanData.image_url) {\n            api.call('uploadJeanThumb', jeanData.image, function (result) {\n              console.log(\"Image has been uploaded: \" + result.url);\n              vm.shareImageUploaded = true;\n            })\n          }\n          //Image already exists... run share\n          else {\n            vm.shareImageUploaded = true;\n          }\n        });\n      }\n\t\t}\n    \n\n\n\t\t\n  }\n\n})();3","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('fmCtrl', fmCtrl);\n  \n  fmCtrl.$inject = ['messages','$scope', '$routeParams', 'user', 'api', 'apiData', '$location'];\n  \n  function fmCtrl (messages, $scope, $routeParams, user, api, apiData, $location) {\n    \n    var vm = this;\n    vm.messages=messages.get();\n    vm.userLoggedIn = user.isLoggedIn();\n    vm.user={loaded:false};\n    vm.user = user.get();\n    vm.user.loaded = !vm.userLoggedIn;\n    vm.checkoutForm = {};\n    vm.data = apiData;\n    vm.add = {};\n    vm.formStep=1;\n    vm.fitMatch = $routeParams.orderDetails.split(\"-\");\n    vm.cards = null;\n    vm.cardForm = {\n      addingCard:false,\n      loadingCards:true\n    };\n    \n    vm.authCallback = function(){\n      vm.user=user.get();\n      vm.userLoggedIn = user.isLoggedIn();\n    };\n    \n    vm.logout = function(){\n      user.logout(function(){\n        vm.user = {};\n        vm.user.loaded=true;\n        vm.userLoggedIn = user.isLoggedIn();\n        vm.add = {};\n      }, false)\n    };\n    vm.fire = function(){};\n    \n    //After User is init'd\n    $scope.$watch(function() {\n      return vm.user;\n    }, function(current, original) {\n      //Make sure we've pulled a user...\n      if(!vm.user.id) return false;\n      \n      //Only run this once..\n      //if(vm.user.loaded) return false;\n      vm.user.loaded = true;\n      \n      //Set primary address to shipping address\n      if(vm.user.addresses.length){\n        for(var i=0; i<vm.user.addresses.length; i++){\n          if(vm.user.addresses[i].primary){\n            vm.add = vm.user.addresses[i];\n            break;\n          }\n        }\n      }\n      \n      if(vm.user.phone) vm.shipping_phone = vm.user.phone;\n      \n      //Pull Credit Cards\n      if(current.square_id){\n        //logged in user has sq id.\n        vm.cardForm.loadingCards = true;\n        api.call('getMyCreditCards', null, function(cards){\n          if (cards.length<1){\n            vm.cardForm.addingCard=true;\n          }else{\n            vm.cards = cards;\n          }\n          vm.cardForm.loadingCards = false;\n        });\n      }\n      else if(current.id && !current.square_id){\n  \n        console.log(\"USER doesn't sqid\");\n        \n        //logged in user does not have sq id.\n        vm.cardForm.addingCard=true;\n        vm.cardForm.loadingCards=false;\n      }\n      else{\n        console.log(\"no user\");\n        //not logged in?\n        vm.cardForm.loadingCards = false;\n      }\n    }, true);\n    \n    vm.inputConfigOverrides = {\n      cardNumber: {placeholder: ''},\n      cvv: {placeholder: ''},\n      expirationDate: {placeholder: ''},\n    };\n    \n    vm.inputStyles = [\n      {\n        backgroundColor: '#e8edef',\n        padding: '10px',\n        fontSize: '20px',\n        lineHeight: '20px',\n      }\n    ];\n    \n    /*\n    $scope.$watch(function() {\n      return vm.add;\n    }, function(current) {\n      console.log(current.id);\n    }, true);\n    */\n    \n    //Create CC from nonce and place order\n    vm.nonceReceived =  function(nonce, err){\n      api.call('createMyCreditCard', {'nonce':nonce}, function(card){\n        vm.orderFitMatch(card.card_id);\n      });\n    };\n    vm.ordering=false;\n    vm.orderFitMatch = function(card){\n      if (vm.ordering) return false;\n      vm.ordering=true;\n      if(!vm.validateFitMatch()) return false;\n      var fmObject = {\n        \"credit_card_id\":card,\n        \"shipping_address_id\":vm.add.id,\n        \"shipping_phone\":vm.shipping_phone,\n        \"requested_fabric_ids\":JSON.stringify(vm.fitMatch)\n      };\n      api.call('createMyFitMatch', fmObject, function(){\n        $location.path('/thank-you/fitmatch');\n      });\n      \n    };\n    vm.truncateBrand =function(brand){\n      if(brand == \"AMERICAN_EXPRESS\") truncated =  \"AMEX\";\n      else if(brand == \"DISCOVER\") truncated =  \"DISC\";\n      else if(brand == \"MASTERCARD\") truncated =  \"MSTR\";\n      else truncated = brand;\n      return truncated;\n    };\n    \n    vm.fit_match_error = false;\n    vm.validateFitMatch = function(){\n      vm.fit_match_error = false;\n      if(!vm.add.id) {\n        vm.fit_match_error = \"Please provide a shipping address\";\n        return false;\n      }\n      if(!vm.shipping_phone) {\n        vm.fit_match_error = \"Please provide a phone number\";\n        return false;\n      }\n      \n      return true;\n    };\n    \n    \n    vm.addCard = function(){\n      if (vm.validateFitMatch()) vm.fire();\n    };\n    \n  }\n  \n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('homeCtrl', homeCtrl);\n\t\t\t\n\t\thomeCtrl.$inject = ['$window', 'user', 'api'];\n\t\t\n\t\t\n    function homeCtrl ($window, user, api) { \t    \n\t\t\tvar vm = this;\t\n\t\t\tvm.user = user.get();\n\t\t\tconsole.log($window.localStorage.getItem(\"bdAccessToken\"));\n    }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('orderCtrl', orderCtrl);\n\n  orderCtrl.$inject = ['$window', '$location', 'jean','popups', '$filter', '$routeParams', 'user', 'api', '$scope', 'apiData', '$http'];\n  function orderCtrl($window, $location, jean, popups, $filter, $routeParams, user, api, $scope, apiData, $http) {\n\t\t\n    var vm = this;\n    vm.popups=popups.get();\n    vm.tailors = apiData.tailors;\n\t\tvm.ordersLoaded = false;\n\t\tvm.orderForm={};\n\t\tvm.orderCreateObj = {}\n    vm.editData = {};\n    vm.lookup = apiData.lookup;\n    \n\t\t\n\t\t/*\n\t\t* SET UP USER\n\t\t*/\n    vm.user = {};\n    vm.user = user.get();\n    $scope.$watch('vm.user', function(newV) {\n\t\t\tvm.orderCreateObj.shipping_name = newV.first_name+\" \"+newV.last_name;\n\t\t\tvm.orderCreateObj.shipping_phone = newV.phone;\n\t\t\tvm.orderCreateObj.shipping_address_id = getPrimaryAddress(newV.addresses);\n    }, true);\n\t\t\n\t\t\n\t\t/*\n    * SET UP ORDER DATA\n    */\n    vm.orders = [];\n    api.call('getMyOrders', null, function(result){\n      vm.orders = result;\n      vm.ordersLoaded=true;\n    });\n    \n   \t//SET UP A RE-ORDER\n\t\tif ($routeParams.dataId && $routeParams.action == 're-order'){\n\t\t\t//Set order type to re-order\n\t\t\tvm.orderCreateObj.order_type_id=5;\n      vm.orderCreateObj.comment=\"Re-Order of Order #\"+$routeParams.dataId;\n      \n      //Set up new order from Id passed through URL\n      $scope.$watch('vm.orders', function(orders) {\n        if (!orders.length) return false;\n        var orderFound = false;\n        for(var i=0; i<orders.length; i++){\n          if(orders[i].id == $routeParams.dataId){\n            var order_from_url = orders[i];\n            //Set up new order via re-order...\n            vm.jeanData = order_from_url.order_items[0];\n            vm.copyItem = order_from_url.order_items[0];\n            vm.jeanData.image_url =\tvm.jeanData.jean_image_url;\n            vm.jeanData.name =\tvm.jeanData.jean_name;\n            vm.orderCreateObj.reorder_item_id = order_from_url.order_items[0].id;\n\t\t\t\t\t\torderFound = true;\n            break;\n          }\n        }\n        \n        //Set Error\n        if(!orderFound) vm.orderErr = \"Order Not Found!\";\n      \n      }, true);\n\t\t}\n\t\t\n\t\t//SET UP A REGULAR ORDER FROM JEAN ID\n\t\telse if ($routeParams.dataId && !$routeParams.action){\n\t\t\tvar jeanId = $routeParams.dataId;\n\t\t\tjean.setup(jeanId).then(function(){\n\t\t\t\tvm.jeanData=jean.get();\n\t\t\t\tconsole.log('aftersetup');\n\t\t\t\tconsole.log(vm.jeanData);\n\t\t\t\tvm.orderCreateObj.jean_id = vm.jeanData.id;\n\t\t\t\tconsole.log(vm.orderCreateObj);\n\t\t\t});\n\t\t}\n  \n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n  \n    //UTIL\n    function getPrimaryAddress(addresses){\n      if(!addresses || !addresses.length) return false;\n      for (var i=0; i<addresses.length; i++) {\n        if (addresses[i].primary == true) return addresses[i].id;\n      }\n      return addresses[0].id;\n    }\n    \n\t\t//FRONT END FUNCS\n\t\tvm.goToCloset = function(){ $location.path('/closet'); }\n\t\t\n\t\tvm.startOver = function(){ \n\t\t\tjean.reset();\n\t\t\t$location.path('/customizer'); \n\t\t};\n\t\tvm.placeOrder = function() {\n\t\t\tvm.orderFormErr = false;\n\t\t\tif(!vm.orderCreateObj.shipping_name)\n\t\t\t\tvm.orderFormErr = \"Please enter a shipping name.\"\n      if(!vm.orderCreateObj.shipping_phone)\n        vm.orderFormErr = \"Please enter a shipping phone number.\"\n      if(!vm.orderCreateObj.order_type_id)\n        vm.orderFormErr = \"Please choose a fitting option.\"\n      if(!vm.orderCreateObj.shipping_address_id)\n        vm.orderFormErr = \"Please choose a shipping address.\"\n\t\t\t\n\t\t\tif(vm.orderFormErr) return false;\n\t\t\t\n      api.call('placeMyOrder', vm.orderCreateObj, function (result) {\n        vm.popups.orderPlaced = true;\n      });\n    };\n\n\t\tvm.chooseOrderType = function(type, copyOrder){\n\t\t\t//Set order type\n\t\t\tvm.orderCreateObj.order_type_id=type;\n\t\t\t\n\t\t\tif(copyOrder){\n\t\t\t\tvar copyItem = copyOrder.order_items[0];\n\t\t\t\tvm.orderCreateObj.fitDate = copyOrder.fit_date;\n\t\t\t}\n\t\t\t\n\t\t\t//Set order_item_copy\n\t\t\tif(type == 4){\n\t\t\t\tvm.orderCreateObj.copy_order_item_id = copyItem.id;\n\t\t\t\tvm.copyItem = copyItem;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdelete vm.orderCreateObj.copy_order_item_id;\t\n\t\t\t\tvm.copyItem = {};\n\t\t\t}\n      if(type!==1 || type!==2){\n\t\t\t\tdelete vm.orderCreateObj.tailor_id;\n\t\t\t}\n\t\t};\n\t\t\n\t\tvm.measurementKeys = [\n\t\t\t\"waist\",\n\t\t\t\"seat_down\",\n\t\t\t\"seat_right\",\n\t\t\t\"rise\",\n\t\t\t\"full_rise\",\n\t\t\t\"thigh_upper_down\",\n\t\t\t\"thigh_upper_right\",\n\t\t\t\"thigh_middle_down\",\n\t\t\t\"thigh_middle_right\",\n\t\t\t\"thigh_lower_down\",\n\t\t\t\"thigh_lower_right\",\n\t\t\t\"outseam\",\n\t\t\t\"knee_up\",\n\t\t\t\"knee_right\", \n\t\t\t\"calf_up\",\n\t\t\t\"calf_right\",\n\t\t\t\"leg_opening\"\n\t\t];\n\t\t\n\t\tvm.hasMeasurements = function(order) {\n\n\t\t\tif (!order || !order.order_items.length ) return false;\n\t\t\t\n\t\t\tvar orderItem = order.order_items[0];\n\t\t\tvar testCols = [\n\t\t\t\t'waist'\n\t\t\t];\n\t\t\tvar measurements = true;\n\t\t\tfor (i=0;i<testCols.length; i++){\n\t\t\t\tif (orderItem[testCols[i]] == \"\" || orderItem[testCols[i]] == null){\n\t\t\t\t\tmeasurements = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn measurements;\n\n\t\t};\n\t\t\n\t\tvm.editField = function(field){\n\t\t\tvar editText = vm.orderCreateObj[field] || \" \";\n\t\t\tvm.editData[field] = angular.copy(editText);\n\t\t};\n\t\t\n\t\tvm.revertField = function(field){\n\t\t\tvm.orderCreateObj[field] = angular.copy(vm.editData[field]);\n\t\t\tvm.editData[field] = false;\t\n\t\t};\n\t\t\n\t\t\n\n  }\n  \n\n\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('payCtrl', payCtrl);\n\n    payCtrl.$inject = ['messages','$scope', '$routeParams', 'user', 'api', 'apiData', '$location'];\n  \n  \n  \n  \n  function payCtrl (messages, $scope, $routeParams, user, api, apiData, $location) {\n    \n    \n    var vm = this;\n    vm.messages = messages.get();\n    vm.userLoggedIn = user.isLoggedIn();\n    vm.user = user.get();\n    vm.user.loaded = !vm.userLoggedIn;\n    vm.orderErr = false;\n    vm.checkoutForm = {};\n    vm.data = apiData;\n    vm.user = user.get();\n    vm.add = {};\n    vm.formStep=1;\n    vm.paidDate = false;\n    vm.cards = null;\n    vm.cardForm = {\n      addingCard:false,\n      loadingCards:true\n    };\n    \n    vm.authCallback = function(){\n      console.log(\"AUTH\");\n      vm.orderLoaded = false;\n      vm.user=user.get();\n      vm.userLoggedIn = user.isLoggedIn();\n      vm.initPage();\n    };\n    \n    vm.logout = function(){\n      user.logout(function(){\n        vm.orderErr = false;\n        vm.user = {};\n        vm.user.loaded=true;\n        vm.userLoggedIn = user.isLoggedIn();\n      }, false)\n    };\n    \n    vm.fire = function(){};\n    \n    //After User is init'd//\n    $scope.$watch(function() {\n      return vm.user;\n    }, function(current, original) {\n      \n      //Make sure we've pulled a user...\n      if(!vm.user.id) return false;\n      //Only run this once..\n      if(vm.user.loaded) return false;\n      vm.user.loaded = true;\n      //Set primary address to shipping address\n      if(vm.user.addresses.length){\n        for(i=0; i<vm.user.addresses.length; i++){\n          if(vm.user.addresses[i].primary){\n            vm.add = vm.user.addresses[i];\n            break;\n          }\n        }\n      }\n      \n      //Pull Credit Cards\n      if(current.square_id){\n        vm.cardForm.loadingCards = true;\n        api.call('getMyCreditCards', null, function(cards){\n          if (cards.length<1){\n            vm.cardForm.addingCard=true;\n          }else{\n            vm.cards = cards;\n          }\n          vm.cardForm.loadingCards = false;\n        });\n      }else if(current.id && !current.square_id){\n        vm.cardForm.addingCard=true;\n        vm.cardForm.loadingCards=false;\n      }\n    }, true);\n    //After User is init'd//\n    \n    \n    \n    vm.inputConfigOverrides = {\n      cardNumber: {placeholder: ''},\n      cvv: {placeholder: ''},\n      expirationDate: {placeholder: ''},\n    };\n    \n    vm.inputStyles = [\n      {\n        backgroundColor: '#e8edef',\n        padding: '10px',\n        fontSize: '20px',\n        lineHeight: '20px',\n      }\n    ];\n    \n    \n    //Create CC from nonce and place order\n    vm.nonceReceived =  function(nonce, err){\n      api.call('createMyCreditCard', {'nonce':nonce}, function(card){\n        vm.payInvoice(card.card_id);\n      });\n    };\n    \n    \n    \n    vm.payInvoice = function(card){\n      var chargeObject = {\n        \"orderId\":vm.order.id,\n        \"customer_card_id\":card,\n        \"amount_money\":vm.checkoutForm.price,\n        \"customer_id\":vm.user.square_id\n      };\n      console.log(chargeObject);\n      api.call('ordersCharge', chargeObject, function(){\n        $location.path('/thank-you/order');\n      });\n    };\n  \n    vm.initPage = function() {\n      vm.orderId = $routeParams.orderDetails;\n      api.call('getMyOrders', $routeParams.orderDetails, function (result) {\n        if (result.price) {\n          vm.order = result;\n          if (result.payment_status_id==3){\n            vm.orderErr = \"This order has been comped\";\n            vm.orderLoaded = true;\n          }\n          else if(result.payment_status_id !== 1 && result.transactions) {\n            for (var i = 0; i < result.transactions.length; i++) {\n              if (result.transactions[i].status === \"ok\") {\n                vm.paidDate = new Date(result.transactions[i].created_at);\n                break;\n              }\n            }\n          }\n          vm.checkoutForm.price = result.price;\n          vm.orderLoaded = true;\n        }\n        else {\n          vm.orderErr = \"Sorry, but this order is not ready for payment\";\n          vm.orderLoaded = true;\n        }\n      }, function (err) {\n        vm.orderLoaded = true;\n        if (err.status == 404) {\n          vm.orderErr = \"Sorry, but you don't have an Order #\" + $routeParams.orderDetails;\n        }\n      });\n    }\n    //Get Order\n    if(vm.userLoggedIn) {\n      vm.initPage();\n    }else{\n      vm.orderLoaded = true;\n    }\n    \n    \n    \n  }\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('tyCtrl', tyCtrl);\n  \n  tyCtrl.$inject = ['user', '$routeParams', '$location'];\n  \n  function tyCtrl (user, $routeParams, $location) {\n    var vm = this;\n  \n    if(!$routeParams.type){\n      $location.path('/login');\n    }\n    vm.type=$routeParams.type;\n    vm.userLoggedIn = user.isLoggedIn();\n    vm.user = user.get();\n  \n    vm.logout = function(){\n      user.logout(function(){\n        vm.orderErr = false;\n        vm.user = {};\n        vm.user.loaded=true;\n        vm.userLoggedIn = user.isLoggedIn();\n        $location.path('/login');\n      }, false)\n    };\n  }\n})();","(function () {\n\n  angular\n  .module('bdApp')\n  .controller('loginCtrl', loginCtrl);\n\n\tloginCtrl.$inject = ['messages'];\n  function loginCtrl(messages) {\n    var vm = this;\n    \n    messages.reset();\n    vm.messages = messages.get();\n    \n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['messages'];\n  function registerCtrl(messages) {\n    var vm = this;\n\n\t\tmessages.reset();\n    vm.messages = messages.get();\n    vm.formStep=1;\n    \t\t\n/*    \t\t\t\t\t\n\t\t//ConfirmUser with Registration Code\n    vm.confirmUser = function() {\n\t\t\tvm.resetMessage();\n\t\t\taws.confirmRegisteredUnauthenticatedUser(vm.credentials.email, vm.credentials.code).then(\n      \tfunction(result){\n\t\t\t\t\tvm.setMessage($sce.trustAsHtml(\"Your Account has been confirmed. <a href='/login'>Click here to login</a>\"), \"success\");\n\t      },   \n\t      function(err){\n\t\t      if (err.message == \"Missing required key 'ConfirmationCode' in params\") err.message = \"Please enter confirmation code\";\n\t\t\t    vm.setMessage(err.message, \"error\");\n\t\t    }\n\t\t  );\n    };\n    \n    //Resend Registration code to user via email\n    vm.resendCode = function(){\n\t    //This function throws an error in the SDK and no result... cannot implement promise for now\n\t    aws.resendConfirmationCode(vm.credentials.email);\n\t    //We're going to show a success message no matter what\n\t    //TODO: Implement corrected SDK and promise structure for this functino\n\t    vm.setMessage(\"A new confirmation code has been sent to \"+vm.credentials.email+\". Enter the code above to confirm your account\", \"success\");\n    };\n\n*/\n  }\n\n})();"]}