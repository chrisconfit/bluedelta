{"version":3,"sources":["main.js","config/config-overrides-generated.js","services/aws.service.js","services/bdapi.service.js","services/config.service.js","services/data.service.js","services/jean.service.js","services/loader.service.js","services/messages.service.js","services/popups.service.js","services/preloader.factory.js","services/user.js","directives/address-choice/address-choice.controller.js","directives/address-choice/address-choice.directive.js","directives/image-stack/image-stack.controller.js","directives/image-stack/image-stack.directive.js","directives/choosers/chooser.controller.js","directives/choosers/chooser.directive.js","directives/choosers/fabric-chooser.directive.js","directives/choosers/gender-chooser.directive.js","directives/choosers/style-chooser.directive.js","directives/jean-card/jean-card.directive.js","directives/jean-list/jean-list.directive.js","directives/login-form/login-form.controller.js","directives/login-form/login-form.directive.js","directives/navigation/navigation.controller.js","directives/navigation/navigation.directive.js","directives/register-form/register-form.controller.js","directives/register-form/register-form.directive.js","directives/slider/slider.controller.js","directives/slider/slider.directive.js","directives/social-actions/social-actions.controller.js","directives/social-actions/social-actions.directive.js","pages/admin/admin.controller.js","pages/customizer/customizer.controller.js","pages/closet/addForm.controller.js","pages/closet/closet.controller.js","pages/home/home.controller.js","pages/order/order.controller.js","pages/auth/login/login.controller.js","pages/auth/register/register.controller.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","user","isLoggedIn","setup","$on","event","nextRoute","currentRoute","locked","indexOf","path","angular","module","filter","input","replace","min","max","key","initInjector","injector","$http","get","then","result","data","genders","id","name","lookup","value","retKey","dataSet","this","console","log","i","length","constant","body","document","getElementById","bootstrap","element","configOverridesGenerated","REGION","PROFILE_IMAGES_S3_BUCKET","API_ENDPOINT","USER_POOL_ID","CLIENT_ID","IDENTITY_POOL_ID","aws","$window","$q","AWSConfig","_setUserInLocalStorage","userDetails","localStorage","JSON","stringify","email","username","identityId","sub","_clearUserInLocalStorage","clear","_getUserPool","poolData","UserPoolId","ClientId","userPool","AWSCognito","CognitoIdentityServiceProvider","CognitoUserPool","_getAuthenticationDetails","uname","pword","authenticationData","Username","Password","authenticationDetails","AuthenticationDetails","_getCognitoUser","upool","userData","Pool","cognitoUser","CognitoUser","_buildAttribute","keyName","attribute","Name","Value","CognitoUserAttribute","_buildAttributeList","attributeBuilder","obj","attrToAdd","attrList","push","_getAWSCredentials","idToken","logins","authenticator","AWS","update","region","credentials","CognitoIdentityCredentials","IdentityPoolId","Logins","getPromise","getCurrentIdentityId","jwt","getCurrentUserFromLocalStorage","getJwtToken","idTokenPayload","split","parse","atob","getUserFromLocalStorage","getSession","err","session","alert","isValid","deleteCognitoUser","getCurrentUser","deleteUser","authenticateViaFB","defer","FB","login","response","authResponse","graph.facebook.com","accessToken","resolve","reject","promise","authenticateCognitoUser","password","authenticateUser","onSuccess","jwtToken","onFailure","newPasswordRequired","userAttributes","requiredAttributes","signupForApplication","emailAddress","attributeList","signUp","updateAttributesOnUser","updateAttributes","deleteUserAttributes","deleteAttributes","verifyUserAttribute","attributeName","getAttributeVerificationCode","inputVerificationCode","verificationCode","prompt","verifyAttribute","retrieveUserAttributes","getUserAttributes","getName","getValue","resendConfirmationCode","confirmRegistration","confirmationCode","changePassword","oldPassword","newPassword","forgotPassword","userName","setNewPassword","confirmPassword","signUserOut","signOut","signCurrentUserOut","signUserOutGlobally","globalSignOut","callback","confirmRegisteredUnauthenticatedUser","saveImageTos3","imageURL","userTokens","filename","dataURItoBlob","dataURI","binary","array","charCodeAt","Blob","Uint8Array","type","blobData","bucketName","s3bucket","S3","params","Bucket","Key","Body","upload","Location","service","$inject","bdAPI","$httpParamSerializer","$filter","_thirdParty","BlueDeltaApi","API","Client","DefaultApi","jsonData","setupJsonData","jsonDataKeys","d","getJsonData","jeanKeyToDataKey","jeanKey","dataKey","dataLookup","attr","dataById","selected","cleanUser","temp","setupHeaders","defaultHeaders_","identityID","call","func","args","success","error","bdapi","Array","isArray","apply","$$phase","$apply","saveUser","usersUpdate","meanData","authentication","getOptions","headers","Authorization","getToken","getJeanById","j","ret","getJeansByUser","userId","getProfile","getStyles","getThreads","getHardware","getFabrics","getGenders","jean","$routeParams","apiData","api","jeanKeytoURL","loadImage","src","image","Image","crossOrigin","onload","onerror","e","searchAndDraw","cntxt","images","drawImage","dataType","jeanData","set","property","saved","createNew","constructor","Object","gender_option_id","style_option_id","fabric_id","accent_thread_id","top_thread_id","bottom_thread_id","reset","buildJeanData","copy","user_id","prop","hasOwnProperty","action","parseInt","getItem","makeCopy","undefined","keys","createThumb","canvas","createElement","width","height","getContext","promises","all","results","dataUrl","toDataURL","getDataCode","url","urlKey","deleter","jeanId","save","blob","loader","loaderDefaults","message","icon","active","show","hide","messages","popups","pops","closeAll","pop","status","$broadcast","preloaderFunc","Preloader","imageLocations","imageCount","loadCount","errorCount","states","PENDING","LOADING","RESOLVED","REJECTED","state","deferred","preloadImages","preloader","load","prototype","isInitiated","isRejected","isResolved","loadImageLocation","handleImageError","imageLocation","handleImageLoad","notify","percent","Math","ceil","bind","target","factory","Nuser","obKey","setItem","access_token","logout","removeItem","addressChoiceCtrl","$scope","resetForm","close","editAdd","model","findAddressbyKey","primary","addresses","add","editing","addForm","choosePrimary","address","a","startEditing","stopEditing","open","index","dataObj","remove","addressId","splice","new_primary_id","newPrimary","newAdd","abbreviation","addressChoice","restrict","scope","directive","istackCtrl","isvm","centerPan","zoom","pan","x","y","isMobile","innerWidth","toggleZoom","touchEnd","dragTracker","returnPan","querySelectorAll","setTimeout","css","transform-origin","touchStart","swipeStart","touches","clientX","clientY","swipe","zoomDrag","touchMove","preventDefault","touch","drag","clientWidth","clientHeight","bounds","top","bottom","left","right","move","dragPan","u","direction","frame","window","innerHeight","deltaX","deltaY","abs","isFinal","scanImage","querySelector","fWidth","fHeight","rect","getBoundingClientRect","rootDoc","ownerDocument","documentElement","offsetT","pageYOffset","clientTop","offsetL","pageXOffset","clientLeft","xPosition","yPosition","breakPoint","trackMouse","$event","pageX","pageY","imageStack","link","ele","attrs","ctrl","on","chooserCtrl","$element","$timeout","scrollToLeft","el","scrollTo","scrollDuration","offsetWidth","maxLeft","scrollWidth","stepNum","distance","scrollLeft","scrollStep","scrollTest","b","scrollInterval","setInterval","newScroll","clearInterval","chvm","selectorCoords","$watch","newValue","oldValue","dataId","step","dataKey4","elementId","activeElement","selector","chooser","selectAttr","text","opacity","jeanSet","val","dataset","template","changeTemplate","screenWidth","viewUrl","onresize","weightFilter","fabric","weight","genderChooser","styleChooser","checkGenderFilter","gender","style","g","jeanCard","click","slug","templatePath","fields","dataBank","defaultFields","findLabel","field","fieldLabels","dataMap","filterFields","matches","k","loginFormCtrl","validateEmail","re","test","validatePassword","logvm","loginEmail","loginPassword","validateLoginForm","redirect","forgotPassword2","forgot","validateForgot","forgot2","validateForgot2","loginVerifcation","newPasswordConfirm","loginFB","loginForm","navigationCtrl","$route","vm","saver","drops","acct","mobileMenu","navigation","registerFormCtrl","$sce","regvm","first_name","last_name","validateRegistrationForm","passwordConfirm","registerUser","register","registerForm","sliderCtrl","imagesLoaded","slides","currentIndex","setCurrentSlideIndex","isCurrentSlideIndex","nextSlide","prevSlide","slider","imageClick","socialCtrl","sovm","jeanToUrl","location","origin","sharingUrls","socialTitle","socialDescription","facebook","baseString","urlencode","twitter","pinterest","share","social","display","adminCtrl","customizerCtrl","landscapeDetect","ua","navigator","userAgent","toLowerCase","isAndroid","orientation","current","original","updateActiveItem","landscape","supportsOrientationChange","orientationEvent","addEventListener","activeItem","panel","panelStep","panelTemplate","title","panelDir","changeStep","savingBar","newJeanName","authCallback","saveCallback","openSaveOpts","redirectToOrder","saveAndOrder","runSave","saveAndShowOpts","keepEditing","goToCloset","startOver","placeOrder","saveJean","registerCallback","details","addFormCtrl","removeAddress","wasPrimary","closetCtrl","validatePhoneNumber","inputtxt","phoneno","match","findJeanbyId","jeans","orders","userForm","saving","feedback","cancel","editField","validate","passForm","currentPass","newPass","newPassConfirm","validatePasswordForm","passwordData","old_password","copyJean","displayJean","selectJean","jeanProfile","selectOrder","order","orderProfile","displayOrder","orderItems","deleteJean","orderJean","homeCtrl","orderCtrl","getPrimaryAddress","tailors","orderCreateObj","newV","shipping_name","shipping_phone","phone","shipping_address_id","jean_id","orderForm","orderPlaced","chooseOrderType","copyItem","order_type_id","tailor_id","copy_order_item_id","measurementKeys","hasMeasurements","order_items","orderItem","testCols","measurements","nextStep","editData","revertField","loginCtrl","registerCtrl","formStep"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('bdApp', ['ngRoute', 'ngAnimate','ngSanitize', 'ngCookies', 'angular-gestures', 'user', 'api']); \n  \n\n\n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: '/pages/home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm',\n      })\n      .when('/register', {\n        templateUrl: '/pages/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/pages/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/closet', {\n        templateUrl: '/pages/closet/closet.view.html',\n        controller: 'closetCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/order/:jeanId?', {\n        templateUrl: '/pages/order/order.view.html',\n        controller: 'orderCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/customizer/:jeanId?/:action?', {\n        templateUrl: '/pages/customizer/customizer.view.html',\n        controller: 'customizerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/admin', {\n        templateUrl: '/pages/admin/admin.view.html',\n        controller: 'adminCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n    \n  }\n\n  function run($rootScope, $location, user) {\n\t  if (user.isLoggedIn()) user.setup();\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n\n\t    var locked = [\n\t\t    '/closet',\n\t\t    '/order'\n\t    ];\n\t    \n\t    if (locked.indexOf($location.path()) >= 0 && !user.isLoggedIn() ){\n\t\t\t\t$location.path('/login');\n\t  \t}\n\t  \t/* TODO\n\t  \t//If there's no jean on the order screen.... redirect to the customizer page.\n\t  \tif($location.path().indexOf(\"/order\") >= 0 && !Object.keys(jean.data).length){\n\t\t  \t$location.path('/customizer');\n\t\t  };\n\t\t  */\n\t\t  \n    });\n  }\n  \n  \n \n\n\t\n\t\t\t\n\n\tangular.module('bdApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'user', run])\n\t\t.filter('spaceless',function() {\n\t    return function(input) {\n\t      if (input) {\n\t      \treturn input.replace(/\\s+/g, '-');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('scoreToSpace',function() {\n\t    return function(input) {\n\t      if (input) {\n\t\t      var input = input.replace( /([A-Z])/g, \" $1\" );\n\t      \treturn input.replace(/_+/g, ' ');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('minMax',function(min, max, key) {\n\t\t\treturn function(input){\n\t\t\t\tif (min && input[key] < min) return false;\n\t\t\t\tif (max && input[key] > max) return false;\n\t\t    return true;\n\t\t  }  \n\t\t})\n\t\t.filter('displayName',function() {\n\t\t\treturn function(input){\t\t\t\t\n\t\t\t\treturn input ? input.replace(/Raw Denim/g, \"\") : false;\n\t\t  }  \n\t\t})\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\t// Get Angular's $http module.\n\tvar initInjector = angular.injector(['ng']);\n\t\n\tvar $http = initInjector.get('$http');\n\tvar $q = initInjector.get('$q');\n\t\n\t/*\n\tvar awsJsonUrl = \"http://bluedelta-data.s3-website-us-east-1.amazonaws.com/data/\"\n\t\n\tvar jsonDataKeys = ['style', 'thread', 'button', 'fabric', 'gender', 'tailors'];\n\tvar promises = [];\t\t\t\t\n\tfor (d = 0; d < jsonDataKeys.length; d++){\n\t\tpromises.push(\n\t\t\t$http.get(awsJsonUrl+jsonDataKeys[d]+'.json')\n\t\t);\t\n\t}\n\t*/\n\t$http.get(\"http://ec2-54-200-231-145.us-west-2.compute.amazonaws.com/api/data\").then(function(result){\n\t\t\n\t\tresult.data.genders = [\n\t\t\t{\"id\":1, \"name\":\"Male\"},\n\t\t\t{\"id\":2, \"name\":\"Female\"},\n\t\t];\n\t\t\n\t\tresult.data.lookup = function(data, key, value, retKey){\n\t\t\tvar dataSet = this[data];\n\t\t\tconsole.log(\"lookin up !!!\");\n\t\t\tretKey = retKey || false;\n\t\t\tfor (i=0; i<dataSet.length; i++){\t\t\t\t\n\t\t\t\tif(dataSet[i][key] == value)\n\t\t\t\t\treturn retKey ? dataSet[i][retKey] : dataSet[i]\n\t\t\t}\n\t\t}\n\t\tangular.module('bdApp').constant('apiData', result.data);\n\t\tvar body = document.getElementById('bdApp');\n\t\tangular.bootstrap(angular.element(body), ['bdApp']);\t\t\n\t});\n\t/*\n\t$q.all(promises).then(\n\t\tfunction(result){\n\t\t\tvar jsonData = {};\n\t\t\tfor(r=0;r<result.length;r++){\n\t\t\t\tvar key = result[r].config.url.replace(awsJsonUrl,\"\").replace(\".json\",\"\");\n\t\t\t\tjsonData[key] = result[r].data;\n\t\t\t}\n\t\t\tangular.module('bdApp').constant('jsonData', jsonData);\n\t\t\tvar body = document.getElementById('bdApp');\n\t\t\tangular.bootstrap(angular.element(body), ['bdApp']);\t\t\n\t\t}\n\t);\n\t*/\n\n\t\n\n\t\t\n\t\t\n\t\n\t\t\n})();","// Autogenerated file, do not modify directly\n\n(function() {\n\nconst configOverridesGenerated = {\n  \"REGION\": \"us-east-1\",\n  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n};\n\nreturn configOverridesGenerated;\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .service('aws', aws);\n\n  aws.$inject = ['$http', '$window', '$q', 'AWSConfig'];\n  function aws ($http, $window, $q, AWSConfig) {\n\t\t\n\t\tfunction _setUserInLocalStorage(userDetails){\n\t\t\t$window.localStorage.user = JSON.stringify({\n\t\t\t\t\"name\":userDetails.name,\n\t\t\t\t\"email\":userDetails.email,\n\t\t\t\t\"username\":userDetails[\"cognito:username\"],\n\t\t\t\t\"identityId\":userDetails.sub\n\t\t\t});\n\t\t\t$window.localStorage.isLoggedIn = true;\n\t\t}\n\t\t\n\t\tfunction _clearUserInLocalStorage(){\n\t\t\t$window.localStorage.clear();\n\t\t\t$window.localStorage.isLoggedIn = false;\n\t\t}\n\t\t\n    function _getUserPool() {\n      var poolData = { UserPoolId : AWSConfig.USER_POOL_ID, ClientId : AWSConfig.CLIENT_ID };\n      var userPool = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData);\n      return userPool;\n    }\n\n    function _getAuthenticationDetails(uname, pword) {\n      var authenticationData = {\n        Username : uname,\n        Password : pword,\n      };\n      var authenticationDetails = new AWSCognito.CognitoIdentityServiceProvider.AuthenticationDetails(authenticationData);\n      return authenticationDetails;\n    }\n      \n    function _getCognitoUser(uname, upool) {\n      var userData = { Username : uname, Pool : upool };\n      var cognitoUser = new AWSCognito.CognitoIdentityServiceProvider.CognitoUser(userData);\n      return cognitoUser;\n    }\n\n    function _buildAttribute(keyName, value) {\n      var attribute = {\n        Name: keyName,\n        Value: value\n      }\n      var result = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserAttribute(attribute);\n      return result;\n    }\n\n    function _buildAttributeList(attributeBuilder, obj) {\n      var attrList = [];\n      var attrToAdd;\n      for (var key in obj) {\n        attrToAdd = attributeBuilder(key, obj[key]);\n        attrList.push(attrToAdd);\n      }\n      return attrList;\n    }\n      \n\n    \n\t\tfunction _getAWSCredentials(idToken){\n\n\t\t\tlogins = {}\n\t\t\tvar authenticator = 'cognito-idp.'+AWSConfig.REGION+'.amazonaws.com/'+AWSConfig.USER_POOL_ID;\n\t\t\tlogins[authenticator] = idToken;\n\n\t\t\tAWS.config.update({ region: AWSConfig.REGION });\n\n      AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n        IdentityPoolId: AWSConfig.IDENTITY_POOL_ID,\n        Logins : logins\n\t\t\t});\n\n\t\t\treturn AWS.config.credentials.getPromise();\n\n\t    // if (AWS.config.credentials.needsRefresh()){\n\t    //   AWS.config.credentials.clearCachedId();\n\t    //   AWS.config.credentials.get(function(err){\n\t    //     if (err) {\n\t    //       defer.reject(err);\n\t    //     }\n\t    //     defer.resolve();\n\t    //   });\n\t    // } else {\n\t    //   AWS.config.credentials.get(function(err){\n\t    //     if (err) {\n\t    //       defer.reject(err);\n\t    //     }\n\t    //     defer.resolve();\n\t    //   });\n\t    // }\n\t\t\t//\n\t\t\t// return defer.promise;\n\t\t\t\n\t\t}\n\t\t\n\t\tgetCurrentIdentityId = function(jwt){\n\t    if (!jwt){\n\t\t  \tvar userData = getCurrentUserFromLocalStorage();\n\t\t\t\tjwt = userData.idToken.getJwtToken();\n\t    }\n\t    var idTokenPayload = jwt.split('.')[1];\n\t\t\treturn JSON.parse(atob(idTokenPayload)).sub;\t\t\t\t\n    }\n\t\t\t\n    getUserFromLocalStorage = function(username) {\n      var cognitoUser = _getCognitoUser(username, _getUserPool());\n      if (cognitoUser != null) {\n          cognitoUser.getSession(function(err, session) {\n              if (err) {\n                  alert(err);\n                  return;\n              }\n              console.log('session validity: ' + session.isValid());\n          });\n      }\n    }\n\n    deleteCognitoUser = function() {\n      var cognitoUser = _getUserPool().getCurrentUser();\n      cognitoUser.deleteUser(function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\t\t\n\n\t\tauthenticateViaFB = function(){\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\t\n\t\t\tFB.login(function (response) {\n\t\t\t  if (response.authResponse) { // logged in\n\t\t\t    AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n\t\t\t      IdentityPoolId: AWSConfig.IDENTITY_POOL_ID,\n\t\t\t      Logins: {\n\t\t\t        'graph.facebook.com': response.authResponse.accessToken\n\t\t\t      }\n\t\t\t    });\n\t\t\t\n\t\t\t    defer.resolve();\n\t\t\t  } else {\n\t\t\t    defer.reject('There was a problem logging in with Facebook.');\n\t\t\t  }\n\t\t\t});\n\t\t\t\n\t\t\treturn defer.promise;\t\t\n\t\t}\n\t\t\n\t\t\n    authenticateCognitoUser = function(username, password) {\n      var authenticationDetails = _getAuthenticationDetails(username, password);\n      var cognitoUser = _getCognitoUser(username, _getUserPool());\n      \n      var defer = $q.defer();\n      \n      \n      cognitoUser.authenticateUser(authenticationDetails, {\n        onSuccess: function (result) {\n\t        var userDetails = JSON.parse(atob(result.idToken.jwtToken.split('.')[1]));\t\t\n\t\t\t\t\t_setUserInLocalStorage(userDetails);\n\t\t\t\t\tconsole.log(userDetails);\n\t\t\t\t\tdefer.resolve(result);\n        },\n        onFailure: function(err) {\n          defer.reject(err);\n        }, \n        newPasswordRequired: function(userAttributes, requiredAttributes) {\n          // User was signed up by an admin and must provide new\n          // password and required attributes, if any, to complete\n          // authentication.\n\t\t\t\t\tconsole.log(userAttributes, requiredAttributes);\n\n          // the api doesn't accept this field back\n          //delete userAttributes.email_verified;\n\n          // Get these details and call\n\t        // cognitoUser.completeNewPasswordChallenge(\"ConfitConfit@123\", userAttributes, this);\n\t      }\n      });\n      \n      return defer.promise;\n    }\n\t\t\n\n    signupForApplication = function(emailAddress, name, password) {\n\t    console.log(emailAddress, name, password);\n\t    var defer = $q.defer();\n\t    \n      var attributeList = _buildAttributeList(_buildAttribute, {email: emailAddress, name: name});\n      console.log(attributeList);\n      //return false;\n      var cognitoUser;\n      _getUserPool().signUp(emailAddress, password, attributeList, null, function(err, result) {\n        if (err) defer.reject(err);\n        else defer.resolve(result);\n      });\n      \n      return defer.promise;\n    }\n\n    updateAttributesOnUser = function(username, obj) {      \n      var attributeList = _buildAttributeList(_buildAttribute, obj);\n      var cognitoUser   = _getCognitoUser(username, _getUserPool());\n      cognitoUser.updateAttributes(attributeList, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          console.log('call result: ' + result);\n      });\n    }\n\n    deleteUserAttributes = function(cognitoUser, attributeList) {\n      cognitoUser.deleteAttributes(attributeList, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          console.log('call result: ' + result);\n      });\n    }\n\n    verifyUserAttribute = function(cognitoUser, attributeName) {\n        cognitoUser.getAttributeVerificationCode(attributeName, {\n          onSuccess: function (result) {\n              console.log('call result: ' + result);\n          },\n          onFailure: function(err) {\n              alert(err);\n          },\n          inputVerificationCode: function() {\n              var verificationCode = prompt('Please input verification code: ' ,'');\n              cognitoUser.verifyAttribute(attributeName, verificationCode, this);\n          }\n      });\n    }\n\n    retrieveUserAttributes = function(cognitoUser) {\n      cognitoUser.getUserAttributes(function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          for (i = 0; i < result.length; i++) {\n              console.log('attribute ' + result[i].getName() + ' has value ' + result[i].getValue());\n          }\n      });\n    }\n\n    resendConfirmationCode = function(cognitoUser) {\n\t    if(!cognitoUser.resendConfirmationCode){\n\t\t  \t//We've just got an email address...\n\t\t  \tcognitoUser = _getCognitoUser(cognitoUser, _getUserPool());\n\t    }\n\t    \n      cognitoUser.resendConfirmationCode(function(err, result) {\n\t      \n\t      //TODO: This function throws an error on success that obscures a promise. Once the SDK has been fixed, we need to implement a promise structure to properly display results on the front end.\n        if (err) {\n          console.log(err);\n          return;\n        }\n        \n        //code has been sent\n        return true;\n      });\n    }\n    \n   confirmRegistration = function(cognitoUser, confirmationCode) {\n      cognitoUser.confirmRegistration(confirmationCode, true, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          alert(result);\n      });\n    }\n\n    changePassword = function(username, oldPassword, newPassword) {\n\t    var defer = $q.defer();\n\t    var cognitoUser = _getCognitoUser(username, _getUserPool());\n\t\t\tif (cognitoUser != null) {\n\t\t\t\tcognitoUser.getSession(function(err, session) {\n\t\t\t    if (err) {\n\t\t\t\t\t\tdefer.reject(err);\n\t\t\t    }else{\n\t\t\t\t  \tcognitoUser.changePassword(oldPassword, newPassword, function(err, result) {\n\t\t\t        if (err) defer.reject(err);\n\t\t\t        else defer.resolve(result);\n\t\t\t    \t});  \n\t\t\t    }\n\t\t\t\t});\n\t\t\t} else defer.reject(\"You are not logged in.\");\n\t\t\treturn defer.promise;\t\t   \n\t\t}\n\t    \n\t\t\n    forgotPassword = function(userName) {\n\t    var defer = $q.defer();\n\t    var cognitoUser = _getCognitoUser(userName, _getUserPool());\n\t    \n\t    \n\t    cognitoUser.forgotPassword({\n        onSuccess: function (result) {\n\t        console.log(\"forgotPassword success... for some reason the email didn't send...\");\n\t        console.log(result);\n\t\t      defer.reject(result);\n        },\n        onFailure: function(err) {\n          console.log(err);\n          defer.reject(err);\n        },\n        \n        inputVerificationCode: function(data) {\n\t        console.log('Code sent to:'); console.log(data);\n\t\t\t\t\tdefer.resolve(\"email sent\");\n        }\n      });\n      \n      return defer.promise;\n    }\n    \n    setNewPassword = function(userName, verificationCode, newPassword){\n\t\t\tvar cognitoUser = _getCognitoUser(userName, _getUserPool());\n\t\t\tvar defer = $q.defer();\n\t\t\t\n      cognitoUser.confirmPassword(verificationCode, newPassword, {\n\t      onSuccess: function (result) {\n\t\t      defer.resolve();\n        },\n        onFailure: function(err) {\n          console.log(err);\n          defer.reject(err);\n        },\n      });\n      return defer.promise;\n    }\n\n    deleteUser = function(cognitoUser) {\n      cognitoUser.deleteUser(function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\n    signUserOut = function(cognitoUser) {\n      if (cognitoUser != null) {\n\t      \t_clearUserInLocalStorage();\n          cognitoUser.signOut();\n      }\n    }\n    \n    signCurrentUserOut = function() {\n\t  \tvar cognitoUser = _getUserPool().getCurrentUser();\n      if (cognitoUser != null) {\n        cognitoUser.signOut();\n\t\t\t\t_clearUserInLocalStorage();\n      }\n    }\n\n\n    signUserOutGlobally = function(cognitoUser) {\n\t    _clearUserInLocalStorage();\n      cognitoUser.globalSignOut();\n    }\n\t\t\n\t\t\n\n    getCurrentUserFromLocalStorage = function(callback) {\n      var cognitoUser = _getUserPool().getCurrentUser();\n      if (cognitoUser != null) {\n      \treturn cognitoUser.getSession(function(err, session) {\n          if (err) {\n\t          console.log(err);\n\t          return false;\n          }\n          if (callback) callback(session);\n          return session;\n        });\n      }else{\n\t      console.log(\"You are not logged in\");\n\t      return false;\n      }\n    }\n   \n\t\t\n\t\tisLoggedIn = function() {\n\t\t\treturn $window.localStorage.isLoggedIn==\"true\";\t\t\n\t\t}\n\t\t\n\t\n    confirmRegisteredUnauthenticatedUser = function(userName, confirmationCode) {\n\t    \n      var cognitoUser = _getCognitoUser(userName, _getUserPool());\n\t    var defer = $q.defer();\n      \n      cognitoUser.confirmRegistration(confirmationCode, true, function(err, result) {\n        if (err) defer.reject(err);\n        else defer.resolve(result);\n      });\n      \n      return defer.promise;\n    }\n    \n\t\t\n    \n    \n    \n    \n    //Save an image to s3 Bucket\n    saveImageTos3 = function (imageURL, userTokens, filename){\n\t\t\t\n\t\tfunction dataURItoBlob(dataURI) {\n\t\t\tvar binary = atob(dataURI.split(',')[1]);\n\t\t\tvar array = [];\n\t\t\tfor(var i = 0; i < binary.length; i++) {\n\t\t\t  array.push(binary.charCodeAt(i));\n\t\t\t}\n\t\t\treturn new Blob([new Uint8Array(array)], {type: 'image/jpeg'});\n\t\t}\n\t\t\t\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\t\n\n\t\t\t_getAWSCredentials(userTokens.idToken.jwtToken).then(\n\n\t\t\t\t//Got credentials.. now save image\n\t\t\t\tfunction(){\n\t\t\t\t\tvar blobData = dataURItoBlob(imageURL);\n\t\t\t\t\tvar bucketName = 'blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy';\n\t\t\t\t\tvar s3bucket = new AWS.S3({region: AWSConfig.REGION, params: {Bucket: bucketName}});\n\t\t\t\t\tvar params = {Key: AWS.config.credentials.identityId + \"/\" + filename, Body: blobData};\n\n\t\t\t\t\ts3bucket.upload(params, function(err, data){\t      \n\t\t\t\t\t\tif (err) defer.reject(err);\n\t\t\t\t\t\telse  defer.resolve(data.Location);\t\t\t\t\t\t\n    \t\t\t});\n    \t\t\t\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t//Can't get AWS Credentials\n\t\t\t\tfunction(err){\n\t\t\t\t\tdefer.reject(err);\n\t\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t\treturn defer.promise;\n\n    }\n \n     \n      \n    \n    return {\n\t    getCurrentIdentityId:getCurrentIdentityId,\n\t    authenticateViaFB: authenticateViaFB,\n\t    getUserFromLocalStorage: getUserFromLocalStorage,\n      deleteCognitoUser: deleteCognitoUser,\n      authenticateCognitoUser: authenticateCognitoUser,\n      signupForApplication: signupForApplication,\n      updateAttributesOnUser: updateAttributesOnUser,\n      deleteUserAttributes: deleteUserAttributes,\n      verifyUserAttribute: verifyUserAttribute,\n      retrieveUserAttributes: retrieveUserAttributes,\n      resendConfirmationCode: resendConfirmationCode,\n      confirmRegistration: confirmRegistration,\n      changePassword: changePassword,\n      forgotPassword: forgotPassword,\n      setNewPassword: setNewPassword,\n      deleteUser: deleteUser,\n      signUserOut: signUserOut,\n      signUserOutGlobally: signUserOutGlobally,\n      getCurrentUserFromLocalStorage: getCurrentUserFromLocalStorage,\n      confirmRegisteredUnauthenticatedUser: confirmRegisteredUnauthenticatedUser,\n      signCurrentUserOut:signCurrentUserOut,\n      saveImageTos3 : saveImageTos3,\n      isLoggedIn:isLoggedIn\n    };\n  }\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('bdAPI', bdAPI);\n\n  bdAPI.$inject = ['$window', '$rootScope', '$http', '$httpParamSerializer', '$filter','$q', 'aws'];\n  function bdAPI ($window, $rootScope, $http, $httpParamSerializer, $filter, $q, aws) {\n\n\t  $window._thirdParty = $window._thirdParty || {};\n\t  $window._thirdParty.BlueDeltaApi =new API.Client.DefaultApi(angular.injector([\"ng\"]).get(\"$http\"),\n    angular.injector([\"ng\"]).get(\"$httpParamSerializer\"),\n    angular.injector([\"ng\"]));\n\n    var BlueDeltaApi = $window._thirdParty.BlueDeltaApi;\n\t\t\n\t\t//JSON Data\n\t\tBlueDeltaApi.jsonData = {};\n\t\tsetupJsonData = function(key){\n\t\t\t$http.get('http://bluedelta-data.s3-website-us-east-1.amazonaws.com/data/'+key+'.json').then(function(response){\n\t\t\t\tBlueDeltaApi.jsonData[key] = response.data;\n\t\t\t});\n\t\t}\n\t\t\n\t\tjsonDataKeys = [\n\t\t\t'style',\n\t\t\t'thread',\n\t\t\t'button',\n\t\t\t'fabric',\n\t\t\t'gender',\n\t\t\t'tailors'\n\t\t];\n\t\t\n\t\tfor (d = 0; d < jsonDataKeys.length; d++) { \n\t\t\tsetupJsonData(jsonDataKeys[d]);\n\t\t}\n\t\t\n\t\tBlueDeltaApi.getJsonData = function(){\n\t\t\treturn this.jsonData;\n\t\t}\n\t\tvar styleByGender = function(gender){\n\t\t\treturn function(style){\n\t\t\t\treturn style[\"images_\"+gender];\n\t\t  }\n\t\t};\n\t\t\n\t\tBlueDeltaApi.jeanKeyToDataKey = function(jeanKey){\n\t\t\tvar dataKey = false;\n\t\t\t\n\t\t\tswitch(true){\n\t\t\t\tcase jeanKey.indexOf('thread') > -1:\n\t\t\t\tdataKey = \"threads\";\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase (jeanKey == \"gender\" || jeanKey == \"style\" ||  jeanKey == \"fabric\"):\n\t\t\t\tdataKey = jeanKey+\"s\";\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\treturn  dataKey;\n\t\t}\n\t\t\t\n\t\t\t\t\n\t\tBlueDeltaApi.dataLookup = function(dataKey, id, attr){\n\t\t\t\n\t\t\tattr = attr||null;\n\t\n\t\t\tif (typeof dataKey == 'undefined' || typeof id == 'undefined') return false;\n\t\t\tvar dataSet = BlueDeltaApi.jsonData[dataKey];\n\t\t\tdataById = \t$filter('filter')(dataSet, {id: id});\n\t\t\tif (typeof dataById == 'undefined') return false; //Return false when dataSet is undefined...\n\t\t\t\n\t\t\tselected = dataById[0];\n\t\t\t\n\t\t\tif (!attr) return selected;\n\t\t\telse return selected[attr];\t\n\t\t\t\n\t\t}\n\n\t\tvar cleanUser = function(user){\n\t\t\tvar temp = JSON.stringify(user);\n\t\t\ttemp = temp.replace(/\\\"\\\"/g, null);\n\t\t\tuser = JSON.parse(temp);\n\t\t\treturn user;\n\t\t}\n\t\t\t\t\n\t\tBlueDeltaApi.setupHeaders = function(){\n\t\t\tvar userData = aws.getCurrentUserFromLocalStorage();\n\t\t\tthis.defaultHeaders_['Authorization'] = userData.idToken.getJwtToken();\n\t\t\tvar idTokenPayload = userData.idToken.jwtToken.split('.')[1];\n\t\t\tvar identityID = JSON.parse(atob(idTokenPayload)).sub;\t\n\t\t\treturn identityID;\n\t\t}\n\t\t\n\t\tBlueDeltaApi.call = function(func,args,success,error){\n\t\t\tconsole.log(\"running \"+func);\n\t\t\tvar bdapi = this;\n\t    aws.getCurrentUserFromLocalStorage(function(session){\n\n\t\t    //Reset auth header\n\t\t\t\tbdapi.defaultHeaders_['Authorization'] = session.idToken.getJwtToken();\n\t\t\t\t\n\t\t\t\t//put args into array form\n\t\t\t\tif (!Array.isArray(args)) args = [args];\n\t\t\t\t\n\t\t\t\t//Run the API call\n\t\t\t\tbdapi[func].apply(bdapi, args).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tsuccess(result);\n\t\t\t\t\t\t$rootScope.$$phase || $rootScope.$apply();\n\t\t\t\t\t}, \n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tif (error) error(err);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\t\n\t    });\n\t\t}\n\n\t\t//Save User\n\t\tBlueDeltaApi.saveUser = function(user){\n\t\t\tvar defer = $q.defer();\n\t\t\tuser = cleanUser(user);\n\t\t\tif (!user.identityId) defer.reject(\"No identity Id\");\n\t\t\telse{\n\t\t\t\tBlueDeltaApi.usersUpdate(user.identityId, user).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tconsole.log(\"got it\");\n\t\t\t\t\t\tdefer.resolve(result);\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tconsole.log(\"Error saving user:\");\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tdefer.reject(err);\n\t\t\t\t\t}\t\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn defer.promise;\t\n\t\t}\n\n\t  return BlueDeltaApi;\n  }\n\n})();","// Autogenerated file, do not modify directly\n(function () {\n  angular \n    .module('bdApp')\n    .service('AWSConfig', AWSConfig);\n      \n  function AWSConfig () {\n\t\treturn{\n\t\t\t\"REGION\": \"us-east-1\",\n\t\t  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n\t\t  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n\t\t  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n\t\t  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n\t\t  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n\t\t}\n  }\n\n\n})();","(function() {\n\n  angular\n    .module('bdApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\t\t\n\t\t/*\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n    */\n    var getOptions = function () {\t    \n      return $http.get('/api/options', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\t\t\n\t\t\n\t\t\n\t\t\n\t\tvar getJeanById = function(id, callback){\n\t\t\t$http.get('/data/chris-jeans.json').then(function(response){\n\t\t\t\tvar jeans = response.data;\n\t\t\t\tfor(j=0; j<response.data.length; j++){\n\n\t\t\t\t\tif (response.data[j].id == id){\n\t\t\t\t\t\tconsole.log('jean found');\n\t\t\t\t\t\tvar ret = response.data[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcallback(ret);\n\n\t\t\t});\n\t\t}\n\t\t\n\t\t//Placeholders\n\t\tvar getJeansByUser = function(userId){\n\t\t\treturn $http.get('/data/chris-jeans.json');\n\t\t};\t\t\n\t\tvar getProfile = function(){\n\t\t\treturn $http.get('/data/profile.json');\n\t\t};\n\t\t\n\t\tvar getStyles = function(){\n\t\t\treturn $http.get('/data/styles.json');\n\t\t};\n\t\t\n\t\tvar getThreads = function(){\n\t\t\treturn $http.get('/data/threads.json');\n\t\t};\n\t\t\n\t\tvar getHardware = function(){\n\t\t\treturn $http.get('/data/buttons.json');\n\t\t};\n\t\t\n\t\tvar getFabrics = function(){\n\t\t\treturn $http.get('/data/fabrics.json');\n\t\t};\n\t\t\n\t\t\n\t\tvar getGenders = function(){\n\t\t\treturn $http.get('/data/genders.json');\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\t\n    return {\n\t    getJeanById: getJeanById,\n\t    getJeansByUser : getJeansByUser,\n      getProfile : getProfile,\n      getOptions : getOptions,\n      getStyles : getStyles,\n      getThreads : getThreads,\n      getHardware: getHardware,\n      getFabrics: getFabrics,\n      getGenders: getGenders\n    };\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('jean', ['$routeParams', '$window', 'bdAPI', '$q', 'aws', 'apiData', 'api', jean]);\n\n  function jean($routeParams, $window, bdAPI, $q, aws, apiData, api) {\n\n\n\t\t/*\n\t\t*   JSON Data lookup\n\t\t*/\n\t\t\n\t\tvar dataLookup = function(dataType, key){\n\n\t\t\tvar data = apiData[dataType];\n\t\t\tif (!data) return false;\n\t\t\t\n\t\t\tfor (i=0; i<data.length; i++) {\n\t\t\t\t//\tconsole.log(data[i][dataType+\"Id\"], key);\n\t\t\t\tif (data[i][dataType+\"Id\"] == key) \t\t\t\t\n\t\t\t\treturn data[i];\n  \t\t}\n\t\t}\n\t\t\n\n\t\t\n\t\t/*\n\t\t*.  Jean Data\n\t\t*/\n\t\t\n  \tvar jeanData = {};\n  \t\n\t\tset = function(property, value){\n\t\t\tjeanData[property] = value;\n\t\t\tthis.saved=false;\n\t\t};\n\t\t\n\t\tcreateNew = function(jean){\n\t\t\tif (!jean || jean.constructor != Object){\n\t\t\t\tjeanData = {\n\t\t\t\t\t\"gender_option_id\" : 1,\n\t\t\t\t\t\"style_option_id\" : 1,\n\t\t\t\t\t\"fabric_id\" : 1004,\n\t\t\t\t\t\"accent_thread_id\" :1,\n\t\t\t\t\t\"top_thread_id\" : 1,\n\t\t\t\t\t\"bottom_thread_id\" : 1\n\t\t\t\t}\n\t\t\t\tjeanData.saved = false;\n\t\t\t}else{\n\t\t\t\tjeanData = {\n\t\t\t\t\t\"gender_option_id\" : jean.gender_option_id,\n\t\t\t\t\t\"style_option_id\" : jean.style_option_id,\n\t\t\t\t\t\"fabric_id\" : jean.fabric_id,\n\t\t\t\t\t\"accent_thread_id\" : jean.accent_thread_id,\n\t\t\t\t\t\"top_thread_id\" : jean.top_thread_id,\n\t\t\t\t\t\"bottom_thread_id\" : jean.bottom_thread_id\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t\t\t\n\t\tfunction parseURLkey(key){\n\t\t\tswitch(key){\n\t\t\t\tcase \"g\":\n\t      return \"gender_option_id\";\n\t      break;\n\t      \n\t      case \"s\":\n\t      return \"style_option_id\";\n\t      break;\n\t      \n\t      case \"f\":\n\t      return \"fabric_id\";\n\t      break;\n\t      \n\t      case \"tt\":\n\t      return \"top_thread_id\";\n\t      break;\n\t      \n\t      case \"tb\":\n\t      return \"bottom_thread_id\";\n\t      break;\n\t      \n\t      case \"ta\":\n\t      return \"accent_thread_id\";\n\t      \n\t      default: return false;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tfunction jeanKeytoURL(key){\n\t\t\tswitch(key){\n\t\t\t\tcase \"gender_option_id\":\n\t      return \"g\";\n\t      break;\n\t      \n\t      case \"style_option_id\":\n\t      return \"s\";\n\t      break;\n\t      \n\t      case \"fabric_id\":\n\t      return \"f\";\n\t      break;\n\t      \n\t      case \"top_thread_id\":\n\t      return \"tt\";\n\t      break;\n\t      \n\t      case \"bottom_thread_id\":\n\t      return \"tb\";\n\t      break;\n\t      \n\t      case \"accent_thread_id\":\n\t      return \"ta\";\n\t      \n\t      default: return false;\n\t\t\t}\n\t\t}\n\t\t\n\t\treset = function(){\n\t\t\tcreateNew();\n\t\t}\n\t\t\n\t\tbuildJeanData = function(data, copy){\n\n\t\t\t//Make a copy\n\t\t\tif(copy==true){\n\t\t\t\tdelete data.user_id;\n\t\t\t\tdelete data.id;\n\t\t\t\tdata.name = \"Copy of \"+data.name;\n\t\t\t}\n\t\t\tfor(prop in data){\n\t\t\t\tif(data.hasOwnProperty(prop)){\n\t\t\t\t\tset(prop, data[prop]);\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//Set up jean data from parameter\n\t\tvar setup = function(data, action){\n\t\t\tvar defer = $q.defer();\n\t\t\t\n\t\t\t//Get our user Id and detrmine whether or not we want to make a copy\t\t\n\t\t\tvar userId = parseInt($window.localStorage.getItem(\"bdUserId\"));\n\t\t\tvar makeCopy = userId ? false : true;\n\t\t\tmakeCopy = action == \"copy\" ? true : makeCopy;\n\t\t\t\n\t\t\t\n\t\t\t//Set up jean from object data\n\t\t\tif (data !== null && typeof data === 'object'){ \n\t\t\t\t\n\t\t\t\tconsole.log(\"working from object data!\");\n\t\t\t\t\n\t\t\t\tif (data.user_id && data.user_id !== userId) delete data.id;\n\t\t\t\tbuildJeanData(data, makeCopy);\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\n\n\t\t\t//Copy or Edit Jean from Id\n\t\t\telse if (data !== null && data !== undefined){\n\t\t\t\t\n\t\t\t\tconsole.log(data, userId, action, makeCopy);\n\t\t\t\tconsole.log(\"working from ID!\");\n\t\t\t\t\n\t\t\t\t//First get Jean\n\t\t\t\tapi.call('getJean', data, function(result){\n\t\t\t\t\t\n\t\t\t\t\tif (result.user_id !== userId) makeCopy = true;\n\n\t\t\t\t\tbuildJeanData(result, makeCopy);\n\t\t\t\t\tconsole.log(jeanData);\n\t\t\t\t\tdefer.resolve(jeanData);\n\t\t\t\t}, function(err){\n\t\t\t\t\t\tdefer.reject(err)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//Jean Data already exists\n\t\t\telse if (Object.keys(jeanData).length > 0){\n\t\t\t\n\t\t\t\tconsole.log(\"jean data already exists!\");\n\t\t\t\t\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t\n\t\t\telse{\n\t\t\t\n\t\t\t\tconsole.log(\"creating new jean!\");\n\t\t\t\t\n\t\t\t\tcreateNew();\t\t\t\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t\n\t\t\t//Data URL\n\t\t\t/*\n\t\t\telse if ($routeParams.jeanId && !$routeParams.userId){\n\t\t\t\tcreateNew();\n\t\t\t\tif ($routeParams.jeanId.indexOf(\":\")>0){\n\t\t\t\t\tjeanData = $routeParams.jeanId.split(\":\");\n\t\t\t\t\tfor(var d=0; d<jeanData.length; d++){\n\t\t\t\t\t\tvar parts= jeanData[d].match(/([A-Za-z]+)([0-9]+)/);\n\t\t\t\t\t\tif (!parts) continue;\n\t\t\t\t\t\tvar jeanKey = parseURLkey(parts[1]);\n\t\t\t\t\t\tif (jeanKey) jeanData[jeanKey] = parseInt(parts[2]);\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdefer.resolve(jeanData);\n\t\t\t}\n\t\t\t*/\n\t\t\t\n\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t/*bdAPI.jeansGet($routeParams.userId, $routeParams.jeanId).then(\t\t\t\t\t\n\t\t\t\t\tfunction(result){\n\n\t\t\t\t\t\tvar newJean = result.data;\n\n\t\t\t\t\t\tvar userData = aws.getCurrentUserFromLocalStorage();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(userData){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar identityId = bdAPI.setupHeaders(userData);\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//Edit Jean\n\t\t\t\t\t\t\tif (identityId == $routeParams.userId){\n\t\t\t\t\t\t\t\tfor(prop in newJean){\n\t\t\t\t\t\t\t\t\tif(newJean.hasOwnProperty(prop)){\n\t\t\t\t\t\t\t\t\t\tset(prop, newJean[prop]);\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//Copy Jean\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tcreateNew(newJean);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Not logged in.. create new.\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcreateNew(newJean);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefer.resolve(jeanData);\n\t\t\t\t\t}, \n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\t//Jean or user not found.. just create a blank jean...\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tcreateNew();\n\t\t\t\t\t\tdefer.resolve(jeanData);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\t*/\n\t\t\n\t\t\t\t\t\n\t\t\t\n\n\t\t\t\n\t\t\treturn defer.promise;\n\t\t}\n\t\t\n\t\t\n\t\tvar get=function(){\n\t\t\treturn jeanData;\n\t\t}\n\t\t\n\t\t\n\t\tfunction loadImage(src) {\n\t\t\treturn $q(function(resolve,reject) {\n\t\t\t  var image = new Image();\n\t\t\t  image.crossOrigin = \"\";\n\t\t\t  image.src = src;\n\t\t\t  image.onload = function() {\n\t\t\t    resolve(image);\n\t\t\t  };\n\t\t\t  image.onerror = function(e) {\n\t\t\t    reject(e);\n\t\t\t  };\n\t\t\t})\n\t\t}   \n    \n\t function searchAndDraw(key, cntxt, images){\n\t\t\tfor(i=0; i<images.length; i++){\n\t\t\t\tvar image = images[i];\n\t\t\t\tif(image.src.indexOf(\"/\"+key+\"/\") > -1){\n\t\t\t\t\tcntxt.drawImage(image,0,0,600,696);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\t\n\t  var createThumb = function(jeanData){\n\t  \tvar canvas = document.createElement('canvas');\n\t  \tcanvas.width=600;\n\t  \tcanvas.height=600;\n\t  \tvar cntxt = canvas.getContext('2d');\t\n\t  \tvar promises = [];\n\t\t\tvar images = [\n\t\t\t\t'http://bluedelta-data.s3-website-us-east-1.amazonaws.com/images/components/fabrics/g'+jeanData.gender_option_id+'/s2/f'+jeanData.fabric_id+'.jpg',\n\t\t\t\t'http://bluedelta-data.s3-website-us-east-1.amazonaws.com/images/components/threads/g'+jeanData.gender_option_id+'/s2/tb/'+jeanData.bottom_thread_id+'.png',\n\t\t\t\t'http://bluedelta-data.s3-website-us-east-1.amazonaws.com/images/components/threads/g'+jeanData.gender_option_id+'/s2/tt/'+jeanData.top_thread_id+'.png',\n\t\t\t\t'http://bluedelta-data.s3-website-us-east-1.amazonaws.com/images/components/threads/g'+jeanData.gender_option_id+'/s2/ta/'+jeanData.accent_thread_id+'.png'\n\t\t\t];\n\t\n\t    for(var i=0; i<images.length; i++){\n\t      promises.push(loadImage(images[i], cntxt));\n\t    }\n\t    \n\t    return $q.all(promises).then(\n\t    \tfunction(results) {\n\t\t\t\t\tsearchAndDraw(\"fabrics\", cntxt, results);\n\t\t\t\t\tsearchAndDraw(\"tb\", cntxt, results);\n\t\t\t\t\tsearchAndDraw(\"tt\", cntxt, results);\n\t\t\t\t\tsearchAndDraw(\"ta\", cntxt, results);\n\t\t      var dataUrl = canvas.toDataURL('image/jpeg');\n\t\t\t\t\treturn dataUrl;\n\t\t    },    \n\t\t    function(err){\n\t\t\t    console.log(err);\n\t\t    }\n\t    );\t\n\t\t}\n\t\t\n\t\t\n\t\tgetDataCode = function(){\n\t\t\tvar url = \"\";\n\t\t\tconsole.log(\"get data code!!!\");\n\t\t\tconsole.log(jeanData);\n\t\t\t\n\t\t\tfor (var property in jeanData) {\n\t\t\t  if (jeanData.hasOwnProperty(property)) {\n\t\t\t\t\tvar id = jeanData[property];\n\t\t\t\t\tvar urlKey = jeanKeytoURL(property);\n\t\t\t\t\tconsole.log(property, urlKey, id);\n\t\t\t\t\tif (urlKey) url += \"_\"+urlKey+id;\n\t\t\t  }\n\t\t\t}\t\n\t\t\turl = url.replace(/(^[_\\s]+)|([_\\s]+$)/g, '');\n\t\t\tconsole.log(url);\n\t\t\treturn url;\n\t\t}\n\t\t\n\t\tvar deleter = function (jeanId, callback){\n\t\t\tapi.call('deleteMyJean', jeanId, function(result){\n\t\t\t\tif (callback) callback(result);\n\t\t\t});\n\t\t};\n\t\t\n\t\tvar save = function(){\n\t\t\t\n\t\t\tconsole.log(\"saving jean...\");\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\tvar jean = this;\n\t\t\tvar jeanData = jean.get();\n\t\t\tvar filename = jean.getDataCode();\n\t\t\tfilename += \".jpg\";\n\t\t\tjeanData.image = {filename:filename};\n\t\t\tthis.createThumb(jeanData).then(function(blob){\n\t\t\t\tjeanData.image.data = blob;\n\t\t\t\tapi.call('createMyJeans', jeanData, function(result){\n\t\t\t\t\tconsole.log(\"We have created the jean\");\n\t\t\t\t\tconsole.log(result);\n\t\t\t\t\tdefer.resolve(result);\n\t\t\t\t}, function(err){\n\t\t\t\t\tdefer.reject(err);\n\t\t\t\t});//api.call();\n\t\t\t\t\n\t\t\t}, function(err){\n\t\t\t\tdefer.reject(err);\n\t\t\t}); //createThumb();\n\t\t\t\n\t\t\treturn defer.promise;\n\t\t\t/*\n\n\t\t\t\n\t\t\t\n\t\t\t\t\n\t\t    var userData = aws.getCurrentUserFromLocalStorage();\n\t\t\t\tif (userData){\t\t\n\t\t\t\t\taws.saveImageTos3(imageURL, userData, filename).then(\n\t\t\t\t\t\tfunction(result){\t\n\n\t\t\t\t\t\t\t//Add image to jean before saving...\n\t\t\t\t  \t\tjean.set(\"imageURL\",result);\n\t\t\t\t\t\t\tvar\tuserId = aws.getCurrentIdentityId();\n\t\t\t\t\t\t\tvar args = jeanData.jeanId ? [userId, jeanData.jeanId, jeanData] : [userId, jeanData];\n\t\t\t\t\t\t\tvar saveFunc = jeanData.jeanId ? 'jeansUpdate' : 'jeansCreate';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tbdAPI.call(saveFunc, args, function(result){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//For new jeans... set the Id..\n\t\t\t\t\t\t\t\tvar newJean = result.data.jeans[result.data.jeans.length-1];\n\t\t\t\t\t\t\t\tif (!jeanData.jeanId) jean.set(\"jeanId\", newJean.jeanId);\n\t\t\t\t\t\t\t\tdefer.resolve(result);\n\t\t\t\t\t\t\t}, function(err){defer.reject(err);});\n\n\t\t\t\t\t\t\t\n\t\t\t\t  \t}, function(err){\n\t\t\t\t\t  \tconsole.log(err);\n\t\t\t\t\t  \tdefer.reject(err.message);\n\t\t\t\t\t  }\n\t\t\t\t\t);\n\t\t\t\t}else{\n\t\t\t\t\tdefer.reject(\"You are not logged in...\");\n\t\t\t\t}\n\t\t\t\t\n\t    });\n\t\t\t*/\n\n\t\t}\n\t\t\n\t\t\t\n\t\treturn {\n\t    dataLookup: dataLookup,\n\t    deleter : deleter,\n\t    save : save,\n\t    get : get,\n\t    set: set,\n\t    setup : setup,\n\t    reset : reset,\n      set : set,\n      createNew :createNew,\n      getDataCode: getDataCode,\n      createThumb: createThumb\n     }\n\t\t\t\n\t\t\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('loader', ['$rootScope', loader]);\n\n  function loader() {\n\t\t\n\t\tvar loader = {}\n    \n    var loaderDefaults = {\n\t    \"message\":\"\",\n\t    \"type\":\"loading\",\n\t    \"icon\":\"fa-circle-o-notch fa-spin\",\n\t    \"active\":false\n    };\n    \n  \n\t        \n\t\tvar closeAll = function(){\n\t\t\tfor (var pop in pops) {\n\t\t\t  if (pops.hasOwnProperty(pop)) {\n\t\t\t    pops[pop]=false;\n\t\t\t  }\n\t\t\t}\n\t\t}\n    \n    var  show = function(message, type, icon){\n\t    loader.active = true;\n\t    loader.message=message || loaderDefaults.message;\n\t    loader.type = type || loaderDefaults.type;\n\t    loader.icon = icon || loaderDefaults.icon;\n    }\n    \n    var hide = function(){\n\t    loader.active=false;\n    }\n    \n    var get = function(){\n\t    return loader;\n    }\n    \n    return {\n\t    get:get,\n\t    show:show,\n\t    hide:hide\n    }\n  }\n\n})();","(function() {\n\n  angular\n    .module('bdApp')\n    .service('messages', messages);\n\n\t//meanData.$inject = [];\n  function messages() {\n\t\n\t\tvar data = {\n\t\t\tmessage : \"\",\n\t\t\ttype: \"\"\n\t\t};\n\t\t\n\t\tvar set = function(message, type){\n\t\t\tdata.message = message;\n\t\t\tdata.type = type;\n\t\t}\n\t\t\t\n\t\tvar reset = function(){\n\t\t\tdata.message = \"\";\n\t\t\tdata.type = \"\";\t\n\t\t}\n\t\t\n\t\tvar get = function(){\n\t\t\treturn data;\n\t\t}\n\t\t\n    return {\n\t    get:get,\n\t    set:set,\n\t    reset:reset\n    };\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('popups', ['$rootScope', popups]);\n\n  function popups($rootScope) {\n\t\t\n    var pops = {};\n        \n\t\tvar closeAll = function(){\n\t\t\tfor (var pop in pops) {\n\t\t\t  if (pops.hasOwnProperty(pop)) {\n\t\t\t    pops[pop]=false;\n\t\t\t  }\n\t\t\t}\n\t\t}\n    \n    var set = function(pop, status){\n\t    if (!pops[pop]){\n\t\t    pops[pop] = true;\n\t\t    $rootScope.$broadcast('popupChange');\n\t    }\n\t    else{\n\t\t  \tvar status = status || pops[pop];\n\t\t\t\tpops[pop] = status;\n\t\t\t}\n    }\n    \n    var get = function(){\n\t    return pops;\n    }\n    \n    return {\n\t    get:get,\n\t    set:set,\n\t    closeAll:closeAll\n    }\n  }\n\n})();","angular.module('bdApp')\n.factory('preloader', preloaderFunc);\n\npreloaderFunc.$inject = ['$q', '$rootScope'];\nfunction preloaderFunc( $q, $rootScope ) {\n  // I manage the preloading of image objects. Accepts an array of image URLs.\n  function Preloader( imageLocations ) {\n      // I am the image SRC values to preload.\n      this.imageLocations = imageLocations;\n      // As the images load, we'll need to keep track of the load/error\n      // counts when announing the progress on the loading.\n      this.imageCount = this.imageLocations.length;\n      this.loadCount = 0;\n      this.errorCount = 0;\n      // I am the possible states that the preloader can be in.\n      this.states = {\n          PENDING: 1,\n          LOADING: 2,\n          RESOLVED: 3,\n          REJECTED: 4\n      };\n      // I keep track of the current state of the preloader.\n      this.state = this.states.PENDING;\n      // When loading the images, a promise will be returned to indicate\n      // when the loading has completed (and / or progressed).\n      this.deferred = $q.defer();\n      this.promise = this.deferred.promise;\n  }\n  // ---\n  // STATIC METHODS.\n  // ---\n  // I reload the given images [Array] and return a promise. The promise\n  // will be resolved with the array of image locations.\n  Preloader.preloadImages = function( imageLocations ) {\n      var preloader = new Preloader( imageLocations );\n      return( preloader.load() );\n  };\n  // ---\n  // INSTANCE METHODS.\n  // ---\n  Preloader.prototype = {\n      // Best practice for \"instnceof\" operator.\n      constructor: Preloader,\n      // ---\n      // PUBLIC METHODS.\n      // ---\n      // I determine if the preloader has started loading images yet.\n      isInitiated: function isInitiated() {\n          return( this.state !== this.states.PENDING );\n      },\n      // I determine if the preloader has failed to load all of the images.\n      isRejected: function isRejected() {\n          return( this.state === this.states.REJECTED );\n      },\n      // I determine if the preloader has successfully loaded all of the images.\n      isResolved: function isResolved() {\n          return( this.state === this.states.RESOLVED );\n      },\n      // I initiate the preload of the images. Returns a promise.\n      load: function load() {\n          // If the images are already loading, return the existing promise.\n          if ( this.isInitiated() ) {\n              return( this.promise );\n          }\n          this.state = this.states.LOADING;\n          for ( var i = 0 ; i < this.imageCount ; i++ ) {\n              this.loadImageLocation( this.imageLocations[ i ] );\n          }\n          // Return the deferred promise for the load event.\n          return( this.promise );\n      },\n      // ---\n      // PRIVATE METHODS.\n      // ---\n      // I handle the load-failure of the given image location.\n      handleImageError: function handleImageError( imageLocation ) {\n          this.errorCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          this.state = this.states.REJECTED;\n          this.deferred.reject( imageLocation );\n      },\n      // I handle the load-success of the given image location.\n      handleImageLoad: function handleImageLoad( imageLocation ) {\n          this.loadCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          // Notify the progress of the overall deferred. This is different\n          // than Resolving the deferred - you can call notify many times\n          // before the ultimate resolution (or rejection) of the deferred.\n          this.deferred.notify({\n              percent: Math.ceil( this.loadCount / this.imageCount * 100 ),\n              imageLocation: imageLocation\n          });\n          // If all of the images have loaded, we can resolve the deferred\n          // value that we returned to the calling context.\n          if ( this.loadCount === this.imageCount ) {\n              this.state = this.states.RESOLVED;\n              this.deferred.resolve( this.imageLocations );\n          }\n      },\n      // I load the given image location and then wire the load / error\n      // events back into the preloader instance.\n      // --\n      // NOTE: The load/error events trigger a $digest.\n      loadImageLocation: function loadImageLocation( imageLocation ) {\n          var preloader = this;\n          // When it comes to creating the image object, it is critical that\n          // we bind the event handlers BEFORE we actually set the image\n          // source. Failure to do so will prevent the events from proper\n          // triggering in some browsers.\n          // --\n          // The below removes a dependency on jQuery, based on a comment\n          // on Ben Nadel's original blog by user Adriaan:\n          // http://www.bennadel.com/members/11887-adriaan.htm\n          var image = angular.element( new Image() )\n              .bind('load', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageLoad( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .bind('error', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageError( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .attr( 'src', imageLocation )\n          ;\n      }\n  };\n  // Return the factory instance.\n  return( Preloader );\n};","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('Nuser', Nuser);\n\t\t\n\tNuser.$inject = ['$location', '$window', 'api'];\n  function Nuser($location, $window, api) {\n\t  \n\t  var user = {};\n\t  \n\t\tvar isLoggedIn = function(){\n\t\t\tconsole.log(\"Here\");\n\t\t\treturn $window.localStorage.getItem(\"bdAccessToken\") ? true : false;\n\t\t}\n\t  \n\t\tvar set = function(key, data){\n\t\t\t\n\t\t\tif (key == null) return false;\n\t\t\t\n\t\t\tif (typeof key === 'object'){\n\t\t\t\t\n\t\t\t\tconsole.log('setting whole user');\n\t\t\t\tvar userData = key;\n\t\t\t\tfor (obKey in userData){\n        if(!userData.hasOwnProperty(obKey)) continue;\n\t\t\t\t\tuser[obKey] = key[obKey]\n    \t\t}\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\telse user[key] = data; \n      return user;\n    };\n\t\t\n\t\tvar setup = function(){\n\t\t\tapi.call('getCurrentUser', {}, function(userDetails){\n\t\t\t\tconsole.log(userDetails);\n\t\t\t\tset(userDetails);\n\t\t\t\tconsole.log(user);\n\t\t\t});\n\t\t}\n\t\t\n\t\tvar login = function(username, password, success, error){\n\t\t\tapi.login(username, password)\n\t\t\t.success(function(response){\n\t\t\t\tconsole.log(response);\n\t\t\t\t$window.localStorage.setItem(\"bdAccessToken\", response.access_token);\n\t\t\t\tif (success) success(response);\n\t\t\t})\n\t\t\t.error(function(err){\n\t\t\t\tconsole.log(err);\n\t\t\t\tif(error) error(err);\n\t\t\t})\n\t\t}\n\t\t\n\t\tvar logout = function(){\n\t\t\t$window.localStorage.removeItem(\"bdAccessToken\");\n\t\t\tuser = {};\n\t\t\tconsole.log(\"logged out\");\n\t\t\t$location.path(\"/login\");\n\t\t}\n\t  \n\t  return {\n      get:function(){ return user;},\n      isLoggedIn : isLoggedIn,\n      set: set,\n      login:login,\n      logout:logout,\n      setup: setup\n    };\n    \n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('addressChoiceCtrl', addressChoiceCtrl);\n\n  addressChoiceCtrl.$inject = ['$scope', '$filter', 'bdAPI', 'messages', 'api', 'user'];\n  \n  function addressChoiceCtrl($scope, $filter, bdAPI, messages, api, user) {\n\t  \n\t  $scope.editing=false;\n\t  $scope.active=false;\n\t\t$scope.addForm = {};\n\t\t$scope.model = {};\n\t\t$scope.user = user.get();\n\n\t\tvar addFormFields = ['address_line_1','address_line_2','city','state','zip'];\n\t\t\n\t\t\n\t\t//Choose Primary Address\n\t\t$scope.choosePrimary = function(address){\n\t\t\tfor (a = 0; a< $scope.user.addresses.length; a++){\n\t\t\t\tvar add = $scope.user.addresses[a];\n\t\t\t\tadd.primary = (add.id == address.id ? 1:0);\n\t\t\t}\n\t\t\tapi.call('postAddress', address);\n\t\t}\n\t\t\t\t\n\t\t$scope.startEditing = function(){\n\t\t\t//Bring Primary address to the top\n\t\t\t$scope.user.addresses = $filter('orderBy')($scope.user.addresses, '-primary');\n\t\t\t$scope.editing = true;\n\t\t}\n\t\t\n\t\t$scope.stopEditing = function(){\n\t\t\t$scope.editing = false;\n\t\t}\n\n\t\t$scope.editAdd = {};\n\t\t\n\t\t//Open Address Form\n\t\t$scope.open = function(index){\n\n\t\t\t$scope.active = true;\n\t\t\tif (!$scope.user.addresses) $scope.user.addresses = [];\n\t\t\t\n\t\t\t//New Address\n\t\t\tif (typeof index === 'undefined'){\n\t\t\t\t$scope.model = {};\n\t\t\t\t$scope.editAdd.data = null;\t\n\t\t\t}\n\t\t\t\n\t\t\t//Editing Existing...\n\t\t\telse{\n\t\t\t\t$scope.model = $scope.user.addresses[index];\n\t\t\t\t$scope.editAdd.index = index;\n\t\t\t\t$scope.editAdd.data =  angular.copy($scope.model);\n\t\t\t}\n\t\t\t\t\t\t\n\t\t}\n\t\t\n\n\t\tfunction resetForm(close){\n\t\t\tclose = close || true;\n\t\t\t$scope.editAdd = {};\n\t\t\t$scope.model = {};\n\t\t\tif (close) $scope.active = false;\n\t\t}\n\n\t\t//Clear Address Form\n\t\t$scope.clear = function(){\n\t\t\tvar dataObj = $scope.editAdd.data;\n\t\t\tif (dataObj !== null) $scope.user.addresses[$scope.editAdd.index] = $scope.editAdd.data;//Reset Address\n\t\t\tresetForm();\t\t\t\n\t\t}\n\t\t\n\t\tfunction findAddressbyKey(key, value){\n\t\t\tvar primary = $scope.user.addresses.filter(function (add) {\n\t\t\t   return (add[key] == value);\n\t\t\t});\n\t\t\treturn primary[0];\n\t\t}\n\t\t\n\t\t\n\t\t//Remove Address and save user\n\t\t$scope.remove = function(addressId){\n\t\t\t//Don't allow user to delete their last address..\n\t\t\tif ($scope.user.addresses.length < 2){\n\t\t\t\tmessages.set(\"You can't remove your last address\", \"error\");\n\t\t\t\treturn false;\t\n\t\t\t}\n\t\t\tapi.call('deleteAddress', addressId, function(result){\n\t\t\t\t//Remove deleted address...\n\t\t\t\tfor(i=0; i<$scope.user.addresses.length; i++){\n\t\t\t\t\tvar add = $scope.user.addresses[i];\n\t\t\t\t\tif (add.id == addressId) $scope.user.addresses.splice(i,1);\n\t\t\t\t}\n\t\t\t\t//Change to new primary if primary was delted...\n\t\t\t\tif(result.new_primary_id){\t\t\t\t\n\t\t\t\t\tvar newPrimary = result.new_primary_id;\n\t\t\t\t\taddress = findAddressbyKey(\"id\", newPrimary);\n\t\t\t\t\taddress.primary=1;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\t//Save Form\n\t\t$scope.save = function(){\n\t\t\tvar newAdd = $scope.model.id ? false : true;\n\t\t\tapi.call('postAddress', $scope.model, function(result){\t\n\t\t\t\tif (newAdd)\t$scope.user.addresses.push(result);\n\t\t\t\t$scope.active = false;\n\t\t\t\t$scope.model = {};\t\n\t\t\t});\n\t\t}\n\t\t\n\t\t\n\t\t//US States\n\t\t$scope.states = [\n\t\t\t{\n\t\t\t  \"name\": \"Alabama\",\n\t\t\t  \"abbreviation\": \"AL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Alaska\",\n\t\t\t  \"abbreviation\": \"AK\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Arizona\",\n\t\t\t  \"abbreviation\": \"AZ\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Arkansas\",\n\t\t\t  \"abbreviation\": \"AR\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"California\",\n\t\t\t  \"abbreviation\": \"CA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Colorado\",\n\t\t\t  \"abbreviation\": \"CO\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Connecticut\",\n\t\t\t  \"abbreviation\": \"CT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Delaware\",\n\t\t\t  \"abbreviation\": \"DE\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"District Of Columbia\",\n\t\t\t  \"abbreviation\": \"DC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Florida\",\n\t\t\t  \"abbreviation\": \"FL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Georgia\",\n\t\t\t  \"abbreviation\": \"GA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Hawaii\",\n\t\t\t  \"abbreviation\": \"HI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Idaho\",\n\t\t\t  \"abbreviation\": \"ID\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Illinois\",\n\t\t\t  \"abbreviation\": \"IL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Indiana\",\n\t\t\t  \"abbreviation\": \"IN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Iowa\",\n\t\t\t  \"abbreviation\": \"IA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Kansas\",\n\t\t\t  \"abbreviation\": \"KS\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Kentucky\",\n\t\t\t  \"abbreviation\": \"KY\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Louisiana\",\n\t\t\t  \"abbreviation\": \"LA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Maine\",\n\t\t\t  \"abbreviation\": \"ME\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Maryland\",\n\t\t\t  \"abbreviation\": \"MD\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Massachusetts\",\n\t\t\t  \"abbreviation\": \"MA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Michigan\",\n\t\t\t  \"abbreviation\": \"MI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Minnesota\",\n\t\t\t  \"abbreviation\": \"MN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Mississippi\",\n\t\t\t  \"abbreviation\": \"MS\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Missouri\",\n\t\t\t  \"abbreviation\": \"MO\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Montana\",\n\t\t\t  \"abbreviation\": \"MT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Nebraska\",\n\t\t\t  \"abbreviation\": \"NE\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Nevada\",\n\t\t\t  \"abbreviation\": \"NV\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Hampshire\",\n\t\t\t  \"abbreviation\": \"NH\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Jersey\",\n\t\t\t  \"abbreviation\": \"NJ\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Mexico\",\n\t\t\t  \"abbreviation\": \"NM\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New York\",\n\t\t\t  \"abbreviation\": \"NY\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"North Carolina\",\n\t\t\t  \"abbreviation\": \"NC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"North Dakota\",\n\t\t\t  \"abbreviation\": \"ND\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Ohio\",\n\t\t\t  \"abbreviation\": \"OH\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Oklahoma\",\n\t\t\t  \"abbreviation\": \"OK\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Oregon\",\n\t\t\t  \"abbreviation\": \"OR\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Pennsylvania\",\n\t\t\t  \"abbreviation\": \"PA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Rhode Island\",\n\t\t\t  \"abbreviation\": \"RI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"South Carolina\",\n\t\t\t  \"abbreviation\": \"SC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"South Dakota\",\n\t\t\t  \"abbreviation\": \"SD\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Tennessee\",\n\t\t\t  \"abbreviation\": \"TN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Texas\",\n\t\t\t  \"abbreviation\": \"TX\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Utah\",\n\t\t\t  \"abbreviation\": \"UT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Vermont\",\n\t\t\t  \"abbreviation\": \"VT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Virginia\",\n\t\t\t  \"abbreviation\": \"VA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Washington\",\n\t\t\t  \"abbreviation\": \"WA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"West Virginia\",\n\t\t\t  \"abbreviation\": \"WV\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Wisconsin\",\n\t\t\t  \"abbreviation\": \"WI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Wyoming\",\n\t\t\t  \"abbreviation\": \"WY\"\n\t\t\t}\n\t\t];\n    \n\t\t\n\t\t\t  \n\t}\n\t\n})();\n\t\t","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('addressChoice', addressChoice);\n\t\t\n\n\t\n  function addressChoice () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/address-choice/address-choice.template.html',\n      controller: 'addressChoiceCtrl as adcvm',\n      scope : {\n\t\t\t\tuser : '='\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('istackCtrl', istackCtrl);\n\n  istackCtrl.$inject = ['$window', '$scope', '$q', 'jean'];\n  \n  \n  \n  function istackCtrl($window, $scope, $q, jean) {\n\t  var isvm = this;\n\n\t\tisvm.centerPan = false;\t\t\n\t\tisvm.zoom = false;\n\t\tisvm.pan = {\"x\":50, \"y\":30};\n\t\tisvm.isMobile = function(){ return $window.innerWidth<800 };\n\t\t\n\t\t\n\t\tisvm.toggleZoom = function(){\n\t\t\tisvm.zoom = !isvm.zoom\n\t\t}\n\t\t\n\t\tisvm.touchEnd = function(){\n\t\t\tisvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\t$scope.$apply();\n\t\t}\n\t\t\n\t\tisvm.returnPan = function(){\n\t\t\tif (isvm.isMobile()) return false;\n\t\t\tisvm.pan = \"50% 30% 0\";\t\n\t\t\tisvm.centerPan = true;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\tsetTimeout(function(){\n\t\t\t\timages.css({\"transform-origin\":isvm.pan});\n\t\t\t}, 200);\n\t\t}\n\t\t\t\t\n\t\tisvm.touchStart= function(e){\t\n\t\t\t//Setup Swipe starting point\n\t\t\tisvm.swipeStart={\"x\":e.touches[0].clientX,\"y\":e.touches[0].clientY};\n\t\t\t//Clear out Swipe Object\n\t\t\tisvm.swipe={};\n\t\t}\n\t\t\n\t\tisvm.zoomDrag = {\"x\":0,\"y\":0};\n\t  isvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\n\t\tisvm.touchMove= function(e){\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t//Prevent Scrolling?\n\t\t\te.preventDefault();\n\t\t\t\n\n\t\t\tvar touch = e.touches[0],\n\t\t\ttarget = touch.target,\n\t\t\tdrag = {\n\t\t\t\t\"x\" : touch.clientX-isvm.swipeStart.x,\n\t\t\t\t\"y\" : touch.clientY-isvm.swipeStart.y\n\t\t\t};\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = (x/target.clientWidth*100)+isvm.zoomDrag.x,      \n\t\t\ty = (y/target.clientHeight*100)+isvm.zoomDrag.y;\n\n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -120;\n\t\t\tbounds.x.right  = 90;\n\t\t\t\n\t\t\t//Apply Bounds\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y};\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\tisvm.dragTracker = drag;\t\n\t\t\t$scope.$apply();\n\n\t\t}\n\t\t\n\n\n\n\t\tisvm.dragPan = function(u, event) {\n\t\t\n\t\t\tconsole.log(event.direction);\n\t\t\t\n\t\t\t\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\")),\n\t\t\twindowHeight = window.innerHeight,\n\t\t\torigHeight = images[0].height,\n\t\t\tnewHeight = origHeight*1.7,\n\t\t\tframe={\n\t\t\t\t\"width\":event.target.clientWidth,\n\t\t\t\t\"height\":event.target.clientHeight\n\t\t\t};\n\t\t\t\n\n\t\t\t//Get drag length\n\t\t\tvar drag = {\n\t\t\t\t\"x\" : event.deltaX,\n\t\t\t\t\"y\" : event.deltaY\n\t\t\t}\n\t\t\t\n\t\t\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\n\t\t\tconsole.log(x,y);\n\t\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = Math.abs(x)/frame.width*100;      \n\t\t\tx = (drag.x<0)?-x:x;\t       \n\t\t\tvar y = Math.abs(y)/frame.height*100;\n\t\t\ty = (drag.y<0)?-y:y;\n\t\t\t\n\t\t\t//Add these values to the last drag. This essentially allows drag and drop\n\t\t\tx=x+isvm.zoomDrag.x;\n\t\t\ty=y+isvm.zoomDrag.y;\n\t\t\t\t \n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\n\t\t\t/*//Left/Right Bounds\n\t\t\tbounds.y.top =(newHeight/2)+175;\n\t\t\tbounds.y.bottom =-(newHeight*.225);\n\t\t\tbounds.x.left = -(event.target.clientWidth-(event.target.clientWidth*.05));\n\t\t\tbounds.x.right = event.target.clientWidth-(event.target.clientWidth*.05);*/\n\t\t\t\t\n\t\t\t//Transform Origin Bounds\n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -150;\n\t\t\tbounds.x.right  = 60;\n\t\t\t\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y}\n\t\t\t\n\t\t\tconsole.log(move);\n\t\t\t//Register Drag\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t       \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\t/*//Alter Left/Bottom\n\t\t\timages.css('left', move.x+\"px\");\n\t\t\timages.css('bottom', -move.y+\"px\");*/\n\t\t\t\n\t\t\t//When drag is over, reset drag tracker\t \n\t\t\tisvm.dragTracker = event.isFinal ? {\"x\":0,\"y\":0} : drag;\n\t\t\t\t \n\n\t\t}\n\t\t\n\n\t\t\n\n\t\t\n\n\t\tisvm.scanImage = function(x,y){\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tisvm.centerPan = false;\n\t\t\t}, 200);\n\t\t\t\n\t\t\t\n\t\t\tframe = angular.element(document.querySelector(\"#zoom-frame\"))[0];\n\t\t\tfWidth = frame.clientWidth;\n\t\t\tfHeight = frame.clientHeight;\n\t\t\trect = frame.getBoundingClientRect();\n\t\t\trootDoc = frame.ownerDocument.documentElement;\n\t\t\t\t//calculate the offset of the frame from the top and left of the document\n\t\t\toffsetT = rect.top + $window.pageYOffset - rootDoc.clientTop\n\t\t\toffsetL = rect.left + $window.pageXOffset - rootDoc.clientLeft\n\n\t\t\t//calculate current cursor position inside the frame, as a percentage\n\t\t\txPosition = ((x - offsetL) / fWidth) * 100\n\t\t\tyPosition = ((y - offsetT) / fHeight) * 100\n\t\t\t\n\t\t\t\n\t\t\t/*\n\t\t\tconsole.log(x,y);\n\t\t\tconsole.log(fWidth);\n\t\t\tconsole.log(offsetL);\n\t\t\tconsole.log(x-offsetL);\n\t\t\tconsole.log(xPosition, yPosition);\n\t\t\t*/\n\t\t\tif ($window.innerWidth < isvm.breakPoint) pan = (100-xPosition) + \"% \" + (100-yPosition) + \"% 0\";\n\t\t\telse pan = (xPosition) + \"% \" + (yPosition) + \"% 0\";\n\t\t\tisvm.pan=pan;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\timages.css({\"transform-origin\":pan});\n\t\t}\n\t\t\n\t\tisvm.trackMouse = function($event){\n\t\t\t//if (isvm.isMobile()) return false;\n\t\t\tisvm.scanImage($event.pageX,$event.pageY);\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('imageStack', imageStack);\n\t\t\n\n\t\n  function imageStack () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/image-stack/image-stack.template.html',\n      controller: 'istackCtrl as isvm',\n      scope : {\n        jeanData : '='\n      },\n      link: function(scope, ele, attrs, ctrl) {\n\t      \n\t     \n\t     ele.on('touchstart', function(e){\n\t\t\t \tscope.isvm.touchStart(e);\t\n\t     });\t\n\t     \n\t     ele.on('touchmove', function(e){\n\t\t\t \tscope.isvm.touchMove(e);\t\n\t     });\t\t\n\t     \n\t     ele.on('touchend', function(e){\n\t\t\t \tscope.isvm.touchEnd(e);\t\n\t     });\t\t\t\t\n\t\t\t\n       \n\t      /*\n\t      $swipe.bind(ele, {\n          'move': function(event) {\n\t\t\t\t\t\tscope.isvm.scanImage(coords.x,coords.y);\n          }\n\t      });\n\t     */\n\n\t    }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('chooserCtrl', chooserCtrl)\n\t\n\t\tchooserCtrl.$inject = ['$scope', '$element','$timeout', '$window', 'jean', 'popups'];\n\n\t\t\n\t\tfunction chooserCtrl($scope, $element, $timeout, $window, jean, popups) {\n\t\n\t\t\tvar chvm = this;\n\t\t\t\n\t\t\t//popups\n\t\t\tchvm.popups = popups.get();\n\t\t\tchvm.jeanData = jean.get();\n\t\t\tchvm.breakPoint = 800;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfunction scrollToLeft(el, scrollTo, scrollDuration) {\n\t\t\t\t//Select First Element\n\t\t\t\tel = el[0];\n\t\t\t\t//Center Scroll To\n\t\t\t\tscrollTo = scrollTo-(el.offsetWidth/2)+40;\n\t\t\t\t\n\t\t\t\tvar maxLeft = el.scrollWidth - el.offsetWidth;\n\t\t\t\t\n\t\t\t\tif (scrollTo >= maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tif (scrollTo == maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tvar stepNum = Math.ceil(scrollDuration / 15),\n\t\t\t\t\t\tdistance = scrollTo - el.scrollLeft,\n\t\t\t\t\t\tscrollStep = (distance / stepNum),\n\t\t\t\t\t\tscrollTest = (el.scrollLeft < scrollTo ? function(a,b){return a<=b-1;} : function(a,b){return a>=b+1;} );\t\t\n\t\t\t\t/*\n\t\t\t\tconsole.log(\"current Scoll pos: \"+el.scrollLeft);\n\t\t\t\tconsole.log(\"Scroll to \"+scrollTo);\n\t\t\t\tconsole.log(\"distance to go \"+distance);\n\t\t\t\tconsole.log(scrollStep);\n\t\t\t\tconsole.log(\"func: \"+scrollTest)\n\t\t\t\tconsole.log(\"eval\");\n\t\t\t\tconsole.log(scrollTest(el.scrollLeft, scrollTo ));\n\t\t\t\tconsole.log(\"done\");\n\t\t\t\t*/\n\t\t\t\t\t\t\n\t\t\t\tvar scrollInterval = setInterval(function(){    \n\t\t\t\t\n\t\t\t\t\tif(scrollTest(el.scrollLeft, scrollTo )){\n\t\t\t\t\t\tvar newScroll = el.scrollLeft+scrollStep;\n\t\t\t\t\t\tif (newScroll >= maxLeft) newScroll = maxLeft-1;\n\t\t\t\t\t\tel.scrollLeft = newScroll;\n\t\t\t\t\t\t\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tconsole.log(newScroll);\n\t\t\t\t\t\tconsole.log(scrollTo);\n\t\t\t\t\t\t*/\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse clearInterval(scrollInterval); \n\t\t      \n\t  \t\t},15);\n\t\t\t  \n\t\t\t}\n\n\t\t\tchvm.selectorCoords = {\"top\":0, \"left\":0};\n\t\t\t\n\t\t\t\n\t\t\t//Center Selector on chooser change... Center on selected attr if edting preexisting jean...\n\t\t\t$scope.$watch('active', function(newValue,oldValue) {\t\n\t\t\t\t\n\t\t\t\t//Only on active choosers...\n\t\t\t\tif (newValue == true){\n\n\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Get the data id \n\t\t\t\t\t\tvar dataId = chvm.jeanData[$scope.step.jeanKey];\n\t\t\t\t\t\n\t\t\t\t\t\t//Make sure this isn't an embedded model\n\t\t\t\t\t\tif (typeof(dataId)== 'object') dataId = dataId[$scope.step.dataKey4];\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar elementId = $scope.step.jeanKey+\"_\"+dataId;\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\tvar activeElement = angular.element(document.querySelector('#'+elementId));\n\t\t\t\t\t\t\n\t\t\t\t\t\tchvm.selectorCoords.top = activeElement.prop('offsetTop');\n\t\t\t\t\t\tchvm.selectorCoords.left = activeElement.prop('offsetLeft');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+$scope.step.jeanKey+\"-selector\"));\n\t\t\t\t\t\tselector.css({'top':chvm.selectorCoords.top+'px', 'left':chvm.selectorCoords.left+'px'});\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Mobile Choosers\n\t\t\t\t\t\tif ($window.innerWidth < chvm.breakPoint){\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0].querySelector('.chooser-grid'));\t\n\t\t\t\t\t\t\tvar left = (chooser[0] ? chvm.selectorCoords.left-(chooser[0].offsetWidth/2)+40 : 0);\n\t\t\t\t\t\t\tchooser.prop('scrollLeft', left);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Desktop Choosers\n\t\t\t\t\t\telse{\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0]);\t\n\t\t\t\t\t\t\tchooser.prop('scrollTop', chvm.selectorCoords.top - 15);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}, 200);\n\t\t\t\t\t\n\t\t\t\t}\t\t\n\t\t\t\t\n    \t});\n\n\n\t\t\tchvm.selectAttr = function($event, id, attr, selector){\n\t\t\t\tvar chooser = angular.element(document.querySelector(\"#\"+attr+\"-chooser\"));\n\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));\n\t\t\t\tvar top = angular.element($event.target).prop('offsetTop');\n\t\t\t\tvar left = angular.element($event.target).prop('offsetLeft');\n\t\t\t\tvar text = angular.element(document.querySelectorAll('#item-title'));\n\t\t\t\t\n\t\t\t\ttext.css({'right':'-400px', 'opacity':0});\n\t\t\t\tselector.css({'top':top+'px', 'left':left+'px'});\n\t\t\t\t\n\t\t\t\tchvm.selectorCoords = {\"top\":top,\"left\":left};\n\t\t\t\t\n\t\t\t\tif ($window.innerWidth < chvm.breakPoint) scrollToLeft(chooser, left, 200);\n\t\t\t\t\n\t\t\t\t$timeout(function(){\n\t\t\t\t\ttext.css({'right':'15px', 'opacity':1});\t\t\t\t\n\t\t\t\t\tjean.set(attr,id);\t\n\t\t\t\t}, 200);\n\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tchvm.jeanSet = function(attr, val){\n\t\t\t\tchvm.jeanData[attr] =\tval;\n\t\t\t}\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('chooser', chooser);\n\t\t\n  function chooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('fabricChooser', ['$window', function($window) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      template: '<div class=\"fabric-chooser-container\" ng-include=\"viewUrl\"></div>',\n\t      controller: 'chooserCtrl as chvm',\n\t      scope : {\n\t        step : '=',\n\t        dataset: '=',\n\t\t\t\t\tactive: '='\n\t      },\n\t      \n\t      link: function($scope){\n\t\t      \n\t\t      $scope.breakPoint = 800;\n\t\t      \n\t\t      //Template on window resize\n\t\t      $window.onresize = function() {\n\t          changeTemplate();\n\t          $scope.$apply();\n\t        };\n\t        \n\t        changeTemplate();\n\t            \n\t        function changeTemplate() {\n\t          var screenWidth = $window.innerWidth;\n\t          if (screenWidth < $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-mobile.html\";\n\t          } else if (screenWidth >= $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-desk.html\";\n\t          }\n\t        }\n\t\t      \n\t\t      \n\t\t      function positionChooser(){\n\t\t\t    \t//element.animate({scrollLeft: element.offset().left - 50}, \"slow\");\n\t\t\t    \t//var selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));  \n\t\t      }\n\t\t      \n\t\t      \n\t\t      //Weight Filter\n\t\t      $scope.weightFilter = function(min, max){\n\t\t\t\t\t\treturn function(fabric){\n\t\t\t\t\t\t\tif (min && fabric.weight < min) return false;\n\t\t\t\t\t\t\tif (max && fabric.weight > max) return false;\n\t\t\t\t\t    return true;\n\t\t\t\t\t  }\n\t\t\t\t\t};\n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('genderChooser', genderChooser);\n\t\t\n  function genderChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/gender-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('styleChooser', styleChooser);\n\t\t\n  function styleChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/style-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      },\n      link: function($scope){\n\t      $scope.checkGenderFilter = function(gender){\n\t\t\t\t\treturn function(style){\n\t\t\t\t\t\tg = gender == 1 ? \"male\":\"female\";\n\t\t\t\t\t\treturn style[g];\n\t\t\t\t  }\n\t\t\t\t};\n\t    }\n     \n\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('jeanCard', jeanCard);\n    \n\t  function jeanCard () {\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      replace:true,\n\t\t\t\ttemplate: '<ng-include src=\"templatePath\"/>',\n\t      scope : {\n\t        click : '=?',\n\t        data: '=',\n\t      },\n\t      link: function link(scope, element, attrs) {\n\t\t      console.log(attrs);\n\t\t\t\t\tvar slug = attrs.template ? attrs.template : \"jean-card\";\n\t\t      scope.templatePath=\"/directives/jean-card/\"+slug+\".template.html\";\n\t\t\t\t}\n\t  \t} \n\t  }\n  \n    \n\n})();\n/*\n\t      function($scope) {\n\t\t      $scope.getTemplateUrl = function() {\n\t\t\t      return '';\n\t\t      }\n\t\t    }\n\t\t    */","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('jeanList', ['jean', 'apiData', function(jean, apiData) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t\t\t\ttemplateUrl: '/directives/jean-list/jean-list.template.html',\n\t      scope : {\n\t        fields : '=?',\n\t        jean: '=?'\n\t      },\n\t      \n\t      link: function($scope){\n\t\t\t\t\t\n\t\t\t\t\t$scope.dataBank = apiData;\n\t\t\t\t\t$scope.jean = $scope.jean || jean.get();\n\t\t\t\t\n\t\t\t\t\tvar defaultFields = [\n\t\t\t\t\t\t'fabric_id',\n\t\t\t\t\t\t'accent_thread_id',\n\t\t\t\t\t\t'top_thread_id',\n\t\t\t\t\t\t'bottom_thread_id',\n\t\t\t\t\t\t'gender',\n\t\t\t\t\t\t'style_option_id'\n\t\t\t\t\t];\n\n\t\t\t\t\t$scope.findLabel = function(field){\n\t\t\t\t\t\tvar fieldLabels = {\n\t\t\t\t\t\t\t'fabric_id' : 'Fabric',\n\t\t\t\t\t\t\t'accent_thread_id' : 'Accent Thread',\n\t\t\t\t\t\t\t'top_thread_id' : 'Top Thread',\n\t\t\t\t\t\t\t'bottom_thread_id' : 'Bottom Thread',\n\t\t\t\t\t\t\t'gender' : 'Gender',\n\t\t\t\t\t\t\t'style_option_id' : 'Style'\n\t\t\t\t\t\t}\n\t\t\t\t\t  return fieldLabels[field]; // otherwise it won't be within the results\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t$scope.fields = $scope.fields || defaultFields;\n\t\t\t\t\t\n\t\t\t\t\t$scope.dataLookup = function(key, value){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tvar dataMap = {\n\t\t\t\t\t\t\t'fabric_id' : 'fabrics',\n\t\t\t\t\t\t\t'accent_thread_id' : 'threads',\n\t\t\t\t\t\t\t'top_thread_id' : 'threads',\n\t\t\t\t\t\t\t'bottom_thread_id' : 'threads',\n\t\t\t\t\t\t\t'gender' : 'gender_options',\n\t\t\t\t\t\t\t'style_option_id' : 'style_options'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar key = dataMap[key];\n\t\t\t\t\t\tvar data = apiData[key];\n\t\t\t\t\t\tfor (d=0;d<data.length;d++){\n\t\t\t\t\t\t\tif (data[d].id == value) return data[d].name;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t$scope.filterFields = function(data){\n\t\t\t\t\t\tmatches = {};\n\t\t\t\t\t\tfor (var k in data) {\n\t\t        \tif (data.hasOwnProperty(k) && $scope.fields.indexOf(k)>=0) {\n\t\t\t\t\t  \t  matches[k]=data[k];\n\t\t\t\t\t    }\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn matches;\n\t\t\t\t\t}\n\n\t\t   \n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('loginFormCtrl', loginFormCtrl);\n\n  loginFormCtrl.$inject = ['$location', 'user', 'messages', '$scope', 'aws'];\n  \n  function loginFormCtrl($location, user, messages, $scope, aws) {\n    var logvm = this;\n    \n\t\tlogvm.messages=messages.get();\n\t\t\n\t\tlogvm.credentials = {\n      loginEmail : \"\",\n      loginPassword : \"\"\n    };\n    \n    \n  \tfunction validateEmail(email) {\n\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t    return re.test(email);\n\t\t}\n\t\t\n    /*\n    *\n    * LOGGING IN\n    *\n    */\n    \n    //Log user in and send errors to \"messages\"\n\t\tlogvm.login = function(email, password){\n\t\t\tmessages.reset();\n\t    if (logvm.validateLoginForm()){\n\t\t    console.log('valid');\n\t      user.login(email, password, function(){\n\t\t\t\t\tif ($scope.callback) $scope.callback();\n\t\t\t\t\tif ($scope.redirect) $location.path($scope.redirect);\n\t\t\t\t\tif (!$scope.callback && !$scope.redirect)\t$location.path('/closet');\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tif (err.message == \"Incorrect username or password.\") err.message = \"Incorrect Email address or password.\"\n\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t});\n\t\t  }\n\t\t}\n\t\t\n\t\t//Login form validation\n\t\tlogvm.validateLoginForm = function(){\t\t\t\t\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!logvm.credentials.loginPassword){\n\t\t\t\tmessages.set(\"Please enter a password\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t/*\n\t\t*\n\t\t*  Forgot Password\n\t\t*\n\t\t*/\n\t\t\n\t\t\n\t\tfunction validatePassword(password){\n\t\t\tvar re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\treturn re.test(password);\n\t\t}\t\t\t\t\n\n\t\tlogvm.forgotPassword = false;\n\t\tlogvm.forgotPassword2 = false;\n\t\t\n\t\t/*\n\t\t*  STEP 1\n\t\t*/\n\t\tlogvm.forgot = function(){\t\n\t\t\tmessages.reset();\n\t    if (logvm.validateForgot()){\n\t\t\t\taws.forgotPassword(logvm.credentials.loginEmail).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tlogvm.forgotPassword2 = true;\t\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tif (err.message == \"Username/client id combination not found\"){\n\t\t\t\t\t\t\terr.message = \"We don't have an account registered for that emial\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t  }\n\t\t}\n\t\t\n\t\t//Forgot password set 1 validation\n\t\tlogvm.validateForgot = function(){\t\t\t\t\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\t\n\t\t/*\n\t\t*   STEP 2\n\t\t*/\t\n\t\tlogvm.forgot2 = function(){\n\t\t\tmessages.reset();\n\t    if (logvm.validateForgot2()){\n\t\t\t\taws.setNewPassword(logvm.credentials.loginEmail, logvm.credentials.loginVerifcation, logvm.credentials.newPassword).then(\n\t\t\t\t\tfunction(){\n\t\t\t\t\t\t//Password reset successfully...\n\t\t\t\t\t\tmessages.set(\"Password reset successfully. Try logging in.\", \"success\");\n\t\t\t\t\t\tlogvm.forgotPassword = false;\n\t\t\t\t\t\tlogvm.forgotPassword2 = false;\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t  }\n\t\t}\n\t\t\n\t\t//Forgot password set 1 validation\n\t\tlogvm.validateForgot2 = function(){\t\t\t\t\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (!logvm.credentials.loginVerifcation){\n\t\t\t\tmessages.set(\"Please enter your verifcation code\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!validatePassword(logvm.credentials.newPassword)){\n\t\t\t\tmessages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one uppercase letter</li><li>Contain at least one lowercase letter</li><li>Contain at least one special character (\\\"!,@,#,$,%,^,&, or *\\\")</li>\");\t\n\t\t\t}\n\n\t\t\tif (logvm.credentials.newPassword !== logvm.credentials.newPasswordConfirm){\n\t\t\t\tmessages.set(\"Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t//Log in via Facebook\n\t\tlogvm.loginFB = function(){\n\t\t\taws.authenticateViaFB().then(\n\t\t\t\tfunction(result){\n\t\t\t\t\t$location.path('/closet');\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('loginForm', loginForm);\n\t\t\n\n\t\n  function loginForm () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/login-form/login-form.template.html',\n      controller: 'loginFormCtrl as logvm',\n      scope : {\n\t\t\t\tredirect : \"=?\",\n\t      callback : \"=?\"\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','$route','popups', 'user', '$window', 'loader'];\n  function navigationCtrl($location, $route, popups, user, $window, loader) {\n    var vm = this;\n\n\t\tvm.loader = loader.get('loader');\n\t\tvm.saver = loader.get('saver');\n\t\tvm.drops={};\n\t\tvm.drops.acct=false;\n\t\tvm.mobileMenu = false;\n\t\t\t\t\n\t\tvm.isLoggedIn = user.isLoggedIn();\n\n\t\tvm.logout = function(){\t\t\t\n\t\t\tuser.logout();\n\t\t}\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerFormCtrl', registerFormCtrl);\n\n  registerFormCtrl.$inject = ['$scope', '$location', 'user', '$sce', 'messages'];\n  \n  function registerFormCtrl($scope, $location, user, $sce, messages) {\n    var regvm = this;\n    \n\t\tregvm.messages=messages.get();\n\t\t\n\t\tregvm.credentials = {\n      first_name : \"\",\n      last_name:\"\",\n      email : \"\",\n      password : \"\"\n    };\n\t\n\t\t//Validate Registration Form\n\t\tregvm.validateRegistrationForm = function () {\n\t\t\t\t\t\t\n\t\t\tfunction validatePassword(password){\n\t\t\t\t//console.log(regvm.credentials.password.length > 5);\n\t\t\t\t//contains numbers\n\t\t\t\t//console.log(regvm.credentials.password.search(/\\d/)>-1);\n\t\t\t\t//contains lowercase letters\n\t\t\t\t//console.log(regvm.credentials.password.search(/[a-z]/) > -1);\n\t\t\t\t//contains uppercase letters\n\t\t\t\t//console.log(regvm.credentials.password.search(/[A-Z]/) > -1);\n\t\t\t\t\n\t\t\t\t//RE to test all\n\t\t\t\tvar re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\t\treturn re.test(password);\n\t\t\t}\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\tfunction validateEmail(email) {\n\t\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t    return re.test(email);\n\t\t\t}\n\n\t\t\t\n\t\t\tif (!regvm.credentials.email || !regvm.credentials.first_name || !regvm.credentials.last_name || !regvm.credentials.password || !regvm.credentials.passwordConfirm){\n\t\t\t\tmessages.set(\"All fields are required\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (!validatePassword(regvm.credentials.password)){\n\t\t\t\tmessages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one uppercase letter</li><li>Contain at least one lowercase letter</li><li>Contain at least one special character (\\\"!,@,#,$,%,^,&, or *\\\")</li>\");\t\n\t\t\t}\n\t\t\t\n\t\t\tif (regvm.credentials.password !== regvm.credentials.passwordConfirm){\n\t\t\t\tmessages.set(\"Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif(!validateEmail(regvm.credentials.email)){\n\t\t\t\tmessages.set(\"Please Enter a valid E-mail address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t//Register User\n    regvm.registerUser = function () {\n\t    messages.reset();\n\t    if (regvm.validateRegistrationForm()){\n\t\t    user.register(regvm.credentials.email, regvm.credentials.password, regvm.credentials.first_name, regvm.credentials.last_name, function(result){\n\t\t\t\t\tif ($scope.callback) $scope.callback(regvm.credentials);\n\t\t\t\t\tif ($scope.redirect) $location.path($scope.redirect);\n\t\t\t\t\tif (!$scope.callback && !$scope.redirect)\t$location.path('/closet');    \n\t\t    },   \n\t\t    function(err){\n\t\t\t    if (err.message = \"Duplicate email address\") err.message = \"This user is already registered.\";\n\t\t\t\t  messages.set(err.message, \"error\");\n\t\t\t  });\t\t\t  \n\t\t  }\n    };\t\n    \n    \n    \t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('registerForm', registerForm);\n\t\t\n\n\t\n  function registerForm () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/register-form/register-form.template.html',\n      controller: 'registerFormCtrl as regvm',\n      scope : {\n\t\t\t\tredirect : \"=?\",\n\t      callback : \"=?\"\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('sliderCtrl', sliderCtrl)\n\t\n\t\tsliderCtrl.$inject = ['$scope', 'preloader'];\n\n\t\tfunction sliderCtrl($scope, preloader) {\n\t\t\tvar slvm = this;\n\n\t\t\t\n\t\t\t$scope.imagesLoaded = false;\n\t\t\t\n\t\t\tpreloader.preloadImages( $scope.slides )\n\t\t\t.then(function() {\n\t\t\t\t$scope.imagesLoaded = true;\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\tconsole.log(\"error loading imgaes...\");\n\t\t\t});\n\t\t \t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t$scope.currentIndex = 0;\n\t\t\t\n\t\t\t$scope.setCurrentSlideIndex = function (index) {\n\t\t\t  $scope.currentIndex = index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.isCurrentSlideIndex = function (index) {\n\t\t\t  return $scope.currentIndex === index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.nextSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex < $scope.slides.length - 1) ? ++$scope.currentIndex : 0;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.prevSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex > 0) ? --$scope.currentIndex : $scope.slides.length - 1;\n\t\t\t};\n\t\t\t\t\n\t\t}\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('slider', slider);\n\t\t\n  function slider () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/slider/slider.template.html',\n      controller: 'sliderCtrl as slvm',\n      scope : {\n        slides : '=',\n        imageClick : '&'\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('socialCtrl', socialCtrl)\n\t\n\t\tsocialCtrl.$inject = ['jean'];\n\n\t\t\n\t\tfunction socialCtrl(jean) {\n\t\n\t\t\tvar sovm = this;\n\t\t\tsovm.jean = jean;\n\t\t\t\n\t\t\t\n\t\t\tsovm.jeanToUrl = function(){\n\t\t\t\tvar url = document.location.origin+\"/customizer/d\";\t\n\t\t\t\turl += \"/copy\";\n\t\t\t\treturn url;\n\t\t\t}\n\t\t\t\n\t\t\tvar sharingUrls = {};\n\t\t\t\n\t\t\tvar socialTitle = \"Check out my custom jeans built with Blue Delta!\";\n\t\t\tvar socialDescription = \"Cras justo odio, dapibus ac facilisis in, egestas eget quam.\";\n\n\t\t\t//Facebook sharing URL\n\t\t\tsharingUrls.facebook = function(url, image){\n\t\t\t\tif (!url) return false;\n\t\t\t\tvar baseString = 'https://www.facebook.com/sharer/sharer.php?u='+url+'&description='+socialDescription+'&title='+socialTitle;\n\t\t\t\tif (image) baseString += '&images='+urlencode(image);\n\t\t\t\treturn baseString;\n\t\t\t}\n\t\t\t\n\t\t\t//Twitter sharing URL\n\t\t\tsharingUrls.twitter = function(url){\n\t\t\t\tif (!url) return false;\n\t\t\t\treturn 'http://twitter.com/home?status='+socialTitle+'-'+url;\n\t\t\t}\n\t\t\t\n\t\t\t//Email sharing URL\n\t\t\tsharingUrls.email = function(url){\n\t\t\t\treturn \"mailto:?&subject=\"+socialTitle+\"&body=\"+socialDescription+\" - \"+url;\n\t\t\t}\n\t\t\t\n\t\t\t//Pinterest sharing URL\n\t\t\tsharingUrls.pinterest = function (url, image){\n\t\t\t\tif(url || image) return false;\n\t\t\t\treturn 'https://pinterest.com/pin/create/button/?url='+url+'&media='+image+'&description='+socialTitle+'%0A'+socialDescription;\t\n\t\t\t}\n\n\t\t\tsovm.share = function(social){\n\t\t\t\tvar url = sharingUrls[social](sovm.jeanToUrl());\n\t\t\t\tif (url !== false){\n\t\t\t\t\tif (social=='email') window.open(url, '_self');\n\t\t\t\t\telse window.open(url, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');\n\t\t\t\t}\n\t\t\t\telse console.log(\"Error builiding social URL\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('socialActions', [function() {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      replace:true,\n\t\t\t\ttemplateUrl: '/directives/social-actions/social-actions.template.html',\n\t      scope : {\n\t        jean : '=',\n\t        display: '='\n\t      },\n\t      controller: 'socialCtrl as sovm',\n\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('adminCtrl', adminCtrl);\n\n  adminCtrl.$inject = ['$location', 'meanData'];\n  function adminCtrl($location, meanData) {\n\t  \n\t  \n    var vm = this;\n\n    vm.user = {};\n    meanData.getOptions()\n      .success(function(data) {\n\t      console.log(\"admin.controller.jsln16:::\");\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('customizerCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['api', 'user', '$q','$filter','$timeout','$location', '$window', '$routeParams', 'bdAPI', 'jean', '$scope', 'popups', 'aws', 'messages', 'loader', 'apiData'];\n  function customizerCtrl(api, user, $q, $filter, $timeout, $location, $window, $routeParams, bdAPI, jean, $scope, popups, aws, messages, loader, apiData) {\n\t\t\n    var vm = this\n\t\t\n\t\t//Setup Loader\t\t\n\t\tvm.loader = loader.get();\n\t\t\n\t\t//Set up shared messages service\n\t\tmessages.reset();\n\t\tvm.messages=messages.get();\n\t\n\t\t//Set up shared popups service\n\t\tpopups.closeAll();\n\t\tvm.popups = popups.get();\n\n\t\t//Set up Jean\n\t\tvar jeanId;\n\t\tif ($routeParams.jeanId) jeanId = $routeParams.jeanId;\n\t\tvar action = false;\n\t\tif ($routeParams.action) action = $routeParams.action;\n\t\t\n\t\tjean.setup(jeanId, action).then(function(result){\n\t\t\tvm.jeanData=jean.get();\t\t\t\n\t\t\t$scope.$watch(function() {\n\t\t\t\treturn vm.jeanData;\n\t\t\t}, function(current, original) {\n\t\t\t\tvm.updateActiveItem();\n\t\t\t}, true);\n\t\t\t\n\t\t\t$scope.$watch(function() {\n\t\t\t\treturn vm.data;\n\t\t\t}, function(current, original) {\n\t\t\t\tvm.updateActiveItem();\n\t\t\t}, true);\n\n\t\t}, \n\t\t\n\t\t\n\t\tfunction(err){\n\t\t\t//Test for jean not found...\n\t\t\tif(err.message = \"Invalid Jean ID\"){\n\t\t\t\tpopups.set('noJean',true);\n\t\t\t}\n\n\t\t});\n\n\t\t\t\n\t\t\n\t\t\n\t\t\n\t\n\n\t\t//Detect Orientation\t\t\t\n\t\tfunction landscapeDetect() {\n\t\t  var ua = navigator.userAgent.toLowerCase();\n\t\t  var isAndroid = ua.indexOf(\"android\") > -1; // Detect Android devices\n\t\t  if (isAndroid) {\n\t\t    //window.orientation is different for iOS and Android\n\t\t    if (window.orientation == 0 || window.orientation == 180) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 90 || window.orientation == -90) { //Portrait Mode\n\t\t\t\t\treturn false;\n\t\t    }\n\t\t  }\n\t\t  else {\n\t\t    if (window.orientation == 90 || window.orientation == -90) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 0 || window.orientation == 180) { //Portrait Mode\n\t\t      return false;\n\t\t    }\n\t\t  }\n\t\t}\n    \n    vm.landscape=landscapeDetect();\n  \tvar supportsOrientationChange = \"onorientationchange\" in window,\n    orientationEvent = supportsOrientationChange ? \"orientationchange\" : \"resize\";\n\t\t\n\t\twindow.addEventListener(orientationEvent, function() {\t\n\t\t\t//Set a scope variable on orientation change. This will display a popup on the front end warning users that the customizer works best in protrait mode\n\t\t  vm.landscape=landscapeDetect();\n\t\t  $scope.$apply();\n\t\t}, false);\n\t\t\n\t\t\n\t\t\n\t\t\n    /*\n\t\t*\n\t\t* GET CUSTOMIZER DATA \n\t\t*\n\t\t*/\t\n\t\tvm.data = apiData;\n\t\tvm.activeItem={};\n\t\t\n\t\tvm.updateActiveItem = function(){\n\t\t\tif (!vm.jeanData) return false;\n\t\t\tvar data = vm.data[vm.panel[vm.panelStep].dataKey];\n\t\t\tvar id = vm.jeanData[vm.panel[vm.panelStep].jeanKey];\n\t\t\tvar ret = $filter('filter')(data, {id: id});\n\t\t\tif (ret) ret = ret[0];\n\t\t\tvm.activeItem = ret||null;\n\t\t}\n\n\t\t//Build Control Panel Steps\n\t\tvm.panel = [];\n\t\t\n\t\t//Gender\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"gender-chooser\",\n\t\t\t\"dataKey\":\"genders\",\n\t\t\t\"title\":\"Gender\",\n\t\t\t\"jeanKey\":\"gender_option_id\"\n\t\t});\n\t\t\n\t\t//Style\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"style-chooser\",\n\t\t\t\"dataKey\":\"style_options\",\n\t\t\t\"title\":\"Style\",\n\t\t\t\"jeanKey\":\"style_option_id\"\n\t\t});\n\t\t\n\t\t//Fabric\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"fabric-chooser\",\n\t\t\t\"dataKey\":\"fabrics\",\n\t\t\t\"title\":\"Fabric\",\n\t\t\t\"jeanKey\":\"fabric_id\"\n\t\t});\n\t\t\n\t\t//Top Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Top Thread\",\n\t\t\t\"jeanKey\":\"top_thread_id\"\n\t\t});\n\t\t\n\t\t//Bottom Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Bottom Thread\",\n\t\t\t\"jeanKey\":\"bottom_thread_id\"\n\t\t});\n\t\t\n\t\t//Accent Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Accent Thread\",\n\t\t\t\"jeanKey\":\"accent_thread_id\"\n\t\t});\n\t\t\n\t\t//Overview\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"list\",\n\t\t\t\"title\":\"Overview\"\n\t\t});\n\t\t\n\t\tvm.panelDir=\"next\";\t\t\n\t\tvm.panelStep = 0;\n\t\tvm.changeStep = function(step){\n\t\t\tif (step >= vm.panel.length) return false;\n\t\t\tif (step < 0) return false;\n\t\t\tif (step===undefined) return false;\n\t\t\telse vm.panelStep = step; \n\t\t\t\n\t\t\t//As long as we're not on the \"Overview\" Step, update active item...\n\t\t\tif (step+1 != vm.panel.length) vm.updateActiveItem();\n\t\t}\n\t\t\n\n\t\t\n\t\t/*\n\t\t*\n\t\t* Control Panel actions\n\t\t*\n\t\t*/\n\t\n\t\t\n\n\t\tvm.savingBar = false;\n\t\tvm.newJeanName = \"My New Jeans\";\n\t\tvm.authCallback;\n\t\tvm.saveCallback;\n\t\t\n\t\tvar openSaveOpts = function(){\n\t\t\tconsole.log(\"running openSaveOpts...\");\n\t\t\tpopups.set('saveOpts',true);\n\t\t\t\n\t\t}\t\n\t\t\n\t\tvar redirectToOrder = function(jean){\n\t\t\t$location.path('/order/'+jean.id);\n\t\t}\t\n\t\t\n\t\tvm.saveAndOrder = function(){\n\t\t\tvm.saveCallback = redirectToOrder;\n\t\t\tvm.runSave();\n\t\t}\t\n\t\t\n\t\tvm.saveAndShowOpts = function(){\n\t\t\tconsole.log(\"running!!!\");\n\t\t\tvm.saveCallback = openSaveOpts;\n\t\t\tvm.runSave();\n\t\t}\t\n\t\t\n    vm.keepEditing = function(){\n\t\t\t$location.path('/customizer/'+vm.jeanData.id);\n    }\n    \n    vm.goToCloset = function(){\n\t    $location.path('/closet');\n    }\n    \n    vm.startOver = function(){\n\t    jean.reset();\n\t    vm.jeanData=jean.get();\n\t    console.log(jean.get());\n\t    popups.closeAll();\n    }\n    \n    //Check for jean name, run save, and ex callback\n\t\tvm.runSave = function(){\n\t\t\tpopups.closeAll();\n\t\t\t\n\t\t\tif(!vm.jeanData.name) popups.set('namer', true);\n\t\t\t\n\t\t\telse{\n\t\t\t\tvm.savingBar = true;\n\t\t\t\tjean.save().then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tvm.jeanData = result;\n\t\t\t\t\t\tvm.savingBar = false;\n\t\t\t\t\t\tif (vm.saveCallback){ \n\t\t\t\t\t\t\tvm.saveCallback(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} \n\t\t}\n    \n    //When Order is clicked...\n    vm.placeOrder=function(){\n\t\t\tif(!user.isLoggedIn()){\n\t\t\t\tvm.authCallback = vm.saveAndOrder;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvm.saveAndOrder();\n\t\t\t}\n\t\t}\n\n\n    //When Save is clicked....\n    vm.saveJean = function(){\n\t\t\tif(!user.isLoggedIn()){\n\t\t\t\tvm.authCallback = vm.saveAndShowOpts;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse vm.saveAndShowOpts();\n  \t}\n    \n    //Set default auth callback\n\t\t\n    \n    vm.registerCallback = function(details){\n\t    aws.authenticateCognitoUser(details.email, details.password).then(\n\t\t    function(result){\n\t\t\t\t\tvm.authCallback();\t\n\t\t  \t}\n\t    )\n    }\n    \n    \n\n\n\t\t\n  }\n\n})();3","\n/*\n*\n* This controller is designed to be a child of closet.controller. It refernces $scope.$scope.vm.user throughout and needs to inherit $scope.vm.user from a parent\n*\n*/\n\n(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('addFormCtrl', addFormCtrl);\n\n  addFormCtrl.$inject = ['$scope', '$filter', 'bdAPI', 'messages', 'api'];\n  function addFormCtrl($scope, $filter, bdAPI, messages, api) {\n\t  \n\t  \n\t  $scope.editing=false;\n\t  $scope.active=false;\n\t\t$scope.addForm = {};\n\t\t$scope.model = {};\n\t\t\n\t\tvar addFormFields = ['addressLine1','addressLine2','city','state','zip'];\n\t\t\n\t\t\n\t\t//Choose Primary Address\n\t\t$scope.choosePrimary = function(address){\n\t\t\t\n\t\t\tconsole.log(\"choosing primary!!\");\n\t\t\tconsole.log(address);\n\t\t\t\n\t\t\tfor (a = 0; a< $scope.vm.user.address.length; a++){\n\t\t\t\tvar add = $scope.vm.user.address[a];\n\t\t\t\tadd.primary = (add.id == address.id ? true :false);\n\t\t\t}\n\t\t\t\n\t\t\tapi.call('postAddress', address, function(result){\n\t\t\t\tconsole.log('saved');\n\t\t\t});\n\t\t}\n\n\t\t\n\t\t$scope.startEditing = function(){\n\t\t\t//Bring Primary address to the top\n\t\t\t$scope.vm.user.address = $filter('orderBy')($scope.vm.user.address, '-primary');\n\t\t\t$scope.editing = true;\n\t\t}\n\t\t\n\t\t$scope.stopEditing = function(){\n\t\t\t$scope.editing = false;\n\t\t}\n\n\n\n\t\t$scope.editAdd = {};\n\t\t\n\t\t//Open Address Form\n\t\t$scope.open = function(index){\n\n\t\t\t$scope.active = true;\n\t\t\tif (!$scope.vm.user.address) $scope.vm.user.address = [];\n\t\t\t//New Address\n\t\t\tif (typeof index === 'undefined'){\n\t\t\t\t$scope.model = {};\n\t\t\t\t$scope.editAdd.index = $scope.vm.user.address.push($scope.model) -1;\n\t\t\t\t$scope.editAdd.data = null;\t\n\t\t\t}\n\t\t\t\n\t\t\t//Editing Existing...\n\t\t\telse{\n\t\t\t\t$scope.model = $scope.vm.user.address[index];\n\t\t\t\t$scope.editAdd.index = index;\n\t\t\t\t$scope.editAdd.data =  angular.copy($scope.model);\n\t\t\t}\n\t\t\t\t\t\t\n\t\t}\n\t\t\n\n\t\tfunction resetForm(close){\n\t\t\tclose = close || true;\n\t\t\t$scope.editAdd = {};\n\t\t\t$scope.model = {};\n\t\t\tif (close) $scope.active = false;\n\t\t}\n\t\t\n\t\tfunction removeAddress(index){\n\t\t\t$scope.vm.user.address.splice(index, 1);\n\t\t}\n\t\n\t\t\n\t\t//Clear Address Form\n\t\t$scope.clear = function(){\n\t\t\tvar dataObj = $scope.editAdd.data;\n\t\t\tif (dataObj == null) removeAddress($scope.editAdd.index);//Remove Address\n\t\t\telse $scope.vm.user.address[$scope.editAdd.index] = $scope.editAdd.data;//Reset Address\n\t\t\tresetForm();\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\t//Remove Address and save user\n\t\t$scope.remove = function(index){\n\t\t\t\n\t\t\tif ($scope.vm.user.address.length < 2){\n\t\t\t\tmessages.set(\"You can't remove your last address\", \"error\");\n\t\t\t\treturn false;\t\n\t\t\t}\n\t\t\t\n\t\t\tvar wasPrimary = $scope.vm.user.address[index].primary;\t\n\t\t\tremoveAddress(index);\n\t\t\tif(wasPrimary) $scope.choosePrimary(0);\n\t\t\tbdAPI.saveUser($scope.vm.user);\n\t\t}\n\t\t\n\t\t//Save Form\n\t\t$scope.save = function(){\n\t\t \tvar primary = $scope.vm.user.address.filter(function(add){\n\t\t\t\treturn add.primary == true;\n \t\t\t});\n \t\t\tif (!primary.length) $scope.vm.user.address[0].primary=true;\n \t\t\t\t\n\t\t\tbdAPI.saveUser($scope.vm.user).then(\n\t\t\t\tfunction(result){\n\t\t\t\t\t$scope.newAdd = null;\n\t\t\t\t\t$scope.active = false;\n\t\t\t\t\t$scope.model = {};\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\t//US States\n\t\t$scope.states = [\n\t\t\t{\n\t\t\t  \"name\": \"Alabama\",\n\t\t\t  \"abbreviation\": \"AL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Alaska\",\n\t\t\t  \"abbreviation\": \"AK\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Arizona\",\n\t\t\t  \"abbreviation\": \"AZ\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Arkansas\",\n\t\t\t  \"abbreviation\": \"AR\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"California\",\n\t\t\t  \"abbreviation\": \"CA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Colorado\",\n\t\t\t  \"abbreviation\": \"CO\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Connecticut\",\n\t\t\t  \"abbreviation\": \"CT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Delaware\",\n\t\t\t  \"abbreviation\": \"DE\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"District Of Columbia\",\n\t\t\t  \"abbreviation\": \"DC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Florida\",\n\t\t\t  \"abbreviation\": \"FL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Georgia\",\n\t\t\t  \"abbreviation\": \"GA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Hawaii\",\n\t\t\t  \"abbreviation\": \"HI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Idaho\",\n\t\t\t  \"abbreviation\": \"ID\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Illinois\",\n\t\t\t  \"abbreviation\": \"IL\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Indiana\",\n\t\t\t  \"abbreviation\": \"IN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Iowa\",\n\t\t\t  \"abbreviation\": \"IA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Kansas\",\n\t\t\t  \"abbreviation\": \"KS\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Kentucky\",\n\t\t\t  \"abbreviation\": \"KY\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Louisiana\",\n\t\t\t  \"abbreviation\": \"LA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Maine\",\n\t\t\t  \"abbreviation\": \"ME\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Maryland\",\n\t\t\t  \"abbreviation\": \"MD\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Massachusetts\",\n\t\t\t  \"abbreviation\": \"MA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Michigan\",\n\t\t\t  \"abbreviation\": \"MI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Minnesota\",\n\t\t\t  \"abbreviation\": \"MN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Mississippi\",\n\t\t\t  \"abbreviation\": \"MS\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Missouri\",\n\t\t\t  \"abbreviation\": \"MO\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Montana\",\n\t\t\t  \"abbreviation\": \"MT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Nebraska\",\n\t\t\t  \"abbreviation\": \"NE\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Nevada\",\n\t\t\t  \"abbreviation\": \"NV\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Hampshire\",\n\t\t\t  \"abbreviation\": \"NH\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Jersey\",\n\t\t\t  \"abbreviation\": \"NJ\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New Mexico\",\n\t\t\t  \"abbreviation\": \"NM\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"New York\",\n\t\t\t  \"abbreviation\": \"NY\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"North Carolina\",\n\t\t\t  \"abbreviation\": \"NC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"North Dakota\",\n\t\t\t  \"abbreviation\": \"ND\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Ohio\",\n\t\t\t  \"abbreviation\": \"OH\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Oklahoma\",\n\t\t\t  \"abbreviation\": \"OK\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Oregon\",\n\t\t\t  \"abbreviation\": \"OR\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Pennsylvania\",\n\t\t\t  \"abbreviation\": \"PA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Rhode Island\",\n\t\t\t  \"abbreviation\": \"RI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"South Carolina\",\n\t\t\t  \"abbreviation\": \"SC\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"South Dakota\",\n\t\t\t  \"abbreviation\": \"SD\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Tennessee\",\n\t\t\t  \"abbreviation\": \"TN\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Texas\",\n\t\t\t  \"abbreviation\": \"TX\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Utah\",\n\t\t\t  \"abbreviation\": \"UT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Vermont\",\n\t\t\t  \"abbreviation\": \"VT\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Virginia\",\n\t\t\t  \"abbreviation\": \"VA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Washington\",\n\t\t\t  \"abbreviation\": \"WA\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"West Virginia\",\n\t\t\t  \"abbreviation\": \"WV\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Wisconsin\",\n\t\t\t  \"abbreviation\": \"WI\"\n\t\t\t},\n\t\t\t{\n\t\t\t  \"name\": \"Wyoming\",\n\t\t\t  \"abbreviation\": \"WY\"\n\t\t\t}\n\t\t];\n    \n\t\t\n\t\t\t  \n\t}\n\t\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('closetCtrl', closetCtrl);\n\n  closetCtrl.$inject = ['$location', '$window', 'jean','popups', '$scope', 'messages', 'loader', 'user', 'api', 'apiData', '$routeParams'];\n  function closetCtrl($location, $window, jean, popups, $scope, messages, loader, user, api, apiData, $routeParams) {\n\t    \n    var vm = this;   \n\t\t\n\t\tpopups.closeAll();\n\t\tvm.popups=popups.get();\n\n\t\tvm.messages=messages.get();\n\t\tvm.data = apiData;\n\t\t//Set up Jean\n\t\tvm.jeans;\n\t\tapi.call('getMyJeans', null, function(results){\n\t\t\tvm.jeans = results;\n\t\t});\n\t\t\n\t\t//Set up orders\n\t\tvm.orders = [];\t\t\n    api.call('getMyOrders', {}, function(result){\n\t    vm.orders = result;\n    });\n    \n\t\tvm.data=apiData;//jsonData.getData();\n\t\t//vm.jeans = vm.data.jeansList;\n\t\t\n\t\t\n\t\tvm.onload=function(){\n\t\t\t$scope.vm = vm;\t\n\t\t}\n\t\t\n\t\t//Edit User\n\t\tvm.userForm = {};\n\t\tvm.userForm.editing={};\n\t\tvm.userForm.saving={};\n\t\tvm.userForm.data = {};\n\t\tvm.userForm.feedback={\n\t\t\t\"type\":\"\",\n\t\t\t\"message\":\"\",\n\t\t}\n\t\t\n\n\t\tvm.userForm.cancel = function(field){\n\t\t\tvm.userForm.editing[field] = false;\n\t\t\tvm.user[field] = vm.userForm.data[field];\n\t\t};\n\t\t\n\t\tvm.userForm.editField = function(field){\n\t\t\tvm.userForm.data[field] = angular.copy(vm.user[field]);\n\t\t\tvm.userForm.editing[field]=true;\n\t\t\t\n\t\t}\n\t\t\n\t\t//Validation functions\n\t\tfunction validateEmail(email) {\n\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t    return re.test(email);\n\t\t}\n\t\t\n\t\tfunction validatePhoneNumber(inputtxt) {\n\t\t  var phoneno = /^\\+?([0-9]{2})\\)?[-. ]?([0-9]{4})[-. ]?([0-9]{4})$/;\n\t\t  return inputtxt.match(phoneno);\n\t\t}\n\t\t\n\t\tvm.userForm.validate = function(field, data){\n\t\t\t\n\t\t\tif (field == 'email'){\n\t\t\t\tif (validateEmail(data)) return true;\n\t\t\t\telse {\n\t\t\t\t\tmessages.set(\"Please enter a valid email address\", \"error\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\telse if (field == 'phoneNumber'){\n\t\t\t\tif (validatePhoneNumber(data)) return true;\n\t\t\t\telse {\n\t\t\t\t\tmessages.set(\"Please enter a valid phone number\", \"error\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\telse return true;\n\t\t}\n\n\t\t\n\t\tvm.userForm.save = function(field){\n\t\t\t//if (vm.user[field] == \"\") vm.user[field] = null;\n\t\t\tif (vm.userForm.validate(field, vm.user[field])){\n\t\t\t\tconsole.log(vm.user);\n\t\t\t\tuser.update(vm.user, function(result){\n\t\t\t\t\tvm.userForm.saving[field] = false;\n\t\t\t\t\tvm.userForm.editing[field] = false;\n\t\t\t\t\t//vm.userForm.data[field] = vm.user[field];\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t\n\n    \n   \t\n    \n    //Get user details and orders...\n //     var identityID = aws.getCurrentIdentityId();\n /*\n    if (!identityID){ $location.path('/'); }\n\t  else{\n\t\t\t\n\t  \t//Todo: Just get orders for user...\n\t\t\tbdAPI.call('ordersList', 100, function(result){\n\t\t\t\tvm.orders=result.data.items;\n\t\t\t});\t\n\t\t\t\t\n\t\t\tbdAPI.call('usersGet', identityID, function(result){\n\t\t\t\tloader.hide();\n\t\t\t\t//vm.user = result.data;\t\t\t\t\t\t\t\n\t\t\t\tvm.userForm.data = angular.copy(result.data);\t\n\t\t\t});\n\t\t\t\n\t\t\tvm.user = user.get();\n\t\t\t\n    }\n\t    \t*/\n\t    vm.user = user.get();\t\n\n\t    \t\n\t\t\t\t\n\t\t/*\n\t\t* Password Form\n\t\t*/\n\t\tvm.passForm = {\n\t\t\t\"editing\" : false,\n\t\t\t\"currentPass\" : \"\",\n\t\t\t\"newPass\": \"\",\n\t\t\t\"newPassConfirm\" : \"\",\n\t\t\t\"clear\": function(){\n\t\t\t\tvm.passForm.editing = false;\n\t\t\t\tvm.passForm.currentPass = \"\";\n\t\t\t\tvm.passForm.newPass = \"\";\n\t\t\t\tvm.passForm.newPassConfirm = \"\";\n\t\t\t\tmessages.reset();\n\t\t\t}\n\t\t};\n\t\t\n\t\t\n\t\tfunction validatePassword(password){\n\t\t\tvar re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\treturn re.test(password);\n\t\t}\n\t\t\n\t\tvm.validatePasswordForm = function(){\n\t\t\n\t\t\tif (!validatePassword(vm.passForm.newPass)){\n\t\t\t\tmessages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one uppercase letter</li><li>Contain at least one lowercase letter</li><li>Contain at least one special character (\\\"!,@,#,$,%,^,&, or *\\\")</li>\");\t\n\t\t\t}\n\t\t\t\n\t\t\tif (vm.passForm.newPass !== vm.passForm.newPassConfirm){\n\t\t\t\tmessages.set(\"New Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\t\n    vm.changePassword = function () {\n\t    messages.reset();\n\t    if (vm.validatePasswordForm()){\n\t\t    var passwordData ={\n\t\t\t    id:vm.user.id,\n\t\t\t    password:vm.passForm.newPass,\n\t\t\t    old_password:vm.passForm.currentPass\n\t\t\t  }\n\t\t\t\tuser.update(passwordData, function(result){\n\t\t\t\t\tvm.passForm.clear();\n\t\t\t\t\tmessages.set(\"Password successfully changed.\", \"success\");\n\t\t\t\t},\n\t\t\t\tfunction(err){\t\n\t\t\t\t\tmessages.set(err.message, \"error\");\n\t\t\t\t});\n\t\t  }\n    };\t\n\t\t\n\n\n\n\n\n\t\tvm.copyJean = function(jeanId){\n\t\t\tvm.jean = jean.createNew(vm.displayJean);\n\t\t\t$location.path('/customizer/'+jeanId+'/copy');\n\t\t}\n\t\t\n\t\tvm.displayJean={};\n\t\tvm.selectJean = function(jean){\n\t\t\tvm.popups.jeanProfile = true; \n\t\t\tvm.displayJean=jean\n\t\t}\n\t\t\n\t\tvm.selectOrder = function(order){\n\t\t\tvm.popups.orderProfile = true; \n\t\t\tvm.displayOrder=order;\n\t\t\tvm.displayJean = order.orderItems[0].jean;\n\t\t}\n\t\t\n\t\n\t\tfunction findJeanbyId(jeanId){\n\t\t\tfor (var j=0; j < vm.jeans.length; j++) {\n\t      if (vm.jeans[j].id === jeanId) return j;\n      }\n  \t}\n\n\t\tvm.deleteJean = function(jeanId){\n\t\t\tapi.call('deleteMyJean', jeanId, function(result){\n\t\t\t\tconsole.log(result);\n\t\t\t\tvar index = findJeanbyId(jeanId);\n\t\t\t\tvm.jeans.splice(index, 1);\n\t\t\t});\n\t\t}\n\t\t\n\t\tvm.orderJean = function(jeanId){\n\t\t\tconsole.log(\"going to order\");\n\t\t\t$location.path('/order/'+jeanId);\n\t\t}\n\t\n\t\t\t\n\n\n\t\n\t\t\n\t\t//Get User\n  }\n  \n\n\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('homeCtrl', homeCtrl);\n\t\t\t\n\t\thomeCtrl.$inject = ['$window', 'user', 'api'];\n\t\t\n\t\t\n    function homeCtrl ($window, user, api) { \t    \n\t\t\tvar vm = this;\n\t\t\n\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tvm.user = user.get();\n\t\t\tconsole.log($window.localStorage.getItem(\"bdAccessToken\"));\n\n\t    \t\n    }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('orderCtrl', orderCtrl);\n\n  orderCtrl.$inject = ['$window', '$location', 'jean','popups', '$filter', '$routeParams', 'user', 'api', '$scope', 'apiData', '$http'];\n  function orderCtrl($window, $location, jean, popups, $filter, $routeParams, user, api, $scope, apiData, $http) {\n\t  \n    var vm = this;\n    vm.popups=popups.get();\n    vm.tailors = apiData.tailors;\n\n\t\tfunction getPrimaryAddress(addresses){\n\t\t\tif(!addresses) return false;\n\t\t\tfor (var i=0; i<addresses.length; i++) {\n\t\t\t\tif (addresses[i].primary == true) return addresses[i].id;\n\t\t\t}\n\t\t\tconsole.log('no address marked as primary... returning first result');\n\t\t\treturn addresses[0].id;\n\t\t}\n\t\t\n\n\t\tvm.orderCreateObj = {}\n\t\tvm.user = {};\n\t\tvm.user = user.get();\t\t\n\t\t$scope.$watch('vm.user', function(newV) {\n\t\t\tvm.orderCreateObj.shipping_name = newV.first_name+\" \"+newV.last_name;\n\t\t\tvm.orderCreateObj.shipping_phone = newV.phone;\n\t\t\tvm.orderCreateObj.shipping_address_id = getPrimaryAddress(newV.addresses);\n    }, true);\n\n\t\t//Get user's orders\n\t\tvm.orders = [];\n\t\tapi.call('getMyOrders', null, function(result){\n\t\t\tvm.orders = result;\n\t\t});\n\t\t\n\t\tvar jeanId;\n\t\tif ($routeParams.jeanId) jeanId = $routeParams.jeanId;\n\t\tvar action = false;\n\t\tif ($routeParams.action) action = $routeParams.action;\t\t\n\t\tjean.setup(jeanId, action).then(function(result){\n\t\t\tvm.jeanData=jean.get();\t\n\t\t\tvm.orderCreateObj.jean_id = vm.jeanData.id;\n\t\t});\n\t\t\n\n\t\tvm.orderForm={};\n\t\tvm.orderForm.step=1;\n\n\n\t\tvm.goToCloset = function(){ $location.path('/closet'); }\n\t\tvm.startOver = function(){ \n\t\t\tjean.reset();\n\t\t\t$location.path('/customizer'); \n\t\t}\t\t\n\t\tvm.placeOrder = function(){\n\t\t\tapi.call('placeMyOrder', vm.orderCreateObj, function(result){\n\t\t\t\tvm.popups.orderPlaced=true;\n\t\t\t});\n\t\t}\n\n\t\tvm.chooseOrderType = function(type, copyItem){\n\t\t\t\n\t\t\tvm.orderCreateObj.order_type_id = type;\n\t\t\tif (type == 2 && !vm.orderCreateObj.tailor_id){\n\t\t\t\tvm.popups.tailors=true;\n\t\t\t}\n\t\t\t\n\t\t\t//Set order_item_copy\n\t\t\tif(type == 4){\n\t\t\t\tvm.orderCreateObj.copy_order_item_id = copyItem.id;\n\t\t\t\tvm.copyItem = copyItem;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdelete vm.orderCreateObj.copy_order_item_id;\t\n\t\t\t\tvm.copyItem = {};\n\t\t\t}\n\t\t}\n\t\t\n\t\tvm.measurementKeys = [\n\t\t\t\"waist\",\n\t\t\t\"seat_down\",\n\t\t\t\"seat_right\",\n\t\t\t\"rise\",\n\t\t\t\"full_rise\",\n\t\t\t\"thigh_upper_down\",\n\t\t\t\"thigh_upper_right\",\n\t\t\t\"thigh_middle_down\",\n\t\t\t\"thigh_middle_right\",\n\t\t\t\"thigh_lower_down\",\n\t\t\t\"thigh_lower_right\",\n\t\t\t\"outseam\",\n\t\t\t\"knee_up\",\n\t\t\t\"knee_right\", \n\t\t\t\"calf_up\",\n\t\t\t\"calf_right\",\n\t\t\t\"leg_opening\"\n\t\t];\n\t\t\n\t\tvm.hasMeasurements = function(order) {\n\n\t\t\tif (!order || !order.order_items.length ) return false;\n\t\t\t\n\t\t\tvar orderItem = order.order_items[0];\n\t\t\tvar testCols = [\n\t\t\t\t'outseam',\n\t\t\t\t'waist',\n\t\t\t\t'rise'\n\t\t\t];\n\t\t\tvar measurements = true;\n\t\t\tfor (i=0;i<testCols.length; i++){\n\t\t\t\tif (orderItem[testCols[i]] == \"\" || orderItem[testCols[i]] == null){\n\t\t\t\t\tmeasurements = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn measurements;\n\n\t\t};\n\t\t\n\t\tvm.orderForm.nextStep = function(){\n\t\t\t//Step 1 to Step 2\n\t\t\tif (vm.orderForm.step==1){\n\t\t\t\t//Make sure we've got a fit type\n\t\t\t\tif (!vm.orderCreateObj.order_type_id){ return false; }\n\t\t\t\t//If we're using a tailor, make sure we've got a tailor\n\t\t\t\tif (vm.orderCreateObj.order_type_id ==2 && !vm.orderCreateObj.tailor_id){\n\t\t\t\t\tvm.popups.tailors=true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\t\n\t\t\t\tvm.orderForm.step=2;\n\t\t\t\treturn;\n\t\t\t}\t\n\t\t}\n\n\t\tvm.editData = {};\n\t\t\n\t\tvm.editField = function(field){\n\t\t\tvm.editData[field] = angular.copy(vm.orderCreateObj[field]);\n\t\t}\n\t\t\n\t\tvm.revertField = function(field){\n\t\t\tvm.orderCreateObj[field] = angular.copy(vm.editData[field]);\n\t\t\tvm.editData[field] = false;\t\n\t\t}\n\t\t\n\t\t\n\n  }\n  \n\n\n\n})();","(function () {\n\n  angular\n  .module('bdApp')\n  .controller('loginCtrl', loginCtrl);\n\n\tloginCtrl.$inject = ['messages'];\n  function loginCtrl(messages) {\n    var vm = this;\n    \n    messages.reset();\n    vm.messages = messages.get();\n    \n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['messages'];\n  function registerCtrl(messages) {\n    var vm = this;\n\n\t\tmessages.reset();\n    vm.messages = messages.get();\n    vm.formStep=1;\n    \t\t\n/*    \t\t\t\t\t\n\t\t//Confirm User with Registration Code\t\t\t\t\n    vm.confirmUser = function() {\n\t\t\tvm.resetMessage();\n\t\t\taws.confirmRegisteredUnauthenticatedUser(vm.credentials.email, vm.credentials.code).then(\n      \tfunction(result){\n\t\t\t\t\tvm.setMessage($sce.trustAsHtml(\"Your Account has been confirmed. <a href='/login'>Click here to login</a>\"), \"success\");\n\t      },   \n\t      function(err){\n\t\t      if (err.message == \"Missing required key 'ConfirmationCode' in params\") err.message = \"Please enter confirmation code\";\n\t\t\t    vm.setMessage(err.message, \"error\");\n\t\t    }\n\t\t  );\n    };\n    \n    //Resend Registration code to user via email\n    vm.resendCode = function(){\n\t    //This function throws an error in the SDK and no result... cannot implement promise for now\n\t    aws.resendConfirmationCode(vm.credentials.email);\n\t    //We're going to show a success message no matter what\n\t    //TODO: Implement corrected SDK and promise structure for this functino\n\t    vm.setMessage(\"A new confirmation code has been sent to \"+vm.credentials.email+\". Enter the code above to confirm your account\", \"success\");\n    };\n\n*/\n  }\n\n})();"]}