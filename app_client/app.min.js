!function(){function e(e,t){e.when("/",{templateUrl:"/pages/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/pages/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/pages/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/closet",{templateUrl:"/pages/closet/closet.view.html",controller:"closetCtrl",controllerAs:"vm"}).when("/customizer/:jean_id?/:action?",{templateUrl:"/pages/customizer/customizer.view.html",controller:"customizerCtrl",controllerAs:"vm"}).when("/admin",{templateUrl:"/pages/admin/admin.view.html",controller:"adminCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}function t(e,t,r){e.$on("$routeChangeStart",function(e,n,o){var l=["/closets"];l.indexOf(t.path())>=0&&!r.isLoggedIn()})}angular.module("bdApp",["ngRoute","ngAnimate","angular-gestures"]),angular.module("bdApp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",t]).filter("spaceless",function(){return function(e){if(e)return e.replace(/\s+/g,"-")}}).filter("scoreToSpace",function(){return function(e){if(e)return e.replace(/_+/g," ")}}).filter("minMax",function(e,t,r){return function(n){return!(e&&n[r]<e)&&!(t&&n[r]>t)}}).filter("displayName",function(){return function(e){return!!e&&e.replace(/Raw Denim/g,"")}}).filter("listData",function(){return function(e){var t={},r=["fabric","accent_thread","top_thread","bottom_thread","gender","style"];for(key in e)r.indexOf(key)>=0&&(t[key]=e[key]);return t}})}();
!function(){function n(n,e){var o=function(n){e.localStorage["mean-token"]=n},t=function(){return e.localStorage["mean-token"]},i=function(){var n,o=t();return!!o&&(n=o.split(".")[1],n=e.atob(n),n=JSON.parse(n),n.exp>Date.now()/1e3)},r=function(){if(i()){var n=t();console.log(n);var o=n.split(".")[1];return o=e.atob(o),o=JSON.parse(o),{email:o.email,name:o.name}}},a=function(){if(i()){var n=t(),o=n.split(".")[1];o=e.atob(o),o=JSON.parse(o),console.log(o);var r=o.permissions;return r.indexOf("admin")!==-1}};return register=function(e){return n.post("/api/register",e).success(function(n){o(n.token)})},login=function(e){return n.post("/api/login",e).success(function(n){o(n.token)})},logout=function(){e.localStorage.removeItem("mean-token")},{isAdmin:a,currentUser:r,saveToken:o,getToken:t,isLoggedIn:i,register:register,login:login,logout:logout}}angular.module("bdApp").service("authentication",n),n.$inject=["$http","$window"]}();
!function(){function t(t,n){var e=function(){return t.get("/api/options",{headers:{Authorization:"Bearer "+n.getToken()}})},a=function(n,e){t.get("/data/chris-jeans.json").then(function(t){t.data;for(j=0;j<t.data.length;j++)if(t.data[j].id==n){console.log("jean found");var a=t.data[j]}e(a)})},r=function(n){return t.get("/data/chris-jeans.json")},o=function(){return t.get("/data/profile.json")},i=function(){return t.get("/data/styles.json")},s=function(){return t.get("/data/threads.json")},u=function(){return t.get("/data/buttons.json")},d=function(){return t.get("/data/fabrics.json")},g=function(){return t.get("/data/genders.json")};return{getJeanById:a,getJeansByUser:r,getProfile:o,getOptions:e,getStyles:i,getThreads:s,getHardware:u,getFabrics:d,getGenders:g}}angular.module("bdApp").service("meanData",t),t.$inject=["$http","authentication"]}();
!function(){function t(){return data={},set=function(t,a){this.data[t]=a},createNew=function(t){t?this.data={title:"Copy of "+t.data.title,gender:t.data.gender,style:t.data.style,fabric:t.data.fabric,accent_thread:t.data.accent_thread,top_thread:t.data.top_thread,bottom_thread:t.data.bottom_thread,id:Math.floor(1e9*Math.random())}:this.data={gender:1,style:1,fabric:"1004",accent_thread:"1",top_thread:"1",bottom_thread:"1",id:Math.floor(1e9*Math.random())}},{data:data,set:set,createNew:createNew}}angular.module("bdApp").service("jean",t)}();
!function(){function n(){return{denim:!1,hiw:!1,infoPop:!1,jeanProfile:!1}}angular.module("bdApp").service("popups",n)}();
function preloaderFunc(t,e){function i(e){this.imageLocations=e,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=t.defer(),this.promise=this.deferred.promise}return i.preloadImages=function(t){var e=new i(t);return e.load()},i.prototype={constructor:i,isInitiated:function(){return this.state!==this.states.PENDING},isRejected:function(){return this.state===this.states.REJECTED},isResolved:function(){return this.state===this.states.RESOLVED},load:function(){if(this.isInitiated())return this.promise;this.state=this.states.LOADING;for(var t=0;t<this.imageCount;t++)this.loadImageLocation(this.imageLocations[t]);return this.promise},handleImageError:function(t){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(t))},handleImageLoad:function(t){this.loadCount++,this.isRejected()||(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:t}),this.loadCount===this.imageCount&&(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)))},loadImageLocation:function(t){var i=this,s=angular.element(new Image).bind("load",function(t){e.$apply(function(){i.handleImageLoad(t.target.src),i=s=t=null})}).bind("error",function(t){e.$apply(function(){i.handleImageError(t.target.src),i=s=t=null})}).attr("src",t)}},i}angular.module("bdApp").factory("preloader",preloaderFunc),preloaderFunc.$inject=["$q","$rootScope"];
!function(){function e(e,t,o,r,l,n){function a(e,t,o){e=e[0],t=t-e.offsetWidth/2+40;var r=e.scrollWidth-e.offsetWidth;t>=r&&(t=r-1),t==r&&(t=r-1);var l=Math.ceil(o/15),n=t-e.scrollLeft,a=n/l,c=e.scrollLeft<t?function(e,t){return e<=t-1}:function(e,t){return e>=t+1},s=setInterval(function(){if(c(e.scrollLeft,t)){var o=e.scrollLeft+a;o>=r&&(o=r-1),e.scrollLeft=o}else clearInterval(s)},15)}var c=this;c.popups=n,c.jean=l,c.breakPoint=800,c.selectorCoords={top:0,left:0},e.$watch("active",function(l,n){1==l&&o(function(){var o=e.step.jeanKey+"_"+c.jean.data[e.step.jeanKey],l=angular.element(document.querySelector("#"+o));c.selectorCoords.top=l.prop("offsetTop"),c.selectorCoords.left=l.prop("offsetLeft");var n=angular.element(document.querySelector("#"+e.step.jeanKey+"-selector"));if(n.css({top:c.selectorCoords.top+"px",left:c.selectorCoords.left+"px"}),r.innerWidth<c.breakPoint){var a=angular.element(t[0].querySelector(".chooser-grid")),s=a[0]?c.selectorCoords.left-a[0].offsetWidth/2+40:0;a.prop("scrollLeft",s)}else{var a=angular.element(t[0]);a.prop("scrollTop",c.selectorCoords.top-15)}},200)}),c.selectAttr=function(e,t,l,n){var s=angular.element(document.querySelector("#"+l+"-chooser")),n=angular.element(document.querySelector("#"+l+"-selector")),f=angular.element(e.target).prop("offsetTop"),p=angular.element(e.target).prop("offsetLeft"),u=angular.element(document.querySelectorAll("#item-title"));u.css({right:"-400px",opacity:0}),n.css({top:f+"px",left:p+"px"}),c.selectorCoords={top:f,left:p},r.innerWidth<c.breakPoint&&a(s,p,200),o(function(){u.css({right:"15px",opacity:1}),c.jean.data[l]=t},200)},c.jeanSet=function(e,t){c.jean.data[e]=t}}angular.module("bdApp").controller("chooserCtrl",e),e.$inject=["$scope","$element","$timeout","$window","jean","popups"]}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/choosers/chooser.template.html",controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="}}}angular.module("bdApp").directive("chooser",e)}();
!function(){angular.module("bdApp").directive("fabricChooser",["$window",function(e){return{restrict:"EA",template:'<div class="fabric-chooser-container" ng-include="viewUrl"></div>',controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="},link:function(i){function t(){var t=e.innerWidth;t<i.breakPoint?i.viewUrl="/directives/choosers/fabric-chooser.template-mobile.html":t>=i.breakPoint&&(i.viewUrl="/directives/choosers/fabric-chooser.template-desk.html")}i.breakPoint=800,e.onresize=function(){t(),i.$apply()},t(),i.weightFilter=function(e,i){return function(t){return!(e&&t.weight<e)&&!(i&&t.weight>i)}}}}}])}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/choosers/gender-chooser.template.html",controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="}}}angular.module("bdApp").directive("genderChooser",e)}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/choosers/style-chooser.template.html",controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="},link:function(e){e.checkGenderFilter=function(e){return function(t){return!!t["images_"+e]}}}}}angular.module("bdApp").directive("styleChooser",e)}();
!function(){angular.module("bdApp").directive("jeanList",[function(){return{restrict:"EA",templateUrl:"/directives/jean-list/jean-list.template.html",scope:{jean:"="},link:function(e){}}}])}();
!function(){function t(t,e,o,r){var n=this;n.jean=r,n.centerPan=!1,n.zoom=!1,n.pan={x:50,y:30},n.isMobile=function(){return t.innerWidth<800},n.toggleZoom=function(){n.zoom=!n.zoom},n.touchEnd=function(){n.dragTracker={x:0,y:0},e.$apply()},n.returnPan=function(){return!n.isMobile()&&(n.pan="50% 30% 0",n.centerPan=!0,images=angular.element(document.querySelectorAll("#zoom-frame img")),void setTimeout(function(){images.css({"transform-origin":n.pan})},200))},n.touchStart=function(t){n.swipeStart={x:t.touches[0].clientX,y:t.touches[0].clientY},n.swipe={}},n.zoomDrag={x:0,y:0},n.dragTracker={x:0,y:0},n.touchMove=function(t){var o=angular.element(document.querySelectorAll("#zoom-frame img"));if(!n.isMobile())return!1;if(!n.zoom)return!1;t.preventDefault();var r=t.touches[0],i=r.target,a={x:r.clientX-n.swipeStart.x,y:r.clientY-n.swipeStart.y},c=a.x-n.dragTracker.x,l=a.y-n.dragTracker.y,c=c/i.clientWidth*100+n.zoomDrag.x,l=l/i.clientHeight*100+n.zoomDrag.y,g={y:{},x:{}};g.y.top=60,g.y.bottom=-90,g.x.left=-120,g.x.right=90,l>g.y.top&&(l=g.y.top),l<g.y.bottom&&(l=g.y.bottom),c<g.x.left&&(c=g.x.left),c>g.x.right&&(c=g.x.right);var m={x:c,y:l};n.zoomDrag=m;var f=-c+"% "+-l+"% 0";o.css({"transform-origin":f}),n.dragTracker=a,e.$apply()},n.dragPan=function(t,e){if(console.log(e.direction),!n.isMobile())return!1;if(!n.zoom)return!1;var o=angular.element(document.querySelectorAll("#zoom-frame img")),r=(window.innerHeight,o[0].height,{width:e.target.clientWidth,height:e.target.clientHeight}),i={x:e.deltaX,y:e.deltaY},a=i.x-n.dragTracker.x,c=i.y-n.dragTracker.y;console.log(a,c);var a=Math.abs(a)/r.width*100;a=i.x<0?-a:a;var c=Math.abs(c)/r.height*100;c=i.y<0?-c:c,a+=n.zoomDrag.x,c+=n.zoomDrag.y;var l={y:{},x:{}};l.y.top=60,l.y.bottom=-90,l.x.left=-150,l.x.right=60,c>l.y.top&&(c=l.y.top),c<l.y.bottom&&(c=l.y.bottom),a<l.x.left&&(a=l.x.left),a>l.x.right&&(a=l.x.right);var g={x:a,y:c};console.log(g),n.zoomDrag=g;var m=-a+"% "+-c+"% 0";o.css({"transform-origin":m}),n.dragTracker=e.isFinal?{x:0,y:0}:i},n.scanImage=function(e,o){setTimeout(function(){n.centerPan=!1},200),frame=angular.element(document.querySelector("#zoom-frame"))[0],fWidth=frame.clientWidth,fHeight=frame.clientHeight,rect=frame.getBoundingClientRect(),rootDoc=frame.ownerDocument.documentElement,offsetT=rect.top+t.pageYOffset-rootDoc.clientTop,offsetL=rect.left+t.pageXOffset-rootDoc.clientLeft,xPosition=(e-offsetL)/fWidth*100,yPosition=(o-offsetT)/fHeight*100,t.innerWidth<n.breakPoint?pan=100-xPosition+"% "+(100-yPosition)+"% 0":pan=xPosition+"% "+yPosition+"% 0",n.pan=pan,images=angular.element(document.querySelectorAll("#zoom-frame img")),images.css({"transform-origin":pan})},n.trackMouse=function(t){n.scanImage(t.pageX,t.pageY)}}angular.module("bdApp").controller("istackCtrl",t),t.$inject=["$window","$scope","$q","jean"]}();
!function(){function t(){return{restrict:"AE",templateUrl:"/directives/image-stack/image-stack.template.html",controller:"istackCtrl as isvm",link:function(t,n,c,i){n.on("touchstart",function(n){t.isvm.touchStart(n)}),n.on("touchmove",function(n){t.isvm.touchMove(n)}),n.on("touchend",function(n){t.isvm.touchEnd(n)})}}}angular.module("bdApp").directive("imageStack",t)}();
!function(){function o(o,n,t,i){var r=this;r.isLoggedIn=n.isLoggedIn(),r.isAdmin=n.isAdmin(),r.currentUser=n.currentUser(),r.drops={},r.drops.acct=!1,r.mobileMenu=!1,r.logout=function(){n.logout(),"/"==o.path()&&t.reload()}}angular.module("bdApp").controller("navigationCtrl",o),o.$inject=["$location","authentication","$route","popups"]}();
!function(){function t(){return{restrict:"EA",templateUrl:"/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("bdApp").directive("navigation",t)}();
!function(){function e(e,n){e.imagesLoaded=!1,n.preloadImages(e.slides).then(function(){e.imagesLoaded=!0},function(){console.log("error loading imgaes...")}),e.currentIndex=0,e.setCurrentSlideIndex=function(n){e.currentIndex=n},e.isCurrentSlideIndex=function(n){return e.currentIndex===n},e.nextSlide=function(){e.currentIndex=e.currentIndex<e.slides.length-1?++e.currentIndex:0},e.prevSlide=function(){e.currentIndex=e.currentIndex>0?--e.currentIndex:e.slides.length-1}}angular.module("bdApp").controller("sliderCtrl",e),e.$inject=["$scope","preloader"]}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/slider/slider.template.html",controller:"sliderCtrl as slvm",scope:{slides:"=",imageClick:"&"}}}angular.module("bdApp").directive("slider",e)}();
!function(){function o(o,n){var l=this;l.user={},n.getOptions().success(function(o){console.log("admin.controller.jsln16:::"),console.log(o)}).error(function(o){console.log(o)})}angular.module("bdApp").controller("adminCtrl",o),o.$inject=["$location","meanData"]}();
!function(){function e(e,t,n,a,o){var s=this;s.popups=a,s.user={},s.jeans=[],s.jean={},s.data={},s.jean=t,s.setupData=function(e,t){n[e]().success(function(e){s.data[t]=e}).error(function(e){console.log(e)})},s.setupData("getGenders","genders"),s.setupData("getStyles","styles"),s.setupData("getFabrics","fabrics"),s.setupData("getThreads","threads"),s.dataLookup=function(e,t,n){if("undefined"==typeof e||"undefined"==typeof t)return!1;n=n||null;var a=e.includes("thread")?"threads":e+"s",c=s.data[a];return selected=o("filter")(c,{id:t})[0],n?selected[n]:selected},s.copyJean=function(){s.jean=t.createNew(s.jean),e.path("/customizer")},s.selectJean=function(e){console.log(e),console.log(s.jean),s.popups.jeanProfile=!0,s.jean.data=e},n.getJeansByUser(1).success(function(e){for(x=0;x<e.length;x++)s.jeans.push(e[x])}).error(function(e){console.log(e)}),n.getProfile().success(function(e){s.user=e}).error(function(e){console.log(e)})}angular.module("bdApp").controller("closetCtrl",e),e.$inject=["$location","jean","meanData","popups","$filter"]}();
!function(){function e(e,t,a,n,r,i,o,d,l,c){function p(){var e=navigator.userAgent.toLowerCase(),t=e.indexOf("android")>-1;if(t){if(0==window.orientation||180==window.orientation)return!0;if(90==window.orientation||window.orientation==-90)return!1}else{if(90==window.orientation||window.orientation==-90)return!0;if(0==window.orientation||180==window.orientation)return!1}}var s=this;s.landscape=p();var u="onorientationchange"in window,f=u?"orientationchange":"resize";window.addEventListener(f,function(){s.landscape=p(),l.$apply()},!1),s.popups=c,i.jean_id&&"copy"==i.action?d.createNew(i.jean_id):i.jean_id&&!i.action?o.getJeanById(i.jean_id,function(e){d.data=e}):0===Object.keys(d.data).length&&d.data.constructor===Object&&d.createNew(),s.jean=d,s.panel=[],s.panel.push({panelTemplate:"gender-chooser",dataKey:"genders",title:"Gender",jeanKey:"gender"}),s.panel.push({panelTemplate:"style-chooser",dataKey:"styles",title:"Style",jeanKey:"style"}),s.panel.push({panelTemplate:"fabric-chooser",dataKey:"fabrics",title:"Fabric",jeanKey:"fabric"}),s.panel.push({panelTemplate:"chooser",dataKey:"threads",title:"Top Thread",jeanKey:"top_thread"}),s.panel.push({panelTemplate:"chooser",dataKey:"threads",title:"Bottom Thread",jeanKey:"bottom_thread"}),s.panel.push({panelTemplate:"chooser",dataKey:"threads",title:"Accent Thread",jeanKey:"accent_thread"}),s.panel.push({panelTemplate:"list",title:"Overview"}),s.panelDir="next",s.panelStep=0,s.changeStep=function(e){return!(e>=s.panel.length)&&(!(e<0)&&(void 0!==e&&(s.panelStep=e,void(e+1!=s.panel.length&&s.updateActiveItem()))))},s.activeItem={},s.updateActiveItem=function(){var e=s.data[s.panel[s.panelStep].dataKey],a=s.jean.data[s.panel[s.panelStep].jeanKey],n=t("filter")(e,{id:a})[0];s.activeItem=n},s.styleByGender=function(e){return function(t){return t["images_"+e]}},s.dataLookup=function(e,a,n){if("undefined"==typeof e||"undefined"==typeof a)return!1;n=n||null;var r=t("filter")(s.panel,{jeanKey:e});if(r.length<1)return!1;var i="gender"==e||"style"==e?e+"s":t("filter")(s.panel,{jeanKey:e})[0].dataKey,o=s.data[i];return dataById=t("filter")(o,{id:a}),"undefined"!=typeof dataById&&(selected=dataById[0],console.log(selected),n?selected[n]:selected)},s.data={},s.getData=function(t,a){var n=e.defer();return o[t]().then(function(e){s.data[a]=e.data,n.resolve(!0)}),n.promise},e.all([s.getData("getGenders","genders"),s.getData("getStyles","styles"),s.getData("getFabrics","fabrics"),s.getData("getThreads","threads")]).then(function(e){l.$watch(function(){return s.jean.data},function(e,t){s.updateActiveItem()},!0)}),s.createThumb=function(){function t(t){return e(function(e,a){var r=new Image;r.src=t,r.onload=function(){n.drawImage(r,0,0,600,696),e(r)},r.onerror=function(e){a(e)}})}var a=document.createElement("canvas");a.width=600,a.height=600;for(var n=a.getContext("2d"),r=[],i=document.getElementsByClassName("zoomed-image"),o=0;o<i.length;o++){var d=i[o];r.push(t(d.src))}return e.all(r).then(function(e){var t=a.toDataURL("image/jpeg");window.open(t)})}}angular.module("bdApp").controller("customizerCtrl",e),e.$inject=["$q","$filter","$timeout","$location","$window","$routeParams","meanData","jean","$scope","popups"]}();
!function(){function n(n,a,e){n.jean=a.data}angular.module("bdApp").controller("homeCtrl",n),n.$inject=["$scope","jean","$animate"]}();
!function(){function e(e,n){var o=this;o.errors={message:""},o.credentials={email:"",password:""},o.onSubmit=function(){o.errors.message="",n.login(o.credentials).error(function(e){console.log(e),o.errors.message=e.message}).then(function(){e.path("closet")})}}angular.module("bdApp").controller("loginCtrl",e),e.$inject=["$location","authentication"]}();
!function(){function e(e,n){var o=this;o.credentials={name:"",email:"",password:""},o.errors={message:""},o.onSubmit=function(){console.log("Submitting registration"),n.register(o.credentials).error(function(e){console.log(e),o.errors.message=e.message}).then(function(){e.path("profile")})}}angular.module("bdApp").controller("registerCtrl",e),e.$inject=["$location","authentication"]}();
//# sourceMappingURL=app.min.js.map
