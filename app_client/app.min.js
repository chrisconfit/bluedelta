!function(){function e(e,t){e.when("/",{templateUrl:"/pages/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/pages/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/pages/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/closet",{templateUrl:"/pages/closet/closet.view.html",controller:"closetCtrl",controllerAs:"vm"}).when("/customizer",{templateUrl:"/pages/customizer/customizer.view.html",controller:"customizerCtrl",controllerAs:"vm"}).when("/admin",{templateUrl:"/pages/admin/admin.view.html",controller:"adminCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}function t(e,t,r){e.$on("$routeChangeStart",function(e,n,o){var l=["/closet"];l.indexOf(t.path())>=0&&!r.isLoggedIn()})}angular.module("bdApp",["ngRoute","ngAnimate","angular-gestures"]),angular.module("bdApp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",t]).filter("spaceless",function(){return function(e){if(e)return e.replace(/\s+/g,"-")}}).filter("scoreToSpace",function(){return function(e){if(e)return e.replace(/_+/g," ")}}).filter("minMax",function(e,t,r){return function(n){return!(e&&n[r]<e)&&!(t&&n[r]>t)}}).filter("displayName",function(){return function(e){return e.replace(/Raw Denim/g,"")}})}();
!function(){function e(e,n,o,t){var r=o.createUserPool(t.poolInfo);console.log(r);var i=function(e){n.localStorage["mean-token"]=e},a=function(){return n.localStorage["mean-token"]},s=function(){var e,o=a();return!!o&&(e=o.split(".")[1],e=n.atob(e),e=JSON.parse(e),e.exp>Date.now()/1e3)},u=function(){if(s()){var e=a();console.log(e);var o=e.split(".")[1];return o=n.atob(o),o=JSON.parse(o),{email:o.email,name:o.name}}},c=function(){if(s()){var e=a(),o=e.split(".")[1];o=n.atob(o),o=JSON.parse(o),console.log(o);var t=o.permissions;return t.indexOf("admin")!==-1}};return ragister=function(){return o.registerUser},register=function(n){return e.post("/api/register",n).success(function(e){i(e.token)})},login=function(n){return e.post("/api/login",n).success(function(e){i(e.token)})},logout=function(){n.localStorage.removeItem("mean-token")},{ragister:ragister,isAdmin:c,currentUser:u,saveToken:i,getToken:a,isLoggedIn:s,register:register,login:login,logout:logout}}angular.module("bdApp").service("authentication",e),e.$inject=["$http","$window","aws","awsConfig"]}();
!function(){function e(e,r){return createUserPool=function(e){var r=new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(e);return r},registerUser=function(e,r,o,n){console.log("insid");var t=null;e.signUp(r,o,n,t,function(e,r){if(e)return void alert(e);var o=r.user;console.log("user name is "+o.getUsername())})},{createUserPool:createUserPool,registerUser:registerUser}}angular.module("bdApp").service("aws",e),e.$inject=["$http","$window"]}();
!function(){function n(n,o){var e="us-east-1";AWSCognito.config.region=e;var i={UserPoolId:"us-east-1_LOGu3QxlG",ClientId:"722lmps6diglhvjek6gmrk4g69"};return{poolInfo:i,region:e}}angular.module("bdApp").service("awsConfig",n),n.$inject=["$http","$window"]}();
!function(){function t(t,e){var n=function(){return t.get("/api/profile",{headers:{Authorization:"Bearer "+e.getToken()}})},r=function(){return t.get("/api/options",{headers:{Authorization:"Bearer "+e.getToken()}})},a=function(){return t.get("/data/styles.json")},o=function(){return t.get("/data/threads.json")},i=function(){return t.get("/data/buttons.json")},u=function(){return t.get("/data/fabrics.json")},s=function(){return t.get("/data/genders.json")};return{getProfile:n,getOptions:r,getStyles:a,getThreads:o,getHardware:i,getFabrics:u,getGenders:s}}angular.module("bdApp").service("meanData",t),t.$inject=["$http","authentication"]}();
!function(){function t(){return data={},set=function(t,a){this.data[t]=a},{data:data,set:set}}angular.module("bdApp").service("jean",t)}();
!function(){function n(){return{denim:!1,hiw:!1,infoPop:!1}}angular.module("bdApp").service("popups",n)}();
function preloaderFunc(t,e){function i(e){this.imageLocations=e,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=t.defer(),this.promise=this.deferred.promise}return i.preloadImages=function(t){var e=new i(t);return e.load()},i.prototype={constructor:i,isInitiated:function(){return this.state!==this.states.PENDING},isRejected:function(){return this.state===this.states.REJECTED},isResolved:function(){return this.state===this.states.RESOLVED},load:function(){if(this.isInitiated())return this.promise;this.state=this.states.LOADING;for(var t=0;t<this.imageCount;t++)this.loadImageLocation(this.imageLocations[t]);return this.promise},handleImageError:function(t){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(t))},handleImageLoad:function(t){this.loadCount++,this.isRejected()||(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:t}),this.loadCount===this.imageCount&&(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)))},loadImageLocation:function(t){var i=this,s=angular.element(new Image).bind("load",function(t){e.$apply(function(){i.handleImageLoad(t.target.src),i=s=t=null})}).bind("error",function(t){e.$apply(function(){i.handleImageError(t.target.src),i=s=t=null})}).attr("src",t)}},i}angular.module("bdApp").factory("preloader",preloaderFunc),preloaderFunc.$inject=["$q","$rootScope"];
!function(){function e(e,t,o,r,n,l){function c(e,t,o){e=e[0],t=t-e.offsetWidth/2+40;var r=e.scrollWidth-e.offsetWidth;t>=r&&(t=r-1),t==r&&(t=r-1);var n=Math.ceil(o/15),l=t-e.scrollLeft,c=l/n,a=e.scrollLeft<t?function(e,t){return e<=t-1}:function(e,t){return e>=t+1},s=setInterval(function(){if(a(e.scrollLeft,t)){var o=e.scrollLeft+c;o>=r&&(o=r-1),e.scrollLeft=o}else clearInterval(s)},15)}var a=this;a.popups=l,a.jean=n,a.breakPoint=800,a.selectorCoords={top:0,left:0},e.$watch("active",function(e,n){1==e&&o(function(){if(r.innerWidth<a.breakPoint){var e=angular.element(t[0].querySelector(".chooser-grid")),o=e[0]?a.selectorCoords.left-e[0].offsetWidth/2+40:0;e.prop("scrollLeft",o)}else{var e=angular.element(t[0]);e.prop("scrollTop",a.selectorCoords.top-15)}},200)}),a.selectAttr=function(e,t,n,l){var s=angular.element(document.querySelector("#"+n+"-chooser")),l=angular.element(document.querySelector("#"+n+"-selector")),i=angular.element(e.target).prop("offsetTop"),f=angular.element(e.target).prop("offsetLeft"),u=angular.element(document.querySelectorAll("#item-title"));u.css({right:"-400px",opacity:0}),l.css({top:i+"px",left:f+"px"}),a.selectorCoords={top:i,left:f},r.innerWidth<a.breakPoint&&c(s,f,200),o(function(){u.css({right:"15px",opacity:1}),a.jean.data[n]=t},200)},a.jeanSet=function(e,t){a.jean.data[e]=t}}angular.module("bdApp").controller("chooserCtrl",e),e.$inject=["$scope","$element","$timeout","$window","jean","popups"]}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/choosers/chooser.template.html",controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="}}}angular.module("bdApp").directive("chooser",e)}();
!function(){angular.module("bdApp").directive("fabricChooser",["$window",function(e){return{restrict:"EA",template:'<div class="fabric-chooser-container" ng-include="viewUrl"></div>',controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="},link:function(i){function t(){var t=e.innerWidth;t<i.breakPoint?i.viewUrl="/directives/choosers/fabric-chooser.template-mobile.html":t>=i.breakPoint&&(i.viewUrl="/directives/choosers/fabric-chooser.template-desk.html")}i.breakPoint=800,e.onresize=function(){t(),i.$apply()},t(),i.weightFilter=function(e,i){return function(t){return!(e&&t.weight<e)&&!(i&&t.weight>i)}}}}}])}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/choosers/gender-chooser.template.html",controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="}}}angular.module("bdApp").directive("genderChooser",e)}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/choosers/style-chooser.template.html",controller:"chooserCtrl as chvm",scope:{step:"=",dataset:"=",active:"="},link:function(e){e.checkGenderFilter=function(e){return function(t){return!!t["images_"+e]}}}}}angular.module("bdApp").directive("styleChooser",e)}();
!function(){function t(t,e,o){var r=this;r.jean=o,r.centerPan=!1,r.zoom=!1,r.pan={x:50,y:30},r.isMobile=function(){return t.innerWidth<800},r.toggleZoom=function(){r.zoom=!r.zoom},r.touchEnd=function(){r.dragTracker={x:0,y:0},e.$apply()},r.returnPan=function(){return!r.isMobile()&&(r.pan="50% 30% 0",r.centerPan=!0,images=angular.element(document.querySelectorAll("#zoom-frame img")),void setTimeout(function(){images.css({"transform-origin":r.pan})},200))},r.touchStart=function(t){r.swipeStart={x:t.touches[0].clientX,y:t.touches[0].clientY},r.swipe={}},r.zoomDrag={x:0,y:0},r.dragTracker={x:0,y:0},r.touchMove=function(t){var o=angular.element(document.querySelectorAll("#zoom-frame img"));if(!r.isMobile())return!1;if(!r.zoom)return!1;t.preventDefault();var n=t.touches[0],i=n.target,a={x:n.clientX-r.swipeStart.x,y:n.clientY-r.swipeStart.y},c=a.x-r.dragTracker.x,l=a.y-r.dragTracker.y,c=c/i.clientWidth*100+r.zoomDrag.x,l=l/i.clientHeight*100+r.zoomDrag.y,g={y:{},x:{}};g.y.top=60,g.y.bottom=-90,g.x.left=-120,g.x.right=90,l>g.y.top&&(l=g.y.top),l<g.y.bottom&&(l=g.y.bottom),c<g.x.left&&(c=g.x.left),c>g.x.right&&(c=g.x.right);var m={x:c,y:l};r.zoomDrag=m;var f=-c+"% "+-l+"% 0";o.css({"transform-origin":f}),r.dragTracker=a,e.$apply()},r.dragPan=function(t,e){if(console.log(e.direction),!r.isMobile())return!1;if(!r.zoom)return!1;var o=angular.element(document.querySelectorAll("#zoom-frame img")),n=(window.innerHeight,o[0].height,{width:e.target.clientWidth,height:e.target.clientHeight}),i={x:e.deltaX,y:e.deltaY},a=i.x-r.dragTracker.x,c=i.y-r.dragTracker.y;console.log(a,c);var a=Math.abs(a)/n.width*100;a=i.x<0?-a:a;var c=Math.abs(c)/n.height*100;c=i.y<0?-c:c,a+=r.zoomDrag.x,c+=r.zoomDrag.y;var l={y:{},x:{}};l.y.top=60,l.y.bottom=-90,l.x.left=-150,l.x.right=60,c>l.y.top&&(c=l.y.top),c<l.y.bottom&&(c=l.y.bottom),a<l.x.left&&(a=l.x.left),a>l.x.right&&(a=l.x.right);var g={x:a,y:c};console.log(g),r.zoomDrag=g;var m=-a+"% "+-c+"% 0";o.css({"transform-origin":m}),r.dragTracker=e.isFinal?{x:0,y:0}:i},r.scanImage=function(e,o){setTimeout(function(){r.centerPan=!1},200),frame=angular.element(document.querySelector("#zoom-frame"))[0],fWidth=frame.clientWidth,fHeight=frame.clientHeight,rect=frame.getBoundingClientRect(),rootDoc=frame.ownerDocument.documentElement,offsetT=rect.top+t.pageYOffset-rootDoc.clientTop,offsetL=rect.left+t.pageXOffset-rootDoc.clientLeft,xPosition=(e-offsetL)/fWidth*100,yPosition=(o-offsetT)/fHeight*100,t.innerWidth<r.breakPoint?pan=100-xPosition+"% "+(100-yPosition)+"% 0":pan=xPosition+"% "+yPosition+"% 0",r.pan=pan,images=angular.element(document.querySelectorAll("#zoom-frame img")),images.css({"transform-origin":pan})},r.trackMouse=function(t){r.scanImage(t.pageX,t.pageY)}}angular.module("bdApp").controller("istackCtrl",t),t.$inject=["$window","$scope","jean"]}();
!function(){function t(){return{restrict:"AE",templateUrl:"/directives/image-stack/image-stack.template.html",controller:"istackCtrl as isvm",link:function(t,n,c,i){n.on("touchstart",function(n){t.isvm.touchStart(n)}),n.on("touchmove",function(n){t.isvm.touchMove(n)}),n.on("touchend",function(n){t.isvm.touchEnd(n)})}}}angular.module("bdApp").directive("imageStack",t)}();
!function(){function o(o,n,t,i){var r=this;r.isLoggedIn=n.isLoggedIn(),r.isAdmin=n.isAdmin(),r.currentUser=n.currentUser(),r.drops={},r.drops.acct=!1,r.mobileMenu=!1,r.logout=function(){n.logout(),"/"==o.path()&&t.reload()}}angular.module("bdApp").controller("navigationCtrl",o),o.$inject=["$location","authentication","$route","popups"]}();
!function(){function t(){return{restrict:"EA",templateUrl:"/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("bdApp").directive("navigation",t)}();
!function(){function e(e,n){e.imagesLoaded=!1,n.preloadImages(e.slides).then(function(){e.imagesLoaded=!0},function(){console.log("error loading imgaes...")}),e.currentIndex=0,e.setCurrentSlideIndex=function(n){e.currentIndex=n},e.isCurrentSlideIndex=function(n){return e.currentIndex===n},e.nextSlide=function(){e.currentIndex=e.currentIndex<e.slides.length-1?++e.currentIndex:0},e.prevSlide=function(){e.currentIndex=e.currentIndex>0?--e.currentIndex:e.slides.length-1}}angular.module("bdApp").controller("sliderCtrl",e),e.$inject=["$scope","preloader"]}();
!function(){function e(){return{restrict:"EA",templateUrl:"/directives/slider/slider.template.html",controller:"sliderCtrl as slvm",scope:{slides:"=",imageClick:"&"}}}angular.module("bdApp").directive("slider",e)}();
!function(){function o(o,n){var l=this;l.user={},n.getOptions().success(function(o){console.log("admin.controller.jsln16:::"),console.log(o)}).error(function(o){console.log(o)})}angular.module("bdApp").controller("adminCtrl",o),o.$inject=["$location","meanData"]}();
!function(){function o(o,n){var e=this;e.user={},n.getProfile().success(function(o){e.user=o}).error(function(o){console.log(o)})}angular.module("bdApp").controller("closetCtrl",o),o.$inject=["$location","meanData"]}();
!function(){function e(e,t,a,n,r,i,o,d,l){function p(){var e=navigator.userAgent.toLowerCase(),t=e.indexOf("android")>-1;if(t){if(0==window.orientation||180==window.orientation)return!0;if(90==window.orientation||window.orientation==-90)return!1}else{if(90==window.orientation||window.orientation==-90)return!0;if(0==window.orientation||180==window.orientation)return!1}}var c=this;c.landscape=p();var s="onorientationchange"in window,u=s?"orientationchange":"resize";window.addEventListener(u,function(){c.landscape=p(),d.$apply()},!1),c.popups=l,c.jean=o,c.jean.selectStyle=function(e){c.jean.data.style=e},c.jean.data.gender=c.jean.data.gender||1,c.jean.data.style=c.jean.data.style||1,c.jean.data.fabric=c.jean.data.fabric||"1004",c.jean.data.accent_thread=c.jean.data.accent_thread||"1",c.jean.data.top_thread=c.jean.data.top_thread||"1",c.jean.data.bottom_thread=c.jean.data.bottom_thread||"1",c.panel=[],c.panel.push({panelTemplate:"gender-chooser",dataKey:"genders",title:"Gender",jeanKey:"gender"}),c.panel.push({panelTemplate:"style-chooser",dataKey:"styles",title:"Style",jeanKey:"style"}),c.panel.push({panelTemplate:"fabric-chooser",dataKey:"fabrics",title:"Fabric",jeanKey:"fabric"}),c.panel.push({panelTemplate:"chooser",dataKey:"threads",title:"Top Thread",jeanKey:"top_thread"}),c.panel.push({panelTemplate:"chooser",dataKey:"threads",title:"Bottom Thread",jeanKey:"bottom_thread"}),c.panel.push({panelTemplate:"chooser",dataKey:"threads",title:"Accent Thread",jeanKey:"accent_thread"}),c.panel.push({panelTemplate:"list",title:"Overview"}),c.panelDir="next",c.panelStep=0,c.changeStep=function(e){return!(e>=c.panel.length)&&(!(e<0)&&(void 0!==e&&(c.panelStep=e,void(e+1!=c.panel.length&&c.updateActiveItem()))))},c.activeItem={},c.updateActiveItem=function(){var e=c.data[c.panel[c.panelStep].dataKey],a=c.jean.data[c.panel[c.panelStep].jeanKey],n=t("filter")(e,{id:a})[0];c.activeItem=n},c.styleByGender=function(e){return function(t){return t["images_"+e]}},c.dataLookup=function(e,a,n){if("undefined"==typeof e||"undefined"==typeof a)return!1;n=n||null;var r="gender"==e||"style"==e?e+"s":t("filter")(c.panel,{jeanKey:e})[0].dataKey,i=c.data[r];return selected=t("filter")(i,{id:a})[0],n?selected[n]:selected},c.data={},c.getData=function(t,a){var n=e.defer();return i[t]().then(function(e){c.data[a]=e.data,n.resolve(!0)}),n.promise},e.all([c.getData("getGenders","genders"),c.getData("getStyles","styles"),c.getData("getFabrics","fabrics"),c.getData("getThreads","threads")]).then(function(e){d.$watch(function(){return c.jean.data},function(e,t){c.updateActiveItem()},!0)})}angular.module("bdApp").controller("customizerCtrl",e),e.$inject=["$q","$filter","$timeout","$location","$window","meanData","jean","$scope","popups"]}();
!function(){function n(n,a,e){n.jean=a.data}angular.module("bdApp").controller("homeCtrl",n),n.$inject=["$scope","jean","$animate"]}();
!function(){function e(e,n){var o=this;o.errors={message:""},o.credentials={email:"",password:""},o.onSubmit=function(){o.errors.message="",n.login(o.credentials).error(function(e){console.log(e),o.errors.message=e.message}).then(function(){e.path("closet")})}}angular.module("bdApp").controller("loginCtrl",e),e.$inject=["$location","authentication"]}();
!function(){function e(e,o,r,n){var t=this,s=r.createUserPool(n.poolInfo);console.log("userPool from registerCtrl => ",s),t.credentials={name:"",email:"",password:""},t.errors={message:""},t.onSubmit=function(){console.log("Submitting registration"),o.ragister().register(t.credentials).error(function(e){console.log(e),t.errors.message=e.message}).then(function(){e.path("profile")})}}angular.module("bdApp").controller("registerCtrl",e),e.$inject=["$location","authentication","aws","awsConfig"]}();
//# sourceMappingURL=app.min.js.map
