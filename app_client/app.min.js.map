{"version":3,"sources":["app.min.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","authentication","$on","event","nextRoute","currentRoute","locked","indexOf","path","isLoggedIn","angular","module","adminCtrl","meanData","vm","this","user","getOptions","success","data","console","log","error","e","$inject","closetCtrl","getProfile","customizerCtrl","jean","form","step","steps","template","title","nextStep","homeCtrl","$scope","loginCtrl","errors","message","credentials","email","password","onSubmit","login","err","then","registerCtrl","name","register","$http","$window","saveToken","token","localStorage","getToken","payload","split","atob","JSON","parse","exp","Date","now","currentUser","isAdmin","roles","permissions","post","logout","removeItem","service","get","headers","Authorization","set","property","value","navigationCtrl","$route","reload","navigation","restrict","directive"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('meanApp', ['ngRoute']);\n\n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: 'home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/register', {\n        templateUrl: '/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/closet', {\n        templateUrl: '/closet/closet.view.html',\n        controller: 'closetCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/customizer', {\n        templateUrl: '/customizer/customizer.view.html',\n        controller: 'customizerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/admin', {\n        templateUrl: '/admin/admin.view.html',\n        controller: 'adminCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n  }\n\n  function run($rootScope, $location, authentication) {\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n\t    var locked = [\n\t\t    '/closet'\n\t    ];\n\t    \n\t    if (locked.indexOf($location.path()) >= 0  && !authentication.isLoggedIn()) {\n       // $location.path('/login');\n      }\n    });\n  }\n  \n  angular\n    .module('meanApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'authentication', run]);\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('adminCtrl', adminCtrl);\n\n  adminCtrl.$inject = ['$location', 'meanData'];\n  function adminCtrl($location, meanData) {\n\t  \n\t  \n    var vm = this;\n\n    vm.user = {};\n    meanData.getOptions()\n      .success(function(data) {\n\t      console.log(\"admin.controller.jsln16:::\");\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('closetCtrl', closetCtrl);\n\n  closetCtrl.$inject = ['$location', 'meanData'];\n  function closetCtrl($location, meanData) {\n    var vm = this;\n\n    vm.user = {};\n\n    meanData.getProfile()\n      .success(function(data) {\n        vm.user = data;\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('builderCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['$location', 'meanData', 'jean'];\n  function customizerCtrl($location, meanData, jean) {\n    var vm = this;\n\t\tvm.jean = jean;\n\t\t\n\t\tvm.form = {};\n    \n    vm.jean.step = (jean.step ? jean.step : 1);\n\n\t\tvm.form.steps = [];\n    vm.form.steps[1] = {\n\t    \"template\": \"/customizer/form-templates/gender.html\",\n\t    \"title\" : \"Gender\"\n    };\n    vm.form.steps[2] = {\n\t    \"template\": \"/customizer/form-templates/style.html\",\n\t    \"title\" : \"Style\"\n    };\n    vm.form.steps[3] = {\n\t    \"template\": \"/customizer/form-templates/build.html\",\n\t    \"title\" : \"Build\"\n    };\n\n    vm.form.nextStep = function(){\n\t    vm.jean.step =\tvm.jean.step + 1;\n\t    \n    }\n    \n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('customizerCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['$location', 'meanData', 'jean'];\n  function customizerCtrl($location, meanData, jean) {\n    var vm = this;\n\t\tvm.jean = jean;\n\t\t\n\t\tvm.form = {};\n    \n    vm.jean.step = (jean.step ? jean.step : 1);\n\n\t\tvm.form.steps = [];\n    vm.form.steps[1] = {\n\t    \"template\": \"/customizer/form-templates/gender.html\",\n\t    \"title\" : \"Gender\"\n    };\n    vm.form.steps[2] = {\n\t    \"template\": \"/customizer/form-templates/style.html\",\n\t    \"title\" : \"Style\"\n    };\n    vm.form.steps[3] = {\n\t    \"template\": \"/customizer/form-templates/build.html\",\n\t    \"title\" : \"Build\"\n    };\n\n    vm.form.nextStep = function(){\n\t    vm.jean.step =\tvm.jean.step + 1;\n\t    \n    }\n    \n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('homeCtrl', homeCtrl);\n\t\t\t\n\t\thomeCtrl.$inject = ['$scope','jean'];\n\n\t\t\n    function homeCtrl ($scope, jean) {\n\t    \n\t    $scope.jean = jean.data;\n\t    \n      console.log('Home controller is running');\n    }\n\n})();\n(function () {\n\n  angular\n  .module('meanApp')\n  .controller('loginCtrl', loginCtrl);\n\n  loginCtrl.$inject = ['$location', 'authentication'];\n  function loginCtrl($location, authentication) {\n    var vm = this;\n\t\t\n\t\tvm.errors = {\n\t\t\tmessage : \"\"\n\t\t}\n\t\t\n    vm.credentials = {\n      email : \"\",\n      password : \"\"\n    };\n\n    vm.onSubmit = function () {\n\t    vm.errors.message = \"\";\n      authentication\n        .login(vm.credentials)\n        .error(function(err){\n          console.log(err);\n          vm.errors.message = err.message;\n        })\n        .then(function(){\n          $location.path('closet');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['$location', 'authentication'];\n  function registerCtrl($location, authentication) {\n    var vm = this;\n\n    vm.credentials = {\n      name : \"\",\n      email : \"\",\n      password : \"\"\n    };\n    \n    vm.errors = {\n\t\t\tmessage : \"\"\n\t\t}\n\n    vm.onSubmit = function () {\n      console.log('Submitting registration');\n      authentication\n        .register(vm.credentials)\n        .error(function(err){\n          //alert(err);\n          console.log(err);\n          vm.errors.message = err.message;\n        })\n        .then(function(){\n          $location.path('profile');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .service('authentication', authentication);\n\n  authentication.$inject = ['$http', '$window'];\n  function authentication ($http, $window) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function() {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      } else {\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        console.log(token);\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        return {\n          email : payload.email,\n          name : payload.name\n        };\n      }\n    };\n\t\t\n\t\tvar isAdmin = function(){\n\t\t\tif(isLoggedIn()){\n        var token = getToken();\n\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        console.log(payload);\n        var roles = payload.permissions;\n\t\t\t\treturn roles.indexOf('admin') !== -1;\n      }\n\n\t\t}\n    register = function(user) {\n      return $http.post('/api/register', user).success(function(data){\n        saveToken(data.token);\n      });\n    };\n\n    login = function(user) {\n      return $http.post('/api/login', user).success(function(data) {\n        saveToken(data.token);\n      });\n    };\n\n    logout = function() {\n      $window.localStorage.removeItem('mean-token');\n    };\n\n    return {\n\t    isAdmin : isAdmin,\n      currentUser : currentUser,\n      saveToken : saveToken,\n      getToken : getToken,\n      isLoggedIn : isLoggedIn,\n      register : register,\n      login : login,\n      logout : logout\n    };\n  }\n\n\n})();\n(function() {\n\n  angular\n    .module('meanApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n    \n    var getOptions = function () {\t    \n      return $http.get('/api/options', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\n    return {\n      getProfile : getProfile,\n      getOptions : getOptions,\n    };\n  }\n\n})();\n\n(function() {\n\n  angular\n    .module('meanApp')\n    .service('jean', jean);\n\n  function jean() {\n\n   \tdata = {};\n\t\t\n\t\tset = function(property, value){\n\t\t\tthis.data[property] = value;\n\t\t}\n\t\t\n    return {\n      data : data,\n      set : set\n    };\n    \n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','authentication','$route'];\n  function navigationCtrl($location, authentication, $route) {\n    var vm = this;\n\n    vm.isLoggedIn = authentication.isLoggedIn();\n\t\tvm.isAdmin = authentication.isAdmin();\n    vm.currentUser = authentication.currentUser();\n\t\t\n\t\tvm.logout = function(){\n\t\t\tauthentication.logout();\n\t\t\tif ($location.path() == \"/\")\n\t\t\t\t$route.reload();\n\t\t}\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/common/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();"]}