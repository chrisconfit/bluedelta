{"version":3,"sources":["app.min.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","authentication","$on","event","nextRoute","currentRoute","locked","indexOf","path","isLoggedIn","angular","module","adminCtrl","meanData","vm","this","user","getOptions","success","data","console","log","error","e","$inject","closetCtrl","getProfile","customizerCtrl","jean","form","currentStep","steps","template","title","nextStep","homeCtrl","loginCtrl","errors","message","credentials","email","password","onSubmit","login","err","then","registerCtrl","name","register","$http","$window","saveToken","token","localStorage","getToken","payload","split","atob","JSON","parse","exp","Date","now","currentUser","isAdmin","roles","permissions","post","logout","removeItem","service","get","headers","Authorization","navigationCtrl","$route","reload","navigation","restrict","directive"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('meanApp', ['ngRoute']);\n\n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: 'home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/register', {\n        templateUrl: '/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/closet', {\n        templateUrl: '/closet/closet.view.html',\n        controller: 'closetCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/customizer', {\n        templateUrl: '/customizer/customizer.view.html',\n        controller: 'customizerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/admin', {\n        templateUrl: '/admin/admin.view.html',\n        controller: 'adminCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n  }\n\n  function run($rootScope, $location, authentication) {\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n\t    var locked = [\n\t\t    '/closet'\n\t    ];\n\t    \n\t    if (locked.indexOf($location.path()) >= 0  && !authentication.isLoggedIn()) {\n       // $location.path('/login');\n      }\n    });\n  }\n  \n  angular\n    .module('meanApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'authentication', run]);\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('adminCtrl', adminCtrl);\n\n  adminCtrl.$inject = ['$location', 'meanData'];\n  function adminCtrl($location, meanData) {\n\t  \n\t  \n    var vm = this;\n\n    vm.user = {};\n    meanData.getOptions()\n      .success(function(data) {\n\t      console.log(\"admin.controller.jsln16:::\");\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('closetCtrl', closetCtrl);\n\n  closetCtrl.$inject = ['$location', 'meanData'];\n  function closetCtrl($location, meanData) {\n    var vm = this;\n\n    vm.user = {};\n\n    meanData.getProfile()\n      .success(function(data) {\n        vm.user = data;\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('customizerCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['$location', 'meanData'];\n  function customizerCtrl($location, meanData) {\n    var vm = this;\n\t\t\n\t\tvm.jean = {}\n\t\tvm.form = {};\n    vm.form.currentStep = 1;\n\t\tvm.form.steps = [];\n    vm.form.steps[1] = {\n\t    \"template\": \"/customizer/form-templates/gender.html\",\n\t    \"title\" : \"Gender\"\n    };\n    vm.form.steps[2] = {\n\t    \"template\": \"/customizer/form-templates/style.html\",\n\t    \"title\" : \"Style\"\n    };\n    vm.form.steps[3] = {\n\t    \"template\": \"/customizer/form-templates/build.html\",\n\t    \"title\" : \"Build\"\n    };\n\n    vm.form.nextStep = function(){\n\t    vm.form.currentStep =\tvm.form.currentStep + 1;\n    }\n    \n  }\n\n})();\n(function() {\n  \n  angular\n    .module('meanApp')\n    .controller('homeCtrl', homeCtrl);\n\n    function homeCtrl () {\n      console.log('Home controller is running');\n    }\n\n})();\n(function () {\n\n  angular\n  .module('meanApp')\n  .controller('loginCtrl', loginCtrl);\n\n  loginCtrl.$inject = ['$location', 'authentication'];\n  function loginCtrl($location, authentication) {\n    var vm = this;\n\t\t\n\t\tvm.errors = {\n\t\t\tmessage : \"\"\n\t\t}\n\t\t\n    vm.credentials = {\n      email : \"\",\n      password : \"\"\n    };\n\n    vm.onSubmit = function () {\n\t    vm.errors.message = \"\";\n      authentication\n        .login(vm.credentials)\n        .error(function(err){\n          console.log(err);\n          vm.errors.message = err.message;\n        })\n        .then(function(){\n          $location.path('closet');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['$location', 'authentication'];\n  function registerCtrl($location, authentication) {\n    var vm = this;\n\n    vm.credentials = {\n      name : \"\",\n      email : \"\",\n      password : \"\"\n    };\n    \n    vm.errors = {\n\t\t\tmessage : \"\"\n\t\t}\n\n    vm.onSubmit = function () {\n      console.log('Submitting registration');\n      authentication\n        .register(vm.credentials)\n        .error(function(err){\n          //alert(err);\n          console.log(err);\n          vm.errors.message = err.message;\n        })\n        .then(function(){\n          $location.path('profile');\n        });\n    };\n\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .service('authentication', authentication);\n\n  authentication.$inject = ['$http', '$window'];\n  function authentication ($http, $window) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function() {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      } else {\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        console.log(token);\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        return {\n          email : payload.email,\n          name : payload.name\n        };\n      }\n    };\n\t\t\n\t\tvar isAdmin = function(){\n\t\t\tif(isLoggedIn()){\n        var token = getToken();\n\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        console.log(payload);\n        var roles = payload.permissions;\n\t\t\t\treturn roles.indexOf('admin') !== -1;\n      }\n\n\t\t}\n    register = function(user) {\n      return $http.post('/api/register', user).success(function(data){\n        saveToken(data.token);\n      });\n    };\n\n    login = function(user) {\n      return $http.post('/api/login', user).success(function(data) {\n        saveToken(data.token);\n      });\n    };\n\n    logout = function() {\n      $window.localStorage.removeItem('mean-token');\n    };\n\n    return {\n\t    isAdmin : isAdmin,\n      currentUser : currentUser,\n      saveToken : saveToken,\n      getToken : getToken,\n      isLoggedIn : isLoggedIn,\n      register : register,\n      login : login,\n      logout : logout\n    };\n  }\n\n\n})();\n(function() {\n\n  angular\n    .module('meanApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n    \n    var getOptions = function () {\t    \n      return $http.get('/api/options', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\n    return {\n      getProfile : getProfile,\n      getOptions : getOptions,\n    };\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','authentication','$route'];\n  function navigationCtrl($location, authentication, $route) {\n    var vm = this;\n\n    vm.isLoggedIn = authentication.isLoggedIn();\n\t\tvm.isAdmin = authentication.isAdmin();\n    vm.currentUser = authentication.currentUser();\n\t\t\n\t\tvm.logout = function(){\n\t\t\tauthentication.logout();\n\t\t\tif ($location.path() == \"/\")\n\t\t\t\t$route.reload();\n\t\t}\n  }\n\n})();\n(function () {\n\n  angular\n    .module('meanApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/common/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();"]}