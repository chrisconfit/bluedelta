{"version":3,"sources":["main.js","config/config-overrides-generated.js","services/authentication.service.js","services/aws.service.js","services/bdapi.service.js","services/config.service.js","services/data.service.js","services/jean.service.js","services/popups.service.js","services/preloader.factory.js","directives/choosers/chooser.controller.js","directives/choosers/chooser.directive.js","directives/choosers/fabric-chooser.directive.js","directives/choosers/gender-chooser.directive.js","directives/choosers/style-chooser.directive.js","directives/jean-list-delete/jean-list.directive.js","directives/image-stack/image-stack.controller.js","directives/image-stack/image-stack.directive.js","directives/navigation/navigation.controller.js","directives/navigation/navigation.directive.js","directives/slider/slider.controller.js","directives/slider/slider.directive.js","pages/admin/admin.controller.js","pages/closet/closet.controller.js","pages/customizer/customizer.controller.js","pages/home/home.controller.js","pages/auth/login/login.controller.js","pages/auth/register/register.controller.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","aws","$on","event","nextRoute","currentRoute","locked","indexOf","path","getCurrentUserFromLocalStorage","then","result","err","angular","module","filter","input","replace","min","max","key","retObj","display","configOverridesGenerated","REGION","PROFILE_IMAGES_S3_BUCKET","API_ENDPOINT","USER_POOL_ID","CLIENT_ID","IDENTITY_POOL_ID","authentication","$http","$window","$q","saveToken","token","localStorage","getToken","isLoggedIn","payload","split","atob","JSON","parse","exp","Date","now","currentUser","console","log","email","name","isAdmin","roles","permissions","register","userDetails","login","user","authenticateCognitoUser","password","logout","removeItem","service","$inject","AWSConfig","_getUserPool","poolData","UserPoolId","ClientId","userPool","AWSCognito","CognitoIdentityServiceProvider","CognitoUserPool","_getAuthenticationDetails","uname","pword","authenticationData","Username","Password","authenticationDetails","AuthenticationDetails","_getCognitoUser","upool","userData","Pool","cognitoUser","CognitoUser","_buildAttribute","keyName","value","attribute","Name","Value","CognitoUserAttribute","_buildAttributeList","attributeBuilder","obj","attrToAdd","attrList","push","_parseIdentityId","jwt","idTokenPayload","sub","_getAWSCredentials","idToken","defer","logins","AWS","update","region","credentials","CognitoIdentityCredentials","IdentityPoolId","Logins","needsRefresh","clearCachedId","get","reject","resolve","promise","getUserFromLocalStorage","username","getSession","session","alert","isValid","deleteCognitoUser","getCurrentUser","deleteUser","authenticateViaFB","FB","response","authResponse","graph.facebook.com","accessToken","authenticateUser","onSuccess","getAccessToken","getJwtToken","jwtToken","onFailure","newPasswordRequired","userAttributes","requiredAttributes","signupForApplication","emailAddress","attributeList","signUp","updateAttributesOnUser","updateAttributes","deleteUserAttributes","deleteAttributes","verifyUserAttribute","attributeName","getAttributeVerificationCode","inputVerificationCode","verificationCode","prompt","verifyAttribute","this","retrieveUserAttributes","getUserAttributes","i","length","getName","getValue","resendConfirmationCode","confirmRegistration","confirmationCode","changePassword","oldPassword","newPassword","forgotPasswordFlow","forgotPassword","confirmPassword","signUserOut","signOut","signCurrentUserOut","signUserOutGlobally","globalSignOut","confirmRegisteredUnauthenticatedUser","userName","saveImageTos3","image","userTokens","userIdentityID","bucketName","s3bucket","S3","params","Bucket","Key","encodeURIComponent","Body","upload","data","bdAPI","$httpParamSerializer","_thirdParty","BlueDeltaApi","API","Client","DefaultApi","injector","jsonData","getJeansByUser","userId","getProfile","getStyles","getThreads","getHardware","getFabrics","getGenders","getJeanById","id","callback","j","ret","meanData","getOptions","headers","Authorization","jean","set","property","createNew","constructor","Object","title","gender","style","fabric","accent_thread","top_thread","bottom_thread","Math","floor","random","popups","denim","hiw","infoPop","jeanProfile","preloaderFunc","Preloader","imageLocations","imageCount","loadCount","errorCount","states","PENDING","LOADING","RESOLVED","REJECTED","state","deferred","preloadImages","preloader","load","prototype","isInitiated","isRejected","isResolved","loadImageLocation","handleImageError","imageLocation","handleImageLoad","notify","percent","ceil","element","Image","bind","$apply","target","src","attr","factory","chooserCtrl","$scope","$element","$timeout","scrollToLeft","el","scrollTo","scrollDuration","offsetWidth","maxLeft","scrollWidth","stepNum","distance","scrollLeft","scrollStep","scrollTest","a","b","scrollInterval","setInterval","newScroll","clearInterval","chvm","breakPoint","selectorCoords","top","left","$watch","newValue","oldValue","step","jeanKey","activeElement","document","querySelector","prop","selector","css","innerWidth","chooser","selectAttr","$event","text","querySelectorAll","right","opacity","jeanSet","val","restrict","scope","dataset","active","directive","template","link","changeTemplate","screenWidth","viewUrl","onresize","weightFilter","weight","genderChooser","styleChooser","checkGenderFilter","istackCtrl","isvm","centerPan","zoom","pan","x","y","isMobile","toggleZoom","touchEnd","dragTracker","returnPan","images","setTimeout","transform-origin","touchStart","e","swipeStart","touches","clientX","clientY","swipe","zoomDrag","touchMove","preventDefault","touch","drag","clientWidth","clientHeight","bounds","bottom","move","dragPan","u","direction","frame","window","innerHeight","height","width","deltaX","deltaY","abs","isFinal","scanImage","fWidth","fHeight","rect","getBoundingClientRect","rootDoc","ownerDocument","documentElement","offsetT","pageYOffset","clientTop","offsetL","pageXOffset","clientLeft","xPosition","yPosition","trackMouse","pageX","pageY","imageStack","ele","attrs","ctrl","on","navigationCtrl","$route","vm","drops","acct","mobileMenu","reload","navigation","sliderCtrl","imagesLoaded","slides","currentIndex","setCurrentSlideIndex","index","isCurrentSlideIndex","nextSlide","prevSlide","slider","imageClick","adminCtrl","success","error","closetCtrl","$filter","jeans","defaultHeaders_","setUpClosetData","userID","usersGet","setupData","func","dataKey","dataLookup","includes","dataSet","selected","copyJean","selectJean","customizerCtrl","$routeParams","landscapeDetect","ua","navigator","userAgent","toLowerCase","isAndroid","orientation","parseURLkey","jeanKeytoURL","loadImage","cntxt","onload","drawImage","onerror","landscape","supportsOrientationChange","orientationEvent","addEventListener","jean_id","action","jeanData","d","parts","match","parseInt","keys","jeanToUrl","url","location","origin","hasOwnProperty","urlKey","panel","panelTemplate","panelDir","panelStep","changeStep","undefined","updateActiveItem","activeItem","styleByGender","dataInfo","dataById","getData","res","all","current","original","saveJean","createThumb","imageURL","canvas","createElement","getContext","promises","imagesElements","getElementsByClassName","results","dataUrl","toDataURL","homeCtrl","$animate","loginCtrl","messages","message","type","reset","validateLoginForm","validateEmail","re","test","loginFB","onSubmit","errors","registerCtrl","$sce","formStep","setMessage","resetMessage","validateRegistrationForm","validatePassword","passwordConfirm","registerUser","confirmUser","code","trustAsHtml","resendCode"],"mappings":"CAAA,WAKE,QAASA,GAAQC,EAAgBC,GAC/BD,EACGE,KAAK,KACJC,YAAa,6BACbC,WAAY,WACZC,aAAc,OAEfH,KAAK,aACJC,YAAa,0CACbC,WAAY,eACZC,aAAc,OAEfH,KAAK,UACJC,YAAa,oCACbC,WAAY,YACZC,aAAc,OAEfH,KAAK,WACJC,YAAa,iCACbC,WAAY,aACZC,aAAc,OAEfH,KAAK,kCACJC,YAAa,yCACbC,WAAY,iBACZC,aAAc,OAEfH,KAAK,UACJC,YAAa,+BACbC,WAAY,YACZC,aAAc,OAEfC,WAAWC,WAAY,MAG1BN,EAAkBO,WAAU,GAI9B,QAASC,GAAIC,EAAYC,EAAWC,GAClCF,EAAWG,IAAI,oBAAqB,SAASC,EAAOC,EAAWC,GAC9D,GAAIC,IACH,UAEGA,GAAOC,QAAQP,EAAUQ,SAAW,GACvCP,EAAIQ,iCAAiCC,KACpC,SAASC,GACR,OAAO,GAET,SAASC,GACRZ,EAAUQ,KAAK,cArDpBK,QAAQC,OAAO,SAAU,UAAW,YAAY,aAAc,qBA4D9DD,QACGC,OAAO,SACP1B,QAAQ,iBAAkB,oBAAqBA,IAC/CU,KAAK,aAAc,YAAa,MAAOA,IACzCiB,OAAO,YAAY,WACjB,MAAO,UAASC,GACd,GAAIA,EACH,MAAOA,GAAMC,QAAQ,OAAQ,QAIlCF,OAAO,eAAe,WACpB,MAAO,UAASC,GACd,GAAIA,EACH,MAAOA,GAAMC,QAAQ,MAAO,QAIjCF,OAAO,SAAS,SAASG,EAAKC,EAAKC,GACnC,MAAO,UAASJ,GACf,QAAIE,GAAOF,EAAMI,GAAOF,MACpBC,GAAOH,EAAMI,GAAOD,MAIzBJ,OAAO,cAAc,WACrB,MAAO,UAASC,GACf,QAAOA,GAAQA,EAAMC,QAAQ,aAAc,OAI5CF,OAAO,WAAW,WAClB,MAAO,UAASC,GACf,GAAIK,MACAC,GACH,SACA,gBACA,aACA,gBACA,SACA,QAGD,KAAKF,MAAOJ,GACPM,EAAQf,QAAQa,MAAM,IACzBC,EAAOD,KAAOJ,EAAMI,KAEtB,OAAOC;CC3GX,WAEA,KAAME,IACJC,OAAU,YACVC,yBAA4B,gEAC5BC,aAAgB,qEAChBC,aAAgB,sBAChBC,UAAa,6BACbC,iBAAoB,iDAGtB,OAAON;CCbP,WAOE,QAASO,GAAgBC,EAAOC,EAAS/B,EAAKgC,GAE5C,GAAIC,GAAY,SAAUC,GACxBH,EAAQI,aAAa,cAAgBD,GAGnCE,EAAW,WACb,MAAOL,GAAQI,aAAa,eAG1BE,EAAa,WACf,GACIC,GADAJ,EAAQE,GAGZ,SAAGF,IACDI,EAAUJ,EAAMK,MAAM,KAAK,GAC3BD,EAAUP,EAAQS,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,GAEdA,EAAQK,IAAMC,KAAKC,MAAQ,MAMlCC,EAAc,WAChB,GAAGT,IAAa,CACd,GAAIH,GAAQE,GACZW,SAAQC,IAAId,EACZ,IAAII,GAAUJ,EAAMK,MAAM,KAAK,EAG/B,OAFAD,GAAUP,EAAQS,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,IAEnBW,MAAQX,EAAQW,MAChBC,KAAOZ,EAAQY,QAMnBC,EAAU,WACb,GAAGd,IAAa,CACX,GAAIH,GAAQE,IAERE,EAAUJ,EAAMK,MAAM,KAAK,EAC/BD,GAAUP,EAAQS,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,GACrBS,QAAQC,IAAIV,EACZ,IAAIc,GAAQd,EAAQe,WACxB,OAAOD,GAAM9C,QAAQ,gBAWnBgD,EAAW,SAASC,IAkBtB,OATAC,OAAQ,SAASC,GAEhBzD,EAAI0D,wBAAwBD,EAAME,WAGnCC,OAAS,WACP7B,EAAQI,aAAa0B,WAAW,gBAOjCV,QAAUA,EACTL,YAAcA,EACdb,UAAYA,EACZG,SAAWA,EACXC,WAAaA,EACbiB,SAAWA,EACXE,MAAQA,MACRI,OAASA,QA9FbhD,QACGC,OAAO,SACPiD,QAAQ,iBAAkBjC,GAE7BA,EAAekC,SAAW,QAAS,UAAW,MAAO;CCNvD,WAOE,QAAS/D,GAAK8B,EAAOC,EAASC,EAAIgC,GAEhC,QAASC,KACP,GAAIC,IAAaC,WAAaH,EAAUtC,aAAc0C,SAAWJ,EAAUrC,WACvE0C,EAAW,GAAIC,YAAWC,+BAA+BC,gBAAgBN,EAC7E,OAAOG,GAGT,QAASI,GAA0BC,EAAOC,GACxC,GAAIC,IACFC,SAAWH,EACXI,SAAWH,GAETI,EAAwB,GAAIT,YAAWC,+BAA+BS,sBAAsBJ,EAChG,OAAOG,GAGT,QAASE,GAAgBP,EAAOQ,GAC9B,GAAIC,IAAaN,SAAWH,EAAOU,KAAOF,GACtCG,EAAc,GAAIf,YAAWC,+BAA+Be,YAAYH,EAC5E,OAAOE,GAGT,QAASE,GAAgBC,EAASC,GAChC,GAAIC,IACFC,KAAMH,EACNI,MAAOH,GAEL/E,EAAS,GAAI4D,YAAWC,+BAA+BsB,qBAAqBH,EAChF,OAAOhF,GAGT,QAASoF,GAAoBC,EAAkBC,GAC7C,GACIC,GADAC,IAEJ,KAAK,GAAI/E,KAAO6E,GACdC,EAAYF,EAAiB5E,EAAK6E,EAAI7E,IACtC+E,EAASC,KAAKF,EAEhB,OAAOC,GAGT,QAASE,GAAiBC,GACzB,GAAIC,GAAiBD,EAAI9D,MAAM,KAAK,EACtC,OAAOE,MAAKC,MAAMF,KAAK8D,IAAiBC,IAGzC,QAASC,GAAmBC,GAC3B,GAAIC,GAAQ1E,EAAG0E,QACXC,IA4BJ,OA3BAA,GAAO,eAAiB3C,EAAUzC,OAAS,kBAAoByC,EAAUtC,cAAc+E,EAEvFG,IAAIzH,OAAO0H,QACVC,OAAQ9C,EAAUzC,OAClBwF,YAAa,GAAIH,KAAII,4BACpBC,eAAgBjD,EAAUpC,iBAC1BsF,OAASP,MAILC,IAAIzH,OAAO4H,YAAYI,gBACzBP,IAAIzH,OAAO4H,YAAYK,gBACvBR,IAAIzH,OAAO4H,YAAYM,IAAI,SAAS1G,GAC9BA,GACF+F,EAAMY,OAAO3G,GAEf+F,EAAMa,aAGRX,IAAIzH,OAAO4H,YAAYM,IAAI,SAAS1G,GAC9BA,GACF+F,EAAMY,OAAO3G,GAEf+F,EAAMa,YAILb,EAAMc,QAuVZ,MAnVAC,yBAA0B,SAASC,GACjC,GAAIrC,GAAcJ,EAAgByC,EAAUzD,IACzB,OAAfoB,GACAA,EAAYsC,WAAW,SAAShH,EAAKiH,GACjC,MAAIjH,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,qBAAuB4E,EAAQE,cAKrDC,kBAAoB,WAClB,GAAI1C,GAAcpB,IAAe+D,gBACjC3C,GAAY4C,WAAW,SAAStH,EAAKD,GACnC,MAAIC,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,gBAAkBtC,MAKpCwH,kBAAoB,WAEnB,GAAIxB,GAAQ1E,EAAG0E,OAiBf,OAfAyB,IAAG3E,MAAM,SAAU4E,GACbA,EAASC,cACXzB,IAAIzH,OAAO4H,YAAc,GAAIH,KAAII,4BAC/BC,eAAgBjD,EAAUpC,iBAC1BsF,QACEoB,qBAAsBF,EAASC,aAAaE,eAIhD7B,EAAMa,WAENb,EAAMY,OAAO,mDAIVZ,EAAMc,SAGZ9D,wBAA0B,SAASgE,EAAU/D,GAC3C,GAAIoB,GAAwBN,EAA0BiD,EAAU/D,GAC5D0B,EAAcJ,EAAgByC,EAAUzD,KAExCyC,EAAQ1E,EAAG0E,OA2Bf,OAxBArB,GAAYmD,iBAAiBzD,GAC3B0D,UAAW,SAAU/H,GACxBgG,EAAMa,QAAQ7G,GACdqC,QAAQC,IAAI,kBAAoBtC,EAAOgI,iBAAiBC,eAExD5F,QAAQC,IAAI,aAAetC,EAAO+F,QAAQmC,WAEvCC,UAAW,SAASlI,GAClB+F,EAAMY,OAAO3G,IAEfmI,oBAAqB,SAASC,EAAgBC,GAIjDjG,QAAQC,IAAI+F,EAAgBC,MAUpBtC,EAAMc,SAIfyB,qBAAuB,SAASC,EAAcvF,GAE7C,GAAI+C,GAAQ1E,EAAG0E,QAEVyC,EAAgBrD,EAAoBP,GAAkBtC,MAAOiG,GAOjE,OALAjF,KAAemF,OAAOF,EAAcvF,EAAUwF,EAAe,KAAM,SAASxI,EAAKD,GAC3EC,EAAK+F,EAAMY,OAAO3G,GACjB+F,EAAMa,QAAQ7G,KAGdgG,EAAMc,SAGf6B,uBAAyB,SAAS3B,EAAU1B,GAC1C,GAAImD,GAAgBrD,EAAoBP,EAAiBS,GACrDX,EAAgBJ,EAAgByC,EAAUzD,IAC9CoB,GAAYiE,iBAAiBH,EAAe,SAASxI,EAAKD,GACtD,MAAIC,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,gBAAkBtC,MAIpC6I,qBAAuB,SAASlE,EAAa8D,GAC3C9D,EAAYmE,iBAAiBL,EAAe,SAASxI,EAAKD,GACtD,MAAIC,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,gBAAkBtC,MAIpC+I,oBAAsB,SAASpE,EAAaqE,GACxCrE,EAAYsE,6BAA6BD,GACvCjB,UAAW,SAAU/H,GACjBqC,QAAQC,IAAI,gBAAkBtC,IAElCmI,UAAW,SAASlI,GAChBkH,MAAMlH,IAEViJ,sBAAuB,WACnB,GAAIC,GAAmBC,OAAO,mCAAoC,GAClEzE,GAAY0E,gBAAgBL,EAAeG,EAAkBG,UAKvEC,uBAAyB,SAAS5E,GAChCA,EAAY6E,kBAAkB,SAASvJ,EAAKD,GACxC,GAAIC,EAEA,WADAkH,OAAMlH,EAGV,KAAKwJ,EAAI,EAAGA,EAAIzJ,EAAO0J,OAAQD,IAC3BpH,QAAQC,IAAI,aAAetC,EAAOyJ,GAAGE,UAAY,cAAgB3J,EAAOyJ,GAAGG,eAKrFC,uBAAyB,SAASlF,GAC7BA,EAAYkF,yBAEhBlF,EAAcJ,EAAgBI,EAAapB,MAG1CoB,EAAYkF,uBAAuB,SAAS5J,EAAKD,GAG/C,OAAIC,OACFoC,SAAQC,IAAIrC,MASnB6J,oBAAsB,SAASnF,EAAaoF,GACzCpF,EAAYmF,oBAAoBC,GAAkB,EAAM,SAAS9J,EAAKD,GAClE,MAAIC,OACAkH,OAAMlH,OAGVkH,OAAMnH,MAIZgK,eAAiB,SAASrF,EAAasF,EAAaC,GAClDvF,EAAYqF,eAAeC,EAAaC,EAAa,SAASjK,EAAKD,GACjE,MAAIC,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,gBAAkBtC,MAIlCmK,mBAAqB,SAASxF,GAC5BA,EAAYyF,gBACVrC,UAAW,SAAU/H,GACjBqC,QAAQC,IAAI,gBAAkBtC,IAElCmI,UAAW,SAASlI,GAChBkH,MAAMlH,IAGViJ,sBAAuB,WACnB,GAAIC,GAAmBC,OAAO,kCAAmC,IAC7Dc,EAAcd,OAAO,sBAAuB,GAChDzE,GAAY0F,gBAAgBlB,EAAkBe,EAAaZ,UAKnE/B,WAAa,SAAS5C,GACpBA,EAAY4C,WAAW,SAAStH,EAAKD,GACnC,MAAIC,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,gBAAkBtC,MAIlCsK,YAAc,SAAS3F,GACF,MAAfA,GACAA,EAAY4F,WAIlBC,mBAAqB,WACrB,GAAI7F,GAAcpB,IAAe+D,gBACZ,OAAf3C,GACAA,EAAY4F,WAKlBE,oBAAsB,SAAS9F,GAC7BA,EAAY+F,iBAKd5K,+BAAiC,WAEhC,GAAIkG,GAAQ1E,EAAG0E,QACVrB,EAAcpB,IAAe+D,gBAuBjC,OArBmB,OAAf3C,EACFA,EAAYsC,WAAW,SAAShH,EAAKiH,GAGnC,MAAIjH,IACF+F,EAAMY,OAAO3G,GACN+F,EAAMc,UAGpBZ,IAAIzH,OAAO4H,YAAc,GAAIH,KAAII,4BAC1BC,eAAiBjD,EAAUpC,uBAI7B8E,GAAMa,QAAQK,MAIjBlB,EAAMY,OAAO,4BAGPZ,EAAMc,SAIf6D,qCAAuC,SAASC,EAAUb,GAExD,GAAIpF,GAAcJ,EAAgBqG,EAAUrH,KACzCyC,EAAQ1E,EAAG0E,OAOd,OALArB,GAAYmF,oBAAoBC,GAAkB,EAAM,SAAS9J,EAAKD,GAChEC,EAAK+F,EAAMY,OAAO3G,GACjB+F,EAAMa,QAAQ7G,KAGdgG,EAAMc,SAIfkD,eAAiB,SAASrF,EAAasF,EAAaC,GAClDvF,EAAYqF,eAAeC,EAAaC,EAAa,SAASjK,EAAKD,GACjE,MAAIC,OACAkH,OAAMlH,OAGVoC,SAAQC,IAAI,gBAAkBtC,MASlC6K,cAAgB,SAAUC,EAAOC,GAElC,GAAI/E,GAAQ1E,EAAG0E,QACXgF,EAAiBtF,EAAiBqF,EAAWhF,QAAQmC,SAuCzD,OArCA7F,SAAQC,IAAI,mBAAoB0I,GAEhClF,EAAmBiF,EAAWhF,QAAQmC,UAAUnI,KAG/C,WAEC,GAAIkL,GAAa,gEACRC,EAAW,GAAIhF,KAAIiF,IAAI/E,OAAQ9C,EAAUzC,OAAQuK,QAASC,OAAQJ,IAEtE5I,SAAQC,IAAIgB,EAAUzC,OAEtB,IAAIuK,IAAUE,IAAKC,mBAAmBP,EAAiB,MAAQ,iBAAkBQ,KAAMV,EAE5FzI,SAAQC,IAAI8I,GAGZF,EAASO,OAAOL,EAAQ,SAASnL,EAAKyL,GACjCzL,GACHoC,QAAQC,IAAI,oBACZD,QAAQC,IAAIrC,GACZ+F,EAAMY,OAAO3G,KAGboC,QAAQC,IAAI,sCACZD,QAAQC,IAAIoJ,OAOf,SAASzL,GACR+F,EAAMY,OAAO3G,KAIR+F,EAAMc,UAQXU,kBAAmBA,kBACnBT,wBAAyBA,wBACxBM,kBAAmBA,kBACnBrE,wBAAyBA,wBACzBuF,qBAAsBA,qBACtBI,uBAAwBA,uBACxBE,qBAAsBA,qBACtBE,oBAAqBA,oBACrBQ,uBAAwBA,uBACxBM,uBAAwBA,uBACxBC,oBAAqBA,oBACrBE,eAAgBA,eAChBG,mBAAoBA,mBACpB5C,WAAYA,WACZ+C,YAAaA,YACbG,oBAAqBA,oBACrB3K,+BAAgCA,+BAChC6K,qCAAsCA,qCACtCH,mBAAmBA,mBACnBK,cAAgBA,eA7bpB3K,QACGC,OAAO,SACPiD,QAAQ,MAAO9D,GAElBA,EAAI+D,SAAW,QAAS,UAAW,KAAM;CCL3C,WAOE,QAASsI,GAAOtK,EAASD,EAAOwK,GAK7BvK,EAAQwK,YAAcxK,EAAQwK,gBAIhCxK,EAAQwK,YAAYC,aAAc,GAAIC,KAAIC,OAAOC,WAAW/L,QAAQgM,UAAU,OAAOvF,IAAI,SAClFzG,QAAQgM,UAAU,OAAOvF,IAAI,wBAC7BzG,QAAQgM,UAAU,OAGtB,IAAIJ,GAAezK,EAAQwK,YAAYC,YAmD1C,OAhDDA,GAAaK,YAEbL,EAAaK,SAASC,eAAiB,SAASC,GAC/C,MAAOjL,GAAMuF,IAAI,2BAGlBmF,EAAaK,SAASG,WAAa,WAClC,MAAOlL,GAAMuF,IAAI,uBAGlBmF,EAAaK,SAASI,UAAY,WACjC,MAAOnL,GAAMuF,IAAI,sBAGlBmF,EAAaK,SAASK,WAAa,WAClC,MAAOpL,GAAMuF,IAAI,uBAGlBmF,EAAaK,SAASM,YAAc,WACnC,MAAOrL,GAAMuF,IAAI,uBAGlBmF,EAAaK,SAASO,WAAa,WAClC,MAAOtL,GAAMuF,IAAI,uBAGlBmF,EAAaK,SAASQ,WAAa,WAClC,MAAOvL,GAAMuF,IAAI,uBAIlBmF,EAAaK,SAASS,YAAc,SAASC,EAAIC,GAChD1L,EAAMuF,IAAI,0BAA0B5G,KAAK,SAAS2H,GACrCA,EAASgE,IACrB,KAAIqB,EAAE,EAAGA,EAAErF,EAASgE,KAAKhC,OAAQqD,IAEhC,GAAIrF,EAASgE,KAAKqB,GAAGF,IAAMA,EAAG,CAC7BxK,QAAQC,IAAI,aACZ,IAAI0K,GAAMtF,EAASgE,KAAKqB,GAI1BD,EAASE,MAMHlB,EAtER5L,QACGC,OAAO,SACPiD,QAAQ,QAASuI,GAEpBA,EAAMtI,SAAW,UAAW,QAAS;CCNvC,WAKE,QAASC,KACT,OACCzC,OAAU,YACTC,yBAA4B,gEAC5BC,aAAgB,qEAChBC,aAAgB,sBAChBC,UAAa,6BACbC,iBAAoB,kDAXtBhB,QACGC,OAAO,SACPiD,QAAQ,YAAaE;CCJ1B,WAOE,QAAS2J,GAAU7L,EAAOD,GAWxB,GAAI+L,GAAa,WACf,MAAO9L,GAAMuF,IAAI,gBACfwG,SACEC,cAAe,UAAWjM,EAAeO,eAQ7CkL,EAAc,SAASC,EAAIC,GAC9B1L,EAAMuF,IAAI,0BAA0B5G,KAAK,SAAS2H,GACrCA,EAASgE,IACrB,KAAIqB,EAAE,EAAGA,EAAErF,EAASgE,KAAKhC,OAAQqD,IAEhC,GAAIrF,EAASgE,KAAKqB,GAAGF,IAAMA,EAAG,CAC7BxK,QAAQC,IAAI,aACZ,IAAI0K,GAAMtF,EAASgE,KAAKqB,GAI1BD,EAASE,MAMPZ,EAAiB,SAASC,GAC7B,MAAOjL,GAAMuF,IAAI,2BAEd2F,EAAa,WAChB,MAAOlL,GAAMuF,IAAI,uBAGd4F,EAAY,WACf,MAAOnL,GAAMuF,IAAI,sBAGd6F,EAAa,WAChB,MAAOpL,GAAMuF,IAAI,uBAGd8F,EAAc,WACjB,MAAOrL,GAAMuF,IAAI,uBAGd+F,EAAa,WAChB,MAAOtL,GAAMuF,IAAI,uBAIdgG,EAAa,WAChB,MAAOvL,GAAMuF,IAAI,sBAMhB,QACCiG,YAAaA,EACbR,eAAiBA,EAChBE,WAAaA,EACbY,WAAaA,EACbX,UAAYA,EACZC,WAAaA,EACbC,YAAaA,EACbC,WAAYA,EACZC,WAAYA,GApFhBzM,QACGC,OAAO,SACPiD,QAAQ,WAAY6J,GAEvBA,EAAS5J,SAAW,QAAS;CCL/B,WAME,QAASgK,KAiCP,MA/BA3B,SAEF4B,IAAM,SAASC,EAAUxI,GACxBuE,KAAKoC,KAAK6B,GAAYxI,GAGvByI,UAAY,SAASH,GACfA,GAAQA,EAAKI,aAAeC,OAWhCpE,KAAKoC,MACJiC,MAAU,WAAWN,EAAK3B,KAAKiC,MAC/BC,OAAWP,EAAK3B,KAAKkC,OACrBC,MAAUR,EAAK3B,KAAKmC,MACpBC,OAAWT,EAAK3B,KAAKoC,OACrBC,cAAkBV,EAAK3B,KAAKqC,cAC5BC,WAAeX,EAAK3B,KAAKsC,WACzBC,cAAkBZ,EAAK3B,KAAKuC,cAC5BpB,GAAKqB,KAAKC,MAAsB,IAAhBD,KAAKE,WAlBtB9E,KAAKoC,MACJkC,OAAW,EACXC,MAAU,EACVC,OAAW,OACXC,cAAkB,IAClBC,WAAe,IACfC,cAAkB,IAClBpB,GAAKqB,KAAKC,MAAsB,IAAhBD,KAAKE,aAiBpB1C,KAAOA,KACP4B,IAAMA,IACNE,UAAWA,WAxCftN,QACGC,OAAO,SACPiD,QAAQ,OAAQiK;CCJrB,WAME,QAASgB,KAEP,OACEC,OAAQ,EACRC,KAAM,EACNC,SAAQ,EACRC,aAAY,GAVhBvO,QACGC,OAAO,SACPiD,QAAQ,SAAUiL;ACDvB,QAASK,eAAepN,EAAIlC,GAE1B,QAASuP,GAAWC,GAEhBtF,KAAKsF,eAAiBA,EAGtBtF,KAAKuF,WAAavF,KAAKsF,eAAelF,OACtCJ,KAAKwF,UAAY,EACjBxF,KAAKyF,WAAa,EAElBzF,KAAK0F,QACDC,QAAS,EACTC,QAAS,EACTC,SAAU,EACVC,SAAU,GAGd9F,KAAK+F,MAAQ/F,KAAK0F,OAAOC,QAGzB3F,KAAKgG,SAAWhO,EAAG0E,QACnBsD,KAAKxC,QAAUwC,KAAKgG,SAASxI,QA2HjC,MApHA6H,GAAUY,cAAgB,SAAUX,GAChC,GAAIY,GAAY,GAAIb,GAAWC,EAC/B,OAAQY,GAAUC,QAKtBd,EAAUe,WAENjC,YAAakB,EAKbgB,YAAa,WACT,MAAQrG,MAAK+F,QAAU/F,KAAK0F,OAAOC,SAGvCW,WAAY,WACR,MAAQtG,MAAK+F,QAAU/F,KAAK0F,OAAOI,UAGvCS,WAAY,WACR,MAAQvG,MAAK+F,QAAU/F,KAAK0F,OAAOG,UAGvCM,KAAM,WAEF,GAAKnG,KAAKqG,cACN,MAAQrG,MAAa,OAEzBA,MAAK+F,MAAQ/F,KAAK0F,OAAOE,OACzB,KAAM,GAAIzF,GAAI,EAAIA,EAAIH,KAAKuF,WAAapF,IACpCH,KAAKwG,kBAAmBxG,KAAKsF,eAAgBnF,GAGjD,OAAQH,MAAa,SAMzByG,iBAAkB,SAA2BC,GACzC1G,KAAKyF,aAEAzF,KAAKsG,eAGVtG,KAAK+F,MAAQ/F,KAAK0F,OAAOI,SACzB9F,KAAKgG,SAAS1I,OAAQoJ,KAG1BC,gBAAiB,SAA0BD,GACvC1G,KAAKwF,YAEAxF,KAAKsG,eAMVtG,KAAKgG,SAASY,QACVC,QAASjC,KAAKkC,KAAM9G,KAAKwF,UAAYxF,KAAKuF,WAAa,KACvDmB,cAAeA,IAId1G,KAAKwF,YAAcxF,KAAKuF,aACzBvF,KAAK+F,MAAQ/F,KAAK0F,OAAOG,SACzB7F,KAAKgG,SAASzI,QAASyC,KAAKsF,mBAOpCkB,kBAAmB,SAA4BE,GAC3C,GAAIR,GAAYlG,KASZwB,EAAQ5K,QAAQmQ,QAAS,GAAIC,QAC5BC,KAAK,OAAQ,SAAU/Q,GAGpBJ,EAAWoR,OACP,WACIhB,EAAUS,gBAAiBzQ,EAAMiR,OAAOC,KAGxClB,EAAY1E,EAAQtL,EAAQ,SAIvC+Q,KAAK,QAAS,SAAU/Q,GAGrBJ,EAAWoR,OACP,WACIhB,EAAUO,iBAAkBvQ,EAAMiR,OAAOC,KAGzClB,EAAY1E,EAAQtL,EAAQ,SAIvCmR,KAAM,MAAOX,KAKpB,EArJR9P,QAAQC,OAAO,SACdyQ,QAAQ,YAAalC,eAEtBA,cAAcrL,SAAW,KAAM;CCH/B,WASE,QAASwN,GAAYC,EAAQC,EAAUC,EAAU3P,EAASgM,EAAMgB,GAW/D,QAAS4C,GAAaC,EAAIC,EAAUC,GAEnCF,EAAKA,EAAG,GAERC,EAAWA,EAAUD,EAAGG,YAAY,EAAG,EAEvC,IAAIC,GAAUJ,EAAGK,YAAcL,EAAGG,WAE9BF,IAAYG,IAASH,EAAWG,EAAQ,GACxCH,GAAYG,IAASH,EAAWG,EAAQ,EAC5C,IAAIE,GAAUtD,KAAKkC,KAAKgB,EAAiB,IACvCK,EAAWN,EAAWD,EAAGQ,WACzBC,EAAcF,EAAWD,EACzBI,EAAcV,EAAGQ,WAAaP,EAAW,SAASU,EAAEC,GAAG,MAAOD,IAAGC,EAAE,GAAM,SAASD,EAAEC,GAAG,MAAOD,IAAGC,EAAE,GAajGC,EAAiBC,YAAY,WAEhC,GAAGJ,EAAWV,EAAGQ,WAAYP,GAAW,CACvC,GAAIc,GAAYf,EAAGQ,WAAWC,CAC1BM,IAAaX,IAASW,EAAYX,EAAQ,GAC9CJ,EAAGQ,WAAaO,MAQZC,eAAcH,IAEjB,IAlDJ,GAAII,GAAO7I,IAGX6I,GAAK9D,OAASA,EACd8D,EAAK9E,KAAOA,EACZ8E,EAAKC,WAAa,IAiDlBD,EAAKE,gBAAkBC,IAAM,EAAGC,KAAO,GAIvCzB,EAAO0B,OAAO,SAAU,SAASC,EAASC,GAGzB,GAAZD,GAEHzB,EAAS,WAER,GAAIvQ,GAAMqQ,EAAO6B,KAAKC,QAAQ,IAAIT,EAAK9E,KAAK3B,KAAKoF,EAAO6B,KAAKC,SAC7DC,EAAgB3S,QAAQmQ,QAAQyC,SAASC,cAAc,IAAItS,GAE3D0R,GAAKE,eAAeC,IAAMO,EAAcG,KAAK,aAC7Cb,EAAKE,eAAeE,KAAOM,EAAcG,KAAK,aAE9C,IAAIC,GAAW/S,QAAQmQ,QAAQyC,SAASC,cAAc,IAAIjC,EAAO6B,KAAKC,QAAQ,aAI9E,IAHAK,EAASC,KAAKZ,IAAMH,EAAKE,eAAeC,IAAI,KAAMC,KAAOJ,EAAKE,eAAeE,KAAK,OAG9ElR,EAAQ8R,WAAahB,EAAKC,WAAW,CACxC,GAAIgB,GAAUlT,QAAQmQ,QAAQU,EAAS,GAAGgC,cAAc,kBACpDR,EAAQa,EAAQ,GAAKjB,EAAKE,eAAeE,KAAMa,EAAQ,GAAG/B,YAAY,EAAG,GAAK,CAClF+B,GAAQJ,KAAK,aAAcT,OAIxB,CACH,GAAIa,GAAUlT,QAAQmQ,QAAQU,EAAS,GACvCqC,GAAQJ,KAAK,YAAab,EAAKE,eAAeC,IAAM,MAGnD,OAOLH,EAAKkB,WAAa,SAASC,EAAQzG,EAAI8D,EAAMsC,GAC5C,GAAIG,GAAUlT,QAAQmQ,QAAQyC,SAASC,cAAc,IAAIpC,EAAK,aAC1DsC,EAAW/S,QAAQmQ,QAAQyC,SAASC,cAAc,IAAIpC,EAAK,cAC3D2B,EAAMpS,QAAQmQ,QAAQiD,EAAO7C,QAAQuC,KAAK,aAC1CT,EAAOrS,QAAQmQ,QAAQiD,EAAO7C,QAAQuC,KAAK,cAC3CO,EAAOrT,QAAQmQ,QAAQyC,SAASU,iBAAiB,eAErDD,GAAKL,KAAKO,MAAQ,SAAUC,QAAU,IACtCT,EAASC,KAAKZ,IAAMA,EAAI,KAAMC,KAAOA,EAAK,OAE1CJ,EAAKE,gBAAkBC,IAAMA,EAAIC,KAAOA,GAEpClR,EAAQ8R,WAAahB,EAAKC,YAAYnB,EAAamC,EAASb,EAAM,KAEtEvB,EAAS,WACRuC,EAAKL,KAAKO,MAAQ,OAAQC,QAAU,IACpCvB,EAAK9E,KAAK3B,KAAKiF,GAAQ9D,GACrB,MAIJsF,EAAKwB,QAAU,SAAShD,EAAMiD,GAC7BzB,EAAK9E,KAAK3B,KAAKiF,GAAQiD,GA7HzB1T,QACGC,OAAO,SACPrB,WAAW,cAAe+R,GAE7BA,EAAYxN,SAAW,SAAU,WAAW,WAAY,UAAW,OAAQ;CCN7E,WAME,QAAS+P,KACP,OACES,SAAU,KACVhV,YAAa,6CACbC,WAAY,sBACZgV,OACEnB,KAAO,IACPoB,QAAS,IACTC,OAAQ,MAZd9T,QACGC,OAAO,SACP8T,UAAU,UAAWb;CCJ1B,WAEElT,QACGC,OAAO,SACP8T,UAAU,iBAAkB,UAAW,SAAS5S,GAElD,OAEIwS,SAAU,KACVK,SAAU,oEACVpV,WAAY,sBACZgV,OACEnB,KAAO,IACPoB,QAAS,IACbC,OAAQ,KAGNG,KAAM,SAASrD,GAYb,QAASsD,KACP,GAAIC,GAAchT,EAAQ8R,UACtBkB,GAAcvD,EAAOsB,WACvBtB,EAAOwD,QAAU,2DACRD,GAAevD,EAAOsB,aAC/BtB,EAAOwD,QAAU,0DAftBxD,EAAOsB,WAAa,IAGpB/Q,EAAQkT,SAAW,WAChBH,IACAtD,EAAON,UAGT4D,IAmBDtD,EAAO0D,aAAe,SAASjU,EAAKC,GACtC,MAAO,UAASsN,GACf,QAAIvN,GAAOuN,EAAO2G,OAASlU,MACvBC,GAAOsN,EAAO2G,OAASjU;CCjDlC,WAME,QAASkU,KACP,OACEb,SAAU,KACVhV,YAAa,oDACbC,WAAY,sBACZgV,OACEnB,KAAO,IACPoB,QAAS,IACTC,OAAQ,MAZd9T,QACGC,OAAO,SACP8T,UAAU,gBAAiBS;CCJhC,WAME,QAASC,KACP,OACEd,SAAU,KACVhV,YAAa,mDACbC,WAAY,sBACZgV,OACEnB,KAAO,IACPoB,QAAS,IACTC,OAAQ,KAEVG,KAAM,SAASrD,GAEdA,EAAO8D,kBAAoB,SAAShH,GACtC,MAAO,UAASC,GACf,QAAQA,EAAM,UAAUD,OAlB5B1N,QACGC,OAAO,SACP8T,UAAU,eAAgBU;CCJ/B,WAEEzU,QACGC,OAAO,SACP8T,UAAU,YAAa,WAEzB,OAEIJ,SAAU,KACbhV,YAAa,gDACViV,OACEzG,KAAO,KAGT8G,KAAM,SAASrD;CCdtB,WAUE,QAAS+D,GAAWxT,EAASyP,EAAQxP,EAAI+L,GACxC,GAAIyH,GAAOxL,IACZwL,GAAKzH,KAAOA,EACZyH,EAAKC,WAAY,EACjBD,EAAKE,MAAO,EACZF,EAAKG,KAAOC,EAAI,GAAIC,EAAI,IACxBL,EAAKM,SAAW,WAAY,MAAO/T,GAAQ8R,WAAW,KAGtD2B,EAAKO,WAAa,WACjBP,EAAKE,MAAQF,EAAKE,MAGnBF,EAAKQ,SAAW,WACfR,EAAKS,aAAeL,EAAI,EAAEC,EAAI,GAC9BrE,EAAON,UAGRsE,EAAKU,UAAY,WAChB,OAAIV,EAAKM,aACTN,EAAKG,IAAM,YACXH,EAAKC,WAAY,EACjBU,OAASvV,QAAQmQ,QAAQyC,SAASU,iBAAiB,wBACnDkC,YAAW,WACVD,OAAOvC,KAAKyC,mBAAmBb,EAAKG,OAClC,OAGJH,EAAKc,WAAY,SAASC,GAEzBf,EAAKgB,YAAYZ,EAAIW,EAAEE,QAAQ,GAAGC,QAAQb,EAAIU,EAAEE,QAAQ,GAAGE,SAE3DnB,EAAKoB,UAGNpB,EAAKqB,UAAYjB,EAAI,EAAEC,EAAI,GAC1BL,EAAKS,aAAeL,EAAI,EAAEC,EAAI,GAE/BL,EAAKsB,UAAW,SAASP,GAExB,GAAIJ,GAASvV,QAAQmQ,QAAQyC,SAASU,iBAAiB,mBAEvD,KAAKsB,EAAKM,WAAY,OAAO,CAE7B,KAAKN,EAAKE,KAAM,OAAO,CAEvBa,GAAEQ,gBAGF,IAAIC,GAAQT,EAAEE,QAAQ,GACtBtF,EAAS6F,EAAM7F,OACf8F,GACCrB,EAAMoB,EAAMN,QAAQlB,EAAKgB,WAAWZ,EACpCC,EAAMmB,EAAML,QAAQnB,EAAKgB,WAAWX,GAIjCD,EAAIqB,EAAKrB,EAAEJ,EAAKS,YAAYL,EAChCC,EAAIoB,EAAKpB,EAAEL,EAAKS,YAAYJ,EAGxBD,EAAKA,EAAEzE,EAAO+F,YAAY,IAAK1B,EAAKqB,SAASjB,EACjDC,EAAKA,EAAE1E,EAAOgG,aAAa,IAAK3B,EAAKqB,SAAShB,EAG1CuB,GAAQvB,KAAOD,KACnBwB,GAAOvB,EAAE7C,IAAS,GAClBoE,EAAOvB,EAAEwB,WACTD,EAAOxB,EAAE3C,UACTmE,EAAOxB,EAAEzB,MAAS,GAGd0B,EAAEuB,EAAOvB,EAAE7C,MAAK6C,EAAIuB,EAAOvB,EAAE7C,KAC7B6C,EAAEuB,EAAOvB,EAAEwB,SAAQxB,EAAIuB,EAAOvB,EAAEwB,QAChCzB,EAAEwB,EAAOxB,EAAE3C,OAAM2C,EAAIwB,EAAOxB,EAAE3C,MAC9B2C,EAAEwB,EAAOxB,EAAEzB,QAAOyB,EAAIwB,EAAOxB,EAAEzB,MAGnC,IAAImD,IAAQ1B,EAAIA,EAAEC,EAAIA,EACtBL,GAAKqB,SAAWS,CAGhB,IAAI3B,IAAOC,EAAI,MAAQC,EAAI,KAC3BM,GAAOvC,KAAKyC,mBAAmBV,IAE/BH,EAAKS,YAAcgB,EACnBzF,EAAON,UAORsE,EAAK+B,QAAU,SAASC,EAAGtX,GAM1B,GAJA6C,QAAQC,IAAI9C,EAAMuX,YAIbjC,EAAKM,WAAY,OAAO,CAG7B,KAAKN,EAAKE,KAAM,OAAO,CAEvB,IAAIS,GAASvV,QAAQmQ,QAAQyC,SAASU,iBAAiB,oBAIvDwD,GAHeC,OAAOC,YACTzB,EAAO,GAAG0B,QAGtBC,MAAQ5X,EAAMiR,OAAO+F,YACrBW,OAAS3X,EAAMiR,OAAOgG,eAKnBF,GACHrB,EAAM1V,EAAM6X,OACZlC,EAAM3V,EAAM8X,QAMTpC,EAAIqB,EAAKrB,EAAEJ,EAAKS,YAAYL,EAChCC,EAAIoB,EAAKpB,EAAEL,EAAKS,YAAYJ,CAE5B9S,SAAQC,IAAI4S,EAAEC,EAGd,IAAID,GAAIhH,KAAKqJ,IAAIrC,GAAG8B,EAAMI,MAAM,GAChClC,GAAKqB,EAAKrB,EAAE,GAAIA,EAAEA,CAClB,IAAIC,GAAIjH,KAAKqJ,IAAIpC,GAAG6B,EAAMG,OAAO,GACjChC,GAAKoB,EAAKpB,EAAE,GAAIA,EAAEA,EAGlBD,GAAIJ,EAAKqB,SAASjB,EAClBC,GAAIL,EAAKqB,SAAShB,CAGlB,IAAIuB,IAAQvB,KAAOD,KASnBwB,GAAOvB,EAAE7C,IAAS,GAClBoE,EAAOvB,EAAEwB,WACTD,EAAOxB,EAAE3C,UACTmE,EAAOxB,EAAEzB,MAAS,GAEd0B,EAAEuB,EAAOvB,EAAE7C,MAAK6C,EAAIuB,EAAOvB,EAAE7C,KAC7B6C,EAAEuB,EAAOvB,EAAEwB,SAAQxB,EAAIuB,EAAOvB,EAAEwB,QAChCzB,EAAEwB,EAAOxB,EAAE3C,OAAM2C,EAAIwB,EAAOxB,EAAE3C,MAC9B2C,EAAEwB,EAAOxB,EAAEzB,QAAOyB,EAAIwB,EAAOxB,EAAEzB,MAGnC,IAAImD,IAAQ1B,EAAIA,EAAEC,EAAIA,EAEtB9S,SAAQC,IAAIsU,GAEZ9B,EAAKqB,SAAWS,CAIhB,IAAI3B,IAAOC,EAAI,MAAQC,EAAI,KAC3BM,GAAOvC,KAAKyC,mBAAmBV,IAO/BH,EAAKS,YAAc/V,EAAMgY,SAAWtC,EAAI,EAAEC,EAAI,GAAKoB,GAUpDzB,EAAK2C,UAAY,SAASvC,EAAEC,GAE3BO,WAAW,WACVZ,EAAKC,WAAY,GACf,KAGHiC,MAAQ9W,QAAQmQ,QAAQyC,SAASC,cAAc,gBAAgB,GAC/D2E,OAASV,MAAMR,YACfmB,QAAUX,MAAMP,aAChBmB,KAAOZ,MAAMa,wBACbC,QAAUd,MAAMe,cAAcC,gBAE9BC,QAAUL,KAAKtF,IAAMjR,EAAQ6W,YAAcJ,QAAQK,UACnDC,QAAUR,KAAKrF,KAAOlR,EAAQgX,YAAcP,QAAQQ,WAGpDC,WAAcrD,EAAIkD,SAAWV,OAAU,IACvCc,WAAcrD,EAAI8C,SAAWN,QAAW,IAUpCtW,EAAQ8R,WAAa2B,EAAK1C,WAAY6C,IAAO,IAAIsD,UAAa,MAAQ,IAAIC,WAAa,MACtFvD,IAAM,UAAc,KAAO,UAAc,MAC9CH,EAAKG,IAAIA,IACTQ,OAASvV,QAAQmQ,QAAQyC,SAASU,iBAAiB,oBACnDiC,OAAOvC,KAAKyC,mBAAmBV,OAGhCH,EAAK2D,WAAa,SAASnF,GAE1BwB,EAAK2C,UAAUnE,EAAOoF,MAAMpF,EAAOqF,QAtOpCzY,QACGC,OAAO,SACPrB,WAAW,aAAc+V,GAE5BA,EAAWxR,SAAW,UAAW,SAAU,KAAM;CCNnD,WAQE,QAASuV,KACP,OACE/E,SAAU,KACVhV,YAAa,oDACbC,WAAY,qBACZqV,KAAM,SAASL,EAAO+E,EAAKC,EAAOC,GAGlCF,EAAIG,GAAG,aAAc,SAASnD,GAC/B/B,EAAMgB,KAAKc,WAAWC,KAGrBgD,EAAIG,GAAG,YAAa,SAASnD,GAC9B/B,EAAMgB,KAAKsB,UAAUP,KAGpBgD,EAAIG,GAAG,WAAY,SAASnD,GAC7B/B,EAAMgB,KAAKQ,SAASO,OAvBvB3V,QACGC,OAAO,SACP8T,UAAU,aAAc2E;CCJ7B,WAOE,QAASK,GAAe5Z,EAAW6Z,EAAQ7K,EAAQ/O,GACjD,GAAI6Z,GAAK7P,IAGX6P,GAAGxX,WAAa,KAChBrC,EAAIQ,iCAAiCC,KACpC,SAASC,GACkB,IAAtBA,EAAO6H,cAAmBsR,EAAGxX,YAAa,IAE/C,SAAS1B,GACRoC,QAAQC,IAAIrC,GACZkZ,EAAGxX,YAAa,IAQlBwX,EAAGC,SACHD,EAAGC,MAAMC,MAAK,EACdF,EAAGG,YAAa,EAEhBH,EAAGjW,OAAS,WACX5D,EAAIkL,qBACoB,KAApBnL,EAAUQ,QACbqZ,EAAOK,UA/BTrZ,QACGC,OAAO,SACPrB,WAAW,iBAAkBma,GAEhCA,EAAe5V,SAAW,YAAY,SAAS,SAAU;CCN3D,WAME,QAASmW,KACP,OACE3F,SAAU,KACVhV,YAAa,kDACbC,WAAY,2BARhBoB,QACGC,OAAO,SACP8T,UAAU,aAAcuF;CCJ7B,WAQE,QAASC,GAAW3I,EAAQtB,GAI3BsB,EAAO4I,cAAe,EAEtBlK,EAAUD,cAAeuB,EAAO6I,QAC/B5Z,KAAK,WACL+Q,EAAO4I,cAAe,GAEvB,WACCrX,QAAQC,IAAI,6BAKbwO,EAAO8I,aAAe,EAEtB9I,EAAO+I,qBAAuB,SAAUC,GACtChJ,EAAO8I,aAAeE,GAGxBhJ,EAAOiJ,oBAAsB,SAAUD,GACrC,MAAOhJ,GAAO8I,eAAiBE,GAGjChJ,EAAOkJ,UAAY,WACjBlJ,EAAO8I,aAAgB9I,EAAO8I,aAAe9I,EAAO6I,OAAOjQ,OAAS,IAAOoH,EAAO8I,aAAe,GAGnG9I,EAAOmJ,UAAY,WACjBnJ,EAAO8I,aAAgB9I,EAAO8I,aAAe,IAAO9I,EAAO8I,aAAe9I,EAAO6I,OAAOjQ,OAAS,GArCpGxJ,QACGC,OAAO,SACPrB,WAAW,aAAc2a,GAE5BA,EAAWpW,SAAW,SAAU;CCNlC,WAME,QAAS6W,KACP,OACErG,SAAU,KACVhV,YAAa,0CACbC,WAAY,qBACZgV,OACE6F,OAAS,IACTQ,WAAa,MAXnBja,QACGC,OAAO,SACP8T,UAAU,SAAUiG;CCJzB,WAOE,QAASE,GAAU/a,EAAW4N,GAG5B,GAAIkM,GAAK7P,IAET6P,GAAGpW,QACHkK,EAASC,aACNmN,QAAQ,SAAS3O,GACjBrJ,QAAQC,IAAI,8BACXD,QAAQC,IAAIoJ,KAEb4O,MAAM,SAAUzE,GACfxT,QAAQC,IAAIuT,KAjBlB3V,QACGC,OAAO,SACPrB,WAAW,YAAasb,GAE3BA,EAAU/W,SAAW,YAAa;CCNpC,WAOE,QAASkX,GAAWlb,EAAWgO,EAAMgB,EAAQmM,EAASlb,EAAKqM,EAAOmF,GAIhE,GAAIqI,GAAK7P,IAEX6P,GAAG9K,OAAOA,EACV8K,EAAG9L,KAAKA,EACR8L,EAAGzN,QACHyN,EAAGsB,SACDnb,EAAIQ,iCAAiCC,KACpC,SAASC,GAER2L,EAAM+O,gBAA+B,cAAI1a,EAAO+F,QAAQkC,cACxDkR,EAAGwB,iBAGH,IAAI/U,GAAiB5F,EAAO+F,QAAQmC,SAASrG,MAAM,KAAK,GACtD+Y,EAAS7Y,KAAKC,MAAMF,KAAK8D,IAAiBC,GAC9C8F,GAAMkP,SAASD,GAAQ7a,KACtB,SAASC,GACRmZ,EAAGpW,KAAO/C,EAAO0L,KACjBoF,EAAON,UAMR,SAASvQ,GAAKoC,QAAQC,IAAIrC,MAG1B,SAASA,GACRoC,QAAQC,IAAI,+BAA+BrC,KAM/CkZ,EAAG2B,UAAY,SAAUC,EAAMC,GAC7BrP,EAAMQ,SAAS4O,KACbV,QAAQ,SAAS3O,GACfyN,EAAGzN,KAAKsP,GAAWtP,IAEpB4O,MAAM,SAAUzE,GACfxT,QAAQC,IAAIuT,KASlBsD,GAAGwB,gBAAkB,WAMpBxB,EAAG2B,UAAU,aAAc,WAC3B3B,EAAG2B,UAAU,YAAa,UAC1B3B,EAAG2B,UAAU,aAAc,WAC3B3B,EAAG2B,UAAU,aAAc,WAE3BnP,EAAMQ,SAASC,eAAe,GAC5BiO,QAAQ,SAAS3O,GAClB,IAAKwJ,EAAE,EAAGA,EAAExJ,EAAKhC,OAAQwL,IACxBiE,EAAGsB,MAAMhV,KAAKiG,EAAKwJ,MAGjBoF,MAAM,SAAUzE,GACfxT,QAAQC,IAAIuT,MAalBsD,EAAG8B,WAAa,SAASrI,EAAS/F,EAAI8D,GAErC,GAAsB,mBAAXiC,IAAuC,mBAAN/F,GAAmB,OAAO,CACtE8D,GAAOA,GAAM,IAEb,IAAIqK,GAAWpI,EAAQsI,SAAS,UAAY,UAAYtI,EAAQ,IAE5DuI,EAAUhC,EAAGzN,KAAKsP,EAEtB,OADAI,UAAWZ,EAAQ,UAAUW,GAAUtO,GAAIA,IAAK,GAC3C8D,EACOyK,SAASzK,GADHyK,UAInBjC,EAAGkC,SAAW,WACblC,EAAG9L,KAAOA,EAAKG,UAAU2L,EAAG9L,MAC5BhO,EAAUQ,KAAK,gBAGhBsZ,EAAGmC,WAAa,SAASjO,GACxBhL,QAAQC,IAAI+K,GACZhL,QAAQC,IAAI6W,EAAG9L,MACf8L,EAAG9K,OAAOI,aAAc,EACxB0K,EAAG9L,KAAK3B,KAAK2B,GA/GdnN,QACGC,OAAO,SACPrB,WAAW,aAAcyb,GAE5BA,EAAWlX,SAAW,YAAa,OAAO,SAAU,UAAW,MAAO,QAAS;CCNjF,WAOE,QAASkY,GAAeja,EAAIkZ,EAASxJ,EAAU3R,EAAWgC,EAASma,EAAc7P,EAAO0B,EAAMyD,EAAQzC,EAAQ/O,GAK9G,QAASmc,KACP,GAAIC,GAAKC,UAAUC,UAAUC,cACzBC,EAAYJ,EAAG9b,QAAQ,aAC3B,IAAIkc,EAAW,CAEb,GAA0B,GAAtB7E,OAAO8E,aAA0C,KAAtB9E,OAAO8E,YACpC,OAAO,CAEJ,IAA0B,IAAtB9E,OAAO8E,aAAqB9E,OAAO8E,iBAC7C,OAAO,MAGH,CACH,GAA0B,IAAtB9E,OAAO8E,aAAqB9E,OAAO8E,iBACrC,OAAO,CAEJ,IAA0B,GAAtB9E,OAAO8E,aAA0C,KAAtB9E,OAAO8E,YACzC,OAAO,GAoBb,QAASC,GAAYvb,GACpB,OAAOA,GACN,IAAK,IACF,MAAO,QAGP,KAAK,IACL,MAAO,OAGP,KAAK,IACL,MAAO,QAGP,KAAK,KACL,MAAO,YAGP,KAAK,KACL,MAAO,eAGP,KAAK,KACL,MAAO,eAEP,SAAS,OAAO,GAIrB,QAASwb,GAAaxb,GACrB,OAAOA,GACN,IAAK,SACF,MAAO,GAGP,KAAK,QACL,MAAO,GAGP,KAAK,SACL,MAAO,GAGP,KAAK,aACL,MAAO,IAGP,KAAK,gBACL,MAAO,IAGP,KAAK,gBACL,MAAO,IAEP,SAAS,OAAO,GA8NpB,QAASyb,GAAUxL,EAAKyL,GACrB,MAAO7a,GAAG,SAASuF,EAAQD,GACzB,GAAIkE,GAAQ,GAAIwF,MAChBxF,GAAM4F,IAAMA,EACZ5F,EAAMsR,OAAS,WACbD,EAAME,UAAUvR,EAAM,EAAE,EAAE,IAAI,KAC9BjE,EAAQiE,IAEVA,EAAMwR,QAAU,SAASzG,GACvBjP,EAAOiP,MAtUb,GAAIsD,GAAK7P,IA0BT6P,GAAGoD,UAAUd,GACd,IAAIe,GAA4B,uBAAyBvF,QACxDwF,EAAmBD,EAA4B,oBAAsB,QA0EvE,IAxEAvF,OAAOyF,iBAAiBD,EAAkB,WAExCtD,EAAGoD,UAAUd,IACb3K,EAAON,WACN,GAIH2I,EAAG9K,OAASA,EA6DZhM,QAAQC,IAAIkZ,GAGRA,EAAamB,SAAgC,QAArBnB,EAAaoB,OACxC,GAAIpB,EAAamB,QAAQ/c,QAAQ,KAAK,EAAE,CACvCyN,EAAKG,YACLqP,SAAWrB,EAAamB,QAAQ9a,MAAM,IACtC,KAAI,GAAIib,GAAE,EAAGA,EAAED,SAASnT,OAAQoT,IAAI,CACnC,GAAIC,GAAOF,SAASC,GAAGE,MAAM,sBAC7B,IAAKD,EAAL,CACA,GAAInK,GAAUoJ,EAAYe,EAAM,GAC5BnK,KAASvF,EAAK3B,KAAKkH,GAAWqK,SAASF,EAAM,WAIlD1P,GAAKG,UAAUgO,EAAamB,aAIpBnB,GAAamB,UAAYnB,EAAaoB,OAE/CjR,EAAMQ,SAASS,YAAY4O,EAAamB,QAAS,SAASjR,GACrDA,EACH2B,EAAK3B,KAAKA,EAGV2B,EAAKG,cAO8B,IAAlCE,OAAOwP,KAAK7P,EAAK3B,MAAMhC,QAAgB2D,EAAK3B,KAAK+B,cAAgBC,QACnEL,EAAKG,WAIP2L,GAAG9L,KAAKA,EAQR8L,EAAGgE,UAAY,WACd,GAAIC,GAAMtK,SAASuK,SAASC,OAAO,eACnC,KAAK,GAAI/P,KAAY4L,GAAG9L,KAAK3B,KAC1B,GAAIyN,EAAG9L,KAAK3B,KAAK6R,eAAehQ,GAAW,CAC5C,GAAIiQ,GAASvB,EAAa1O,EACtBiQ,KAAQJ,GAAO,IAAII,EAAOrE,EAAG9L,KAAK3B,KAAK6B,IAG7C6P,GAAO,QACP/a,QAAQC,IAAI8a,IAabjE,EAAGsE,SAGHtE,EAAGsE,MAAMhY,MACRiY,cAAgB,iBAChB1C,QAAU,UACVrN,MAAQ,SACRiF,QAAU,WAIXuG,EAAGsE,MAAMhY,MACRiY,cAAgB,gBAChB1C,QAAU,SACVrN,MAAQ,QACRiF,QAAU,UAIXuG,EAAGsE,MAAMhY,MACRiY,cAAgB,iBAChB1C,QAAU,UACVrN,MAAQ,SACRiF,QAAU,WAIXuG,EAAGsE,MAAMhY,MACRiY,cAAgB,UAChB1C,QAAU,UACVrN,MAAQ,aACRiF,QAAU,eAIXuG,EAAGsE,MAAMhY,MACRiY,cAAgB,UAChB1C,QAAU,UACVrN,MAAQ,gBACRiF,QAAU,kBAIXuG,EAAGsE,MAAMhY,MACRiY,cAAgB,UAChB1C,QAAU,UACVrN,MAAQ,gBACRiF,QAAU,kBAIXuG,EAAGsE,MAAMhY,MACRiY,cAAgB,OAChB/P,MAAQ,aAeTwL,EAAGwE,SAAS,OACZxE,EAAGyE,UAAY,EACfzE,EAAG0E,WAAa,SAASlL,GACxB,QAAIA,GAAQwG,EAAGsE,MAAM/T,YACjBiJ,EAAO,KACAmL,SAAPnL,IACCwG,EAAGyE,UAAYjL,OAGhBA,EAAK,GAAKwG,EAAGsE,MAAM/T,QAAQyP,EAAG4E,wBAGnC5E,EAAG6E,cAEH7E,EAAG4E,iBAAmB,WACrB,GAAIrS,GAAOyN,EAAGzN,KAAKyN,EAAGsE,MAAMtE,EAAGyE,WAAW5C,SACtCva,EAAM0Y,EAAG9L,KAAK3B,KAAKyN,EAAGsE,MAAMtE,EAAGyE,WAAWhL,SAC1C5F,EAAMwN,EAAQ,UAAU9O,GAAOmB,GAAIpM,IAAM,EAC7C0Y,GAAG6E,WAAahR,GAGjBmM,EAAG8E,cAAgB,SAASrQ,GAC3B,MAAO,UAASC,GACf,MAAOA,GAAM,UAAUD,KAKzBuL,EAAG8B,WAAa,SAASrI,EAAS/F,EAAI8D,GAErC,GAAsB,mBAAXiC,IAAuC,mBAAN/F,GAAmB,OAAO,CACtE8D,GAAOA,GAAM,IAEb,IAAIuN,GAAW1D,EAAQ,UAAUrB,EAAGsE,OAAQ7K,QAASA,GAErD,IAAIsL,EAASxU,OAAS,EAAG,OAAO,CAEhC,IAAIsR,GAAsB,UAAXpI,GAAkC,SAAXA,EAAqBA,EAAQ,IAAM4H,EAAQ,UAAUrB,EAAGsE,OAAQ7K,QAASA,IAAU,GAAGoI,QACxHG,EAAUhC,EAAGzN,KAAKsP,EAGtB,OADAmD,UAAY3D,EAAQ,UAAUW,GAAUtO,GAAIA,IACrB,mBAAZsR,YACX/C,SAAW+C,SAAS,GAEfxN,EACOyK,SAASzK,GADHyK,WAOnBjC,EAAGzN,QAEHyN,EAAGiF,QAAU,SAAUrD,EAAMC,GAC5B,GAAI8B,GAAIxb,EAAG0E,OAMX,OALC2F,GAAMQ,SAAS4O,KACdhb,KAAK,SAASse,GACblF,EAAGzN,KAAKsP,GAASqD,EAAI3S,KACrBoR,EAAEjW,SAAQ,KAENiW,EAAEhW,SAIVxF,EAAGgd,KACFnF,EAAGiF,QAAQ,aAAc,WACzBjF,EAAGiF,QAAQ,YAAa,UACxBjF,EAAGiF,QAAQ,aAAc,WACzBjF,EAAGiF,QAAQ,aAAc,aACvBre,KAAK,SAAS2L,GAGhBoF,EAAO0B,OAAO,WACZ,MAAO2G,GAAG9L,KAAK3B,MACd,SAAS6S,EAASC,GACpBrF,EAAG4E,qBACD,KAoBF5E,EAAGsF,SAAW,WACbpc,QAAQC,IAAI,QACZhD,EAAIQ,iCAAiCC,KACpC,SAASC,GACR,GAAIyE,GAAWzE,CACfmZ,GAAGuF,cAAc3e,KAChB,SAAS4e,GACTrf,EAAIuL,cAAc8T,EAAUla,GAAU1E,KACrC,WACCsC,QAAQC,IAAI,oBAEd,SAASrC,GACRoC,QAAQC,IAAIrC,QAMf,SAASA,GAEVkH,MAAM,qCAMTgS,EAAGuF,YAAc,WACf,GAAIE,GAAS9L,SAAS+L,cAAc,SACpCD,GAAOxH,MAAM,IACbwH,EAAOzH,OAAO,GAKb,KAAI,GAJDgF,GAAQyC,EAAOE,WAAW,MAC1BC,KAECC,EAAiBlM,SAASmM,uBAAuB,gBAC7CxV,EAAE,EAAGA,EAAEuV,EAAetV,OAAQD,IAAI,CACzC,GAAIqB,GAAQkU,EAAevV,EAC1BsV,GAAStZ,KAAKyW,EAAUpR,EAAM4F,IAAKyL,IAGrC,MAAO7a,GAAGgd,IAAIS,GAAUhf,KAAK,SAASmf,GACpC,GAAIC,GAAUP,EAAOQ,UAAU,aAClC,OAAOD,MA1XTjf,QACGC,OAAO,SACPrB,WAAW,iBAAkByc,GAEhCA,EAAelY,SAAW,KAAK,UAAU,WAAW,YAAa,UAAW,eAAgB,QAAS,OAAQ,SAAU,SAAU;CCNnI,WASI,QAASgc,GAAUvO,EAAQzD,EAAMiS,GAEhCxO,EAAOzD,KAAOA,EAAK3B,KATtBxL,QACGC,OAAO,SACPrB,WAAW,WAAYugB,GAE1BA,EAAShc,SAAW,SAAS,OAAQ;CCNvC,WAOE,QAASkc,GAAUlgB,EAAWC,GAC5B,GAAI6Z,GAAK7P,IAEX6P,GAAG9S,aACC7D,KAAO,GACPD,MAAQ,GACRU,SAAW,IAGdkW,EAAGqG,UACHC,QAAU,GACVC,KAAM,GACNpS,IAAK,SAASmS,EAASC,GACtBvG,EAAGqG,SAASC,QAAUA,EACtBtG,EAAGqG,SAASE,KAAOA,GAEpBC,MAAM,WACLxG,EAAGqG,SAASC,QAAU,GACtBtG,EAAGqG,SAASE,KAAO,KAOrBvG,EAAGyG,kBAAoB,WACtB,QAASC,GAActd,GACpB,GAAIud,GAAK,wJACT,OAAOA,GAAGC,KAAKxd,GAElB,MAAIsd,GAAc1G,EAAG9S,YAAY9D,SAI5B4W,EAAG9S,YAAYpD,WACnBkW,EAAGqG,SAASlS,IAAI,0BAA2B,UACpC,IALP6L,EAAGqG,SAASlS,IAAI,qCAAsC,UAC/C,IAST6L,EAAGrW,MAAQ,SAASP,EAAOU,GAE1BkW,EAAGqG,SAASG,QAENxG,EAAGyG,qBACLtgB,EAAI0D,wBAAwBT,EAAMU,GAAUlD,KAC9C,SAASC,GACRX,EAAUQ,KAAK,YAEhB,SAASI,GACW,mCAAfA,EAAIwf,UAA8Cxf,EAAIwf,QAAU,wCACpEtG,EAAGqG,SAASlS,IAAIrN,EAAIwf,QAAQ,YAOhCtG,EAAG6G,QAAU,WACZ1gB,EAAIkI,oBAAoBzH,KACvB,SAASC,GACRX,EAAUQ,KAAK,YAEhB,SAASI,GACRkZ,EAAGqG,SAASlS,IAAIrN,EAAIwf,QAAQ,YAK7BtG,EAAG8G,SAAW,WACb9G,EAAG+G,OAAOT,QAAU,GACnBte,eACG2B,MAAMqW,EAAG9S,aACTiU,MAAM,SAASra,GACdoC,QAAQC,IAAIrC,GACZkZ,EAAG+G,OAAOT,QAAUxf,EAAIwf,UAEzB1f,KAAK,WACJV,EAAUQ,KAAK,aApFvBK,QACCC,OAAO,SACPrB,WAAW,YAAaygB,GAEzBA,EAAUlc,SAAW,YAAa;CCNpC,WAOE,QAAS8c,GAAa9gB,EAAWC,EAAK8gB,GACpC,GAAIjH,GAAK7P,IAET6P,GAAG9S,aACD7D,KAAO,GACPD,MAAQ,GACRU,SAAW,IAGfkW,EAAGkH,SAAW,EAEZlH,EAAGqG,UACJC,QAAU,GACVC,KAAM,GACNpS,IAAK,SAASmS,EAASC,GACtBvG,EAAGqG,SAASC,QAAUA,EACtBtG,EAAGqG,SAASE,KAAOA,GAEpBC,MAAO,WACNxG,EAAGqG,SAASC,QAAU,GACtBtG,EAAGqG,SAASE,KAAO,KAIrBvG,EAAGmH,WAAa,SAASb,EAASC,GACjCvG,EAAGqG,SAASC,QAAUA,EACtBtG,EAAGqG,SAASE,KAAOA,GAGpBvG,EAAGoH,aAAe,WACjBpH,EAAGqG,SAASC,QAAU,GACtBtG,EAAGqG,SAASE,KAAO,IAKpBvG,EAAGqH,yBAA2B,WAG7B,QAASC,GAAiBxd,GAUzB,GAAI6c,GAAK,wDACT,OAAOA,GAAGC,KAAK9c,GAGhB,QAAS4c,GAActd,GACpB,GAAIud,GAAK,wJACT,OAAOA,GAAGC,KAAKxd,GAIlB,MAtBAF,SAAQC,IAAI,kBAsBP6W,EAAG9S,YAAY9D,OAAU4W,EAAG9S,YAAY7D,MAAS2W,EAAG9S,YAAYpD,UAAakW,EAAG9S,YAAYqa,iBAO5FD,EAAiBtH,EAAG9S,YAAYpD,WACpCkW,EAAGqG,SAASlS,IAAI,6QAGb6L,EAAG9S,YAAYpD,WAAakW,EAAG9S,YAAYqa,iBAC9CvH,EAAGqG,SAASlS,IAAI,yCAA0C,UACnD,KAGJuS,EAAc1G,EAAG9S,YAAY9D,SAChC4W,EAAGqG,SAASlS,IAAI,sCAAuC,UAChD,KAjBPjL,QAAQC,IAAI,aACZD,QAAQC,IAAI6W,EAAG9S,aACf8S,EAAGqG,SAASlS,IAAI,0BAA2B,UACpC,IAqBP6L,EAAGwH,aAAe,WACjBxH,EAAGqG,SAASG,QAERxG,EAAGqH,4BACLlhB,EAAIiJ,qBAAqB4Q,EAAG9S,YAAY9D,MAAO4W,EAAG9S,YAAYpD,UAAUlD,KACvE,WACFoZ,EAAGkH,SAAW,GAEZ,SAASpgB,GACTkZ,EAAGqG,SAASlS,IAAIrN,EAAIwf,QAAS,YAOjCtG,EAAGyH,YAAc,WAClBzH,EAAGoH,eACHjhB,EAAIqL,qCAAqCwO,EAAG9S,YAAY9D,MAAO4W,EAAG9S,YAAYwa,MAAM9gB,KAChF,SAASC,GACXmZ,EAAGmH,WAAWF,EAAKU,YAAY,6EAA8E,YAE3G,SAAS7gB,GACW,qDAAfA,EAAIwf,UAAgExf,EAAIwf,QAAU,kCACvFtG,EAAGmH,WAAWrgB,EAAIwf,QAAS,YAM9BtG,EAAG4H,WAAa,WAEfzhB,EAAIuK,uBAAuBsP,EAAG9S,YAAY9D,OAG1C4W,EAAGmH,WAAW,4CAA4CnH,EAAG9S,YAAY9D,MAAM,iDAAkD,YA5HpIrC,QACGC,OAAO,SACPrB,WAAW,eAAgBqhB,GAE9BA,EAAa9c,SAAW,YAAa,MAAO","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('bdApp', ['ngRoute', 'ngAnimate','ngSanitize', 'angular-gestures']); \n  \n  \n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: '/pages/home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/register', {\n        templateUrl: '/pages/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/pages/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/closet', {\n        templateUrl: '/pages/closet/closet.view.html',\n        controller: 'closetCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/customizer/:jean_id?/:action?', {\n        templateUrl: '/pages/customizer/customizer.view.html',\n        controller: 'customizerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/admin', {\n        templateUrl: '/pages/admin/admin.view.html',\n        controller: 'adminCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n    \n   }\n\n  function run($rootScope, $location, aws) {\n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n\t    var locked = [\n\t\t    '/closet'\n\t    ];\n\t    if (locked.indexOf($location.path()) >= 0 ){\n\t\t    aws.getCurrentUserFromLocalStorage().then(\n\t\t\t    function(result){\n\t\t\t\t    return true;\n\t\t\t\t  },\n\t\t\t\t  function(err){\n\t\t\t\t\t  $location.path('/login');\n\t\t\t\t\t}\n\t\t    );\n\t  \t}\n    });\n  }\n  \n  angular\n    .module('bdApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'aws', run])\n\t\t.filter('spaceless',function() {\n\t    return function(input) {\n\t      if (input) {\n\t      \treturn input.replace(/\\s+/g, '-');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('scoreToSpace',function() {\n\t    return function(input) {\n\t      if (input) {\n\t      \treturn input.replace(/_+/g, ' ');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('minMax',function(min, max, key) {\n\t\t\treturn function(input){\n\t\t\t\tif (min && input[key] < min) return false;\n\t\t\t\tif (max && input[key] > max) return false;\n\t\t    return true;\n\t\t  }  \n\t\t})\n\t\t.filter('displayName',function() {\n\t\t\treturn function(input){\t\t\t\t\n\t\t\t\treturn input ? input.replace(/Raw Denim/g, \"\") : false;\n\t\t  }  \n\t\t})\n\t\t\n\t\t.filter('listData',function() {\n\t\t\treturn function(input){\n\t\t\t\tvar retObj = {}; \n\t\t\t\tvar display = [\n\t\t\t\t\t'fabric',\n\t\t\t\t\t'accent_thread',\n\t\t\t\t\t'top_thread',\n\t\t\t\t\t'bottom_thread',\n\t\t\t\t\t'gender',\n\t\t\t\t\t'style'\n\t\t\t\t];\n\t\t\t\n\t\t\t\tfor (key in input){\n\t\t\t\t\tif (display.indexOf(key)>=0)\n\t\t\t\t\t\tretObj[key] = input[key];\t\t\t\n\t\t\t\t}\n\t\t\t\treturn retObj;\n\t\t  }  \n\t\t})\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n})();","// Autogenerated file, do not modify directly\n\n(function() {\n\nconst configOverridesGenerated = {\n  \"REGION\": \"us-east-1\",\n  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n};\n\nreturn configOverridesGenerated;\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .service('authentication', authentication);\n\n  authentication.$inject = ['$http', '$window', 'aws', '$q'];\n  function authentication ($http, $window, aws, $q) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function() {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      } else {\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        console.log(token);\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        return {\n          email : payload.email,\n          name : payload.name\n        };\n      }\n    };\n\n\t\t\n\t\tvar isAdmin = function(){\n\t\t\tif(isLoggedIn()){\n        var token = getToken();\n\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        console.log(payload);\n        var roles = payload.permissions;\n\t\t\t\treturn roles.indexOf('admin') !== -1;\n      }\n\t\t}\n\n    \n\n    \n\n\n//\t\tconsole.log(aws.authenticateCognitoUser('cplefevre', 'ConfitConfit@123'));\n\n\t\tvar register = function(userDetails){\n\t\t\t//console.log(userDetails);\n\t\t//\tconsole.log(aws.signupForApplication('hello@confitdesign.com', 'ConfitConfit@123'));\t\n\t\t}\n    \n\n\t\t\n    \n\n    login = function(user) {\n\t    \n\t    aws.authenticateCognitoUser(user, password);\n\t\t};\n\n    logout = function() {\n      $window.localStorage.removeItem('mean-token');\n    };\n\n    return {\n      //userAttrList: userAttrList,\n      //createUserAttributeList: createUserAttributeList,\n      //userPool: userPool,\n\t    isAdmin : isAdmin,\n      currentUser : currentUser,\n      saveToken : saveToken,\n      getToken : getToken,\n      isLoggedIn : isLoggedIn,\n      register : register,\n      login : login,\n      logout : logout\n    };\n  }\n\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .service('aws', aws);\n\n  aws.$inject = ['$http', '$window', '$q', 'AWSConfig'];\n  function aws ($http, $window, $q, AWSConfig) {\n\t\t\t\n    function _getUserPool() {\n      var poolData = { UserPoolId : AWSConfig.USER_POOL_ID, ClientId : AWSConfig.CLIENT_ID };\n      var userPool = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData);\n      return userPool;\n    }\n\n    function _getAuthenticationDetails(uname, pword) {\n      var authenticationData = {\n        Username : uname,\n        Password : pword,\n      };\n      var authenticationDetails = new AWSCognito.CognitoIdentityServiceProvider.AuthenticationDetails(authenticationData);\n      return authenticationDetails;\n    }\n      \n    function _getCognitoUser(uname, upool) {\n      var userData = { Username : uname, Pool : upool };\n      var cognitoUser = new AWSCognito.CognitoIdentityServiceProvider.CognitoUser(userData);\n      return cognitoUser;\n    }\n\n    function _buildAttribute(keyName, value) {\n      var attribute = {\n        Name: keyName,\n        Value: value\n      }\n      var result = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserAttribute(attribute);\n      return result;\n    }\n\n    function _buildAttributeList(attributeBuilder, obj) {\n      var attrList = [];\n      var attrToAdd;\n      for (var key in obj) {\n        attrToAdd = attributeBuilder(key, obj[key]);\n        attrList.push(attrToAdd);\n      }\n      return attrList;\n    }\n      \n    function _parseIdentityId(jwt){\n\t    var idTokenPayload = jwt.split('.')[1];\n\t\t\treturn JSON.parse(atob(idTokenPayload)).sub;\t\t\t\t\n    }\n    \n\t\tfunction _getAWSCredentials(idToken){\n\t\t\tvar defer = $q.defer();\n\t\t\tvar logins = {};\n\t\t\tlogins['cognito-idp.' + AWSConfig.REGION + '.amazonaws.com/' + AWSConfig.USER_POOL_ID]=idToken;\n\t\t\t\n\t\t\tAWS.config.update({\n\t\t\t\tregion: AWSConfig.REGION,\n\t\t\t\tcredentials: new AWS.CognitoIdentityCredentials({\n\t\t\t\t\tIdentityPoolId: AWSConfig.IDENTITY_POOL_ID,\n\t\t\t\t\tLogins : logins\n\t\t\t\t})\n\t\t\t});\n\t\t\t\n\t    if (AWS.config.credentials.needsRefresh()){\n\t      AWS.config.credentials.clearCachedId();\n\t      AWS.config.credentials.get(function(err){\n\t        if (err) {\n\t          defer.reject(err);\n\t        }\n\t        defer.resolve();\n\t      });\n\t    } else {\n\t      AWS.config.credentials.get(function(err){\n\t        if (err) {\n\t          defer.reject(err);\n\t        }\n\t        defer.resolve();\n\t      });\n\t    }\n\t\t\t\n\t\t\treturn defer.promise;\n\t\t\t\n\t\t}\n\t\t\t\n    getUserFromLocalStorage = function(username) {\n      var cognitoUser = _getCognitoUser(username, _getUserPool());\n      if (cognitoUser != null) {\n          cognitoUser.getSession(function(err, session) {\n              if (err) {\n                  alert(err);\n                  return;\n              }\n              console.log('session validity: ' + session.isValid());\n          });\n      }\n    }\n\n    deleteCognitoUser = function() {\n      var cognitoUser = _getUserPool().getCurrentUser();\n      cognitoUser.deleteUser(function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\t\t\n\n\t\tauthenticateViaFB = function(){\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\t\n\t\t\tFB.login(function (response) {\n\t\t\t  if (response.authResponse) { // logged in\n\t\t\t    AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n\t\t\t      IdentityPoolId: AWSConfig.IDENTITY_POOL_ID,\n\t\t\t      Logins: {\n\t\t\t        'graph.facebook.com': response.authResponse.accessToken\n\t\t\t      }\n\t\t\t    });\n\t\t\t\n\t\t\t    defer.resolve();\n\t\t\t  } else {\n\t\t\t    defer.reject('There was a problem logging in with Facebook.');\n\t\t\t  }\n\t\t\t});\n\t\t\t\n\t\t\treturn defer.promise;\t\t\n\t\t}\n\t\t\n    authenticateCognitoUser = function(username, password) {\n      var authenticationDetails = _getAuthenticationDetails(username, password);\n      var cognitoUser = _getCognitoUser(username, _getUserPool());\n      \n      var defer = $q.defer();\n      \n      \n      cognitoUser.authenticateUser(authenticationDetails, {\n        onSuccess: function (result) {\n\t\t\t\t\tdefer.resolve(result);\n\t\t\t\t\tconsole.log('access token + ' + result.getAccessToken().getJwtToken());\n\t\t\t\t\t//Use the idToken for Logins Map when Federating User Pools with Cognito Identity or when passing through an Authorization Header to an API Gateway Authorizer\n\t\t\t\t\tconsole.log('idToken + ' + result.idToken.jwtToken);\n        },\n        onFailure: function(err) {\n          defer.reject(err);\n        }, \n        newPasswordRequired: function(userAttributes, requiredAttributes) {\n          // User was signed up by an admin and must provide new\n          // password and required attributes, if any, to complete\n          // authentication.\n\t\t\t\t\tconsole.log(userAttributes, requiredAttributes);\n\n          // the api doesn't accept this field back\n          //delete userAttributes.email_verified;\n\n          // Get these details and call\n\t        // cognitoUser.completeNewPasswordChallenge(\"ConfitConfit@123\", userAttributes, this);\n\t      }\n      });\n      \n      return defer.promise;\n    }\n\t\t\n\n    signupForApplication = function(emailAddress, password) {\n\t    \n\t    var defer = $q.defer();\n\t    \n      var attributeList = _buildAttributeList(_buildAttribute, {email: emailAddress});\n      var cognitoUser;\n      _getUserPool().signUp(emailAddress, password, attributeList, null, function(err, result) {\n        if (err) defer.reject(err);\n        else defer.resolve(result);\n      });\n      \n      return defer.promise;\n    }\n\n    updateAttributesOnUser = function(username, obj) {      \n      var attributeList = _buildAttributeList(_buildAttribute, obj);\n      var cognitoUser   = _getCognitoUser(username, _getUserPool());\n      cognitoUser.updateAttributes(attributeList, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          console.log('call result: ' + result);\n      });\n    }\n\n    deleteUserAttributes = function(cognitoUser, attributeList) {\n      cognitoUser.deleteAttributes(attributeList, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          console.log('call result: ' + result);\n      });\n    }\n\n    verifyUserAttribute = function(cognitoUser, attributeName) {\n        cognitoUser.getAttributeVerificationCode(attributeName, {\n          onSuccess: function (result) {\n              console.log('call result: ' + result);\n          },\n          onFailure: function(err) {\n              alert(err);\n          },\n          inputVerificationCode: function() {\n              var verificationCode = prompt('Please input verification code: ' ,'');\n              cognitoUser.verifyAttribute(attributeName, verificationCode, this);\n          }\n      });\n    }\n\n    retrieveUserAttributes = function(cognitoUser) {\n      cognitoUser.getUserAttributes(function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          for (i = 0; i < result.length; i++) {\n              console.log('attribute ' + result[i].getName() + ' has value ' + result[i].getValue());\n          }\n      });\n    }\n\n    resendConfirmationCode = function(cognitoUser) {\n\t    if(!cognitoUser.resendConfirmationCode){\n\t\t  \t//We've just got an email address...\n\t\t  \tcognitoUser = _getCognitoUser(cognitoUser, _getUserPool());\n\t    }\n\t    \n      cognitoUser.resendConfirmationCode(function(err, result) {\n\t      \n\t      //TODO: This function throws an error on success that obscures a promise. Once the SDK has been fixed, we need to implement a promise structure to properly display results on the front end.\n        if (err) {\n          console.log(err);\n          return;\n        }\n        \n        //code has been sent\n        return true;\n      });\n    }\n    \n   confirmRegistration = function(cognitoUser, confirmationCode) {\n      cognitoUser.confirmRegistration(confirmationCode, true, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          alert(result);\n      });\n    }\n\n    changePassword = function(cognitoUser, oldPassword, newPassword) {\n      cognitoUser.changePassword(oldPassword, newPassword, function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\n    forgotPasswordFlow = function(cognitoUser) {\n      cognitoUser.forgotPassword({\n        onSuccess: function (result) {\n            console.log('call result: ' + result);\n        },\n        onFailure: function(err) {\n            alert(err);\n        },\n        \n        inputVerificationCode: function() {\n            var verificationCode = prompt('Please input verification code ' ,'');\n            var newPassword = prompt('Enter new password ' ,'');\n            cognitoUser.confirmPassword(verificationCode, newPassword, this);\n        }\n      });\n    }\n\n    deleteUser = function(cognitoUser) {\n      cognitoUser.deleteUser(function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\n    signUserOut = function(cognitoUser) {\n      if (cognitoUser != null) {\n          cognitoUser.signOut();\n      }\n    }\n    \n    signCurrentUserOut = function() {\n\t  \tvar cognitoUser = _getUserPool().getCurrentUser();\n      if (cognitoUser != null) {\n          cognitoUser.signOut();\n      }\n    }\n\n\n    signUserOutGlobally = function(cognitoUser) {\n      cognitoUser.globalSignOut();\n    }\n\t\t\n\t\t\n\n    getCurrentUserFromLocalStorage = function() {\n\n\t    var defer = $q.defer();\n      var cognitoUser = _getUserPool().getCurrentUser();\n      \n      if (cognitoUser != null) {\n        cognitoUser.getSession(function(err, session) {\n        \t\n        \t//TODO: Decide if further error handling is necessary...\n          if (err) {\n            defer.reject(err);\n            return defer.promise;\n          }\n\t\t\t\t\t\n\t\t\t\t\tAWS.config.credentials = new AWS.CognitoIdentityCredentials({\n            IdentityPoolId : AWSConfig.IDENTITY_POOL_ID\n          });\n\t          \n          //var loginKey = 'cognito-idp.'+AWSConfig.REGION+'.amazonaws.com/'+AWSConfig.USER_POOL_ID;\n          defer.resolve(session);\n          \n        });\n      }else{\n\t      defer.reject(\"User is not logged in...\");\n      }\n      \n      return defer.promise;\n    }\n\t\t\n\t\t\n    confirmRegisteredUnauthenticatedUser = function(userName, confirmationCode) {\n\t    \n      var cognitoUser = _getCognitoUser(userName, _getUserPool());\n\t    var defer = $q.defer();\n      \n      cognitoUser.confirmRegistration(confirmationCode, true, function(err, result) {\n        if (err) defer.reject(err);\n        else defer.resolve(result);\n      });\n      \n      return defer.promise;\n    }\n    \n\t\t\n    changePassword = function(cognitoUser, oldPassword, newPassword) {\n      cognitoUser.changePassword(oldPassword, newPassword, function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n   \n    \n    \n    \n    \n    //Save an image to s3 Bucket\n    saveImageTos3 = function (image, userTokens){\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\tvar userIdentityID = _parseIdentityId(userTokens.idToken.jwtToken);\n\t\t\t\n\t\t\tconsole.log(\"userIdentityID: \"+ userIdentityID);\n\t\t\t\n\t\t\t_getAWSCredentials(userTokens.idToken.jwtToken).then(\n\n\t\t\t\t//Got credentials.. now save image\n\t\t\t\tfunction(){\n\t\t\t\t\t\n\t\t\t\t\tvar bucketName = 'blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy';\n          var s3bucket = new AWS.S3({region: AWSConfig.REGION, params: {Bucket: bucketName}});\n          \n          console.log(AWSConfig.REGION);\n          \n          var params = {Key: encodeURIComponent(userIdentityID + \"//\") + \"myfilename.png\", Body: image};\n\t\t\t\t\t\n\t\t\t\t\tconsole.log(params);\n\t\t\t\t\t\n\t\t\t\t\t//This is throwing 403 error\n\t\t\t\t\ts3bucket.upload(params, function(err, data){\t      \n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tconsole.log('Failed to upload');\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t\tdefer.reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconsole.log('Successfully uploaded image to S3.');\n\t\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t}\n    \t\t\t});\n    \t\t\t\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t//Can't get AWS Credentials\n\t\t\t\tfunction(err){\n\t\t\t\t\tdefer.reject(err);\n\t\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t\treturn defer.promise;\n\n    }\n \n     \n      \n    \n    return {\n\t    authenticateViaFB: authenticateViaFB,\n\t    getUserFromLocalStorage: getUserFromLocalStorage,\n      deleteCognitoUser: deleteCognitoUser,\n      authenticateCognitoUser: authenticateCognitoUser,\n      signupForApplication: signupForApplication,\n      updateAttributesOnUser: updateAttributesOnUser,\n      deleteUserAttributes: deleteUserAttributes,\n      verifyUserAttribute: verifyUserAttribute,\n      retrieveUserAttributes: retrieveUserAttributes,\n      resendConfirmationCode: resendConfirmationCode,\n      confirmRegistration: confirmRegistration,\n      changePassword: changePassword,\n      forgotPasswordFlow: forgotPasswordFlow,\n      deleteUser: deleteUser,\n      signUserOut: signUserOut,\n      signUserOutGlobally: signUserOutGlobally,\n      getCurrentUserFromLocalStorage: getCurrentUserFromLocalStorage,\n      confirmRegisteredUnauthenticatedUser: confirmRegisteredUnauthenticatedUser,\n      signCurrentUserOut:signCurrentUserOut,\n      saveImageTos3 : saveImageTos3\n    };\n  }\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('bdAPI', bdAPI);\n\n  bdAPI.$inject = ['$window', '$http', '$httpParamSerializer'];\n  function bdAPI ($window, $http, $httpParamSerializer) {\n\t\t// if($window.BlueDeltaApi){\n\t  //   //Delete moment from window so it's not globally accessible.\n\t  //   //  We can still get at it through _thirdParty however, more on why later\n\n\t    $window._thirdParty = $window._thirdParty || {};\n\t  //   $window._thirdParty.BlueDeltaApi = $window.BlueDeltaApi;\n\t  //   try { delete $window.BlueDeltaApi; } catch (e) {$window.BlueDeltaApi = undefined;}\n\t  // }\n\t  $window._thirdParty.BlueDeltaApi =new API.Client.DefaultApi(angular.injector([\"ng\"]).get(\"$http\"),\n          angular.injector([\"ng\"]).get(\"$httpParamSerializer\"),\n          angular.injector([\"ng\"]));\n      //\n      //\n      var BlueDeltaApi = $window._thirdParty.BlueDeltaApi;\n\n\t\t// //JSON Data\n\t\tBlueDeltaApi.jsonData = {};\n\n\t\tBlueDeltaApi.jsonData.getJeansByUser = function(userId){\n\t\t\treturn $http.get('/data/chris-jeans.json');\n\t\t};\n\n\t\tBlueDeltaApi.jsonData.getProfile = function(){\n\t\t\treturn $http.get('/data/profile.json');\n\t\t};\n\n\t\tBlueDeltaApi.jsonData.getStyles = function(){\n\t\t\treturn $http.get('/data/styles.json');\n\t\t};\n\n\t\tBlueDeltaApi.jsonData.getThreads = function(){\n\t\t\treturn $http.get('/data/threads.json');\n\t\t};\n\n\t\tBlueDeltaApi.jsonData.getHardware = function(){\n\t\t\treturn $http.get('/data/buttons.json');\n\t\t};\n\n\t\tBlueDeltaApi.jsonData.getFabrics = function(){\n\t\t\treturn $http.get('/data/fabrics.json');\n\t\t};\n\n\t\tBlueDeltaApi.jsonData.getGenders = function(){\n\t\t\treturn $http.get('/data/genders.json');\n\t\t};\n\n\n\t\tBlueDeltaApi.jsonData.getJeanById = function(id, callback){\n\t\t\t$http.get('/data/chris-jeans.json').then(function(response){\n\t\t\t\tvar jeans = response.data;\n\t\t\t\tfor(j=0; j<response.data.length; j++){\n\n\t\t\t\t\tif (response.data[j].id == id){\n\t\t\t\t\t\tconsole.log('jean found');\n\t\t\t\t\t\tvar ret = response.data[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcallback(ret);\n\n\t\t\t});\n\t\t}\n\n\n\t  return BlueDeltaApi;\n  }\n\n})();","// Autogenerated file, do not modify directly\n(function () {\n  angular \n    .module('bdApp')\n    .service('AWSConfig', AWSConfig);\n      \n  function AWSConfig () {\n\t\treturn{\n\t\t\t\"REGION\": \"us-east-1\",\n\t\t  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n\t\t  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n\t\t  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n\t\t  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n\t\t  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n\t\t}\n  }\n\n\n})();","(function() {\n\n  angular\n    .module('bdApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\t\t\n\t\t/*\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n    */\n    var getOptions = function () {\t    \n      return $http.get('/api/options', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\t\t\n\t\t\n\t\t\n\t\t\n\t\tvar getJeanById = function(id, callback){\n\t\t\t$http.get('/data/chris-jeans.json').then(function(response){\n\t\t\t\tvar jeans = response.data;\n\t\t\t\tfor(j=0; j<response.data.length; j++){\n\n\t\t\t\t\tif (response.data[j].id == id){\n\t\t\t\t\t\tconsole.log('jean found');\n\t\t\t\t\t\tvar ret = response.data[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcallback(ret);\n\n\t\t\t});\n\t\t}\n\t\t\n\t\t//Placeholders\n\t\tvar getJeansByUser = function(userId){\n\t\t\treturn $http.get('/data/chris-jeans.json');\n\t\t};\t\t\n\t\tvar getProfile = function(){\n\t\t\treturn $http.get('/data/profile.json');\n\t\t};\n\t\t\n\t\tvar getStyles = function(){\n\t\t\treturn $http.get('/data/styles.json');\n\t\t};\n\t\t\n\t\tvar getThreads = function(){\n\t\t\treturn $http.get('/data/threads.json');\n\t\t};\n\t\t\n\t\tvar getHardware = function(){\n\t\t\treturn $http.get('/data/buttons.json');\n\t\t};\n\t\t\n\t\tvar getFabrics = function(){\n\t\t\treturn $http.get('/data/fabrics.json');\n\t\t};\n\t\t\n\t\t\n\t\tvar getGenders = function(){\n\t\t\treturn $http.get('/data/genders.json');\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\t\n    return {\n\t    getJeanById: getJeanById,\n\t    getJeansByUser : getJeansByUser,\n      getProfile : getProfile,\n      getOptions : getOptions,\n      getStyles : getStyles,\n      getThreads : getThreads,\n      getHardware: getHardware,\n      getFabrics: getFabrics,\n      getGenders: getGenders\n    };\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('jean', jean);\n\n  function jean() {\n\t\t\n   \tdata = {};\n\t\t\n\t\tset = function(property, value){\n\t\t\tthis.data[property] = value;\n\t\t};\n\t\t\n\t\tcreateNew = function(jean){\n\t\t\tif (!jean || jean.constructor != Object){\n\t\t\t\tthis.data = {\n\t\t\t\t\t\"gender\" : 1,\n\t\t\t\t\t\"style\" : 1,\n\t\t\t\t\t\"fabric\" : \"1004\",\n\t\t\t\t\t\"accent_thread\" : \"1\",\n\t\t\t\t\t\"top_thread\" : \"1\",\n\t\t\t\t\t\"bottom_thread\" : \"1\",\n\t\t\t\t\t\"id\":Math.floor(Math.random() * 1000000000)\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tthis.data = {\n\t\t\t\t\t\"title\" : \"Copy of \"+jean.data.title,\n\t\t\t\t\t\"gender\" : jean.data.gender,\n\t\t\t\t\t\"style\" : jean.data.style,\n\t\t\t\t\t\"fabric\" : jean.data.fabric,\n\t\t\t\t\t\"accent_thread\" : jean.data.accent_thread,\n\t\t\t\t\t\"top_thread\" : jean.data.top_thread,\n\t\t\t\t\t\"bottom_thread\" : jean.data.bottom_thread,\n\t\t\t\t\t\"id\":Math.floor(Math.random() * 1000000000)\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n    return {\n      data : data,\n      set : set,\n      createNew :createNew\n    };\n    \n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('popups', popups);\n\n  function popups() {\n\t\t\n    return {\n      denim : false,\n      hiw : false,\n      infoPop:false,\n      jeanProfile:false\n    };\n    \n  }\n\n})();","angular.module('bdApp')\n.factory('preloader', preloaderFunc);\n\npreloaderFunc.$inject = ['$q', '$rootScope'];\nfunction preloaderFunc( $q, $rootScope ) {\n  // I manage the preloading of image objects. Accepts an array of image URLs.\n  function Preloader( imageLocations ) {\n      // I am the image SRC values to preload.\n      this.imageLocations = imageLocations;\n      // As the images load, we'll need to keep track of the load/error\n      // counts when announing the progress on the loading.\n      this.imageCount = this.imageLocations.length;\n      this.loadCount = 0;\n      this.errorCount = 0;\n      // I am the possible states that the preloader can be in.\n      this.states = {\n          PENDING: 1,\n          LOADING: 2,\n          RESOLVED: 3,\n          REJECTED: 4\n      };\n      // I keep track of the current state of the preloader.\n      this.state = this.states.PENDING;\n      // When loading the images, a promise will be returned to indicate\n      // when the loading has completed (and / or progressed).\n      this.deferred = $q.defer();\n      this.promise = this.deferred.promise;\n  }\n  // ---\n  // STATIC METHODS.\n  // ---\n  // I reload the given images [Array] and return a promise. The promise\n  // will be resolved with the array of image locations.\n  Preloader.preloadImages = function( imageLocations ) {\n      var preloader = new Preloader( imageLocations );\n      return( preloader.load() );\n  };\n  // ---\n  // INSTANCE METHODS.\n  // ---\n  Preloader.prototype = {\n      // Best practice for \"instnceof\" operator.\n      constructor: Preloader,\n      // ---\n      // PUBLIC METHODS.\n      // ---\n      // I determine if the preloader has started loading images yet.\n      isInitiated: function isInitiated() {\n          return( this.state !== this.states.PENDING );\n      },\n      // I determine if the preloader has failed to load all of the images.\n      isRejected: function isRejected() {\n          return( this.state === this.states.REJECTED );\n      },\n      // I determine if the preloader has successfully loaded all of the images.\n      isResolved: function isResolved() {\n          return( this.state === this.states.RESOLVED );\n      },\n      // I initiate the preload of the images. Returns a promise.\n      load: function load() {\n          // If the images are already loading, return the existing promise.\n          if ( this.isInitiated() ) {\n              return( this.promise );\n          }\n          this.state = this.states.LOADING;\n          for ( var i = 0 ; i < this.imageCount ; i++ ) {\n              this.loadImageLocation( this.imageLocations[ i ] );\n          }\n          // Return the deferred promise for the load event.\n          return( this.promise );\n      },\n      // ---\n      // PRIVATE METHODS.\n      // ---\n      // I handle the load-failure of the given image location.\n      handleImageError: function handleImageError( imageLocation ) {\n          this.errorCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          this.state = this.states.REJECTED;\n          this.deferred.reject( imageLocation );\n      },\n      // I handle the load-success of the given image location.\n      handleImageLoad: function handleImageLoad( imageLocation ) {\n          this.loadCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          // Notify the progress of the overall deferred. This is different\n          // than Resolving the deferred - you can call notify many times\n          // before the ultimate resolution (or rejection) of the deferred.\n          this.deferred.notify({\n              percent: Math.ceil( this.loadCount / this.imageCount * 100 ),\n              imageLocation: imageLocation\n          });\n          // If all of the images have loaded, we can resolve the deferred\n          // value that we returned to the calling context.\n          if ( this.loadCount === this.imageCount ) {\n              this.state = this.states.RESOLVED;\n              this.deferred.resolve( this.imageLocations );\n          }\n      },\n      // I load the given image location and then wire the load / error\n      // events back into the preloader instance.\n      // --\n      // NOTE: The load/error events trigger a $digest.\n      loadImageLocation: function loadImageLocation( imageLocation ) {\n          var preloader = this;\n          // When it comes to creating the image object, it is critical that\n          // we bind the event handlers BEFORE we actually set the image\n          // source. Failure to do so will prevent the events from proper\n          // triggering in some browsers.\n          // --\n          // The below removes a dependency on jQuery, based on a comment\n          // on Ben Nadel's original blog by user Adriaan:\n          // http://www.bennadel.com/members/11887-adriaan.htm\n          var image = angular.element( new Image() )\n              .bind('load', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageLoad( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .bind('error', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageError( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .attr( 'src', imageLocation )\n          ;\n      }\n  };\n  // Return the factory instance.\n  return( Preloader );\n};","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('chooserCtrl', chooserCtrl)\n\t\n\t\tchooserCtrl.$inject = ['$scope', '$element','$timeout', '$window', 'jean', 'popups'];\n\n\t\t\n\t\tfunction chooserCtrl($scope, $element, $timeout, $window, jean, popups) {\n\t\n\t\t\tvar chvm = this;\n\t\t\t\n\t\t\t//popups\n\t\t\tchvm.popups = popups;\n\t\t\tchvm.jean = jean;\n\t\t\tchvm.breakPoint = 800;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfunction scrollToLeft(el, scrollTo, scrollDuration) {\n\t\t\t\t//Select First Element\n\t\t\t\tel = el[0];\n\t\t\t\t//Center Scroll To\n\t\t\t\tscrollTo = scrollTo-(el.offsetWidth/2)+40;\n\t\t\t\t\n\t\t\t\tvar maxLeft = el.scrollWidth - el.offsetWidth;\n\t\t\t\t\n\t\t\t\tif (scrollTo >= maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tif (scrollTo == maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tvar stepNum = Math.ceil(scrollDuration / 15),\n\t\t\t\t\t\tdistance = scrollTo - el.scrollLeft,\n\t\t\t\t\t\tscrollStep = (distance / stepNum),\n\t\t\t\t\t\tscrollTest = (el.scrollLeft < scrollTo ? function(a,b){return a<=b-1;} : function(a,b){return a>=b+1;} );\t\t\n\t\t\t\t/*\n\n\t\t\t\tconsole.log(\"current Scoll pos: \"+el.scrollLeft);\n\t\t\t\tconsole.log(\"Scroll to \"+scrollTo);\n\t\t\t\tconsole.log(\"distance to go \"+distance);\n\t\t\t\tconsole.log(scrollStep);\n\t\t\t\tconsole.log(\"func: \"+scrollTest)\n\t\t\t\tconsole.log(\"eval\");\n\t\t\t\tconsole.log(scrollTest(el.scrollLeft, scrollTo ));\n\t\t\t\tconsole.log(\"done\");\n\t\t\t\t*/\n\t\t\t\t\t\t\n\t\t\t\tvar scrollInterval = setInterval(function(){    \n\t\t\t\t\n\t\t\t\t\tif(scrollTest(el.scrollLeft, scrollTo )){\n\t\t\t\t\t\tvar newScroll = el.scrollLeft+scrollStep;\n\t\t\t\t\t\tif (newScroll >= maxLeft) newScroll = maxLeft-1;\n\t\t\t\t\t\tel.scrollLeft = newScroll;\n\t\t\t\t\t\t\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tconsole.log(newScroll);\n\t\t\t\t\t\tconsole.log(scrollTo);\n\t\t\t\t\t\t*/\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse clearInterval(scrollInterval); \n\t\t      \n\t  \t\t},15);\n\t\t\t  \n\t\t\t}\n\n\t\t\tchvm.selectorCoords = {\"top\":0, \"left\":0};\n\t\t\t\n\t\t\t\n\t\t\t//Center Selector on chooser change... Center on selected attr if edting preexisting jean...\n\t\t\t$scope.$watch('active', function(newValue,oldValue) {\t\n\t\t\t\t\n\t\t\t\t//Only on active choosers...\n\t\t\t\tif (newValue == true){\n\n\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar key = $scope.step.jeanKey+\"_\"+chvm.jean.data[$scope.step.jeanKey],\n\t\t\t\t\t\tactiveElement = angular.element(document.querySelector('#'+key));\n\t\t\t\t\t\t\n\t\t\t\t\t\tchvm.selectorCoords.top = activeElement.prop('offsetTop');\n\t\t\t\t\t\tchvm.selectorCoords.left = activeElement.prop('offsetLeft');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+$scope.step.jeanKey+\"-selector\"));\n\t\t\t\t\t\tselector.css({'top':chvm.selectorCoords.top+'px', 'left':chvm.selectorCoords.left+'px'});\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Mobile Choosers\n\t\t\t\t\t\tif ($window.innerWidth < chvm.breakPoint){\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0].querySelector('.chooser-grid'));\t\n\t\t\t\t\t\t\tvar left = (chooser[0] ? chvm.selectorCoords.left-(chooser[0].offsetWidth/2)+40 : 0);\n\t\t\t\t\t\t\tchooser.prop('scrollLeft', left);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Desktop Choosers\n\t\t\t\t\t\telse{\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0]);\t\n\t\t\t\t\t\t\tchooser.prop('scrollTop', chvm.selectorCoords.top - 15);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}, 200);\n\t\t\t\t\t\n\t\t\t\t}\t\t\n\t\t\t\t\n    \t});\n\n\n\t\t\tchvm.selectAttr = function($event, id, attr, selector){\n\t\t\t\tvar chooser = angular.element(document.querySelector(\"#\"+attr+\"-chooser\"));\n\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));\n\t\t\t\tvar top = angular.element($event.target).prop('offsetTop');\n\t\t\t\tvar left = angular.element($event.target).prop('offsetLeft');\n\t\t\t\tvar text = angular.element(document.querySelectorAll('#item-title'));\n\t\t\t\t\n\t\t\t\ttext.css({'right':'-400px', 'opacity':0});\n\t\t\t\tselector.css({'top':top+'px', 'left':left+'px'});\n\t\t\t\t\n\t\t\t\tchvm.selectorCoords = {\"top\":top,\"left\":left};\n\t\t\t\t\n\t\t\t\tif ($window.innerWidth < chvm.breakPoint) scrollToLeft(chooser, left, 200);\n\t\t\t\t\n\t\t\t\t$timeout(function(){\n\t\t\t\t\ttext.css({'right':'15px', 'opacity':1});\t\t\t\t\n\t\t\t\t\tchvm.jean.data[attr] =\tid;\t\n\t\t\t\t}, 200);\n\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tchvm.jeanSet = function(attr, val){\n\t\t\t\tchvm.jean.data[attr] =\tval;\n\t\t\t}\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('chooser', chooser);\n\t\t\n  function chooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('fabricChooser', ['$window', function($window) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      template: '<div class=\"fabric-chooser-container\" ng-include=\"viewUrl\"></div>',\n\t      controller: 'chooserCtrl as chvm',\n\t      scope : {\n\t        step : '=',\n\t        dataset: '=',\n\t\t\t\t\tactive: '='\n\t      },\n\t      \n\t      link: function($scope){\n\t\t      \n\t\t      $scope.breakPoint = 800;\n\t\t      \n\t\t      //Template on window resize\n\t\t      $window.onresize = function() {\n\t          changeTemplate();\n\t          $scope.$apply();\n\t        };\n\t        \n\t        changeTemplate();\n\t            \n\t        function changeTemplate() {\n\t          var screenWidth = $window.innerWidth;\n\t          if (screenWidth < $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-mobile.html\";\n\t          } else if (screenWidth >= $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-desk.html\";\n\t          }\n\t        }\n\t\t      \n\t\t      \n\t\t      function positionChooser(){\n\t\t\t    \t//element.animate({scrollLeft: element.offset().left - 50}, \"slow\");\n\t\t\t    \t//var selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));  \n\t\t      }\n\t\t      \n\t\t      \n\t\t      //Weight Filter\n\t\t      $scope.weightFilter = function(min, max){\n\t\t\t\t\t\treturn function(fabric){\n\t\t\t\t\t\t\tif (min && fabric.weight < min) return false;\n\t\t\t\t\t\t\tif (max && fabric.weight > max) return false;\n\t\t\t\t\t    return true;\n\t\t\t\t\t  }\n\t\t\t\t\t};\n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('genderChooser', genderChooser);\n\t\t\n  function genderChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/gender-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('styleChooser', styleChooser);\n\t\t\n  function styleChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/style-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      },\n      link: function($scope){\n\t      //Weight Filter\n\t      $scope.checkGenderFilter = function(gender){\n\t\t\t\t\treturn function(style){\n\t\t\t\t\t\treturn (style['images_'+gender] ? true:false);\n\t\t\t\t  }\n\t\t\t\t};\n\t    }\n     \n\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('jeanList', [function() {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t\t\t\ttemplateUrl: '/directives/jean-list/jean-list.template.html',\n\t      scope : {\n\t        jean : '='\n\t      },\n\t      \n\t      link: function($scope){\n\t\t\t\t\n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('istackCtrl', istackCtrl);\n\n  istackCtrl.$inject = ['$window', '$scope', '$q', 'jean'];\n  \n  \n  \n  function istackCtrl($window, $scope, $q, jean) {\n\t  var isvm = this;\n\t\tisvm.jean = jean;\n\t\tisvm.centerPan = false;\t\t\n\t\tisvm.zoom = false;\n\t\tisvm.pan = {\"x\":50, \"y\":30};\n\t\tisvm.isMobile = function(){ return $window.innerWidth<800 };\n\t\t\n\t\t\n\t\tisvm.toggleZoom = function(){\n\t\t\tisvm.zoom = !isvm.zoom\n\t\t}\n\t\t\n\t\tisvm.touchEnd = function(){\n\t\t\tisvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\t$scope.$apply();\n\t\t}\n\t\t\n\t\tisvm.returnPan = function(){\n\t\t\tif (isvm.isMobile()) return false;\n\t\t\tisvm.pan = \"50% 30% 0\";\t\n\t\t\tisvm.centerPan = true;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\tsetTimeout(function(){\n\t\t\t\timages.css({\"transform-origin\":isvm.pan});\n\t\t\t}, 200);\n\t\t}\n\t\t\t\t\n\t\tisvm.touchStart= function(e){\t\n\t\t\t//Setup Swipe starting point\n\t\t\tisvm.swipeStart={\"x\":e.touches[0].clientX,\"y\":e.touches[0].clientY};\n\t\t\t//Clear out Swipe Object\n\t\t\tisvm.swipe={};\n\t\t}\n\t\t\n\t\tisvm.zoomDrag = {\"x\":0,\"y\":0};\n\t  isvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\n\t\tisvm.touchMove= function(e){\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t//Prevent Scrolling?\n\t\t\te.preventDefault();\n\t\t\t\n\n\t\t\tvar touch = e.touches[0],\n\t\t\ttarget = touch.target,\n\t\t\tdrag = {\n\t\t\t\t\"x\" : touch.clientX-isvm.swipeStart.x,\n\t\t\t\t\"y\" : touch.clientY-isvm.swipeStart.y\n\t\t\t};\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = (x/target.clientWidth*100)+isvm.zoomDrag.x,      \n\t\t\ty = (y/target.clientHeight*100)+isvm.zoomDrag.y;\n\n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -120;\n\t\t\tbounds.x.right  = 90;\n\t\t\t\n\t\t\t//Apply Bounds\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y};\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\tisvm.dragTracker = drag;\t\n\t\t\t$scope.$apply();\n\n\t\t}\n\t\t\n\n\n\n\t\tisvm.dragPan = function(u, event) {\n\t\t\n\t\t\tconsole.log(event.direction);\n\t\t\t\n\t\t\t\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\")),\n\t\t\twindowHeight = window.innerHeight,\n\t\t\torigHeight = images[0].height,\n\t\t\tnewHeight = origHeight*1.7,\n\t\t\tframe={\n\t\t\t\t\"width\":event.target.clientWidth,\n\t\t\t\t\"height\":event.target.clientHeight\n\t\t\t};\n\t\t\t\n\n\t\t\t//Get drag length\n\t\t\tvar drag = {\n\t\t\t\t\"x\" : event.deltaX,\n\t\t\t\t\"y\" : event.deltaY\n\t\t\t}\n\t\t\t\n\t\t\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\n\t\t\tconsole.log(x,y);\n\t\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = Math.abs(x)/frame.width*100;      \n\t\t\tx = (drag.x<0)?-x:x;\t       \n\t\t\tvar y = Math.abs(y)/frame.height*100;\n\t\t\ty = (drag.y<0)?-y:y;\n\t\t\t\n\t\t\t//Add these values to the last drag. This essentially allows drag and drop\n\t\t\tx=x+isvm.zoomDrag.x;\n\t\t\ty=y+isvm.zoomDrag.y;\n\t\t\t\t \n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\n\t\t\t/*//Left/Right Bounds\n\t\t\tbounds.y.top =(newHeight/2)+175;\n\t\t\tbounds.y.bottom =-(newHeight*.225);\n\t\t\tbounds.x.left = -(event.target.clientWidth-(event.target.clientWidth*.05));\n\t\t\tbounds.x.right = event.target.clientWidth-(event.target.clientWidth*.05);*/\n\t\t\t\t\n\t\t\t//Transform Origin Bounds\n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -150;\n\t\t\tbounds.x.right  = 60;\n\t\t\t\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y}\n\t\t\t\n\t\t\tconsole.log(move);\n\t\t\t//Register Drag\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t       \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\t/*//Alter Left/Bottom\n\t\t\timages.css('left', move.x+\"px\");\n\t\t\timages.css('bottom', -move.y+\"px\");*/\n\t\t\t\n\t\t\t//When drag is over, reset drag tracker\t \n\t\t\tisvm.dragTracker = event.isFinal ? {\"x\":0,\"y\":0} : drag;\n\t\t\t\t \n\n\t\t}\n\t\t\n\n\t\t\n\n\t\t\n\n\t\tisvm.scanImage = function(x,y){\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tisvm.centerPan = false;\n\t\t\t}, 200);\n\t\t\t\n\t\t\t\n\t\t\tframe = angular.element(document.querySelector(\"#zoom-frame\"))[0];\n\t\t\tfWidth = frame.clientWidth;\n\t\t\tfHeight = frame.clientHeight;\n\t\t\trect = frame.getBoundingClientRect();\n\t\t\trootDoc = frame.ownerDocument.documentElement;\n\t\t\t\t//calculate the offset of the frame from the top and left of the document\n\t\t\toffsetT = rect.top + $window.pageYOffset - rootDoc.clientTop\n\t\t\toffsetL = rect.left + $window.pageXOffset - rootDoc.clientLeft\n\n\t\t\t//calculate current cursor position inside the frame, as a percentage\n\t\t\txPosition = ((x - offsetL) / fWidth) * 100\n\t\t\tyPosition = ((y - offsetT) / fHeight) * 100\n\t\t\t\n\t\t\t\n\t\t\t/*\n\t\t\tconsole.log(x,y);\n\t\t\tconsole.log(fWidth);\n\t\t\tconsole.log(offsetL);\n\t\t\tconsole.log(x-offsetL);\n\t\t\tconsole.log(xPosition, yPosition);\n\t\t\t*/\n\t\t\tif ($window.innerWidth < isvm.breakPoint) pan = (100-xPosition) + \"% \" + (100-yPosition) + \"% 0\";\n\t\t\telse pan = (xPosition) + \"% \" + (yPosition) + \"% 0\";\n\t\t\tisvm.pan=pan;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\timages.css({\"transform-origin\":pan});\n\t\t}\n\t\t\n\t\tisvm.trackMouse = function($event){\n\t\t\t//if (isvm.isMobile()) return false;\n\t\t\tisvm.scanImage($event.pageX,$event.pageY);\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('imageStack', imageStack);\n\t\t\n\n\t\n  function imageStack () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/image-stack/image-stack.template.html',\n      controller: 'istackCtrl as isvm',\n      link: function(scope, ele, attrs, ctrl) {\n\t      \n\t      \n\t     ele.on('touchstart', function(e){\n\t\t\t \tscope.isvm.touchStart(e);\t\n\t     });\t\n\t     \n\t     ele.on('touchmove', function(e){\n\t\t\t \tscope.isvm.touchMove(e);\t\n\t     });\t\t\n\t     \n\t     ele.on('touchend', function(e){\n\t\t\t \tscope.isvm.touchEnd(e);\t\n\t     });\t\t\t\t\n\t\t\t\n       \n\t      /*\n\t      $swipe.bind(ele, {\n          'move': function(event) {\n\t\t\t\t\t\tscope.isvm.scanImage(coords.x,coords.y);\n          }\n\t      });\n\t     */\n\n\t    }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','$route','popups', 'aws'];\n  function navigationCtrl($location, $route, popups, aws) {\n    var vm = this;\n\t\t\n\n\t\tvm.isLoggedIn = null;\n\t\taws.getCurrentUserFromLocalStorage().then(\n\t\t\tfunction(result){\n\t\t\t\tif (result.accessToken != \"\") vm.isLoggedIn = true;\n\t\t\t},\n\t\t\tfunction(err){\n\t\t\t\tconsole.log(err);\n\t\t\t\tvm.isLoggedIn = false;\n\t\t\t}\n\t\t);\n\t\t\n\t\t\n\t\t//vm.isAdmin = accountManagement.isAdmin();\n    //vm.currentUser = accountManagement.currentUser();\n\t\t\n\t\tvm.drops={};\n\t\tvm.drops.acct=false;\n\t\tvm.mobileMenu = false;\n\t\t\n\t\tvm.logout = function(){\n\t\t\taws.signCurrentUserOut();\n\t\t\tif ($location.path() == \"/\")\n\t\t\t\t$route.reload();\n\t\t}\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('sliderCtrl', sliderCtrl)\n\t\n\t\tsliderCtrl.$inject = ['$scope', 'preloader'];\n\n\t\tfunction sliderCtrl($scope, preloader) {\n\t\t\tvar slvm = this;\n\n\t\t\t\n\t\t\t$scope.imagesLoaded = false;\n\t\t\t\n\t\t\tpreloader.preloadImages( $scope.slides )\n\t\t\t.then(function() {\n\t\t\t\t$scope.imagesLoaded = true;\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\tconsole.log(\"error loading imgaes...\");\n\t\t\t});\n\t\t \t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t$scope.currentIndex = 0;\n\t\t\t\n\t\t\t$scope.setCurrentSlideIndex = function (index) {\n\t\t\t  $scope.currentIndex = index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.isCurrentSlideIndex = function (index) {\n\t\t\t  return $scope.currentIndex === index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.nextSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex < $scope.slides.length - 1) ? ++$scope.currentIndex : 0;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.prevSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex > 0) ? --$scope.currentIndex : $scope.slides.length - 1;\n\t\t\t};\n\t\t\t\t\n\t\t}\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('slider', slider);\n\t\t\n  function slider () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/slider/slider.template.html',\n      controller: 'sliderCtrl as slvm',\n      scope : {\n        slides : '=',\n        imageClick : '&'\n      }\n    };\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('adminCtrl', adminCtrl);\n\n  adminCtrl.$inject = ['$location', 'meanData'];\n  function adminCtrl($location, meanData) {\n\t  \n\t  \n    var vm = this;\n\n    vm.user = {};\n    meanData.getOptions()\n      .success(function(data) {\n\t      console.log(\"admin.controller.jsln16:::\");\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('closetCtrl', closetCtrl);\n\n  closetCtrl.$inject = ['$location', 'jean','popups', '$filter', 'aws', 'bdAPI', '$scope'];\n  function closetCtrl($location, jean, popups, $filter, aws, bdAPI, $scope) {\n\t  \n\n\t  \n    var vm = this;\n    \n\t\tvm.popups=popups;\n\t\tvm.jean=jean;\n\t\tvm.data={};\n\t\tvm.jeans = [];\n    aws.getCurrentUserFromLocalStorage().then(\n    \tfunction(result){\n\t    \t\n\t    \tbdAPI.defaultHeaders_['Authorization'] = result.idToken.getJwtToken();\n\t    \tvm.setUpClosetData();\n\t    \t\n\t    \t//Set Up user\n\t    \tvar idTokenPayload = result.idToken.jwtToken.split('.')[1];\n\t\t\t\tvar userID = JSON.parse(atob(idTokenPayload)).sub;\t\t\t\t\n\t\t\t\tbdAPI.usersGet(userID).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tvm.user = result.data;\t\n\t\t\t\t\t\t$scope.$apply();\n\t\t\t\t\t\t\n\t\t\t\t\t\t//var user = result.data;\n\t\t\t\t\t\t//user.name = \"Chris LeFevre\";\n\t\t\t\t\t\t//bdAPI.usersUpdate(userID, user);\n\t\t\t\t\t}, \n\t\t\t\t\tfunction(err){console.log(err)} \n\t\t\t\t);\n    \t},    \t\n    \tfunction(err){\n\t    \tconsole.log('you are not authenticated...'+err);\n    \t}\n    );\n\t\t\n\n\t\t//Utility function for setting up customizer data from JSON... \n\t\tvm.setupData = function (func, dataKey) {\n\t\t  bdAPI.jsonData[func]()\n\t\t   .success(function(data) {\n        vm.data[dataKey] = data;\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n\t\t}\n\n\t\t\n\t\tvar logError = function(err){console.log(err)};\n\t\t\n\t\t\n\t\t//Set up Closet Data using JSON\n\t\tvm.setUpClosetData = function(){\n\t\n\t\t\n\t\t\t\n\t\n\t\t\t\n\t\t\tvm.setupData('getGenders', 'genders');\n\t\t\tvm.setupData('getStyles', 'styles');\n\t\t\tvm.setupData('getFabrics', 'fabrics');\n\t\t\tvm.setupData('getThreads', 'threads');\n\t\t\t\n\t\t\tbdAPI.jsonData.getJeansByUser(1)\n\t\t  .success(function(data) {\n\t\t\t\tfor (x=0; x<data.length; x++){\n\t\t\t\t\tvm.jeans.push(data[x]);\n\t\t\t\t}\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n      \n\t\t}\n\t\t\n\n\t\t\n\t\n\n\n\n\n\n\t\tvm.dataLookup = function(jeanKey, id, attr){\n\n\t\t\tif (typeof jeanKey == 'undefined' || typeof id == 'undefined') return false;\n\t\t\tattr = attr||null;\n\t\t\t\n\t\t\tvar dataKey = (jeanKey.includes(\"thread\") ? \"threads\" : jeanKey+\"s\");\n\t\t\t\n\t\t\tvar dataSet = vm.data[dataKey];\n\t\t\tselected = $filter('filter')(dataSet, {id: id})[0];\n\t\t\tif (!attr) return selected;\n\t\t\telse return selected[attr];\t\n\t\t}\n\t\t\n\t\tvm.copyJean = function(){\n\t\t\tvm.jean = jean.createNew(vm.jean);\n\t\t\t$location.path('/customizer');\n\t\t}\n\t\t\n\t\tvm.selectJean = function(jean){\n\t\t\tconsole.log(jean);\n\t\t\tconsole.log(vm.jean);\n\t\t\tvm.popups.jeanProfile = true; \n\t\t\tvm.jean.data=jean\n\t\t}\n\t\t\n\t\n\t\t\n\t\t//Get User\n  }\n  \n\n\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('customizerCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['$q','$filter','$timeout','$location', '$window', '$routeParams', 'bdAPI', 'jean', '$scope', 'popups', 'aws'];\n  function customizerCtrl($q, $filter, $timeout, $location, $window, $routeParams, bdAPI, jean, $scope, popups, aws) {\n    var vm = this;\n\t\t\n\n\t\t//Detect Orientation\t\t\n\t\tfunction landscapeDetect() {\n\t\t  var ua = navigator.userAgent.toLowerCase();\n\t\t  var isAndroid = ua.indexOf(\"android\") > -1; // Detect Android devices\n\t\t  if (isAndroid) {\n\t\t    //window.orientation is different for iOS and Android\n\t\t    if (window.orientation == 0 || window.orientation == 180) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 90 || window.orientation == -90) { //Portrait Mode\n\t\t\t\t\treturn false;\n\t\t    }\n\t\t  }\n\t\t  else {\n\t\t    if (window.orientation == 90 || window.orientation == -90) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 0 || window.orientation == 180) { //Portrait Mode\n\t\t      return false;\n\t\t    }\n\t\t  }\n\t\t}\n    \n    vm.landscape=landscapeDetect();\n  \tvar supportsOrientationChange = \"onorientationchange\" in window,\n    orientationEvent = supportsOrientationChange ? \"orientationchange\" : \"resize\";\n\t\t\n\t\twindow.addEventListener(orientationEvent, function() {\t\n\t\t\t//Set a scope variable on orientation change. This will display a popup on the front end warning users that the customizer works best in protrait mode\n\t\t  vm.landscape=landscapeDetect();\n\t\t  $scope.$apply();\n\t\t}, false);\n\t\t\n\t\t\n\t\t//popups\n\t\tvm.popups = popups;\n\t\t\n\n\t\tfunction parseURLkey(key){\n\t\t\tswitch(key){\n\t\t\t\tcase \"g\":\n\t      return \"gender\";\n\t      break;\n\t      \n\t      case \"s\":\n\t      return \"style\";\n\t      break;\n\t      \n\t      case \"f\":\n\t      return \"fabric\";\n\t      break;\n\t      \n\t      case \"tt\":\n\t      return \"top_thread\";\n\t      break;\n\t      \n\t      case \"tb\":\n\t      return \"bottom_thread\";\n\t      break;\n\t      \n\t      case \"ta\":\n\t      return \"accent_thread\";\n\t      \n\t      default: return false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction jeanKeytoURL(key){\n\t\t\tswitch(key){\n\t\t\t\tcase \"gender\":\n\t      return \"g\";\n\t      break;\n\t      \n\t      case \"style\":\n\t      return \"s\";\n\t      break;\n\t      \n\t      case \"fabric\":\n\t      return \"f\";\n\t      break;\n\t      \n\t      case \"top_thread\":\n\t      return \"tt\";\n\t      break;\n\t      \n\t      case \"bottom_thread\":\n\t      return \"tb\";\n\t      break;\n\t      \n\t      case \"accent_thread\":\n\t      return \"ta\";\n\t      \n\t      default: return false;\n\t\t\t}\n\t\t}\n\t\t\n\t\tconsole.log($routeParams);\n\t\t\n\t\t//Set up jean data from parameter\n\t\tif ($routeParams.jean_id && $routeParams.action=='copy'){\n\t\t\tif ($routeParams.jean_id.indexOf(\":\")>0){\n\t\t\t\tjean.createNew();\n\t\t\t\tjeanData = $routeParams.jean_id.split(\":\");\n\t\t\t\tfor(var d=0; d<jeanData.length; d++){\n\t\t\t\t\tvar parts= jeanData[d].match(/([A-Za-z]+)([0-9]+)/);\n\t\t\t\t\tif (!parts) continue;\n\t\t\t\t\tvar jeanKey = parseURLkey(parts[1]);\n\t\t\t\t\tif (jeanKey) jean.data[jeanKey] = parseInt(parts[2]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t//Copy Jean from ID\t\n\t\t\t\tjean.createNew($routeParams.jean_id);\n\t\t\t}\n\t\t\t\n\t\t//Lookup Jean by Id\n\t\t}else if ($routeParams.jean_id && !$routeParams.action){\n\t\t\t//Edit Jean\n\t\t\tbdAPI.jsonData.getJeanById($routeParams.jean_id, function(data){\n\t\t\t\tif (data){\n\t\t\t\t\tjean.data=data;\t\n\t\t\t\t}else{\n\t\t\t\t\t//jean id doesn't exist\n\t\t\t\t\tjean.createNew();\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t//New Jean\n\t\t}else{\n\t\t\t//New Jean\n\t\t\tif(Object.keys(jean.data).length === 0 && jean.data.constructor === Object){\n\t\t\t\tjean.createNew();\n\t\t\t}\t\t\t\n\t\t}\n\t\t\n\t\tvm.jean=jean;\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t//SHARE JEAN\n\t\tvm.jeanToUrl = function(){\n\t\t\tvar url = document.location.origin+\"/customizer/d\";\n\t\t\tfor (var property in vm.jean.data) {\n\t\t    if (vm.jean.data.hasOwnProperty(property)) {\n\t\t\t\t\tvar urlKey = jeanKeytoURL(property);\n\t\t\t\t\tif (urlKey) url += \":\"+urlKey+vm.jean.data[property];\n\t\t    }\n\t\t\t}\n\t\t\turl += \"/copy\";\n\t\t\tconsole.log(url);\n\n\t\t}\n\t\n    /*\n\t  vm.jean.selectStyle = function(id){\n\t    vm.jean.data.style =\tid;\t   \n\t    //vm.form.nextStep();\n    }    \n\t\t*/\n\n\t\t\n\t\t//Build Control Panel Steps\n\t\tvm.panel = [];\n\t\t\n\t\t//Gender\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"gender-chooser\",\n\t\t\t\"dataKey\":\"genders\",\n\t\t\t\"title\":\"Gender\",\n\t\t\t\"jeanKey\":\"gender\"\n\t\t});\n\t\t\n\t\t//Style\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"style-chooser\",\n\t\t\t\"dataKey\":\"styles\",\n\t\t\t\"title\":\"Style\",\n\t\t\t\"jeanKey\":\"style\"\n\t\t});\n\t\t\n\t\t//Fabric\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"fabric-chooser\",\n\t\t\t\"dataKey\":\"fabrics\",\n\t\t\t\"title\":\"Fabric\",\n\t\t\t\"jeanKey\":\"fabric\"\n\t\t});\n\t\t\n\t\t//Top Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Top Thread\",\n\t\t\t\"jeanKey\":\"top_thread\"\n\t\t});\n\t\t\n\t\t//Bottom Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Bottom Thread\",\n\t\t\t\"jeanKey\":\"bottom_thread\"\n\t\t});\n\t\t\n\t\t//Accent Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Accent Thread\",\n\t\t\t\"jeanKey\":\"accent_thread\"\n\t\t});\n\t\t\n\t\t//Overview\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"list\",\n\t\t\t\"title\":\"Overview\"\n\t\t});\n\t\t\n\t\t\n\t\t/*\n\t\tNot using hardware for now...\n\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"hardware\",\n\t\t\t\"title\":\"Hardware\",\n\t\t\t\"jeanKey\":\"hardware\"\n\t\t});\n\t\t*/\n\t\t\n\t\tvm.panelDir=\"next\";\t\t\n\t\tvm.panelStep = 0;\n\t\tvm.changeStep = function(step){\n\t\t\tif (step >= vm.panel.length) return false;\n\t\t\tif (step < 0) return false;\n\t\t\tif (step===undefined) return false;\n\t\t\telse vm.panelStep = step; \n\t\t\t\n\t\t\t//As long as we're not on the \"Overview\" Step, update active item...\n\t\t\tif (step+1 != vm.panel.length) vm.updateActiveItem();\n\t\t}\n\t\t\n\t\tvm.activeItem={};\n\t\t\n\t\tvm.updateActiveItem = function(){\n\t\t\tvar data = vm.data[vm.panel[vm.panelStep].dataKey];\n\t\t\tvar key = vm.jean.data[vm.panel[vm.panelStep].jeanKey];\n\t\t\tvar ret = $filter('filter')(data, {id: key})[0];\n\t\t\tvm.activeItem = ret;\n\t\t}\n\t\t\n\t\tvm.styleByGender = function(gender){\n\t\t\treturn function(style){\n\t\t\t\treturn style[\"images_\"+gender];\n\t\t  }\n\t\t};\n\t\t\n\t\t\t\t\n\t\tvm.dataLookup = function(jeanKey, id, attr){\n\t\t\t\n\t\t\tif (typeof jeanKey == 'undefined' || typeof id == 'undefined') return false;\n\t\t\tattr = attr||null;\n\t\t\t\n\t\t\tvar dataInfo = $filter('filter')(vm.panel, {jeanKey: jeanKey});\n\n\t\t\tif (dataInfo.length < 1) return false; //Return false for the \"List\" Panel\n\t\t\t\n\t\t\tvar dataKey = (jeanKey == \"gender\" || jeanKey == \"style\" ? jeanKey+\"s\" : $filter('filter')(vm.panel, {jeanKey: jeanKey})[0].dataKey);\n\t\t\tvar dataSet = vm.data[dataKey];\n\n\t\t\tdataById = \t$filter('filter')(dataSet, {id: id});\n\t\t\tif (typeof dataById == 'undefined') return false; //Return false when dataSet is undefined...\n\t\t\tselected = dataById[0];\n\t\t\t\n\t\t\tif (!attr) return selected;\n\t\t\telse return selected[attr];\t\n\t\t\t\n\t\t}\n\t\t\n\t\t\t\t\n\t\t/* GET CUSTOMIZER DATA */\n\t\tvm.data = {};\n\t\t\t\n\t\tvm.getData = function (func, dataKey) {\n\t\t\tvar d = $q.defer();\t   \n\t\t  bdAPI.jsonData[func]()\n\t\t  .then(function(res){\n\t\t    vm.data[dataKey]=res.data;\n\t\t    d.resolve(true);\n\t\t\t});\n\t\t\treturn d.promise;\n\t\t}\n\t\t\n\t\t//Make sure that all data is in place before running updateActiveItem\n\t\t$q.all([\n\t\t\tvm.getData('getGenders', 'genders'),\n\t\t\tvm.getData('getStyles', 'styles'),\n\t\t\tvm.getData('getFabrics', 'fabrics'),\n\t\t\tvm.getData('getThreads', 'threads'),\n\t\t]).then(function(data) {\n\t\t\n\t\t\t//Update the active item any time the jean data changes\n\t\t\t$scope.$watch(function() {\n\t\t\t  return vm.jean.data;\n\t\t\t}, function(current, original) {\n\t\t\t\tvm.updateActiveItem();\n\t\t\t}, true);\n\t\t\t\n\t\t});\n\t\t\n\t\t\n\t\t//Thumbnail\t\t\n  \tfunction loadImage(src, cntxt) {\n      return $q(function(resolve,reject) {\n        var image = new Image();\n        image.src = src;\n        image.onload = function() {\n          cntxt.drawImage(image,0,0,600,696);\n          resolve(image);\n        };\n        image.onerror = function(e) {\n          reject(e);\n        };\n      })\n    }\n    \n    vm.saveJean = function(){\n\t    console.log(\"save\");\n\t    aws.getCurrentUserFromLocalStorage().then(\n\t\t    function(result){\n\t\t\t    var userData = result;\n\t\t\t    vm.createThumb().then(\n\t\t\t\t    function(imageURL){\n\t\t\t\t\t  \taws.saveImageTos3(imageURL, userData).then(\n\t\t\t\t\t  \t\tfunction(){\n\t\t\t\t\t\t  \t\tconsole.log('creds refreshed');\n\t\t\t\t\t\t  \t}, \n\t\t\t\t\t\t\t\tfunction(err){\n\t\t\t\t\t\t\t\t\tconsole.log(err)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t    }\n\t\t\t    );\n\t\t    },\n\t\t    function(err){\n\t\t\t    //TODO: properly notify\n\t\t\t\t\talert('you must be logged in to save!');\n\t\t    }\n\t    );\n    }\n    \n    \n\t\tvm.createThumb = function(){\n\t  \tvar canvas = document.createElement('canvas');\n\t  \tcanvas.width=600;\n\t  \tcanvas.height=600;\n\t  \tvar cntxt = canvas.getContext('2d');\t\n\t  \tvar promises = [];\n    \n\t    var imagesElements = document.getElementsByClassName(\"zoomed-image\");\n\t    for(var i=0; i<imagesElements.length; i++){\n\t\t    var image = imagesElements[i];\t\n\t      promises.push(loadImage(image.src, cntxt));\n\t    }\n\n\t    return $q.all(promises).then(function(results) {\n\t      var dataUrl = canvas.toDataURL('image/jpeg');\n\t\t\t\treturn dataUrl;\n\t    });\n\t\t\t\n  \t}\n\n\t\t\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('homeCtrl', homeCtrl);\n\t\t\t\n\t\thomeCtrl.$inject = ['$scope','jean', '$animate'];\n\n\t\t\n    function homeCtrl ($scope, jean, $animate) {\n\t    \t    \t    \n\t    $scope.jean = jean.data;\n\t    \t\n    }\n\n})();","(function () {\n\n  angular\n  .module('bdApp')\n  .controller('loginCtrl', loginCtrl);\n\n  loginCtrl.$inject = ['$location', 'aws'];\n  function loginCtrl($location, aws) {\n    var vm = this;\n\t\t\n\t\tvm.credentials = {\n      name : \"\",\n      email : \"\",\n      password : \"\"\n    };\n\t  \n\t  vm.messages = {\n\t\t\tmessage : \"\",\n\t\t\ttype: \"\",\n\t\t\tset: function(message, type){\n\t\t\t\tvm.messages.message = message;\n\t\t\t\tvm.messages.type = type;\n\t\t\t},\n\t\t\treset:function(){\n\t\t\t\tvm.messages.message = \"\";\n\t\t\t\tvm.messages.type = \"\";\n\t\t\t}\n\t\t}\n\t\t\n\n\t\t//aws.getCurrentUserFromLocalStorage();\n\t\t\n\t\tvm.validateLoginForm = function(){\t\t\t\t\t\n\t\t\tfunction validateEmail(email) {\n\t\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t    return re.test(email);\n\t\t\t}\n\t\t\tif(!validateEmail(vm.credentials.email)){\n\t\t\t\tvm.messages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!vm.credentials.password){\n\t\t\t\tvm.messages.set(\"Please enter a password\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\tvm.login = function(email, password){\n\t\t\t\n\t\t\tvm.messages.reset();\n\t    \n\t    if (vm.validateLoginForm()){\n\t      aws.authenticateCognitoUser(email,password).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\t$location.path('/closet');\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tif (err.message == \"Incorrect username or password.\") err.message = \"Incorrect Email address or password.\"\n\t\t\t\t\t\tvm.messages.set(err.message,\"error\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t  }\n\n\t\t}\n\t\t\n\t\tvm.loginFB = function(){\n\t\t\taws.authenticateViaFB().then(\n\t\t\t\tfunction(result){\n\t\t\t\t\t$location.path('/closet');\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tvm.messages.set(err.message,\"error\");\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n    vm.onSubmit = function () {\n\t    vm.errors.message = \"\";\n      authentication\n        .login(vm.credentials)\n        .error(function(err){\n          console.log(err);\n          vm.errors.message = err.message;\n        })\n        .then(function(){\n          $location.path('closet');\n        });\n    };\n    \n        /*\n\t    \n\t     aws.checkUserForConfirmation(vm.credentials.email);\n\t\t\t      //Check to see if user is already confirmed\n\t\t\t      \n\t\t\t      vm.setMessage(\"We already have an unconfirmed user associated with this email address. Please check your email for the confirmation code or use the link above to resend.\", \"warning\");\n\t\t\t      vm.formStep = 2;\n\t\t\t      \n\t\t\t      vm.setMessage(err.message, \"error\");\n\t\t      }else{\n\t\t\t      \n\t\t\t      */\n\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['$location', 'aws', '$sce'];\n  function registerCtrl($location, aws, $sce) {\n    var vm = this;\n\n    vm.credentials = {\n      name : \"\",\n      email : \"\",\n      password : \"\"\n    };\n\t\n\t\tvm.formStep = 1;\n\t    \n    vm.messages = {\n\t\t\tmessage : \"\",\n\t\t\ttype: \"\",\n\t\t\tset: function(message, type){\n\t\t\t\tvm.messages.message = message;\n\t\t\t\tvm.messages.type = type;\n\t\t\t},\n\t\t\treset: function(){\n\t\t\t\tvm.messages.message = \"\";\n\t\t\t\tvm.messages.type = \"\";\n\t\t\t}\n\t\t}\n\t\t\n\t\tvm.setMessage = function(message, type){\n\t\t\tvm.messages.message = message;\n\t\t\tvm.messages.type = type;\n\t\t}\n\t\t\n\t\tvm.resetMessage = function(){\n\t\t\tvm.messages.message = \"\";\n\t\t\tvm.messages.type = \"\";\n\t\t}\n\t\t\n\t\t\n\t\t//Validate Registration Form\n\t\tvm.validateRegistrationForm = function () {\n\t\t\tconsole.log(\"validatingf...\");\n\t\t\t\t\t\t\n\t\t\tfunction validatePassword(password){\n\t\t\t\t//console.log(vm.credentials.password.length > 5);\n\t\t\t\t//contains numbers\n\t\t\t\t//console.log(vm.credentials.password.search(/\\d/)>-1);\n\t\t\t\t//contains lowercase letters\n\t\t\t\t//console.log(vm.credentials.password.search(/[a-z]/) > -1);\n\t\t\t\t//contains uppercase letters\n\t\t\t\t//console.log(vm.credentials.password.search(/[A-Z]/) > -1);\n\t\t\t\t\n\t\t\t\t//RE to test all\n\t\t\t\tvar re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\t\treturn re.test(password);\n\t\t\t}\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\tfunction validateEmail(email) {\n\t\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t    return re.test(email);\n\t\t\t}\n\n\t\t\t\n\t\t\tif (!vm.credentials.email || !vm.credentials.name || !vm.credentials.password || !vm.credentials.passwordConfirm){\n\t\t\t\tconsole.log(\"this one!\");\n\t\t\t\tconsole.log(vm.credentials);\n\t\t\t\tvm.messages.set(\"All fields are required\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (!validatePassword(vm.credentials.password)){\n\t\t\t\tvm.messages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one uppercase letter</li><li>Contain at least one lowercase letter</li><li>Contain at least one special character (\\\"!,@,#,$,%,^,&, or *\\\")</li>\");\t\n\t\t\t}\n\t\t\t\n\t\t\tif (vm.credentials.password !== vm.credentials.passwordConfirm){\n\t\t\t\tvm.messages.set(\"Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif(!validateEmail(vm.credentials.email)){\n\t\t\t\tvm.messages.set(\"Please Enter a valid E-mail address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t\t\n\t\t}\n\t\t//Register User\n    vm.registerUser = function () {\n\t    vm.messages.reset();\n\t    \n\t    if (vm.validateRegistrationForm()){\n\t      aws.signupForApplication(vm.credentials.email, vm.credentials.password).then(\n\t      \tfunction(){\n\t\t\t\t\t\tvm.formStep = 2;\t      \t\n\t\t      },   \n\t\t      function(err){\n\t\t\t\t    vm.messages.set(err.message, \"error\");\n\t\t\t    }\n\t\t\t  );\n\t\t  }\n    };\n    \t\t\t\t\t\n\t\t//Confirm User with Registration Code\t\t\t\t\n    vm.confirmUser = function() {\n\t\t\tvm.resetMessage();\n\t\t\taws.confirmRegisteredUnauthenticatedUser(vm.credentials.email, vm.credentials.code).then(\n      \tfunction(result){\n\t\t\t\t\tvm.setMessage($sce.trustAsHtml(\"Your Account has been confirmed. <a href='/login'>Click here to login</a>\"), \"success\");\n\t      },   \n\t      function(err){\n\t\t      if (err.message == \"Missing required key 'ConfirmationCode' in params\") err.message = \"Please enter confirmation code\";\n\t\t\t    vm.setMessage(err.message, \"error\");\n\t\t    }\n\t\t  );\n    };\n    \n    //Resend Registration code to user via email\n    vm.resendCode = function(){\n\t    //This function throws an error in the SDK and no result... cannot implement promise for now\n\t    aws.resendConfirmationCode(vm.credentials.email);\n\t    //We're going to show a success message no matter what\n\t    //TODO: Implement corrected SDK and promise structure for this functino\n\t    vm.setMessage(\"A new confirmation code has been sent to \"+vm.credentials.email+\". Enter the code above to confirm your account\", \"success\");\n    };\n\n  }\n\n})();"]}