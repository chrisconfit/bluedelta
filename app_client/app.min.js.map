{"version":3,"sources":["main.js","directives/insert.js","services/account.service.js","services/authentication.service.js","services/aws.service.js","services/bdapi.service.js","services/config.service.js","services/data.service.js","services/jean.service.js","services/jsonData.service.js","services/messages.service.js","services/popups.service.js","services/preloader.factory.js","services/user.service.js","directives/image-stack/image-stack.controller.js","directives/image-stack/image-stack.directive.js","directives/jean-list/jean-list.directive.js","directives/choosers/chooser.controller.js","directives/choosers/chooser.directive.js","directives/choosers/fabric-chooser.directive.js","directives/choosers/gender-chooser.directive.js","directives/choosers/style-chooser.directive.js","config/config-overrides-generated.js","directives/navigation/navigation.controller.js","directives/navigation/navigation.directive.js","directives/social-actions/social-actions.controller.js","directives/social-actions/social-actions.directive.js","directives/slider/slider.controller.js","directives/slider/slider.directive.js","pages/admin/admin.controller.js","pages/closet/closet.controller.js","pages/customizer/customizer.controller.js","directives/login-form/login-form.controller.js","directives/login-form/login-form.directive.js","directives/register-form/register-form.controller.js","directives/register-form/register-form.directive.js","pages/order/order.controller.js","pages/auth/login/login.controller.js","pages/auth/register/register.controller.js","pages/home/home.controller.js"],"names":["config","$routeProvider","$locationProvider","when","templateUrl","controller","controllerAs","otherwise","redirectTo","html5Mode","run","$rootScope","$location","aws","jean","popups","$on","event","nextRoute","currentRoute","locked","indexOf","path","isLoggedIn","Object","keys","data","length","angular","module","filter","input","replace","min","max","key","account","$window","console","log","localStorage","setUpUser","getCurrentUserFromLocalStorage","then","result","accessToken","err","service","$inject","authentication","$http","$q","saveToken","token","getToken","payload","split","atob","JSON","parse","exp","Date","now","currentUser","email","name","isAdmin","roles","permissions","register","userDetails","login","user","authenticateCognitoUser","password","logout","removeItem","AWSConfig","_getUserPool","poolData","UserPoolId","USER_POOL_ID","ClientId","CLIENT_ID","userPool","AWSCognito","CognitoIdentityServiceProvider","CognitoUserPool","_getAuthenticationDetails","uname","pword","authenticationData","Username","Password","authenticationDetails","AuthenticationDetails","_getCognitoUser","upool","userData","Pool","cognitoUser","CognitoUser","_buildAttribute","keyName","value","attribute","Name","Value","CognitoUserAttribute","_buildAttributeList","attributeBuilder","obj","attrToAdd","attrList","push","_getAWSCredentials","idToken","logins","authenticator","REGION","AWS","update","region","credentials","CognitoIdentityCredentials","IdentityPoolId","IDENTITY_POOL_ID","Logins","getPromise","getUserFromLocalStorage","username","getSession","session","alert","isValid","deleteCognitoUser","getCurrentUser","deleteUser","authenticateViaFB","defer","FB","response","authResponse","graph.facebook.com","resolve","reject","promise","authenticateUser","onSuccess","onFailure","newPasswordRequired","userAttributes","requiredAttributes","signupForApplication","emailAddress","attributeList","signUp","updateAttributesOnUser","updateAttributes","deleteUserAttributes","deleteAttributes","verifyUserAttribute","attributeName","getAttributeVerificationCode","inputVerificationCode","verificationCode","prompt","verifyAttribute","this","retrieveUserAttributes","getUserAttributes","i","getName","getValue","resendConfirmationCode","confirmRegistration","confirmationCode","changePassword","oldPassword","newPassword","forgotPasswordFlow","forgotPassword","confirmPassword","signUserOut","signOut","signCurrentUserOut","signUserOutGlobally","globalSignOut","agetCurrentUserFromLocalStorage","confirmRegisteredUnauthenticatedUser","userName","saveImageTos3","imageURL","userTokens","dataURItoBlob","dataURI","binary","array","charCodeAt","Blob","Uint8Array","type","jwtToken","blobData","bucketName","s3bucket","S3","params","Bucket","Key","identityId","Body","upload","Location","bdAPI","$httpParamSerializer","$filter","_thirdParty","BlueDeltaApi","API","Client","DefaultApi","injector","get","jsonData","setupJsonData","jsonDataKeys","d","jeanKeyToDataKey","jeanKey","dataKey","dataLookup","id","attr","dataSet","dataById","selected","PROFILE_IMAGES_S3_BUCKET","API_ENDPOINT","meanData","getOptions","headers","Authorization","getJeanById","callback","j","ret","getJeansByUser","userId","getProfile","getStyles","getThreads","getHardware","getFabrics","getGenders","$routeParams","parseURLkey","set","property","saved","createNew","constructor","title","gender","style","fabric","accent_thread","top_thread","bottom_thread","Math","floor","random","setup","jean_id","action","jeanData","parts","match","parseInt","save","$timeout","jeansList","getData","messages","message","reset","pops","closeAll","pop","hasOwnProperty","status","$broadcast","preloaderFunc","Preloader","imageLocations","imageCount","loadCount","errorCount","states","PENDING","LOADING","RESOLVED","REJECTED","state","deferred","preloadImages","preloader","load","prototype","isInitiated","isRejected","isResolved","loadImageLocation","handleImageError","imageLocation","handleImageLoad","notify","percent","ceil","image","element","Image","bind","$apply","target","src","factory","istackCtrl","$scope","isvm","centerPan","zoom","pan","x","y","isMobile","innerWidth","toggleZoom","touchEnd","dragTracker","returnPan","images","document","querySelectorAll","setTimeout","css","transform-origin","touchStart","e","swipeStart","touches","clientX","clientY","swipe","zoomDrag","touchMove","preventDefault","touch","drag","clientWidth","clientHeight","bounds","top","bottom","left","right","move","dragPan","u","direction","frame","window","innerHeight","height","width","deltaX","deltaY","abs","isFinal","scanImage","querySelector","fWidth","fHeight","rect","getBoundingClientRect","rootDoc","ownerDocument","documentElement","offsetT","pageYOffset","clientTop","offsetL","pageXOffset","clientLeft","xPosition","yPosition","breakPoint","trackMouse","$event","pageX","pageY","imageStack","restrict","link","scope","ele","attrs","ctrl","on","directive","fields","defaultFields","filterFields","matches","k","chooserCtrl","$element","scrollToLeft","el","scrollTo","scrollDuration","offsetWidth","maxLeft","scrollWidth","stepNum","distance","scrollLeft","scrollStep","scrollTest","a","b","scrollInterval","setInterval","newScroll","clearInterval","chvm","selectorCoords","$watch","newValue","oldValue","step","activeElement","prop","selector","chooser","selectAttr","text","opacity","jeanSet","val","dataset","active","template","changeTemplate","screenWidth","viewUrl","onresize","weightFilter","weight","genderChooser","styleChooser","checkGenderFilter","configOverridesGenerated","navigationCtrl","$route","vm","drops","acct","mobileMenu","reload","navigation","socialCtrl","jeanKeytoURL","sovm","jeanToUrl","url","location","origin","urlKey","sharingUrls","socialTitle","socialDescription","facebook","baseString","urlencode","twitter","pinterest","share","social","open","display","sliderCtrl","imagesLoaded","slides","currentIndex","setCurrentSlideIndex","index","isCurrentSlideIndex","nextSlide","prevSlide","slider","imageClick","adminCtrl","success","error","closetCtrl","validateEmail","re","test","validatePhoneNumber","inputtxt","phoneno","jeans","onload","userForm","editing","feedback","cancel","field","validate","usersUpdate","defaultHeaders_","getJwtToken","idTokenPayload","userID","sub","usersGet","copy","copyJean","displayJean","selectJean","jeanProfile","customizerCtrl","landscapeDetect","ua","navigator","userAgent","toLowerCase","isAndroid","orientation","loadImage","cntxt","drawImage","onerror","landscape","supportsOrientationChange","orientationEvent","addEventListener","current","original","updateActiveItem","activeItem","panel","panelStep","panelTemplate","panelDir","changeStep","undefined","orderCallback","saveCallback","placeOrder","authCallback","createThumb","canvas","createElement","getContext","promises","imagesElements","getElementsByClassName","all","results","dataUrl","toDataURL","savingBar","saveJean","loginFormCtrl","logvm","loginEmail","loginPassword","validateLoginForm","redirect","loginFB","loginForm","registerFormCtrl","$sce","regvm","validateRegistrationForm","validatePassword","passwordConfirm","registerUser","registerForm","orderCtrl","orderForm","chooseFitType","fitType","tailor","tailors","tailorLocations","nextStep","onbeforeunload","loginCtrl","registerCtrl","formStep","homeCtrl","$animate"],"mappings":"CAAA,WAKE,QAASA,GAAQC,EAAgBC,GAC/BD,EACGE,KAAK,KACJC,YAAa,6BACbC,WAAY,WACZC,aAAc,OAEfH,KAAK,aACJC,YAAa,0CACbC,WAAY,eACZC,aAAc,OAEfH,KAAK,UACJC,YAAa,oCACbC,WAAY,YACZC,aAAc,OAEfH,KAAK,WACJC,YAAa,iCACbC,WAAY,aACZC,aAAc,OAEfH,KAAK,UACJC,YAAa,+BACbC,WAAY,YACZC,aAAc,OAEfH,KAAK,kCACJC,YAAa,yCACbC,WAAY,iBACZC,aAAc,OAEfH,KAAK,UACJC,YAAa,+BACbC,WAAY,YACZC,aAAc,OAEfC,WAAWC,WAAY,MAG1BN,EAAkBO,WAAU,GAI9B,QAASC,GAAIC,EAAYC,EAAWC,EAAKC,EAAMC,GAE7CJ,EAAWK,IAAI,oBAAqB,SAASC,EAAOC,EAAWC,GAC9D,GAAIC,IACH,UACA,SAGGA,GAAOC,QAAQT,EAAUU,SAAW,IAAMT,EAAIU,cACnDX,EAAUU,KAAK,UAIZV,EAAUU,OAAOD,QAAQ,WAAa,IAAMG,OAAOC,KAAKX,EAAKY,MAAMC,QACrEf,EAAUU,KAAK,iBA7DlBM,QAAQC,OAAO,SAAU,UAAW,YAAY,aAAc,YAAa,qBAoE3ED,QACGC,OAAO,SACP7B,QAAQ,iBAAkB,oBAAqBA,IAC/CU,KAAK,aAAc,YAAa,MAAO,OAAQ,SAAUA,IAC3DoB,OAAO,YAAY,WACjB,MAAO,UAASC,GACd,GAAIA,EACH,MAAOA,GAAMC,QAAQ,OAAQ,QAIlCF,OAAO,eAAe,WACpB,MAAO,UAASC,GACd,GAAIA,EACH,MAAOA,GAAMC,QAAQ,MAAO,QAIjCF,OAAO,SAAS,SAASG,EAAKC,EAAKC,GACnC,MAAO,UAASJ,GACf,QAAIE,GAAOF,EAAMI,GAAOF,MACpBC,GAAOH,EAAMI,GAAOD,MAIzBJ,OAAO,cAAc,WACrB,MAAO,UAASC,GACf,QAAOA,GAAQA,EAAMC,QAAQ,aAAc;ACjG/C;CCCA,WAOE,QAASI,GAAQvB,EAAKwB,GAGtBC,QAAQC,IAAI,QAEZhB,WAAac,EAAQG,aAAajB,UAElC,IAAIkB,GAAY,WACfH,QAAQC,IAAI,oBACZ1B,EAAI6B,iCAAiCC,KACpC,SAASC,GAER,GADAN,QAAQC,IAAI,eACc,IAAtBK,EAAOC,eAEZ,SAASC,GACRR,QAAQC,IAAIO,KAab,OAFFL,MAGIlB,WAAaA,WACbkB,UAAYA,GAnChBb,QACGC,OAAO,SACPkB,QAAQ,UAAWX,GAEvBA,EAAQY,SAAW,MAAO;CCP3B,WAOE,QAASC,GAAgBC,EAAOb,EAASxB,EAAKsC,GAE5C,GAAIC,GAAY,SAAUC,GACxBhB,EAAQG,aAAa,cAAgBa,GAGnCC,EAAW,WACb,MAAOjB,GAAQG,aAAa,eAG1BjB,EAAa,WACf,GACIgC,GADAF,EAAQC,GAGZ,SAAGD,IACDE,EAAUF,EAAMG,MAAM,KAAK,GAC3BD,EAAUlB,EAAQoB,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,GAEdA,EAAQK,IAAMC,KAAKC,MAAQ,MAMlCC,EAAc,WAChB,GAAGxC,IAAa,CACd,GAAI8B,GAAQC,GACZhB,SAAQC,IAAIc,EACZ,IAAIE,GAAUF,EAAMG,MAAM,KAAK,EAG/B,OAFAD,GAAUlB,EAAQoB,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,IAEnBS,MAAQT,EAAQS,MAChBC,KAAOV,EAAQU,QAMnBC,EAAU,WACb,GAAG3C,IAAa,CACX,GAAI8B,GAAQC,IAERC,EAAUF,EAAMG,MAAM,KAAK,EAC/BD,GAAUlB,EAAQoB,KAAKF,GACvBA,EAAUG,KAAKC,MAAMJ,GACrBjB,QAAQC,IAAIgB,EACZ,IAAIY,GAAQZ,EAAQa,WACxB,OAAOD,GAAM9C,QAAQ,gBAWnBgD,EAAW,SAASC,IAkBtB,OATAC,OAAQ,SAASC,GAEhB3D,EAAI4D,wBAAwBD,EAAME,WAGnCC,OAAS,WACPtC,EAAQG,aAAaoC,WAAW,gBAOjCV,QAAUA,EACTH,YAAcA,EACdX,UAAYA,EACZE,SAAWA,EACX/B,WAAaA,EACb8C,SAAWA,EACXE,MAAQA,MACRI,OAASA,QA9Fb/C,QACGC,OAAO,SACPkB,QAAQ,iBAAkBE,GAE7BA,EAAeD,SAAW,QAAS,UAAW,MAAO;CCNvD,WAOE,QAASnC,GAAKqC,EAAOb,EAASc,EAAI0B,GAEhC,QAASC,KACP,GAAIC,IAAaC,WAAaH,EAAUI,aAAcC,SAAWL,EAAUM,WACvEC,EAAW,GAAIC,YAAWC,+BAA+BC,gBAAgBR,EAC7E,OAAOK,GAGT,QAASI,GAA0BC,EAAOC,GACxC,GAAIC,IACFC,SAAWH,EACXI,SAAWH,GAETI,EAAwB,GAAIT,YAAWC,+BAA+BS,sBAAsBJ,EAChG,OAAOG,GAGT,QAASE,GAAgBP,EAAOQ,GAC9B,GAAIC,IAAaN,SAAWH,EAAOU,KAAOF,GACtCG,EAAc,GAAIf,YAAWC,+BAA+Be,YAAYH,EAC5E,OAAOE,GAGT,QAASE,GAAgBC,EAASC,GAChC,GAAIC,IACFC,KAAMH,EACNI,MAAOH,GAEL5D,EAAS,GAAIyC,YAAWC,+BAA+BsB,qBAAqBH,EAChF,OAAO7D,GAGT,QAASiE,GAAoBC,EAAkBC,GAC7C,GACIC,GADAC,IAEJ,KAAK,GAAI9E,KAAO4E,GACdC,EAAYF,EAAiB3E,EAAK4E,EAAI5E,IACtC8E,EAASC,KAAKF,EAEhB,OAAOC,GAQX,QAASE,GAAmBC,GAE3BC,SACA,IAAIC,GAAgB,eAAezC,EAAU0C,OAAO,kBAAkB1C,EAAUI,YAUhF,OATAoC,QAAOC,GAAiBF,EAExBI,IAAIxH,OAAOyH,QAASC,OAAQ7C,EAAU0C,SAEnCC,IAAIxH,OAAO2H,YAAc,GAAIH,KAAII,4BAC/BC,eAAgBhD,EAAUiD,iBAC1BC,OAASV,SAGPG,IAAIxH,OAAO2H,YAAYK,aAwX7B,MAjWAC,yBAA0B,SAASC,GACjC,GAAI9B,GAAcJ,EAAgBkC,EAAUpD,IACzB,OAAfsB,GACAA,EAAY+B,WAAW,SAASrF,EAAKsF,GACjC,MAAItF,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,qBAAuB6F,EAAQE,cAKrDC,kBAAoB,WAClB,GAAInC,GAActB,IAAe0D,gBACjCpC,GAAYqC,WAAW,SAAS3F,EAAKF,GACnC,MAAIE,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,gBAAkBK,MAKpC8F,kBAAoB,WAEnB,GAAIC,GAAQxF,EAAGwF,OAiBf,OAfAC,IAAGrE,MAAM,SAAUsE,GACbA,EAASC,cACXtB,IAAIxH,OAAO2H,YAAc,GAAIH,KAAII,4BAC/BC,eAAgBhD,EAAUiD,iBAC1BC,QACEgB,qBAAsBF,EAASC,aAAajG,eAIhD8F,EAAMK,WAENL,EAAMM,OAAO,mDAIVN,EAAMO,SAGZzE,wBAA0B,SAASyD,EAAUxD,GAC3C,GAAIoB,GAAwBN,EAA0B0C,EAAUxD,GAC5D0B,EAAcJ,EAAgBkC,EAAUpD,KAExC6D,EAAQxF,EAAGwF,OA0Bf,OAvBAvC,GAAY+C,iBAAiBrD,GAC3BsD,UAAW,SAAUxG,GACxB+F,EAAMK,QAAQpG,GAEdP,EAAQG,aAAajB,YAAa,GAE/B8H,UAAW,SAASvG,GAClB6F,EAAMM,OAAOnG,IAEfwG,oBAAqB,SAASC,EAAgBC,GAIjDlH,QAAQC,IAAIgH,EAAgBC,MAUpBb,EAAMO,SAIfO,qBAAuB,SAASC,EAAchF,GAE7C,GAAIiE,GAAQxF,EAAGwF,QAEVgB,EAAgB9C,EAAoBP,GAAkBtC,MAAO0F,GAOjE,OALA5E,KAAe8E,OAAOF,EAAchF,EAAUiF,EAAe,KAAM,SAAS7G,EAAKF,GAC3EE,EAAK6F,EAAMM,OAAOnG,GACjB6F,EAAMK,QAAQpG,KAGd+F,EAAMO,SAGfW,uBAAyB,SAAS3B,EAAUnB,GAC1C,GAAI4C,GAAgB9C,EAAoBP,EAAiBS,GACrDX,EAAgBJ,EAAgBkC,EAAUpD,IAC9CsB,GAAY0D,iBAAiBH,EAAe,SAAS7G,EAAKF,GACtD,MAAIE,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,gBAAkBK,MAIpCmH,qBAAuB,SAAS3D,EAAauD,GAC3CvD,EAAY4D,iBAAiBL,EAAe,SAAS7G,EAAKF,GACtD,MAAIE,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,gBAAkBK,MAIpCqH,oBAAsB,SAAS7D,EAAa8D,GACxC9D,EAAY+D,6BAA6BD,GACvCd,UAAW,SAAUxG,GACjBN,QAAQC,IAAI,gBAAkBK,IAElCyG,UAAW,SAASvG,GAChBuF,MAAMvF,IAEVsH,sBAAuB,WACnB,GAAIC,GAAmBC,OAAO,mCAAoC,GAClElE,GAAYmE,gBAAgBL,EAAeG,EAAkBG,UAKvEC,uBAAyB,SAASrE,GAChCA,EAAYsE,kBAAkB,SAAS5H,EAAKF,GACxC,GAAIE,EAEA,WADAuF,OAAMvF,EAGV,KAAK6H,EAAI,EAAGA,EAAI/H,EAAOjB,OAAQgJ,IAC3BrI,QAAQC,IAAI,aAAeK,EAAO+H,GAAGC,UAAY,cAAgBhI,EAAO+H,GAAGE,eAKrFC,uBAAyB,SAAS1E,GAC7BA,EAAY0E,yBAEhB1E,EAAcJ,EAAgBI,EAAatB,MAG1CsB,EAAY0E,uBAAuB,SAAShI,EAAKF,GAG/C,OAAIE,OACFR,SAAQC,IAAIO,MASnBiI,oBAAsB,SAAS3E,EAAa4E,GACzC5E,EAAY2E,oBAAoBC,GAAkB,EAAM,SAASlI,EAAKF,GAClE,MAAIE,OACAuF,OAAMvF,OAGVuF,OAAMzF,MAIZqI,eAAiB,SAAS7E,EAAa8E,EAAaC,GAClD/E,EAAY6E,eAAeC,EAAaC,EAAa,SAASrI,EAAKF,GACjE,MAAIE,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,gBAAkBK,MAIlCwI,mBAAqB,SAAShF,GAC5BA,EAAYiF,gBACVjC,UAAW,SAAUxG,GACjBN,QAAQC,IAAI,gBAAkBK,IAElCyG,UAAW,SAASvG,GAChBuF,MAAMvF,IAGVsH,sBAAuB,WACnB,GAAIC,GAAmBC,OAAO,kCAAmC,IAC7Da,EAAcb,OAAO,sBAAuB,GAChDlE,GAAYkF,gBAAgBjB,EAAkBc,EAAaX,UAKnE/B,WAAa,SAASrC,GACpBA,EAAYqC,WAAW,SAAS3F,EAAKF,GACnC,MAAIE,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,gBAAkBK,MAIlC2I,YAAc,SAASnF,GACF,MAAfA,GACAA,EAAYoF,WAIlBC,mBAAqB,WACrB,GAAIrF,GAActB,IAAe0D,gBACZ,OAAfpC,IACFA,EAAYoF,UAChBnJ,EAAQG,aAAajB,YAAa,IAKlCmK,oBAAsB,SAAStF,GAC9B/D,EAAQG,aAAajB,YAAa,EACjC6E,EAAYuF,iBAKdjJ,+BAAiC,WAC/B,GAAI0D,GAActB,IAAe0D,gBACjC,OAAmB,OAAfpC,EACIA,EAAY+B,WAAW,SAASrF,EAAKsF,GACzC,MAAItF,IACHR,QAAQC,IAAIO,IACL,GAEDsF,KAGV9F,QAAQC,IAAI,0BACL,IAMZhB,WAAa,WACZ,GAAI6E,GAActB,IAAe0D,gBACjC,SAAOpC,GAGRwF,gCAAkC,WAEjC,GAAIxF,GAActB,IAAe0D,gBACjC,OAAmB,OAAfpC,OAEHA,GAAY+B,WAAW,SAASrF,EAAKsF,GAEpC,OAAItF,IAKJ0E,IAAIxH,OAAO2H,YAAc,GAAIH,KAAII,4BAC3BC,eAAiBhD,EAAUiD,mBAI1BM,MAQRyD,qCAAuC,SAASC,EAAUd,GAExD,GAAI5E,GAAcJ,EAAgB8F,EAAUhH,KACzC6D,EAAQxF,EAAGwF,OAOd,OALAvC,GAAY2E,oBAAoBC,GAAkB,EAAM,SAASlI,EAAKF,GAChEE,EAAK6F,EAAMM,OAAOnG,GACjB6F,EAAMK,QAAQpG,KAGd+F,EAAMO,SAIf+B,eAAiB,SAAS7E,EAAa8E,EAAaC,GAClD/E,EAAY6E,eAAeC,EAAaC,EAAa,SAASrI,EAAKF,GACjE,MAAIE,OACAuF,OAAMvF,OAGVR,SAAQC,IAAI,gBAAkBK,MASlCmJ,cAAgB,SAAUC,EAAUC,GAEtC,QAASC,GAAcC,GAGtB,IAAI,GAFAC,GAAS3I,KAAK0I,EAAQ3I,MAAM,KAAK,IACjC6I,KACI1B,EAAI,EAAGA,EAAIyB,EAAOzK,OAAQgJ,IAChC0B,EAAMnF,KAAKkF,EAAOE,WAAW3B,GAE/B,OAAO,IAAI4B,OAAM,GAAIC,YAAWH,KAAUI,KAAM,eAIhD,GAAI9D,GAAQxF,EAAGwF,OAyBf,OAtBAxB,GAAmB8E,EAAW7E,QAAQsF,UAAU/J,KAG/C,WACC,GAAIgK,GAAWT,EAAcF,GACzBY,EAAa,gEACbC,EAAW,GAAIrF,KAAIsF,IAAIpF,OAAQ7C,EAAU0C,OAAQwF,QAASC,OAAQJ,KAClEG,GAAUE,IAAKzF,IAAIxH,OAAO2H,YAAYuF,WAAa,kBAAwBC,KAAMR,EAErFE,GAASO,OAAOL,EAAQ,SAASjK,EAAKpB,GACjCoB,EAAK6F,EAAMM,OAAOnG,GAChB6F,EAAMK,QAAQtH,EAAK2L,aAM3B,SAASvK,GACR6F,EAAMM,OAAOnG,KAIR6F,EAAMO,UAQXR,kBAAmBA,kBACnBT,wBAAyBA,wBACxBM,kBAAmBA,kBACnB9D,wBAAyBA,wBACzBgF,qBAAsBA,qBACtBI,uBAAwBA,uBACxBE,qBAAsBA,qBACtBE,oBAAqBA,oBACrBQ,uBAAwBA,uBACxBK,uBAAwBA,uBACxBC,oBAAqBA,oBACrBE,eAAgBA,eAChBG,mBAAoBA,mBACpB3C,WAAYA,WACZ8C,YAAaA,YACbG,oBAAqBA,oBACrBhJ,+BAAgCA,+BAChCmJ,qCAAsCA,qCACtCJ,mBAAmBA,mBACnBM,cAAgBA,cAChBxK,WAAWA,YA9cfK,QACGC,OAAO,SACPkB,QAAQ,MAAOlC,GAElBA,EAAImC,SAAW,QAAS,UAAW,KAAM;CCL3C,WAOE,QAASsK,GAAOjL,EAASa,EAAOqK,EAAsBC,GAErDnL,EAAQoL,YAAcpL,EAAQoL,gBAC9BpL,EAAQoL,YAAYC,aAAc,GAAIC,KAAIC,OAAOC,WAAWjM,QAAQkM,UAAU,OAAOC,IAAI,SACxFnM,QAAQkM,UAAU,OAAOC,IAAI,wBAC7BnM,QAAQkM,UAAU,OAElB,IAAIJ,GAAerL,EAAQoL,YAAYC,YAqBzC,KAlBAA,EAAaM,YACbC,cAAgB,SAAS9L,GACxBe,EAAM6K,IAAI,SAAS5L,EAAI,SAASQ,KAAK,SAASkG,GAC7C6E,EAAaM,SAAS7L,GAAO0G,EAASnH,QAIxCwM,cACC,cACA,UACA,SACA,UACA,UACA,UACA,UACA,WAGIC,EAAI,EAAGA,EAAID,aAAavM,OAAQwM,IACpCF,cAAcC,aAAaC,GA6C3B,OAnCDT,GAAaU,iBAAmB,SAASC,GACxC,GAAIC,IAAU,CAEd,SAAO,GACN,IAAKD,GAAQhN,QAAQ,aACrBiN,EAAU,SACV,MAEA,KAAiB,UAAXD,GAAkC,SAAXA,GAAkC,UAAXA,EACpDC,EAAUD,EAAQ,IAInB,MAAQC,IAITZ,EAAaa,WAAa,SAASD,EAASE,EAAIC,GAI/C,GAFAA,EAAOA,GAAM,KAES,mBAAXH,IAAuC,mBAANE,GAAmB,OAAO,CACtE,IAAIE,GAAUhB,EAAaM,SAASM,EAEpC,OADAK,UAAYnB,EAAQ,UAAUkB,GAAUF,GAAIA,IACrB,mBAAZG,YAEXC,SAAWD,SAAS,GAEfF,EACOG,SAASH,GADHG,WAOXlB,EA/ER9L,QACGC,OAAO,SACPkB,QAAQ,QAASuK,GAEpBA,EAAMtK,SAAW,UAAW,QAAS,uBAAwB;CCN/D,WAKE,QAAS6B,KACT,OACC0C,OAAU,YACTsH,yBAA4B,gEAC5BC,aAAgB,qEAChB7J,aAAgB,sBAChBE,UAAa,6BACb2C,iBAAoB,kDAXtBlG,QACGC,OAAO,SACPkB,QAAQ,YAAa8B;CCJ1B,WAOE,QAASkK,GAAU7L,EAAOD,GAWxB,GAAI+L,GAAa,WACf,MAAO9L,GAAM6K,IAAI,gBACfkB,SACEC,cAAe,UAAWjM,EAAeK,eAQ7C6L,EAAc,SAASX,EAAIY,GAC9BlM,EAAM6K,IAAI,0BAA0BpL,KAAK,SAASkG,GACrCA,EAASnH,IACrB,KAAI2N,EAAE,EAAGA,EAAExG,EAASnH,KAAKC,OAAQ0N,IAEhC,GAAIxG,EAASnH,KAAK2N,GAAGb,IAAMA,EAAG,CAC7BlM,QAAQC,IAAI,aACZ,IAAI+M,GAAMzG,EAASnH,KAAK2N,GAI1BD,EAASE,MAMPC,EAAiB,SAASC,GAC7B,MAAOtM,GAAM6K,IAAI,2BAEd0B,EAAa,WAChB,MAAOvM,GAAM6K,IAAI,uBAGd2B,EAAY,WACf,MAAOxM,GAAM6K,IAAI,sBAGd4B,EAAa,WAChB,MAAOzM,GAAM6K,IAAI,uBAGd6B,EAAc,WACjB,MAAO1M,GAAM6K,IAAI,uBAGd8B,EAAa,WAChB,MAAO3M,GAAM6K,IAAI,uBAId+B,EAAa,WAChB,MAAO5M,GAAM6K,IAAI,sBAMhB,QACCoB,YAAaA,EACbI,eAAiBA,EAChBE,WAAaA,EACbT,WAAaA,EACbU,UAAYA,EACZC,WAAaA,EACbC,YAAaA,EACbC,WAAYA,EACZC,WAAYA,GApFhBlO,QACGC,OAAO,SACPkB,QAAQ,WAAYgM,GAEvBA,EAAS/L,SAAW,QAAS;CCL/B,WAME,QAASlC,GAAKiP,EAAczC,GA4C5B,QAAS0C,GAAY7N,GACpB,OAAOA,GACN,IAAK,IACF,MAAO,QAGP,KAAK,IACL,MAAO,OAGP,KAAK,IACL,MAAO,QAGP,KAAK,KACL,MAAO,YAGP,KAAK,KACL,MAAO,eAGP,KAAK,KACL,MAAO,eAEP,SAAS,OAAO,GAnEnBT,QAEFuO,IAAM,SAASC,EAAU1J,GACxBgE,KAAK9I,KAAKwO,GAAY1J,EACtBgE,KAAK2F,OAAM,GAGZC,UAAY,SAAStP,GACfA,GAAQA,EAAKuP,aAAe7O,OAchCgJ,KAAK9I,MACJ4O,MAAU,WAAWxP,EAAKY,KAAK4O,MAC/BC,OAAWzP,EAAKY,KAAK6O,OACrBC,MAAU1P,EAAKY,KAAK8O,MACpBC,OAAW3P,EAAKY,KAAK+O,OACrBC,cAAkB5P,EAAKY,KAAKgP,cAC5BC,WAAe7P,EAAKY,KAAKiP,WACzBC,cAAkB9P,EAAKY,KAAKkP,cAC5BpC,GAAKqC,KAAKC,MAAsB,IAAhBD,KAAKE,YArBtBvG,KAAK9I,MACJ6O,OAAW,EACXC,MAAU,EACVC,OAAW,OACXC,cAAkB,IAClBC,WAAe,IACfC,cAAkB,IAClBpC,GAAKqC,KAAKC,MAAsB,IAAhBD,KAAKE,WAGtBvG,KAAK2F,OAAM,GAsDb,IAAIa,GAAQ,WAGX,GAAIjB,EAAakB,SAAgC,QAArBlB,EAAamB,OAGxC,GAAInB,EAAakB,QAAQ5P,QAAQ,KAAK,EAAE,CACvCmJ,KAAK4F,YACLe,SAAWpB,EAAakB,QAAQzN,MAAM,IACtC,KAAI,GAAI2K,GAAE,EAAGA,EAAEgD,SAASxP,OAAQwM,IAAI,CACnC,GAAIiD,GAAOD,SAAShD,GAAGkD,MAAM,sBAC7B,IAAKD,EAAL,CACA,GAAI/C,GAAU2B,EAAYoB,EAAM,GAC5B/C,KAAS7D,KAAK9I,KAAK2M,GAAWiD,SAASF,EAAM,WAOlD5G,MAAK4F,UAAUL,EAAakB,aAKpBlB,GAAakB,UAAYlB,EAAamB,OAG/C5D,EAAMU,SAASmB,YAAYY,EAAakB,QAAS,SAASvP,GACrDA,EACH8I,KAAK9I,KAAKA,EAGV8I,KAAK4F,cAO8B,IAAlC5O,OAAOC,KAAK+I,KAAK9I,MAAMC,QAAgB6I,KAAK9I,KAAK2O,cAAgB7O,QAAQgJ,KAAK4F,WAKlF,OAAO5F,MAAK9I,MAITqM,EAAI,WACP,MAAOvD,MAAK9I,MAGT6P,EAAO,SAASzQ,GACnBwB,QAAQC,IAAI,kBAGX,QACCgP,KAAOA,EACPxD,IAAMA,EACNiD,MAAQA,EACPtP,KAAOA,KACPuO,IAAMA,IACNG,UAAWA,WA9IfxO,QACGC,OAAO,SACPkB,QAAQ,QAAS,eAAgB,QAASjC;CCJ/C,WAOE,QAASkN,GAAU9K,EAAOsK,EAASgE,GAqBnC,IAnBA9P,QAEAuM,cAAgB,SAAS9L,GACxBe,EAAM6K,IAAI,SAAS5L,EAAI,SAASQ,KAAK,SAASkG,GAC7CnH,KAAKS,GAAO0G,EAASnH,QAIvBwM,cACC,YACA,UACA,SACA,UACA,UACA,UACA,UACA,WAGIC,EAAI,EAAGA,EAAID,aAAavM,OAAQwM,IACpCF,cAAcC,aAAaC,GAG5B,IAMIC,GAAmB,SAASC,GAC/B,GAAIC,IAAU,CAEd,SAAO,GACN,IAAKD,GAAQhN,QAAQ,aACrBiN,EAAU,SACV,MAEA,KAAiB,UAAXD,GAAkC,SAAXA,GAAkC,UAAXA,EACpDC,EAAUD,EAAQ,IAInB,MAAQC,IAILC,EAAa,SAASF,EAASG,EAAIC,GAItC,GAFAA,EAAOA,GAAM,KAES,mBAAXJ,IAAuC,mBAANG,GAAmB,OAAO,CACtE,IAAIF,GAAUF,EAAiBC,GAC3BK,EAAUhN,KAAK4M,EAInB,OADAK,UAAYnB,EAAQ,UAAUkB,GAAUF,GAAIA,IACrB,mBAAZG,YAEXC,SAAWD,SAAS,GAEfF,EACOG,SAASH,GADHG,WAKfO,EAAc,SAASX,EAAIY,GAC9B9M,QAAQC,IAAIb,KAAK+P,WACjBrC,IAGA,QACCsC,QAAQ,WAAW,MAAOhQ,OAC1B0M,iBAAiBA,EAClBG,WAAWA,EACXY,YAAcA,GAjFfvN,QACGC,OAAO,SACPkB,QAAQ,WAAYiL,GAEvBA,EAAShL,SAAW,QAAQ,UAAW;CCPzC,WAOE,QAAS2O,KAET,GAAIjQ,IACHkQ,QAAU,GACVnF,KAAM,IAGHwD,EAAM,SAAS2B,EAASnF,GAC3B/K,EAAKkQ,QAAUA,EACflQ,EAAK+K,KAAOA,GAGToF,EAAQ,WACXnQ,EAAKkQ,QAAU,GACflQ,EAAK+K,KAAO,IAGTsB,EAAM,WACT,MAAOrM,GAGN,QACCqM,IAAIA,EACJkC,IAAIA,EACJ4B,MAAMA,GA7BTjQ,QACGC,OAAO,SACPkB,QAAQ,WAAY4O;CCHzB,WAME,QAAS5Q,GAAOJ,GAEd,GAAImR,MAEFC,EAAW,WACd,IAAK,GAAIC,KAAOF,GACVA,EAAKG,eAAeD,KACtBF,EAAKE,IAAK,IAKT/B,EAAM,SAAS+B,EAAKE,GACvB,GAAKJ,EAAKE,GAIN,CACJ,GAAIE,GAASA,GAAUJ,EAAKE,EAC7BF,GAAKE,GAAOE,MALVJ,GAAKE,IAAO,EACZrR,EAAWwR,WAAW,gBAQpBpE,EAAM,WACT,MAAO+D,GAGR,QACC/D,IAAIA,EACJkC,IAAIA,EACJ8B,SAASA,GAlCZnQ,QACGC,OAAO,SACPkB,QAAQ,UAAW,aAAchC;ACDtC,QAASqR,eAAejP,EAAIxC,GAE1B,QAAS0R,GAAWC,GAEhB9H,KAAK8H,eAAiBA,EAGtB9H,KAAK+H,WAAa/H,KAAK8H,eAAe3Q,OACtC6I,KAAKgI,UAAY,EACjBhI,KAAKiI,WAAa,EAElBjI,KAAKkI,QACDC,QAAS,EACTC,QAAS,EACTC,SAAU,EACVC,SAAU,GAGdtI,KAAKuI,MAAQvI,KAAKkI,OAAOC,QAGzBnI,KAAKwI,SAAW7P,EAAGwF,QACnB6B,KAAKtB,QAAUsB,KAAKwI,SAAS9J,QA2HjC,MApHAmJ,GAAUY,cAAgB,SAAUX,GAChC,GAAIY,GAAY,GAAIb,GAAWC,EAC/B,OAAQY,GAAUC,QAKtBd,EAAUe,WAEN/C,YAAagC,EAKbgB,YAAa,WACT,MAAQ7I,MAAKuI,QAAUvI,KAAKkI,OAAOC,SAGvCW,WAAY,WACR,MAAQ9I,MAAKuI,QAAUvI,KAAKkI,OAAOI,UAGvCS,WAAY,WACR,MAAQ/I,MAAKuI,QAAUvI,KAAKkI,OAAOG,UAGvCM,KAAM,WAEF,GAAK3I,KAAK6I,cACN,MAAQ7I,MAAa,OAEzBA,MAAKuI,MAAQvI,KAAKkI,OAAOE,OACzB,KAAM,GAAIjI,GAAI,EAAIA,EAAIH,KAAK+H,WAAa5H,IACpCH,KAAKgJ,kBAAmBhJ,KAAK8H,eAAgB3H,GAGjD,OAAQH,MAAa,SAMzBiJ,iBAAkB,SAA2BC,GACzClJ,KAAKiI,aAEAjI,KAAK8I,eAGV9I,KAAKuI,MAAQvI,KAAKkI,OAAOI,SACzBtI,KAAKwI,SAAS/J,OAAQyK,KAG1BC,gBAAiB,SAA0BD,GACvClJ,KAAKgI,YAEAhI,KAAK8I,eAMV9I,KAAKwI,SAASY,QACVC,QAAShD,KAAKiD,KAAMtJ,KAAKgI,UAAYhI,KAAK+H,WAAa,KACvDmB,cAAeA,IAIdlJ,KAAKgI,YAAchI,KAAK+H,aACzB/H,KAAKuI,MAAQvI,KAAKkI,OAAOG,SACzBrI,KAAKwI,SAAShK,QAASwB,KAAK8H,mBAOpCkB,kBAAmB,SAA4BE,GAC3C,GAAIR,GAAY1I,KASZuJ,EAAQnS,QAAQoS,QAAS,GAAIC,QAC5BC,KAAK,OAAQ,SAAUjT,GAGpBN,EAAWwT,OACP,WACIjB,EAAUS,gBAAiB1S,EAAMmT,OAAOC,KAGxCnB,EAAYa,EAAQ9S,EAAQ,SAIvCiT,KAAK,QAAS,SAAUjT,GAGrBN,EAAWwT,OACP,WACIjB,EAAUO,iBAAkBxS,EAAMmT,OAAOC,KAGzCnB,EAAYa,EAAQ9S,EAAQ,SAIvCwN,KAAM,MAAOiF,KAKpB,EArJR9R,QAAQC,OAAO,SACdyS,QAAQ,YAAalC,eAEtBA,cAAcpP,SAAW,KAAM;ACH/B;CCAA,WAUE,QAASuR,GAAWlS,EAASmS,EAAQrR,EAAIrC,GACxC,GAAI2T,GAAOjK,IACZiK,GAAK3T,KAAOA,EACZ2T,EAAKC,WAAY,EACjBD,EAAKE,MAAO,EACZF,EAAKG,KAAOC,EAAI,GAAIC,EAAI,IACxBL,EAAKM,SAAW,WAAY,MAAO1S,GAAQ2S,WAAW,KAGtDP,EAAKQ,WAAa,WACjBR,EAAKE,MAAQF,EAAKE,MAGnBF,EAAKS,SAAW,WACfT,EAAKU,aAAeN,EAAI,EAAEC,EAAI,GAC9BN,EAAOL,UAGRM,EAAKW,UAAY,WAChB,OAAIX,EAAKM,aACTN,EAAKG,IAAM,YACXH,EAAKC,WAAY,EACjBW,OAASzT,QAAQoS,QAAQsB,SAASC,iBAAiB,wBACnDC,YAAW,WACVH,OAAOI,KAAKC,mBAAmBjB,EAAKG,OAClC,OAGJH,EAAKkB,WAAY,SAASC,GAEzBnB,EAAKoB,YAAYhB,EAAIe,EAAEE,QAAQ,GAAGC,QAAQjB,EAAIc,EAAEE,QAAQ,GAAGE,SAE3DvB,EAAKwB,UAGNxB,EAAKyB,UAAYrB,EAAI,EAAEC,EAAI,GAC1BL,EAAKU,aAAeN,EAAI,EAAEC,EAAI,GAE/BL,EAAK0B,UAAW,SAASP,GAExB,GAAIP,GAASzT,QAAQoS,QAAQsB,SAASC,iBAAiB,mBAEvD,KAAKd,EAAKM,WAAY,OAAO,CAE7B,KAAKN,EAAKE,KAAM,OAAO,CAEvBiB,GAAEQ,gBAGF,IAAIC,GAAQT,EAAEE,QAAQ,GACtB1B,EAASiC,EAAMjC,OACfkC,GACCzB,EAAMwB,EAAMN,QAAQtB,EAAKoB,WAAWhB,EACpCC,EAAMuB,EAAML,QAAQvB,EAAKoB,WAAWf,GAIjCD,EAAIyB,EAAKzB,EAAEJ,EAAKU,YAAYN,EAChCC,EAAIwB,EAAKxB,EAAEL,EAAKU,YAAYL,EAGxBD,EAAKA,EAAET,EAAOmC,YAAY,IAAK9B,EAAKyB,SAASrB,EACjDC,EAAKA,EAAEV,EAAOoC,aAAa,IAAK/B,EAAKyB,SAASpB,EAG1C2B,GAAQ3B,KAAOD,KACnB4B,GAAO3B,EAAE4B,IAAS,GAClBD,EAAO3B,EAAE6B,WACTF,EAAO5B,EAAE+B,UACTH,EAAO5B,EAAEgC,MAAS,GAGd/B,EAAE2B,EAAO3B,EAAE4B,MAAK5B,EAAI2B,EAAO3B,EAAE4B,KAC7B5B,EAAE2B,EAAO3B,EAAE6B,SAAQ7B,EAAI2B,EAAO3B,EAAE6B,QAChC9B,EAAE4B,EAAO5B,EAAE+B,OAAM/B,EAAI4B,EAAO5B,EAAE+B,MAC9B/B,EAAE4B,EAAO5B,EAAEgC,QAAOhC,EAAI4B,EAAO5B,EAAEgC,MAGnC,IAAIC,IAAQjC,EAAIA,EAAEC,EAAIA,EACtBL,GAAKyB,SAAWY,CAGhB,IAAIlC,IAAOC,EAAI,MAAQC,EAAI,KAC3BO,GAAOI,KAAKC,mBAAmBd,IAE/BH,EAAKU,YAAcmB,EACnB9B,EAAOL,UAORM,EAAKsC,QAAU,SAASC,EAAG/V,GAM1B,GAJAqB,QAAQC,IAAItB,EAAMgW,YAIbxC,EAAKM,WAAY,OAAO,CAG7B,KAAKN,EAAKE,KAAM,OAAO,CAEvB,IAAIU,GAASzT,QAAQoS,QAAQsB,SAASC,iBAAiB,oBAIvD2B,GAHeC,OAAOC,YACT/B,EAAO,GAAGgC,QAGtBC,MAAQrW,EAAMmT,OAAOmC,YACrBc,OAASpW,EAAMmT,OAAOoC,eAKnBF,GACHzB,EAAM5T,EAAMsW,OACZzC,EAAM7T,EAAMuW,QAMT3C,EAAIyB,EAAKzB,EAAEJ,EAAKU,YAAYN,EAChCC,EAAIwB,EAAKxB,EAAEL,EAAKU,YAAYL,CAE5BxS,SAAQC,IAAIsS,EAAEC,EAGd,IAAID,GAAIhE,KAAK4G,IAAI5C,GAAGqC,EAAMI,MAAM,GAChCzC,GAAKyB,EAAKzB,EAAE,GAAIA,EAAEA,CAClB,IAAIC,GAAIjE,KAAK4G,IAAI3C,GAAGoC,EAAMG,OAAO,GACjCvC,GAAKwB,EAAKxB,EAAE,GAAIA,EAAEA,EAGlBD,GAAIJ,EAAKyB,SAASrB,EAClBC,GAAIL,EAAKyB,SAASpB,CAGlB,IAAI2B,IAAQ3B,KAAOD,KASnB4B,GAAO3B,EAAE4B,IAAS,GAClBD,EAAO3B,EAAE6B,WACTF,EAAO5B,EAAE+B,UACTH,EAAO5B,EAAEgC,MAAS,GAEd/B,EAAE2B,EAAO3B,EAAE4B,MAAK5B,EAAI2B,EAAO3B,EAAE4B,KAC7B5B,EAAE2B,EAAO3B,EAAE6B,SAAQ7B,EAAI2B,EAAO3B,EAAE6B,QAChC9B,EAAE4B,EAAO5B,EAAE+B,OAAM/B,EAAI4B,EAAO5B,EAAE+B,MAC9B/B,EAAE4B,EAAO5B,EAAEgC,QAAOhC,EAAI4B,EAAO5B,EAAEgC,MAGnC,IAAIC,IAAQjC,EAAIA,EAAEC,EAAIA,EAEtBxS,SAAQC,IAAIuU,GAEZrC,EAAKyB,SAAWY,CAIhB,IAAIlC,IAAOC,EAAI,MAAQC,EAAI,KAC3BO,GAAOI,KAAKC,mBAAmBd,IAO/BH,EAAKU,YAAclU,EAAMyW,SAAW7C,EAAI,EAAEC,EAAI,GAAKwB,GAUpD7B,EAAKkD,UAAY,SAAS9C,EAAEC,GAE3BU,WAAW,WACVf,EAAKC,WAAY,GACf,KAGHwC,MAAQtV,QAAQoS,QAAQsB,SAASsC,cAAc,gBAAgB,GAC/DC,OAASX,MAAMX,YACfuB,QAAUZ,MAAMV,aAChBuB,KAAOb,MAAMc,wBACbC,QAAUf,MAAMgB,cAAcC,gBAE9BC,QAAUL,KAAKrB,IAAMrU,EAAQgW,YAAcJ,QAAQK,UACnDC,QAAUR,KAAKnB,KAAOvU,EAAQmW,YAAcP,QAAQQ,WAGpDC,WAAc7D,EAAI0D,SAAWV,OAAU,IACvCc,WAAc7D,EAAIsD,SAAWN,QAAW,IAUpCzV,EAAQ2S,WAAaP,EAAKmE,WAAYhE,IAAO,IAAI8D,UAAa,MAAQ,IAAIC,WAAa,MACtF/D,IAAM,UAAc,KAAO,UAAc,MAC9CH,EAAKG,IAAIA,IACTS,OAASzT,QAAQoS,QAAQsB,SAASC,iBAAiB,oBACnDF,OAAOI,KAAKC,mBAAmBd,OAGhCH,EAAKoE,WAAa,SAASC,GAE1BrE,EAAKkD,UAAUmB,EAAOC,MAAMD,EAAOE,QAtOpCpX,QACGC,OAAO,SACPxB,WAAW,aAAckU,GAE5BA,EAAWvR,SAAW,UAAW,SAAU,KAAM;CCNnD,WAQE,QAASiW,KACP,OACEC,SAAU,KACV9Y,YAAa,oDACbC,WAAY,qBACZ8Y,KAAM,SAASC,EAAOC,EAAKC,EAAOC,GAGlCF,EAAIG,GAAG,aAAc,SAAS5D,GAC/BwD,EAAM3E,KAAKkB,WAAWC,KAGrByD,EAAIG,GAAG,YAAa,SAAS5D,GAC9BwD,EAAM3E,KAAK0B,UAAUP,KAGpByD,EAAIG,GAAG,WAAY,SAAS5D,GAC7BwD,EAAM3E,KAAKS,SAASU,OAvBvBhU,QACGC,OAAO,SACP4X,UAAU,aAAcR;CCJ7B,WAEErX,QACGC,OAAO,SACP4X,UAAU,YAAa,WAAY,SAASzL,GAE9C,OAEIkL,SAAU,KACb9Y,YAAa,gDACVgZ,OACEtY,KAAO,IACP4Y,OAAS,MAGXP,KAAM,SAAS3E,GACjBA,EAAO9S,KAAOsM,EAAS0D,UACvB8C,EAAOjG,WAAaP,EAASO,UAE7B,IAAIoL,IACH,SACA,gBACA,aACA,gBACA,SACA,QAGDnF,GAAOkF,OAASlF,EAAOkF,QAAUC,EAEjCnF,EAAOoF,aAAe,SAASlY,GAC9BmY,UACA,KAAK,GAAIC,KAAKpY,GACLA,EAAKuQ,eAAe6H,IAAMtF,EAAOkF,OAAOrY,QAAQyY,IAAI,IACzDD,QAAQC,GAAGpY,EAAKoY,GAGpB,OAAOD;CCrCb,WASE,QAASE,GAAYvF,EAAQwF,EAAUxI,EAAUnP,EAASvB,EAAMC,GAW/D,QAASkZ,GAAaC,EAAIC,EAAUC,GAEnCF,EAAKA,EAAG,GAERC,EAAWA,EAAUD,EAAGG,YAAY,EAAG,EAEvC,IAAIC,GAAUJ,EAAGK,YAAcL,EAAGG,WAE9BF,IAAYG,IAASH,EAAWG,EAAQ,GACxCH,GAAYG,IAASH,EAAWG,EAAQ,EAC5C,IAAIE,GAAU3J,KAAKiD,KAAKsG,EAAiB,IACvCK,EAAWN,EAAWD,EAAGQ,WACzBC,EAAcF,EAAWD,EACzBI,EAAcV,EAAGQ,WAAaP,EAAW,SAASU,EAAEC,GAAG,MAAOD,IAAGC,EAAE,GAAM,SAASD,EAAEC,GAAG,MAAOD,IAAGC,EAAE,GAajGC,EAAiBC,YAAY,WAEhC,GAAGJ,EAAWV,EAAGQ,WAAYP,GAAW,CACvC,GAAIc,GAAYf,EAAGQ,WAAWC,CAC1BM,IAAaX,IAASW,EAAYX,EAAQ,GAC9CJ,EAAGQ,WAAaO,MAQZC,eAAcH,IAEjB,IAlDJ,GAAII,GAAO3Q,IAGX2Q,GAAKpa,OAASA,EAAOgN,MACrBoN,EAAKra,KAAOA,EACZqa,EAAKvC,WAAa,IAiDlBuC,EAAKC,gBAAkB1E,IAAM,EAAGE,KAAO,GAIvCpC,EAAO6G,OAAO,SAAU,SAASC,EAASC,GAGzB,GAAZD,GAEH9J,EAAS,WAER,GAAIrP,GAAMqS,EAAOgH,KAAKnN,QAAQ,IAAI8M,EAAKra,KAAKY,KAAK8S,EAAOgH,KAAKnN,SAC7DoN,EAAgB7Z,QAAQoS,QAAQsB,SAASsC,cAAc,IAAIzV,GAE3DgZ,GAAKC,eAAe1E,IAAM+E,EAAcC,KAAK,aAC7CP,EAAKC,eAAexE,KAAO6E,EAAcC,KAAK,aAE9C,IAAIC,GAAW/Z,QAAQoS,QAAQsB,SAASsC,cAAc,IAAIpD,EAAOgH,KAAKnN,QAAQ,aAI9E,IAHAsN,EAASlG,KAAKiB,IAAMyE,EAAKC,eAAe1E,IAAI,KAAME,KAAOuE,EAAKC,eAAexE,KAAK,OAG9EvU,EAAQ2S,WAAamG,EAAKvC,WAAW,CACxC,GAAIgD,GAAUha,QAAQoS,QAAQgG,EAAS,GAAGpC,cAAc,kBACpDhB,EAAQgF,EAAQ,GAAKT,EAAKC,eAAexE,KAAMgF,EAAQ,GAAGvB,YAAY,EAAG,GAAK,CAClFuB,GAAQF,KAAK,aAAc9E,OAIxB,CACH,GAAIgF,GAAUha,QAAQoS,QAAQgG,EAAS,GACvC4B,GAAQF,KAAK,YAAaP,EAAKC,eAAe1E,IAAM,MAGnD,OAOLyE,EAAKU,WAAa,SAAS/C,EAAQtK,EAAIC,EAAMkN,GAC5C,GAAIC,GAAUha,QAAQoS,QAAQsB,SAASsC,cAAc,IAAInJ,EAAK,aAC1DkN,EAAW/Z,QAAQoS,QAAQsB,SAASsC,cAAc,IAAInJ,EAAK,cAC3DiI,EAAM9U,QAAQoS,QAAQ8E,EAAO1E,QAAQsH,KAAK,aAC1C9E,EAAOhV,QAAQoS,QAAQ8E,EAAO1E,QAAQsH,KAAK,cAC3CI,EAAOla,QAAQoS,QAAQsB,SAASC,iBAAiB,eAErDuG,GAAKrG,KAAKoB,MAAQ,SAAUkF,QAAU,IACtCJ,EAASlG,KAAKiB,IAAMA,EAAI,KAAME,KAAOA,EAAK,OAE1CuE,EAAKC,gBAAkB1E,IAAMA,EAAIE,KAAOA,GAEpCvU,EAAQ2S,WAAamG,EAAKvC,YAAYqB,EAAa2B,EAAShF,EAAM,KAEtEpF,EAAS,WACRsK,EAAKrG,KAAKoB,MAAQ,OAAQkF,QAAU,IACpCZ,EAAKra,KAAKY,KAAK+M,GAAQD,GACrB,MAIJ2M,EAAKa,QAAU,SAASvN,EAAMwN,GAC7Bd,EAAKra,KAAKY,KAAK+M,GAAQwN,GA7HzBra,QACGC,OAAO,SACPxB,WAAW,cAAe0Z,GAE7BA,EAAY/W,SAAW,SAAU,WAAW,WAAY,UAAW,OAAQ;CCN7E,WAME,QAAS4Y,KACP,OACE1C,SAAU,KACV9Y,YAAa,6CACbC,WAAY,sBACZ+Y,OACEoC,KAAO,IACPU,QAAS,IACTC,OAAQ,MAZdva,QACGC,OAAO,SACP4X,UAAU,UAAWmC;CCJ1B,WAEEha,QACGC,OAAO,SACP4X,UAAU,iBAAkB,UAAW,SAASpX,GAElD,OAEI6W,SAAU,KACVkD,SAAU,oEACV/b,WAAY,sBACZ+Y,OACEoC,KAAO,IACPU,QAAS,IACbC,OAAQ,KAGNhD,KAAM,SAAS3E,GAYb,QAAS6H,KACP,GAAIC,GAAcja,EAAQ2S,UACtBsH,GAAc9H,EAAOoE,WACvBpE,EAAO+H,QAAU,2DACRD,GAAe9H,EAAOoE,aAC/BpE,EAAO+H,QAAU,0DAftB/H,EAAOoE,WAAa,IAGpBvW,EAAQma,SAAW,WAChBH,IACA7H,EAAOL,UAGTkI,IAmBD7H,EAAOiI,aAAe,SAASxa,EAAKC,GACtC,MAAO,UAASuO,GACf,QAAIxO,GAAOwO,EAAOiM,OAASza,MACvBC,GAAOuO,EAAOiM,OAASxa;CCjDlC,WAME,QAASya,KACP,OACEzD,SAAU,KACV9Y,YAAa,oDACbC,WAAY,sBACZ+Y,OACEoC,KAAO,IACPU,QAAS,IACTC,OAAQ,MAZdva,QACGC,OAAO,SACP4X,UAAU,gBAAiBkD;CCJhC,WAME,QAASC,KACP,OACE1D,SAAU,KACV9Y,YAAa,mDACbC,WAAY,sBACZ+Y,OACEoC,KAAO,IACPU,QAAS,IACTC,OAAQ,KAEVhD,KAAM,SAAS3E,GAEdA,EAAOqI,kBAAoB,SAAStM,GACtC,MAAO,UAASC,GACf,QAAQA,EAAM,UAAUD,OAlB5B3O,QACGC,OAAO,SACP4X,UAAU,eAAgBmD;CCF/B,WAEA,KAAME,IACJvV,OAAU,YACVsH,yBAA4B,gEAC5BC,aAAgB,qEAChB7J,aAAgB,sBAChBE,UAAa,6BACb2C,iBAAoB,iDAGtB,OAAOgV;CCbP,WAOE,QAASC,GAAenc,EAAWoc,EAAQjc,EAAQF,EAAKwB,GACtD,GAAI4a,GAAKzS,IAEXyS,GAAGC,SACHD,EAAGC,MAAMC,MAAK,EACdF,EAAGG,YAAa,EAEhBH,EAAG1b,WAAamC,KAAKC,MAAMtB,EAAQG,aAAajB,YAChD0b,EAAGtY,OAAS,WACX9D,EAAI4K,qBACoB,KAApB7K,EAAUU,QACb0b,EAAOK,UAhBTzb,QACGC,OAAO,SACPxB,WAAW,iBAAkB0c,GAEhCA,EAAe/Z,SAAW,YAAY,SAAS,SAAU,MAAO;CCNlE,WAME,QAASsa,KACP,OACEpE,SAAU,KACV9Y,YAAa,kDACbC,WAAY,2BARhBuB,QACGC,OAAO,SACP4X,UAAU,aAAc6D;CCJ7B,WASE,QAASC,GAAWzc,GAKnB,QAAS0c,GAAarb,GACrB,OAAOA,GACN,IAAK,SACF,MAAO,GAGP,KAAK,QACL,MAAO,GAGP,KAAK,SACL,MAAO,GAGP,KAAK,aACL,MAAO,IAGP,KAAK,gBACL,MAAO,IAGP,KAAK,gBACL,MAAO,IAEP,SAAS,OAAO,GA5BrB,GAAIsb,GAAOjT,IACXiT,GAAK3c,KAAOA,EA+BZ2c,EAAKC,UAAY,WAChB,GAAIC,GAAMrI,SAASsI,SAASC,OAAO,eACnC,KAAK,GAAI3N,KAAYuN,GAAK3c,KAAKY,KAC5B,GAAI+b,EAAK3c,KAAKY,KAAKuQ,eAAe/B,GAAW,CAC9C,GAAI4N,GAASN,EAAatN,EACtB4N,KAAQH,GAAO,IAAIG,EAAOL,EAAK3c,KAAKY,KAAKwO,IAI/C,MADAyN,IAAO,QAIR,IAAII,MAEAC,EAAc,mDACdC,EAAoB,8DAGxBF,GAAYG,SAAW,SAASP,EAAK5J,GACpC,IAAK4J,EAAK,OAAO,CACjB,IAAIQ,GAAa,gDAAgDR,EAAI,gBAAgBM,EAAkB,UAAUD,CAEjH,OADIjK,KAAOoK,GAAc,WAAWC,UAAUrK,IACvCoK,GAIRJ,EAAYM,QAAU,SAASV,GAC9B,QAAKA,GACE,kCAAkCK,EAAY,IAAIL,GAI1DI,EAAY/Z,MAAQ,SAAS2Z,GAC5B,MAAO,oBAAoBK,EAAY,SAASC,EAAkB,MAAMN,GAIzEI,EAAYO,UAAY,SAAUX,EAAK5J,GACtC,OAAG4J,IAAO5J,GACH,gDAAgD4J,EAAI,UAAU5J,EAAM,gBAAgBiK,EAAY,MAAMC,GAG9GR,EAAKc,MAAQ,SAASC,GACrB,GAAIb,GAAMI,EAAYS,GAAQf,EAAKC,YAMnC,OALIC,MAAQ,EACC,SAARa,EAAiBrH,OAAOsH,KAAKd,EAAK,SACjCxG,OAAOsH,KAAKd,EAAK,GAAI,2EAEtBrb,QAAQC,IAAI,+BACV,GA1FTX,QACGC,OAAO,SACPxB,WAAW,aAAckd,GAE5BA,EAAWva,SAAW;CCNxB,WAEEpB,QACGC,OAAO,SACP4X,UAAU,iBAAkB,WAE9B,OAEIP,SAAU,KACVlX,SAAQ,EACX5B,YAAa,0DACVgZ,OACEtY,KAAO,IACP4d,QAAS,KAEXre,WAAY;CCfnB,WAQE,QAASse,GAAWnK,EAAQtB,GAI3BsB,EAAOoK,cAAe,EAEtB1L,EAAUD,cAAeuB,EAAOqK,QAC/Blc,KAAK,WACL6R,EAAOoK,cAAe,GAEvB,WACCtc,QAAQC,IAAI,6BAKbiS,EAAOsK,aAAe,EAEtBtK,EAAOuK,qBAAuB,SAAUC,GACtCxK,EAAOsK,aAAeE,GAGxBxK,EAAOyK,oBAAsB,SAAUD,GACrC,MAAOxK,GAAOsK,eAAiBE,GAGjCxK,EAAO0K,UAAY,WACjB1K,EAAOsK,aAAgBtK,EAAOsK,aAAetK,EAAOqK,OAAOld,OAAS,IAAO6S,EAAOsK,aAAe,GAGnGtK,EAAO2K,UAAY,WACjB3K,EAAOsK,aAAgBtK,EAAOsK,aAAe,IAAOtK,EAAOsK,aAAetK,EAAOqK,OAAOld,OAAS,GArCpGC,QACGC,OAAO,SACPxB,WAAW,aAAcse,GAE5BA,EAAW3b,SAAW,SAAU;CCNlC,WAME,QAASoc,KACP,OACElG,SAAU,KACV9Y,YAAa,0CACbC,WAAY,qBACZ+Y,OACEyF,OAAS,IACTQ,WAAa,MAXnBzd,QACGC,OAAO,SACP4X,UAAU,SAAU2F;CCJzB,WAOE,QAASE,GAAU1e,EAAWmO,GAG5B,GAAIkO,GAAKzS,IAETyS,GAAGzY,QACHuK,EAASC,aACNuQ,QAAQ,SAAS7d,GACjBY,QAAQC,IAAI,8BACXD,QAAQC,IAAIb,KAEb8d,MAAM,SAAU5J,GACftT,QAAQC,IAAIqT,KAjBlBhU,QACGC,OAAO,SACPxB,WAAW,YAAaif,GAE3BA,EAAUtc,SAAW,YAAa;CCNpC,WAOE,QAASyc,GAAW7e,EAAWE,EAAMC,EAAQF,EAAKyM,EAAOkH,EAAQxG,EAAU2D,GAwC3E,QAAS+N,GAAc1b,GACpB,GAAI2b,GAAK,wJACT,OAAOA,GAAGC,KAAK5b,GAGlB,QAAS6b,GAAoBC,GAC3B,GAAIC,GAAU,oDACd,OAAOD,GAASzO,MAAM0O,GA3CtB,GAAI9C,GAAKzS,IAEXzJ,GAAOgR,WACPkL,EAAGlc,OAAOA,EAAOgN,MAEjBkP,EAAGtL,SAASA,EAAS5D,MAGrBkP,EAAGnc,KAAOA,EAEVmc,EAAGvb,KAAKsM,EAAS0D,UACjBuL,EAAG+C,MAAQ/C,EAAGvb,KAAK+P,UAGnBwL,EAAGgD,OAAO,WACTzL,EAAOyI,GAAKA,GAKbA,EAAGiD,YACHjD,EAAGiD,SAASC,WACZlD,EAAGiD,SAASE,UACX3T,KAAO,GACPmF,QAAU,IAIXqL,EAAGiD,SAASG,OAAS,SAASC,GAC7Bhe,QAAQC,IAAI+d,GACZrD,EAAGiD,SAASC,QAAQG,IAAS,EAC7BrD,EAAGzY,KAAK8b,GAASrD,EAAGiD,SAASxe,KAAK4e,IAenCrD,EAAGiD,SAASK,SAAW,SAASD,EAAO5e,GAEtC,MAAa,SAAT4e,IACCZ,EAAche,KAEjBiQ,EAAS1B,IAAI,qCAAsC,UAC5C,GAIS,eAATqQ,MACJT,EAAoBne,KAEvBiQ,EAAS1B,IAAI,oCAAqC,UAC3C,KASVgN,EAAGiD,SAAS3O,KAAO,SAAS+O,GACvBrD,EAAGiD,SAASK,SAASD,EAAOrD,EAAGzY,KAAK8b,MAEvC3O,EAASE,QAETvE,EAAMkT,YAAYvD,EAAGzY,KAAK0I,WAAY+P,EAAGzY,MAAM7B,KAC9C,SAASC,GACRqa,EAAGiD,SAASC,QAAQG,IAAS,EAC7BrD,EAAGiD,SAASxe,KAAK4e,GAASrD,EAAGzY,KAAK8b,GAClC3O,EAAS1B,IAAI,eAAgB,YAE9B,SAASnN,GACRR,QAAQC,IAAIO,GACZ6O,EAAS1B,IAAInN,EAAI8O,QAAS,YAU5B,IAAIpN,GAAO3D,EAAI6B,gCACf,IAAI8B,EAAK,CACR8I,EAAMmT,gBAA+B,cAAIjc,EAAK4C,QAAQsZ,aACtD,IAAIC,GAAiBnc,EAAK4C,QAAQsF,SAASlJ,MAAM,KAAK,GACpDod,EAASld,KAAKC,MAAMF,KAAKkd,IAAiBE,GAC9CvT,GAAMwT,SAASF,GAAQje,KACtB,SAASC,GACRqa,EAAGzY,KAAO5B,EAAOlB,KACjBub,EAAGiD,SAASxe,KAAOE,QAAQmf,KAAKne,EAAOlB,MACvC8S,EAAOL,UAER,SAASrR,GAAKR,QAAQC,IAAIO,SAGzBlC,GAAUU,KAAK,IAelB2b,GAAG+D,SAAW,WACb/D,EAAGnc,KAAOA,EAAKsP,UAAU6M,EAAGgE,aAC5BrgB,EAAUU,KAAK,gBAGhB2b,EAAGgE,eACHhE,EAAGiE,WAAa,SAASpgB,GACxBmc,EAAGlc,OAAOogB,aAAc,EACxBlE,EAAGgE,YAAYvf,KAAKZ,GA1IrBc,QACGC,OAAO,SACPxB,WAAW,aAAcof,GAE5BA,EAAWzc,SAAW,YAAa,OAAO,SAAU,MAAO,QAAS,SAAU,WAAY;CCN5F,WAOE,QAASoe,GAAeje,EAAIqK,EAASgE,EAAU5Q,EAAWyB,EAAS0N,EAAczC,EAAOxM,EAAM0T,EAAQzT,EAAQF,EAAKmN,EAAU2D,GAc7H,QAAS0P,KACP,GAAIC,GAAKC,UAAUC,UAAUC,cACzBC,EAAYJ,EAAGjgB,QAAQ,aAC3B,IAAIqgB,EAAW,CAEb,GAA0B,GAAtBvK,OAAOwK,aAA0C,KAAtBxK,OAAOwK,YACpC,OAAO,CAEJ,IAA0B,IAAtBxK,OAAOwK,aAAqBxK,OAAOwK,iBAC7C,OAAO,MAGH,CACH,GAA0B,IAAtBxK,OAAOwK,aAAqBxK,OAAOwK,iBACrC,OAAO,CAEJ,IAA0B,GAAtBxK,OAAOwK,aAA0C,KAAtBxK,OAAOwK,YACzC,OAAO,GAwKZ,QAASC,GAAUvN,EAAKwN,GACrB,MAAO1e,GAAG,SAAS6F,EAAQC,GACzB,GAAI8K,GAAQ,GAAIE,MAChBF,GAAMM,IAAMA,EACZN,EAAMkM,OAAS,WACb4B,EAAMC,UAAU/N,EAAM,EAAE,EAAE,IAAI,KAC9B/K,EAAQ+K,IAEVA,EAAMgO,QAAU,SAASnM,GACvB3M,EAAO2M,MA9Mb,GAAIqH,GAAKzS,IAGXmH,GAASE,QACToL,EAAGtL,SAASA,EAAS5D,MAGrBhN,EAAOgR,WACPkL,EAAGlc,OAASA,EAAOgN,MA0BjBkP,EAAG+E,UAAUX,GACd,IAAIY,GAA4B,uBAAyB9K,QACxD+K,EAAmBD,EAA4B,oBAAsB,QAEvE9K,QAAOgL,iBAAiBD,EAAkB,WAExCjF,EAAG+E,UAAUX,IACb7M,EAAOL,WACN,GAKH8I,EAAGnc,MAAQY,KAAOZ,EAAKkQ,SAQvBiM,EAAGvb,KAAOsM,EAAS0D,UAEnB8C,EAAO6G,OAAO,WACb,MAAO4B,GAAGnc,KAAKY,MACb,SAAS0gB,EAASC,GACpBpF,EAAGqF,qBACD,GAEH9N,EAAO6G,OAAO,WACb,MAAO4B,GAAGvb,MACR,SAAS0gB,EAASC,GACpBpF,EAAGqF,qBACD,GAEHrF,EAAGsF,cACHtF,EAAGqF,iBAAmB,WACrB,GAAI5gB,GAAOub,EAAGvb,KAAKub,EAAGuF,MAAMvF,EAAGwF,WAAWnU,SACtCnM,EAAM8a,EAAGnc,KAAKY,KAAKub,EAAGuF,MAAMvF,EAAGwF,WAAWpU,SAC1CiB,EAAM9B,EAAQ,UAAU9L,GAAO8M,GAAIrM,GACnCmN,KAAKA,EAAMA,EAAI,IACnB2N,EAAGsF,WAAajT,GAAK,MAKtB2N,EAAGuF,SAGHvF,EAAGuF,MAAMtb,MACRwb,cAAgB,iBAChBpU,QAAU,UACVgC,MAAQ,SACRjC,QAAU,WAIX4O,EAAGuF,MAAMtb,MACRwb,cAAgB,gBAChBpU,QAAU,SACVgC,MAAQ,QACRjC,QAAU,UAIX4O,EAAGuF,MAAMtb,MACRwb,cAAgB,iBAChBpU,QAAU,UACVgC,MAAQ,SACRjC,QAAU,WAIX4O,EAAGuF,MAAMtb,MACRwb,cAAgB,UAChBpU,QAAU,UACVgC,MAAQ,aACRjC,QAAU,eAIX4O,EAAGuF,MAAMtb,MACRwb,cAAgB,UAChBpU,QAAU,UACVgC,MAAQ,gBACRjC,QAAU,kBAIX4O,EAAGuF,MAAMtb,MACRwb,cAAgB,UAChBpU,QAAU,UACVgC,MAAQ,gBACRjC,QAAU,kBAIX4O,EAAGuF,MAAMtb,MACRwb,cAAgB,OAChBpS,MAAQ,aAeT2M,EAAG0F,SAAS,OACZ1F,EAAGwF,UAAY,EACfxF,EAAG2F,WAAa,SAASpH,GACxB,QAAIA,GAAQyB,EAAGuF,MAAM7gB,YACjB6Z,EAAO,KACAqH,SAAPrH,IACCyB,EAAGwF,UAAYjH,OAGhBA,EAAK,GAAKyB,EAAGuF,MAAM7gB,QAAQsb,EAAGqF,wBAanCrF,EAAG6F,cAAgB,WAClB7F,EAAG8F,aAAa,WACfniB,EAAUU,KAAK,aAIjB2b,EAAG+F,WAAW,WACb,MAAIniB,GAAIU,iBAMP0b,GAAG8F,aAAa,WACfniB,EAAUU,KAAK,aANhB2b,EAAGgG,aAAehG,EAAG6F,cACrB/hB,EAAOkP,IAAI,mBAAkB,IACtB,IA+BTgN,EAAGiG,YAAc,WACf,GAAIC,GAAS7N,SAAS8N,cAAc,SACpCD,GAAO7L,MAAM,IACb6L,EAAO9L,OAAO,GAKb,KAAI,GAJDwK,GAAQsB,EAAOE,WAAW,MAC1BC,KAECC,EAAiBjO,SAASkO,uBAAuB,gBAC7C7Y,EAAE,EAAGA,EAAE4Y,EAAe5hB,OAAQgJ,IAAI,CACzC,GAAIoJ,GAAQwP,EAAe5Y,EAC1B2Y,GAASpc,KAAK0a,EAAU7N,EAAMM,IAAKwN,IAGrC,MAAO1e,GAAGsgB,IAAIH,GAAU3gB,KAAK,SAAS+gB,GACpC,GAAIC,GAAUR,EAAOS,UAAU,aAClC,OAAOD,MAIP1G,EAAG8F,aAAe,SAAS3T,GAC1BrO,EAAOgR,WACPkL,EAAG4G,WAAY,EACf5G,EAAGiG,cAAcvgB,KAAM,SAASqJ,GAC/B,GAAI9F,GAAWrF,EAAI6B,gCACjBwD,IACH5D,QAAQC,IAAI,KAAK2D,GACjBrF,EAAIkL,cAAcC,EAAU9F,GAAUvD,KACrC,SAASC,GACPqa,EAAG4G,WAAY,EAChB/iB,EAAKmP,IAAI,SAAS,GACjBnP,EAAKmP,IAAI,WAAW,GAAIpM,OACxB/C,EAAKmP,IAAI,QAAQrN,GAClB9B,EAAKyQ,OACAnC,GAAUA,EAASxM,IACrB,SAASE,GAAKR,QAAQC,IAAIO,OAI/Bma,EAAG4G,WAAY,EACf5G,EAAGgG,aAAehG,EAAG8F,aACrBhiB,EAAOkP,IAAI,mBAAkB,OAK9BgN,EAAG6G,SAAW,WACf,MAAIjjB,GAAIU,iBAMN0b,GAAG8F,gBALJ9F,EAAGgG,aAAehG,EAAG8F,aACrBhiB,EAAOkP,IAAI,mBAAkB,IACtB,IASPgN,EAAGgG,aAAehG,EAAG6F,cApRvBlhB,QACGC,OAAO,SACPxB,WAAW,iBAAkB+gB,GAEhCA,EAAepe,SAAW,KAAK,UAAU,WAAW,YAAa,UAAW,eAAgB,QAAS,OAAQ,SAAU,SAAU,MAAO,WAAY;CCNtJ,WAQE,QAAS+gB,GAAcnjB,EAAWC,EAAK8Q,EAAU6C,GAC/C,GAAIwP,GAAQxZ,IACZlI,SAAQC,IAAIiS,GAEdwP,EAAMrS,SAASA,EAAS5D,MAExBiW,EAAMrc,aACFsc,WAAa,GACbC,cAAgB,IAIpBF,EAAMG,kBAAoB,WACzB,QAASzE,GAAc1b,GACpB,GAAI2b,GAAK,wJACT,OAAOA,GAAGC,KAAK5b,GAElB,MAAI0b,GAAcsE,EAAMrc,YAAYsc,cAI/BD,EAAMrc,YAAYuc,gBACtBvS,EAAS1B,IAAI,0BAA2B,UACjC,IALP0B,EAAS1B,IAAI,qCAAsC,UAC5C,IAUT+T,EAAMzf,MAAQ,SAASP,EAAOU,GAC7BpC,QAAQC,IAAI,aACZoP,EAASE,QACHmS,EAAMG,sBACT7hB,QAAQC,IAAI,SACX1B,EAAI4D,wBAAwBT,EAAMU,GAAU/B,KAC9C,SAASC,GACJ4R,EAAOpF,UAAUoF,EAAOpF,WACxBoF,EAAO4P,UAAUxjB,EAAUU,KAAKkT,EAAO4P,WACtC5P,EAAOpF,UAAYoF,EAAO4P,UAAUxjB,EAAUU,KAAK,YAEzD,SAASwB,GACW,mCAAfA,EAAI8O,UAA8C9O,EAAI8O,QAAU,wCACpED,EAAS1B,IAAInN,EAAI8O,QAAQ,aAO7BoS,EAAMK,QAAU,WACfxjB,EAAI6H,oBAAoB/F,KACvB,SAASC,GACRhC,EAAUU,KAAK,YAEhB,SAASwB,GACR6O,EAAS1B,IAAInN,EAAI8O,QAAQ,YA7D5BhQ,QACGC,OAAO,SACPxB,WAAW,gBAAiB0jB,GAE/BA,EAAc/gB,SAAW,YAAa,MAAO,WAAY;CCN3D,WAQE,QAASshB,KACP,OACEpL,SAAU,KACV9Y,YAAa,kDACbC,WAAY,yBACZ+Y,OACFgL,SAAW,KACRhV,SAAW,OAbhBxN,QACGC,OAAO,SACP4X,UAAU,YAAa6K;CCJ5B,WAQE,QAASC,GAAiB3jB,EAAWC,EAAK2jB,EAAM7S,GAC9C,GAAI8S,GAAQja,IAEdia,GAAM9S,SAASA,EAAS5D,MAExB0W,EAAM9c,aACF1D,KAAO,GACPD,MAAQ,GACRU,SAAW,IAIf+f,EAAMC,yBAA2B,WAEhC,QAASC,GAAiBjgB,GAUzB,GAAIib,GAAK,wDACT,OAAOA,GAAGC,KAAKlb,GAGhB,QAASgb,GAAc1b,GACpB,GAAI2b,GAAK,wJACT,OAAOA,GAAGC,KAAK5b,GAIlB,MAAKygB,GAAM9c,YAAY3D,OAAUygB,EAAM9c,YAAY1D,MAASwgB,EAAM9c,YAAYjD,UAAa+f,EAAM9c,YAAYid,iBAKxGD,EAAiBF,EAAM9c,YAAYjD,WACvCiN,EAAS1B,IAAI,6QAGVwU,EAAM9c,YAAYjD,WAAa+f,EAAM9c,YAAYid,iBACpDjT,EAAS1B,IAAI,yCAA0C,UAChD,KAGJyP,EAAc+E,EAAM9c,YAAY3D,SACnC2N,EAAS1B,IAAI,sCAAuC,UAC7C,KAfP0B,EAAS1B,IAAI,0BAA2B,UACjC,IAwBPwU,EAAMI,aAAe,WACpBlT,EAASE,QAEL4S,EAAMC,4BACR7jB,EAAI4I,qBAAqBgb,EAAM9c,YAAY3D,MAAOygB,EAAM9c,YAAYjD,UAAU/B,KAC7E,WACE6R,OAAOpF,UAAUoF,OAAOpF,WACxBoF,OAAO4P,UAAUxjB,EAAUU,KAAKkT,OAAO4P,WACtC5P,OAAOpF,UAAYoF,OAAO4P,UAAUxjB,EAAUU,KAAK,gBAEtD,SAASwB,GACT6O,EAAS1B,IAAInN,EAAI8O,QAAS,YA7EhChQ,QACGC,OAAO,SACPxB,WAAW,mBAAoBkkB,GAElCA,EAAiBvhB,SAAW,YAAa,MAAO,OAAQ;CCN1D,WAQE,QAAS8hB,KACP,OACE5L,SAAU,KACV9Y,YAAa,wDACbC,WAAY,4BACZ+Y,OACFgL,SAAW,KACRhV,SAAW,OAbhBxN,QACGC,OAAO,SACP4X,UAAU,eAAgBqL;CCJ/B,WAOE,QAASC,GAAU1iB,EAASzB,EAAWE,EAAMC,EAAQyM,EAAS3M,EAAKyM,EAAOkH,EAAQxG,GAIhF,GAAIiP,GAAKzS,IACTyS,GAAGlc,OAAOA,EAAOgN,MAEnBkP,EAAGnc,KAAKA,EAAKY,KACbY,QAAQC,IAAIzB,GAEZmc,EAAG+H,aACH/H,EAAG+H,UAAUxJ,KAAK,EAElByB,EAAG+H,UAAUtjB,QACbub,EAAGgI,cAAgB,SAASxY,GAC3BwQ,EAAG+H,UAAUtjB,KAAKwjB,QAAUzY,EAEhB,GAARA,GAAcwQ,EAAG+H,UAAUtjB,KAAKyjB,SACnClI,EAAGlc,OAAOqkB,SAAQ,IAKpBnI,EAAGoI,mBAEHpI,EAAGvb,KAAKsM,EAAS0D,UACjBpP,QAAQC,IAAI0a,EAAGvb,MAEfub,EAAG+H,UAAUM,SAAW,WAKvB,GAHAhjB,QAAQC,IAAI,wBAGW,GAAnB0a,EAAG+H,UAAUxJ,KAGhB,MAAKyB,GAAG+H,UAAUtjB,KAAKwjB,QAMQ,GAA3BjI,EAAG+H,UAAUtjB,KAAKwjB,SAAejI,EAAG+H,UAAUtjB,KAAKyjB,YAMvDlI,EAAG+H,UAAUxJ,KAAK,IALjBlZ,QAAQC,IAAI,aACZ0a,EAAGlc,OAAOqkB,SAAQ,GACX,IARP9iB,QAAQC,IAAI,gBACL,IAgBV4U,OAAOoO,eAAiB,WACpB,MAAO,6BAKXtI,EAAG+C,SAjEHpe,QACGC,OAAO,SACPxB,WAAW,YAAa0kB,GAE3BA,EAAU/hB,SAAW,UAAW,YAAa,OAAO,SAAU,UAAW,MAAO,QAAS,SAAU;CCNrG,WAOE,QAASwiB,GAAU7T,GACjB,GAAIsL,GAAKzS,IAETmH,GAASE,QACToL,EAAGtL,SAAWA,EAAS5D,MATzBnM,QACCC,OAAO,SACPxB,WAAW,YAAamlB,GAE1BA,EAAUxiB,SAAW;CCNtB,WAOE,QAASyiB,GAAa9T,GACpB,GAAIsL,GAAKzS,IAEXmH,GAASE,QACPoL,EAAGtL,SAAWA,EAAS5D,MACvBkP,EAAGyI,SAAS,EAVd9jB,QACGC,OAAO,SACPxB,WAAW,eAAgBolB,GAE9BA,EAAaziB,SAAW;CCN1B,WASI,QAAS2iB,GAAUnR,EAAQ1T,EAAM8kB,GAEhCpR,EAAO1T,KAAOA,EAAKY,KATtBE,QACGC,OAAO,SACPxB,WAAW,WAAYslB,GAE1BA,EAAS3iB,SAAW,SAAS,OAAQ","file":"app.min.js","sourcesContent":["(function () {\n\n  angular.module('bdApp', ['ngRoute', 'ngAnimate','ngSanitize', 'ngCookies', 'angular-gestures']); \n  \n  \n  function config ($routeProvider, $locationProvider) {\n    $routeProvider\n      .when('/', {\n        templateUrl: '/pages/home/home.view.html',\n        controller: 'homeCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/register', {\n        templateUrl: '/pages/auth/register/register.view.html',\n        controller: 'registerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/login', {\n        templateUrl: '/pages/auth/login/login.view.html',\n        controller: 'loginCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/closet', {\n        templateUrl: '/pages/closet/closet.view.html',\n        controller: 'closetCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/order', {\n        templateUrl: '/pages/order/order.view.html',\n        controller: 'orderCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/customizer/:jean_id?/:action?', {\n        templateUrl: '/pages/customizer/customizer.view.html',\n        controller: 'customizerCtrl',\n        controllerAs: 'vm'\n      })\n      .when('/admin', {\n        templateUrl: '/pages/admin/admin.view.html',\n        controller: 'adminCtrl',\n        controllerAs: 'vm'\n      })\n      .otherwise({redirectTo: '/'});\n\n    // use the HTML5 History API\n    $locationProvider.html5Mode(true);\n    \n   }\n\n  function run($rootScope, $location, aws, jean, popups) {\n\t  \n    $rootScope.$on('$routeChangeStart', function(event, nextRoute, currentRoute) {\n\t    var locked = [\n\t\t    '/closet',\n\t\t    '/order'\n\t    ];\n\t    \n\t    if (locked.indexOf($location.path()) >= 0 && !aws.isLoggedIn() ){\n\t\t\t\t$location.path('/login');\n\t  \t}\n\t  \t\n\t  \t//If there's no jean on the order screen.... redirect to the customizer page.\n\t  \tif($location.path().indexOf(\"/order\") >= 0 && !Object.keys(jean.data).length){\n\t\t  \t$location.path('/customizer');\n\t\t  };\n\t\t  \n\t\t  \n    });\n  }\n  \n  angular\n    .module('bdApp')\n    .config(['$routeProvider', '$locationProvider', config])\n    .run(['$rootScope', '$location', 'aws', 'jean', 'popups', run])\n\t\t.filter('spaceless',function() {\n\t    return function(input) {\n\t      if (input) {\n\t      \treturn input.replace(/\\s+/g, '-');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('scoreToSpace',function() {\n\t    return function(input) {\n\t      if (input) {\n\t      \treturn input.replace(/_+/g, ' ');    \n\t      }\n\t    }\n\t\t})\n\t\t.filter('minMax',function(min, max, key) {\n\t\t\treturn function(input){\n\t\t\t\tif (min && input[key] < min) return false;\n\t\t\t\tif (max && input[key] > max) return false;\n\t\t    return true;\n\t\t  }  \n\t\t})\n\t\t.filter('displayName',function() {\n\t\t\treturn function(input){\t\t\t\t\n\t\t\t\treturn input ? input.replace(/Raw Denim/g, \"\") : false;\n\t\t  }  \n\t\t})\n\t\t\n\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t\n})();","","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('account', account);\n\t\t\n\taccount.$inject = ['aws', '$window'];\n  function account(aws, $window) {\n\t  \n\t  \n\t\tconsole.log('init');\n\t\t\n\t\tisLoggedIn = $window.localStorage.isLoggedIn;\n\t\t\n\t\tvar setUpUser = function(){\n\t\t\tconsole.log('somone ran setup');\n\t\t\taws.getCurrentUserFromLocalStorage().then(\n\t\t\t\tfunction(result){\n\t\t\t\t\tconsole.log('we have one');\n\t\t\t\t\tif (result.accessToken != \"\") var isLoggedIn = true;\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t\tvar isLoggedIn = false;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\t\n\t\tvar getLoggedInStatus = function(){\n\t\t\tconsole.log(isLoggedIn);\n\t\t\treturn isLoggedIn;\n\t\t}\n\t\t\n\t\tsetUpUser();\n\n    return {\n      isLoggedIn : isLoggedIn,\n      setUpUser : setUpUser\n    };\n    \n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .service('authentication', authentication);\n\n  authentication.$inject = ['$http', '$window', 'aws', '$q'];\n  function authentication ($http, $window, aws, $q) {\n\n    var saveToken = function (token) {\n      $window.localStorage['mean-token'] = token;\n    };\n\n    var getToken = function () {\n      return $window.localStorage['mean-token'];\n    };\n\n    var isLoggedIn = function() {\n      var token = getToken();\n      var payload;\n\n      if(token){\n        payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n\n        return payload.exp > Date.now() / 1000;\n      } else {\n        return false;\n      }\n    };\n\n    var currentUser = function() {\n      if(isLoggedIn()){\n        var token = getToken();\n        console.log(token);\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        return {\n          email : payload.email,\n          name : payload.name\n        };\n      }\n    };\n\n\t\t\n\t\tvar isAdmin = function(){\n\t\t\tif(isLoggedIn()){\n        var token = getToken();\n\n        var payload = token.split('.')[1];\n        payload = $window.atob(payload);\n        payload = JSON.parse(payload);\n        console.log(payload);\n        var roles = payload.permissions;\n\t\t\t\treturn roles.indexOf('admin') !== -1;\n      }\n\t\t}\n\n    \n\n    \n\n\n//\t\tconsole.log(aws.authenticateCognitoUser('cplefevre', 'ConfitConfit@123'));\n\n\t\tvar register = function(userDetails){\n\t\t\t//console.log(userDetails);\n\t\t//\tconsole.log(aws.signupForApplication('hello@confitdesign.com', 'ConfitConfit@123'));\t\n\t\t}\n    \n\n\t\t\n    \n\n    login = function(user) {\n\t    \n\t    aws.authenticateCognitoUser(user, password);\n\t\t};\n\n    logout = function() {\n      $window.localStorage.removeItem('mean-token');\n    };\n\n    return {\n      //userAttrList: userAttrList,\n      //createUserAttributeList: createUserAttributeList,\n      //userPool: userPool,\n\t    isAdmin : isAdmin,\n      currentUser : currentUser,\n      saveToken : saveToken,\n      getToken : getToken,\n      isLoggedIn : isLoggedIn,\n      register : register,\n      login : login,\n      logout : logout\n    };\n  }\n\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .service('aws', aws);\n\n  aws.$inject = ['$http', '$window', '$q', 'AWSConfig'];\n  function aws ($http, $window, $q, AWSConfig) {\n\t\t\t\n    function _getUserPool() {\n      var poolData = { UserPoolId : AWSConfig.USER_POOL_ID, ClientId : AWSConfig.CLIENT_ID };\n      var userPool = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData);\n      return userPool;\n    }\n\n    function _getAuthenticationDetails(uname, pword) {\n      var authenticationData = {\n        Username : uname,\n        Password : pword,\n      };\n      var authenticationDetails = new AWSCognito.CognitoIdentityServiceProvider.AuthenticationDetails(authenticationData);\n      return authenticationDetails;\n    }\n      \n    function _getCognitoUser(uname, upool) {\n      var userData = { Username : uname, Pool : upool };\n      var cognitoUser = new AWSCognito.CognitoIdentityServiceProvider.CognitoUser(userData);\n      return cognitoUser;\n    }\n\n    function _buildAttribute(keyName, value) {\n      var attribute = {\n        Name: keyName,\n        Value: value\n      }\n      var result = new AWSCognito.CognitoIdentityServiceProvider.CognitoUserAttribute(attribute);\n      return result;\n    }\n\n    function _buildAttributeList(attributeBuilder, obj) {\n      var attrList = [];\n      var attrToAdd;\n      for (var key in obj) {\n        attrToAdd = attributeBuilder(key, obj[key]);\n        attrList.push(attrToAdd);\n      }\n      return attrList;\n    }\n      \n    function _parseIdentityId(jwt){\n\t    var idTokenPayload = jwt.split('.')[1];\n\t\t\treturn JSON.parse(atob(idTokenPayload)).sub;\t\t\t\t\n    }\n    \n\t\tfunction _getAWSCredentials(idToken){\n\n\t\t\tlogins = {}\n\t\t\tvar authenticator = 'cognito-idp.'+AWSConfig.REGION+'.amazonaws.com/'+AWSConfig.USER_POOL_ID;\n\t\t\tlogins[authenticator] = idToken;\n\n\t\t\tAWS.config.update({ region: AWSConfig.REGION });\n\n      AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n        IdentityPoolId: AWSConfig.IDENTITY_POOL_ID,\n        Logins : logins\n\t\t\t});\n\n\t\t\treturn AWS.config.credentials.getPromise();\n\n\t    // if (AWS.config.credentials.needsRefresh()){\n\t    //   AWS.config.credentials.clearCachedId();\n\t    //   AWS.config.credentials.get(function(err){\n\t    //     if (err) {\n\t    //       defer.reject(err);\n\t    //     }\n\t    //     defer.resolve();\n\t    //   });\n\t    // } else {\n\t    //   AWS.config.credentials.get(function(err){\n\t    //     if (err) {\n\t    //       defer.reject(err);\n\t    //     }\n\t    //     defer.resolve();\n\t    //   });\n\t    // }\n\t\t\t//\n\t\t\t// return defer.promise;\n\t\t\t\n\t\t}\n\t\t\t\n    getUserFromLocalStorage = function(username) {\n      var cognitoUser = _getCognitoUser(username, _getUserPool());\n      if (cognitoUser != null) {\n          cognitoUser.getSession(function(err, session) {\n              if (err) {\n                  alert(err);\n                  return;\n              }\n              console.log('session validity: ' + session.isValid());\n          });\n      }\n    }\n\n    deleteCognitoUser = function() {\n      var cognitoUser = _getUserPool().getCurrentUser();\n      cognitoUser.deleteUser(function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\t\t\n\n\t\tauthenticateViaFB = function(){\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\t\n\t\t\tFB.login(function (response) {\n\t\t\t  if (response.authResponse) { // logged in\n\t\t\t    AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n\t\t\t      IdentityPoolId: AWSConfig.IDENTITY_POOL_ID,\n\t\t\t      Logins: {\n\t\t\t        'graph.facebook.com': response.authResponse.accessToken\n\t\t\t      }\n\t\t\t    });\n\t\t\t\n\t\t\t    defer.resolve();\n\t\t\t  } else {\n\t\t\t    defer.reject('There was a problem logging in with Facebook.');\n\t\t\t  }\n\t\t\t});\n\t\t\t\n\t\t\treturn defer.promise;\t\t\n\t\t}\n\t\t\n    authenticateCognitoUser = function(username, password) {\n      var authenticationDetails = _getAuthenticationDetails(username, password);\n      var cognitoUser = _getCognitoUser(username, _getUserPool());\n      \n      var defer = $q.defer();\n      \n      \n      cognitoUser.authenticateUser(authenticationDetails, {\n        onSuccess: function (result) {\n\t\t\t\t\tdefer.resolve(result);\n\t\t\t\t\t//Use the idToken for Logins Map when Federating User Pools with Cognito Identity or when passing through an Authorization Header to an API Gateway Authorizer\n\t\t\t\t\t$window.localStorage.isLoggedIn = true;\n        },\n        onFailure: function(err) {\n          defer.reject(err);\n        }, \n        newPasswordRequired: function(userAttributes, requiredAttributes) {\n          // User was signed up by an admin and must provide new\n          // password and required attributes, if any, to complete\n          // authentication.\n\t\t\t\t\tconsole.log(userAttributes, requiredAttributes);\n\n          // the api doesn't accept this field back\n          //delete userAttributes.email_verified;\n\n          // Get these details and call\n\t        // cognitoUser.completeNewPasswordChallenge(\"ConfitConfit@123\", userAttributes, this);\n\t      }\n      });\n      \n      return defer.promise;\n    }\n\t\t\n\n    signupForApplication = function(emailAddress, password) {\n\t    \n\t    var defer = $q.defer();\n\t    \n      var attributeList = _buildAttributeList(_buildAttribute, {email: emailAddress});\n      var cognitoUser;\n      _getUserPool().signUp(emailAddress, password, attributeList, null, function(err, result) {\n        if (err) defer.reject(err);\n        else defer.resolve(result);\n      });\n      \n      return defer.promise;\n    }\n\n    updateAttributesOnUser = function(username, obj) {      \n      var attributeList = _buildAttributeList(_buildAttribute, obj);\n      var cognitoUser   = _getCognitoUser(username, _getUserPool());\n      cognitoUser.updateAttributes(attributeList, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          console.log('call result: ' + result);\n      });\n    }\n\n    deleteUserAttributes = function(cognitoUser, attributeList) {\n      cognitoUser.deleteAttributes(attributeList, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          console.log('call result: ' + result);\n      });\n    }\n\n    verifyUserAttribute = function(cognitoUser, attributeName) {\n        cognitoUser.getAttributeVerificationCode(attributeName, {\n          onSuccess: function (result) {\n              console.log('call result: ' + result);\n          },\n          onFailure: function(err) {\n              alert(err);\n          },\n          inputVerificationCode: function() {\n              var verificationCode = prompt('Please input verification code: ' ,'');\n              cognitoUser.verifyAttribute(attributeName, verificationCode, this);\n          }\n      });\n    }\n\n    retrieveUserAttributes = function(cognitoUser) {\n      cognitoUser.getUserAttributes(function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          for (i = 0; i < result.length; i++) {\n              console.log('attribute ' + result[i].getName() + ' has value ' + result[i].getValue());\n          }\n      });\n    }\n\n    resendConfirmationCode = function(cognitoUser) {\n\t    if(!cognitoUser.resendConfirmationCode){\n\t\t  \t//We've just got an email address...\n\t\t  \tcognitoUser = _getCognitoUser(cognitoUser, _getUserPool());\n\t    }\n\t    \n      cognitoUser.resendConfirmationCode(function(err, result) {\n\t      \n\t      //TODO: This function throws an error on success that obscures a promise. Once the SDK has been fixed, we need to implement a promise structure to properly display results on the front end.\n        if (err) {\n          console.log(err);\n          return;\n        }\n        \n        //code has been sent\n        return true;\n      });\n    }\n    \n   confirmRegistration = function(cognitoUser, confirmationCode) {\n      cognitoUser.confirmRegistration(confirmationCode, true, function(err, result) {\n          if (err) {\n              alert(err);\n              return;\n          }\n          alert(result);\n      });\n    }\n\n    changePassword = function(cognitoUser, oldPassword, newPassword) {\n      cognitoUser.changePassword(oldPassword, newPassword, function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\n    forgotPasswordFlow = function(cognitoUser) {\n      cognitoUser.forgotPassword({\n        onSuccess: function (result) {\n            console.log('call result: ' + result);\n        },\n        onFailure: function(err) {\n            alert(err);\n        },\n        \n        inputVerificationCode: function() {\n            var verificationCode = prompt('Please input verification code ' ,'');\n            var newPassword = prompt('Enter new password ' ,'');\n            cognitoUser.confirmPassword(verificationCode, newPassword, this);\n        }\n      });\n    }\n\n    deleteUser = function(cognitoUser) {\n      cognitoUser.deleteUser(function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n\n    signUserOut = function(cognitoUser) {\n      if (cognitoUser != null) {\n          cognitoUser.signOut();\n      }\n    }\n    \n    signCurrentUserOut = function() {\n\t  \tvar cognitoUser = _getUserPool().getCurrentUser();\n      if (cognitoUser != null) {\n        cognitoUser.signOut();\n\t\t\t\t$window.localStorage.isLoggedIn = false;\n      }\n    }\n\n\n    signUserOutGlobally = function(cognitoUser) {\n\t    $window.localStorage.isLoggedIn = false;\n      cognitoUser.globalSignOut();\n    }\n\t\t\n\t\t\n\n    getCurrentUserFromLocalStorage = function() {\n      var cognitoUser = _getUserPool().getCurrentUser();\n      if (cognitoUser != null) {\n      \treturn cognitoUser.getSession(function(err, session) {\n          if (err) {\n\t          console.log(err);\n\t          return false;\n          }\n          return session;\n        });\n      }else{\n\t      console.log(\"You are not logged in\");\n\t      return false;\n      }\n    }\n    \n    \n\t\t\n\t\tisLoggedIn = function() {\n\t\t\tvar cognitoUser = _getUserPool().getCurrentUser();\n\t\t\treturn cognitoUser ? true: false;\n\t\t}\n\t\t\n\t\tagetCurrentUserFromLocalStorage = function() {\n\n\t\t\tvar cognitoUser = _getUserPool().getCurrentUser();\n\t\t\tif (cognitoUser != null) {\n\n\t\t\t\tcognitoUser.getSession(function(err, session) {\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tif (err){\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t}\n\n\t\t\t\t\tAWS.config.credentials = new AWS.CognitoIdentityCredentials({\n          \tIdentityPoolId : AWSConfig.IDENTITY_POOL_ID\n        \t});\n\t\t\t\t\t\n\t\t\t\t\t//User is logged in\n\t\t\t\t\treturn session;\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\telse{return false;}\n\t\t}\n\n\t\t\n    confirmRegisteredUnauthenticatedUser = function(userName, confirmationCode) {\n\t    \n      var cognitoUser = _getCognitoUser(userName, _getUserPool());\n\t    var defer = $q.defer();\n      \n      cognitoUser.confirmRegistration(confirmationCode, true, function(err, result) {\n        if (err) defer.reject(err);\n        else defer.resolve(result);\n      });\n      \n      return defer.promise;\n    }\n    \n\t\t\n    changePassword = function(cognitoUser, oldPassword, newPassword) {\n      cognitoUser.changePassword(oldPassword, newPassword, function(err, result) {\n        if (err) {\n            alert(err);\n            return;\n        }\n        console.log('call result: ' + result);\n      });\n    }\n   \n    \n    \n    \n    \n    //Save an image to s3 Bucket\n    saveImageTos3 = function (imageURL, userTokens){\n\t\t\t\n\t\tfunction dataURItoBlob(dataURI) {\n\t\t\tvar binary = atob(dataURI.split(',')[1]);\n\t\t\tvar array = [];\n\t\t\tfor(var i = 0; i < binary.length; i++) {\n\t\t\t  array.push(binary.charCodeAt(i));\n\t\t\t}\n\t\t\treturn new Blob([new Uint8Array(array)], {type: 'image/jpeg'});\n\t\t}\n\t\t\t\n\t\t\t\n\t\t\tvar defer = $q.defer();\n\t\t\t\n\n\t\t\t_getAWSCredentials(userTokens.idToken.jwtToken).then(\n\n\t\t\t\t//Got credentials.. now save image\n\t\t\t\tfunction(){\n\t\t\t\t\tvar blobData = dataURItoBlob(imageURL);\n\t\t\t\t\tvar bucketName = 'blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy';\n\t\t\t\t\tvar s3bucket = new AWS.S3({region: AWSConfig.REGION, params: {Bucket: bucketName}});\n\t\t\t\t\tvar params = {Key: AWS.config.credentials.identityId + \"/\" + \"myfilename.png\", Body: blobData};\n\n\t\t\t\t\ts3bucket.upload(params, function(err, data){\t      \n\t\t\t\t\t\tif (err) defer.reject(err);\n\t\t\t\t\t\telse  defer.resolve(data.Location);\t\t\t\t\t\t\n    \t\t\t});\n    \t\t\t\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t//Can't get AWS Credentials\n\t\t\t\tfunction(err){\n\t\t\t\t\tdefer.reject(err);\n\t\t\t\t}\n\t\t\t);\n\t\t\t\n\t\t\treturn defer.promise;\n\n    }\n \n     \n      \n    \n    return {\n\t    authenticateViaFB: authenticateViaFB,\n\t    getUserFromLocalStorage: getUserFromLocalStorage,\n      deleteCognitoUser: deleteCognitoUser,\n      authenticateCognitoUser: authenticateCognitoUser,\n      signupForApplication: signupForApplication,\n      updateAttributesOnUser: updateAttributesOnUser,\n      deleteUserAttributes: deleteUserAttributes,\n      verifyUserAttribute: verifyUserAttribute,\n      retrieveUserAttributes: retrieveUserAttributes,\n      resendConfirmationCode: resendConfirmationCode,\n      confirmRegistration: confirmRegistration,\n      changePassword: changePassword,\n      forgotPasswordFlow: forgotPasswordFlow,\n      deleteUser: deleteUser,\n      signUserOut: signUserOut,\n      signUserOutGlobally: signUserOutGlobally,\n      getCurrentUserFromLocalStorage: getCurrentUserFromLocalStorage,\n      confirmRegisteredUnauthenticatedUser: confirmRegisteredUnauthenticatedUser,\n      signCurrentUserOut:signCurrentUserOut,\n      saveImageTos3 : saveImageTos3,\n      isLoggedIn:isLoggedIn\n    };\n  }\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('bdAPI', bdAPI);\n\n  bdAPI.$inject = ['$window', '$http', '$httpParamSerializer', '$filter'];\n  function bdAPI ($window, $http, $httpParamSerializer, $filter) {\n\n\t  $window._thirdParty = $window._thirdParty || {};\n\t  $window._thirdParty.BlueDeltaApi =new API.Client.DefaultApi(angular.injector([\"ng\"]).get(\"$http\"),\n    angular.injector([\"ng\"]).get(\"$httpParamSerializer\"),\n    angular.injector([\"ng\"]));\n\n    var BlueDeltaApi = $window._thirdParty.BlueDeltaApi;\n\t\t\n\t\t//JSON Data\n\t\tBlueDeltaApi.jsonData = {};\n\t\tsetupJsonData = function(key){\n\t\t\t$http.get('/data/'+key+'.json').then(function(response){\n\t\t\t\tBlueDeltaApi.jsonData[key] = response.data;\n\t\t\t});\n\t\t}\n\t\t\n\t\tjsonDataKeys = [\n\t\t\t'chris-jeans',\n\t\t\t'profile',\n\t\t\t'styles',\n\t\t\t'threads',\n\t\t\t'buttons',\n\t\t\t'fabrics',\n\t\t\t'genders',\n\t\t\t'tailors'\n\t\t];\n\t\t\n\t\tfor (d = 0; d < jsonDataKeys.length; d++) { \n\t\t\tsetupJsonData(jsonDataKeys[d]);\n\t\t}\n\t\t\n\n\t\tvar styleByGender = function(gender){\n\t\t\treturn function(style){\n\t\t\t\treturn style[\"images_\"+gender];\n\t\t  }\n\t\t};\n\t\t\n\t\tBlueDeltaApi.jeanKeyToDataKey = function(jeanKey){\n\t\t\tvar dataKey = false;\n\t\t\t\n\t\t\tswitch(true){\n\t\t\t\tcase jeanKey.indexOf('thread') > -1:\n\t\t\t\tdataKey = \"threads\";\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase (jeanKey == \"gender\" || jeanKey == \"style\" ||  jeanKey == \"fabric\"):\n\t\t\t\tdataKey = jeanKey+\"s\";\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\treturn  dataKey;\n\t\t}\n\t\t\t\n\t\t\t\t\n\t\tBlueDeltaApi.dataLookup = function(dataKey, id, attr){\n\t\t\t\n\t\t\tattr = attr||null;\n\t\n\t\t\tif (typeof dataKey == 'undefined' || typeof id == 'undefined') return false;\n\t\t\tvar dataSet = BlueDeltaApi.jsonData[dataKey];\n\t\t\tdataById = \t$filter('filter')(dataSet, {id: id});\n\t\t\tif (typeof dataById == 'undefined') return false; //Return false when dataSet is undefined...\n\t\t\t\n\t\t\tselected = dataById[0];\n\t\t\t\n\t\t\tif (!attr) return selected;\n\t\t\telse return selected[attr];\t\n\t\t\t\n\t\t}\n\n\n\n\t  return BlueDeltaApi;\n  }\n\n})();","// Autogenerated file, do not modify directly\n(function () {\n  angular \n    .module('bdApp')\n    .service('AWSConfig', AWSConfig);\n      \n  function AWSConfig () {\n\t\treturn{\n\t\t\t\"REGION\": \"us-east-1\",\n\t\t  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n\t\t  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n\t\t  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n\t\t  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n\t\t  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n\t\t}\n  }\n\n\n})();","(function() {\n\n  angular\n    .module('bdApp')\n    .service('meanData', meanData);\n\n  meanData.$inject = ['$http', 'authentication'];\n  function meanData ($http, authentication) {\n\t\t\n\t\t/*\n    var getProfile = function () {\n      return $http.get('/api/profile', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n    */\n    var getOptions = function () {\t    \n      return $http.get('/api/options', {\n        headers: {\n          Authorization: 'Bearer '+ authentication.getToken()\n        }\n      });\n    };\n\t\t\n\t\t\n\t\t\n\t\t\n\t\tvar getJeanById = function(id, callback){\n\t\t\t$http.get('/data/chris-jeans.json').then(function(response){\n\t\t\t\tvar jeans = response.data;\n\t\t\t\tfor(j=0; j<response.data.length; j++){\n\n\t\t\t\t\tif (response.data[j].id == id){\n\t\t\t\t\t\tconsole.log('jean found');\n\t\t\t\t\t\tvar ret = response.data[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tcallback(ret);\n\n\t\t\t});\n\t\t}\n\t\t\n\t\t//Placeholders\n\t\tvar getJeansByUser = function(userId){\n\t\t\treturn $http.get('/data/chris-jeans.json');\n\t\t};\t\t\n\t\tvar getProfile = function(){\n\t\t\treturn $http.get('/data/profile.json');\n\t\t};\n\t\t\n\t\tvar getStyles = function(){\n\t\t\treturn $http.get('/data/styles.json');\n\t\t};\n\t\t\n\t\tvar getThreads = function(){\n\t\t\treturn $http.get('/data/threads.json');\n\t\t};\n\t\t\n\t\tvar getHardware = function(){\n\t\t\treturn $http.get('/data/buttons.json');\n\t\t};\n\t\t\n\t\tvar getFabrics = function(){\n\t\t\treturn $http.get('/data/fabrics.json');\n\t\t};\n\t\t\n\t\t\n\t\tvar getGenders = function(){\n\t\t\treturn $http.get('/data/genders.json');\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\t\n    return {\n\t    getJeanById: getJeanById,\n\t    getJeansByUser : getJeansByUser,\n      getProfile : getProfile,\n      getOptions : getOptions,\n      getStyles : getStyles,\n      getThreads : getThreads,\n      getHardware: getHardware,\n      getFabrics: getFabrics,\n      getGenders: getGenders\n    };\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('jean', ['$routeParams', 'bdAPI', jean]);\n\n  function jean($routeParams, bdAPI) {\n\n   \tdata = {};\n\t\t\n\t\tset = function(property, value){\n\t\t\tthis.data[property] = value;\n\t\t\tthis.saved=false;\n\t\t};\n\t\t\n\t\tcreateNew = function(jean){\n\t\t\tif (!jean || jean.constructor != Object){\n\t\t\t\tthis.data = {\n\t\t\t\t\t\"gender\" : 1,\n\t\t\t\t\t\"style\" : 1,\n\t\t\t\t\t\"fabric\" : \"1004\",\n\t\t\t\t\t\"accent_thread\" : \"1\",\n\t\t\t\t\t\"top_thread\" : \"1\",\n\t\t\t\t\t\"bottom_thread\" : \"1\",\n\t\t\t\t\t\"id\":Math.floor(Math.random() * 1000000000)\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tthis.saved=false;\n\t\t\t\t\n\t\t\t}else{\n\t\t\t\tthis.data = {\n\t\t\t\t\t\"title\" : \"Copy of \"+jean.data.title,\n\t\t\t\t\t\"gender\" : jean.data.gender,\n\t\t\t\t\t\"style\" : jean.data.style,\n\t\t\t\t\t\"fabric\" : jean.data.fabric,\n\t\t\t\t\t\"accent_thread\" : jean.data.accent_thread,\n\t\t\t\t\t\"top_thread\" : jean.data.top_thread,\n\t\t\t\t\t\"bottom_thread\" : jean.data.bottom_thread,\n\t\t\t\t\t\"id\":Math.floor(Math.random() * 1000000000)\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t\n\t\t\n\t\t\n\t\t/*\n\t\t*\n\t\t* SET UP JEAN - Check route params for a data url or jean Id...\n\t\t*\n\t\t*/\n\t\tfunction parseURLkey(key){\n\t\t\tswitch(key){\n\t\t\t\tcase \"g\":\n\t      return \"gender\";\n\t      break;\n\t      \n\t      case \"s\":\n\t      return \"style\";\n\t      break;\n\t      \n\t      case \"f\":\n\t      return \"fabric\";\n\t      break;\n\t      \n\t      case \"tt\":\n\t      return \"top_thread\";\n\t      break;\n\t      \n\t      case \"tb\":\n\t      return \"bottom_thread\";\n\t      break;\n\t      \n\t      case \"ta\":\n\t      return \"accent_thread\";\n\t      \n\t      default: return false;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t//Set up jean data from parameter\n\t\tvar setup = function(){\n\t\t\t\n\t\t\t//Copy or Create from Data\n\t\t\tif ($routeParams.jean_id && $routeParams.action=='copy'){\n\n\t\t\t\t//Create Jean from data\n\t\t\t\tif ($routeParams.jean_id.indexOf(\":\")>0){\n\t\t\t\t\tthis.createNew();\n\t\t\t\t\tjeanData = $routeParams.jean_id.split(\":\");\n\t\t\t\t\tfor(var d=0; d<jeanData.length; d++){\n\t\t\t\t\t\tvar parts= jeanData[d].match(/([A-Za-z]+)([0-9]+)/);\n\t\t\t\t\t\tif (!parts) continue;\n\t\t\t\t\t\tvar jeanKey = parseURLkey(parts[1]);\n\t\t\t\t\t\tif (jeanKey) this.data[jeanKey] = parseInt(parts[2]);\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//Copy Jean from ID\t\n\t\t\t\telse{\t\n\t\t\t\t\tthis.createNew($routeParams.jean_id);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t//Lookup Jean by Id\n\t\t\t}else if ($routeParams.jean_id && !$routeParams.action){\n\n\t\t\t\t//Edit Jean TODO: Change out with real API function to look up by ID...\n\t\t\t\tbdAPI.jsonData.getJeanById($routeParams.jean_id, function(data){\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.data=data;\t\n\t\t\t\t\t}else{\n\t\t\t\t\t\t//jean id doesn't exist\n\t\t\t\t\t\tthis.createNew();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t//New Jean or Existing Data.\n\t\t\t}else{\n\t\t\t\t//New Jean\n\t\t\t\tif(Object.keys(this.data).length === 0 && this.data.constructor === Object) this.createNew();\n\t\t\t\t\n\t\t\t\t//If there's already data in place we'll use that.\n\t\t\t}\n\t\t\t//Return Jean data...\n\t\t\treturn this.data;\n\t\t}\n\t\t\n\t\t\n\t\tvar get=function(){\n\t\t\treturn this.data;\n\t\t}\n\t\t\n\t\tvar save = function(jean){\n\t\t\tconsole.log(\"saving jean...\");\t\n\t\t}\n\t\t\n    return {\n\t    save : save,\n\t    get : get,\n\t    setup : setup,\n      data : data,\n      set : set,\n      createNew :createNew\n    };\n    \n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('jsonData', jsonData);\n\n  jsonData.$inject = ['$http','$filter', '$timeout'];\n  function jsonData ($http, $filter, $timeout) {\n\t  \n\t\tdata = {};\n\t\t$timeout\n\t\tsetupJsonData = function(key){\n\t\t\t$http.get('/data/'+key+'.json').then(function(response){\n\t\t\t\tdata[key] = response.data;\n\t\t\t});\n\t\t}\n\t\t\n\t\tjsonDataKeys = [\n\t\t\t'jeansList',\n\t\t\t'profile',\n\t\t\t'styles',\n\t\t\t'threads',\n\t\t\t'buttons',\n\t\t\t'fabrics',\n\t\t\t'genders',\n\t\t\t'tailors'\n\t\t];\n\n\t\tfor (d = 0; d < jsonDataKeys.length; d++) { \n\t\t\tsetupJsonData(jsonDataKeys[d]);\n\t\t}\t\t\t\n\n\t\tvar styleByGender = function(gender){\n\t\t\treturn function(style){\n\t\t\t\treturn style[\"images_\"+gender];\n\t\t  }\n\t\t};\n\t\t\n\t\tvar jeanKeyToDataKey = function(jeanKey){\n\t\t\tvar dataKey = false;\n\t\t\t\n\t\t\tswitch(true){\n\t\t\t\tcase jeanKey.indexOf('thread') > -1:\n\t\t\t\tdataKey = \"threads\";\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t\tcase (jeanKey == \"gender\" || jeanKey == \"style\" ||  jeanKey == \"fabric\"):\n\t\t\t\tdataKey = jeanKey+\"s\";\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t\treturn  dataKey;\n\t\t}\n\t\t\t\n\t\t\t\t\n\t\tvar dataLookup = function(jeanKey, id, attr){\n\n\t\t\tattr = attr||null;\n\t\t\t\n\t\t\tif (typeof jeanKey == 'undefined' || typeof id == 'undefined') return false;\n\t\t\tvar dataKey = jeanKeyToDataKey(jeanKey);\n\t\t\tvar dataSet = data[dataKey];\n\t\t\t//console.log(\"dataSetVV\");\n\t\t\t//console.log(dataSet);\n\t\t\tdataById = \t$filter('filter')(dataSet, {id: id});\n\t\t\tif (typeof dataById == 'undefined') return false; //Return false when dataSet is undefined...\n\t\t\t\n\t\t\tselected = dataById[0];\n\t\t\t\n\t\t\tif (!attr) return selected;\n\t\t\telse return selected[attr];\t\n\t\t\t\n\t\t}\n\n\t\tvar getJeanById = function(id, callback){\n\t\t\tconsole.log(data.jeansList);\n\t\t\tcallback();\n\t\t}\n\n\t  return {\n\t\t  getData:function(){return data;},\n\t\t  jeanKeyToDataKey:jeanKeyToDataKey,\n\t\t\tdataLookup:dataLookup,\n\t\t\tgetJeanById : getJeanById\n\t\t};\n  }\n\n})();","(function() {\n\n  angular\n    .module('bdApp')\n    .service('messages', messages);\n\n\t//meanData.$inject = [];\n  function messages() {\n\t\n\t\tvar data = {\n\t\t\tmessage : \"\",\n\t\t\ttype: \"\"\n\t\t};\n\t\t\n\t\tvar set = function(message, type){\n\t\t\tdata.message = message;\n\t\t\tdata.type = type;\n\t\t}\n\t\t\t\n\t\tvar reset = function(){\n\t\t\tdata.message = \"\";\n\t\t\tdata.type = \"\";\t\n\t\t}\n\t\t\n\t\tvar get = function(){\n\t\t\treturn data;\n\t\t}\n\t\t\n    return {\n\t    get:get,\n\t    set:set,\n\t    reset:reset\n    };\n  }\n\n})();","\n(function() {\n\n  angular\n    .module('bdApp')\n    .service('popups', ['$rootScope', popups]);\n\n  function popups($rootScope) {\n\t\t\n    var pops = {};\n        \n\t\tvar closeAll = function(){\n\t\t\tfor (var pop in pops) {\n\t\t\t  if (pops.hasOwnProperty(pop)) {\n\t\t\t    pops[pop]=false;\n\t\t\t  }\n\t\t\t}\n\t\t}\n    \n    var set = function(pop, status){\n\t    if (!pops[pop]){\n\t\t    pops[pop] = true;\n\t\t    $rootScope.$broadcast('popupChange');\n\t    }\n\t    else{\n\t\t  \tvar status = status || pops[pop];\n\t\t\t\tpops[pop] = status;\n\t\t\t}\n    }\n    \n    var get = function(){\n\t    return pops;\n    }\n    \n    return {\n\t    get:get,\n\t    set:set,\n\t    closeAll:closeAll\n    }\n  }\n\n})();","angular.module('bdApp')\n.factory('preloader', preloaderFunc);\n\npreloaderFunc.$inject = ['$q', '$rootScope'];\nfunction preloaderFunc( $q, $rootScope ) {\n  // I manage the preloading of image objects. Accepts an array of image URLs.\n  function Preloader( imageLocations ) {\n      // I am the image SRC values to preload.\n      this.imageLocations = imageLocations;\n      // As the images load, we'll need to keep track of the load/error\n      // counts when announing the progress on the loading.\n      this.imageCount = this.imageLocations.length;\n      this.loadCount = 0;\n      this.errorCount = 0;\n      // I am the possible states that the preloader can be in.\n      this.states = {\n          PENDING: 1,\n          LOADING: 2,\n          RESOLVED: 3,\n          REJECTED: 4\n      };\n      // I keep track of the current state of the preloader.\n      this.state = this.states.PENDING;\n      // When loading the images, a promise will be returned to indicate\n      // when the loading has completed (and / or progressed).\n      this.deferred = $q.defer();\n      this.promise = this.deferred.promise;\n  }\n  // ---\n  // STATIC METHODS.\n  // ---\n  // I reload the given images [Array] and return a promise. The promise\n  // will be resolved with the array of image locations.\n  Preloader.preloadImages = function( imageLocations ) {\n      var preloader = new Preloader( imageLocations );\n      return( preloader.load() );\n  };\n  // ---\n  // INSTANCE METHODS.\n  // ---\n  Preloader.prototype = {\n      // Best practice for \"instnceof\" operator.\n      constructor: Preloader,\n      // ---\n      // PUBLIC METHODS.\n      // ---\n      // I determine if the preloader has started loading images yet.\n      isInitiated: function isInitiated() {\n          return( this.state !== this.states.PENDING );\n      },\n      // I determine if the preloader has failed to load all of the images.\n      isRejected: function isRejected() {\n          return( this.state === this.states.REJECTED );\n      },\n      // I determine if the preloader has successfully loaded all of the images.\n      isResolved: function isResolved() {\n          return( this.state === this.states.RESOLVED );\n      },\n      // I initiate the preload of the images. Returns a promise.\n      load: function load() {\n          // If the images are already loading, return the existing promise.\n          if ( this.isInitiated() ) {\n              return( this.promise );\n          }\n          this.state = this.states.LOADING;\n          for ( var i = 0 ; i < this.imageCount ; i++ ) {\n              this.loadImageLocation( this.imageLocations[ i ] );\n          }\n          // Return the deferred promise for the load event.\n          return( this.promise );\n      },\n      // ---\n      // PRIVATE METHODS.\n      // ---\n      // I handle the load-failure of the given image location.\n      handleImageError: function handleImageError( imageLocation ) {\n          this.errorCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          this.state = this.states.REJECTED;\n          this.deferred.reject( imageLocation );\n      },\n      // I handle the load-success of the given image location.\n      handleImageLoad: function handleImageLoad( imageLocation ) {\n          this.loadCount++;\n          // If the preload action has already failed, ignore further action.\n          if ( this.isRejected() ) {\n              return;\n          }\n          // Notify the progress of the overall deferred. This is different\n          // than Resolving the deferred - you can call notify many times\n          // before the ultimate resolution (or rejection) of the deferred.\n          this.deferred.notify({\n              percent: Math.ceil( this.loadCount / this.imageCount * 100 ),\n              imageLocation: imageLocation\n          });\n          // If all of the images have loaded, we can resolve the deferred\n          // value that we returned to the calling context.\n          if ( this.loadCount === this.imageCount ) {\n              this.state = this.states.RESOLVED;\n              this.deferred.resolve( this.imageLocations );\n          }\n      },\n      // I load the given image location and then wire the load / error\n      // events back into the preloader instance.\n      // --\n      // NOTE: The load/error events trigger a $digest.\n      loadImageLocation: function loadImageLocation( imageLocation ) {\n          var preloader = this;\n          // When it comes to creating the image object, it is critical that\n          // we bind the event handlers BEFORE we actually set the image\n          // source. Failure to do so will prevent the events from proper\n          // triggering in some browsers.\n          // --\n          // The below removes a dependency on jQuery, based on a comment\n          // on Ben Nadel's original blog by user Adriaan:\n          // http://www.bennadel.com/members/11887-adriaan.htm\n          var image = angular.element( new Image() )\n              .bind('load', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageLoad( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .bind('error', function( event ) {\n                  // Since the load event is asynchronous, we have to\n                  // tell AngularJS that something changed.\n                  $rootScope.$apply(\n                      function() {\n                          preloader.handleImageError( event.target.src );\n                          // Clean up object reference to help with the\n                          // garbage collection in the closure.\n                          preloader = image = event = null;\n                      }\n                  );\n              })\n              .attr( 'src', imageLocation )\n          ;\n      }\n  };\n  // Return the factory instance.\n  return( Preloader );\n};","","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('istackCtrl', istackCtrl);\n\n  istackCtrl.$inject = ['$window', '$scope', '$q', 'jean'];\n  \n  \n  \n  function istackCtrl($window, $scope, $q, jean) {\n\t  var isvm = this;\n\t\tisvm.jean = jean;\n\t\tisvm.centerPan = false;\t\t\n\t\tisvm.zoom = false;\n\t\tisvm.pan = {\"x\":50, \"y\":30};\n\t\tisvm.isMobile = function(){ return $window.innerWidth<800 };\n\t\t\n\t\t\n\t\tisvm.toggleZoom = function(){\n\t\t\tisvm.zoom = !isvm.zoom\n\t\t}\n\t\t\n\t\tisvm.touchEnd = function(){\n\t\t\tisvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\t$scope.$apply();\n\t\t}\n\t\t\n\t\tisvm.returnPan = function(){\n\t\t\tif (isvm.isMobile()) return false;\n\t\t\tisvm.pan = \"50% 30% 0\";\t\n\t\t\tisvm.centerPan = true;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\tsetTimeout(function(){\n\t\t\t\timages.css({\"transform-origin\":isvm.pan});\n\t\t\t}, 200);\n\t\t}\n\t\t\t\t\n\t\tisvm.touchStart= function(e){\t\n\t\t\t//Setup Swipe starting point\n\t\t\tisvm.swipeStart={\"x\":e.touches[0].clientX,\"y\":e.touches[0].clientY};\n\t\t\t//Clear out Swipe Object\n\t\t\tisvm.swipe={};\n\t\t}\n\t\t\n\t\tisvm.zoomDrag = {\"x\":0,\"y\":0};\n\t  isvm.dragTracker = {\"x\":0,\"y\":0};\n\t\t\n\t\tisvm.touchMove= function(e){\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t//Prevent Scrolling?\n\t\t\te.preventDefault();\n\t\t\t\n\n\t\t\tvar touch = e.touches[0],\n\t\t\ttarget = touch.target,\n\t\t\tdrag = {\n\t\t\t\t\"x\" : touch.clientX-isvm.swipeStart.x,\n\t\t\t\t\"y\" : touch.clientY-isvm.swipeStart.y\n\t\t\t};\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = (x/target.clientWidth*100)+isvm.zoomDrag.x,      \n\t\t\ty = (y/target.clientHeight*100)+isvm.zoomDrag.y;\n\n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -120;\n\t\t\tbounds.x.right  = 90;\n\t\t\t\n\t\t\t//Apply Bounds\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y};\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\tisvm.dragTracker = drag;\t\n\t\t\t$scope.$apply();\n\n\t\t}\n\t\t\n\n\n\n\t\tisvm.dragPan = function(u, event) {\n\t\t\n\t\t\tconsole.log(event.direction);\n\t\t\t\n\t\t\t\n\t\t\t//Only Drag on mobile\n\t\t\tif (!isvm.isMobile()) return false;\n\t\t\t\n\t\t\t//Only run function if we're zoomed in\n\t\t\tif (!isvm.zoom) return false;\n\t\t\t\n\t\t\tvar images = angular.element(document.querySelectorAll(\"#zoom-frame img\")),\n\t\t\twindowHeight = window.innerHeight,\n\t\t\torigHeight = images[0].height,\n\t\t\tnewHeight = origHeight*1.7,\n\t\t\tframe={\n\t\t\t\t\"width\":event.target.clientWidth,\n\t\t\t\t\"height\":event.target.clientHeight\n\t\t\t};\n\t\t\t\n\n\t\t\t//Get drag length\n\t\t\tvar drag = {\n\t\t\t\t\"x\" : event.deltaX,\n\t\t\t\t\"y\" : event.deltaY\n\t\t\t}\n\t\t\t\n\t\t\n\t\t\t\n\t\t\t//Subtract previous returns of this drag length to get the amount dragged since last return\t\n\t\t\tvar x = drag.x-isvm.dragTracker.x,\n\t\t\ty = drag.y-isvm.dragTracker.y;\n\n\t\t\tconsole.log(x,y);\n\t\t\t\n\t\t\t//Get drag % of container for Transform Origin Only \n\t\t\tvar x = Math.abs(x)/frame.width*100;      \n\t\t\tx = (drag.x<0)?-x:x;\t       \n\t\t\tvar y = Math.abs(y)/frame.height*100;\n\t\t\ty = (drag.y<0)?-y:y;\n\t\t\t\n\t\t\t//Add these values to the last drag. This essentially allows drag and drop\n\t\t\tx=x+isvm.zoomDrag.x;\n\t\t\ty=y+isvm.zoomDrag.y;\n\t\t\t\t \n\t\t\t//Set up max bounds\n\t\t\tvar bounds={\"y\":{},\"x\":{}}; \n\n\t\t\t/*//Left/Right Bounds\n\t\t\tbounds.y.top =(newHeight/2)+175;\n\t\t\tbounds.y.bottom =-(newHeight*.225);\n\t\t\tbounds.x.left = -(event.target.clientWidth-(event.target.clientWidth*.05));\n\t\t\tbounds.x.right = event.target.clientWidth-(event.target.clientWidth*.05);*/\n\t\t\t\t\n\t\t\t//Transform Origin Bounds\n\t\t\tbounds.y.top    = 60;\n\t\t\tbounds.y.bottom = -90;\n\t\t\tbounds.x.left   = -150;\n\t\t\tbounds.x.right  = 60;\n\t\t\t\t\n\t\t\tif (y>bounds.y.top) y = bounds.y.top;\n\t\t\tif (y<bounds.y.bottom) y = bounds.y.bottom;\n\t\t\tif (x<bounds.x.left) x = bounds.x.left;\n\t\t\tif (x>bounds.x.right) x = bounds.x.right;\n\t\t\t\n\t\t\t//Build Move Objext\t\t\n\t\t\tvar move = {\"x\":x,\"y\":y}\n\t\t\t\n\t\t\tconsole.log(move);\n\t\t\t//Register Drag\n\t\t\tisvm.zoomDrag = move;\t \t       \n\t        \n\t       \n\t\t\t//Alter transform origin\n\t\t\tvar pan = -x + \"% \" + -y + \"% 0\";\n\t\t\timages.css({\"transform-origin\":pan});\n\n\t\t\t/*//Alter Left/Bottom\n\t\t\timages.css('left', move.x+\"px\");\n\t\t\timages.css('bottom', -move.y+\"px\");*/\n\t\t\t\n\t\t\t//When drag is over, reset drag tracker\t \n\t\t\tisvm.dragTracker = event.isFinal ? {\"x\":0,\"y\":0} : drag;\n\t\t\t\t \n\n\t\t}\n\t\t\n\n\t\t\n\n\t\t\n\n\t\tisvm.scanImage = function(x,y){\n\n\t\t\tsetTimeout(function(){\n\t\t\t\tisvm.centerPan = false;\n\t\t\t}, 200);\n\t\t\t\n\t\t\t\n\t\t\tframe = angular.element(document.querySelector(\"#zoom-frame\"))[0];\n\t\t\tfWidth = frame.clientWidth;\n\t\t\tfHeight = frame.clientHeight;\n\t\t\trect = frame.getBoundingClientRect();\n\t\t\trootDoc = frame.ownerDocument.documentElement;\n\t\t\t\t//calculate the offset of the frame from the top and left of the document\n\t\t\toffsetT = rect.top + $window.pageYOffset - rootDoc.clientTop\n\t\t\toffsetL = rect.left + $window.pageXOffset - rootDoc.clientLeft\n\n\t\t\t//calculate current cursor position inside the frame, as a percentage\n\t\t\txPosition = ((x - offsetL) / fWidth) * 100\n\t\t\tyPosition = ((y - offsetT) / fHeight) * 100\n\t\t\t\n\t\t\t\n\t\t\t/*\n\t\t\tconsole.log(x,y);\n\t\t\tconsole.log(fWidth);\n\t\t\tconsole.log(offsetL);\n\t\t\tconsole.log(x-offsetL);\n\t\t\tconsole.log(xPosition, yPosition);\n\t\t\t*/\n\t\t\tif ($window.innerWidth < isvm.breakPoint) pan = (100-xPosition) + \"% \" + (100-yPosition) + \"% 0\";\n\t\t\telse pan = (xPosition) + \"% \" + (yPosition) + \"% 0\";\n\t\t\tisvm.pan=pan;\n\t\t\timages = angular.element(document.querySelectorAll(\"#zoom-frame img\"));\n\t\t\timages.css({\"transform-origin\":pan});\n\t\t}\n\t\t\n\t\tisvm.trackMouse = function($event){\n\t\t\t//if (isvm.isMobile()) return false;\n\t\t\tisvm.scanImage($event.pageX,$event.pageY);\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('imageStack', imageStack);\n\t\t\n\n\t\n  function imageStack () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/image-stack/image-stack.template.html',\n      controller: 'istackCtrl as isvm',\n      link: function(scope, ele, attrs, ctrl) {\n\t      \n\t      \n\t     ele.on('touchstart', function(e){\n\t\t\t \tscope.isvm.touchStart(e);\t\n\t     });\t\n\t     \n\t     ele.on('touchmove', function(e){\n\t\t\t \tscope.isvm.touchMove(e);\t\n\t     });\t\t\n\t     \n\t     ele.on('touchend', function(e){\n\t\t\t \tscope.isvm.touchEnd(e);\t\n\t     });\t\t\t\t\n\t\t\t\n       \n\t      /*\n\t      $swipe.bind(ele, {\n          'move': function(event) {\n\t\t\t\t\t\tscope.isvm.scanImage(coords.x,coords.y);\n          }\n\t      });\n\t     */\n\n\t    }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('jeanList', ['jsonData', function(jsonData) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t\t\t\ttemplateUrl: '/directives/jean-list/jean-list.template.html',\n\t      scope : {\n\t        jean : '=',\n\t        fields : '=?'\n\t      },\n\t      \n\t      link: function($scope){\n\t\t\t\t\t$scope.data = jsonData.getData();\n\t\t\t\t\t$scope.dataLookup = jsonData.dataLookup;\n\t\t\t\t\t\n\t\t\t\t\tvar defaultFields = [\n\t\t\t\t\t\t'fabric',\n\t\t\t\t\t\t'accent_thread',\n\t\t\t\t\t\t'top_thread',\n\t\t\t\t\t\t'bottom_thread',\n\t\t\t\t\t\t'gender',\n\t\t\t\t\t\t'style'\n\t\t\t\t\t];\n\t\t\t\t\t\n\t\t\t\t\t$scope.fields = $scope.fields || defaultFields;\n\n\t\t\t\t\t$scope.filterFields = function(data){\n\t\t\t\t\t\tmatches = {};\n\t\t\t\t\t\tfor (var k in data) {\n\t\t        \tif (data.hasOwnProperty(k) && $scope.fields.indexOf(k)>=0) {\n\t\t\t\t\t  \t  matches[k]=data[k];\n\t\t\t\t\t    }\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn matches;\n\t\t\t\t\t}\n\n\t\t   \n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('chooserCtrl', chooserCtrl)\n\t\n\t\tchooserCtrl.$inject = ['$scope', '$element','$timeout', '$window', 'jean', 'popups'];\n\n\t\t\n\t\tfunction chooserCtrl($scope, $element, $timeout, $window, jean, popups) {\n\t\n\t\t\tvar chvm = this;\n\t\t\t\n\t\t\t//popups\n\t\t\tchvm.popups = popups.get();\n\t\t\tchvm.jean = jean;\n\t\t\tchvm.breakPoint = 800;\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\tfunction scrollToLeft(el, scrollTo, scrollDuration) {\n\t\t\t\t//Select First Element\n\t\t\t\tel = el[0];\n\t\t\t\t//Center Scroll To\n\t\t\t\tscrollTo = scrollTo-(el.offsetWidth/2)+40;\n\t\t\t\t\n\t\t\t\tvar maxLeft = el.scrollWidth - el.offsetWidth;\n\t\t\t\t\n\t\t\t\tif (scrollTo >= maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tif (scrollTo == maxLeft) scrollTo = maxLeft-1;\n\t\t\t\tvar stepNum = Math.ceil(scrollDuration / 15),\n\t\t\t\t\t\tdistance = scrollTo - el.scrollLeft,\n\t\t\t\t\t\tscrollStep = (distance / stepNum),\n\t\t\t\t\t\tscrollTest = (el.scrollLeft < scrollTo ? function(a,b){return a<=b-1;} : function(a,b){return a>=b+1;} );\t\t\n\t\t\t\t/*\n\n\t\t\t\tconsole.log(\"current Scoll pos: \"+el.scrollLeft);\n\t\t\t\tconsole.log(\"Scroll to \"+scrollTo);\n\t\t\t\tconsole.log(\"distance to go \"+distance);\n\t\t\t\tconsole.log(scrollStep);\n\t\t\t\tconsole.log(\"func: \"+scrollTest)\n\t\t\t\tconsole.log(\"eval\");\n\t\t\t\tconsole.log(scrollTest(el.scrollLeft, scrollTo ));\n\t\t\t\tconsole.log(\"done\");\n\t\t\t\t*/\n\t\t\t\t\t\t\n\t\t\t\tvar scrollInterval = setInterval(function(){    \n\t\t\t\t\n\t\t\t\t\tif(scrollTest(el.scrollLeft, scrollTo )){\n\t\t\t\t\t\tvar newScroll = el.scrollLeft+scrollStep;\n\t\t\t\t\t\tif (newScroll >= maxLeft) newScroll = maxLeft-1;\n\t\t\t\t\t\tel.scrollLeft = newScroll;\n\t\t\t\t\t\t\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tconsole.log(newScroll);\n\t\t\t\t\t\tconsole.log(scrollTo);\n\t\t\t\t\t\t*/\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\telse clearInterval(scrollInterval); \n\t\t      \n\t  \t\t},15);\n\t\t\t  \n\t\t\t}\n\n\t\t\tchvm.selectorCoords = {\"top\":0, \"left\":0};\n\t\t\t\n\t\t\t\n\t\t\t//Center Selector on chooser change... Center on selected attr if edting preexisting jean...\n\t\t\t$scope.$watch('active', function(newValue,oldValue) {\t\n\t\t\t\t\n\t\t\t\t//Only on active choosers...\n\t\t\t\tif (newValue == true){\n\n\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar key = $scope.step.jeanKey+\"_\"+chvm.jean.data[$scope.step.jeanKey],\n\t\t\t\t\t\tactiveElement = angular.element(document.querySelector('#'+key));\n\t\t\t\t\t\t\n\t\t\t\t\t\tchvm.selectorCoords.top = activeElement.prop('offsetTop');\n\t\t\t\t\t\tchvm.selectorCoords.left = activeElement.prop('offsetLeft');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+$scope.step.jeanKey+\"-selector\"));\n\t\t\t\t\t\tselector.css({'top':chvm.selectorCoords.top+'px', 'left':chvm.selectorCoords.left+'px'});\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Mobile Choosers\n\t\t\t\t\t\tif ($window.innerWidth < chvm.breakPoint){\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0].querySelector('.chooser-grid'));\t\n\t\t\t\t\t\t\tvar left = (chooser[0] ? chvm.selectorCoords.left-(chooser[0].offsetWidth/2)+40 : 0);\n\t\t\t\t\t\t\tchooser.prop('scrollLeft', left);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t//Desktop Choosers\n\t\t\t\t\t\telse{\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar chooser = angular.element($element[0]);\t\n\t\t\t\t\t\t\tchooser.prop('scrollTop', chvm.selectorCoords.top - 15);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}, 200);\n\t\t\t\t\t\n\t\t\t\t}\t\t\n\t\t\t\t\n    \t});\n\n\n\t\t\tchvm.selectAttr = function($event, id, attr, selector){\n\t\t\t\tvar chooser = angular.element(document.querySelector(\"#\"+attr+\"-chooser\"));\n\t\t\t\tvar selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));\n\t\t\t\tvar top = angular.element($event.target).prop('offsetTop');\n\t\t\t\tvar left = angular.element($event.target).prop('offsetLeft');\n\t\t\t\tvar text = angular.element(document.querySelectorAll('#item-title'));\n\t\t\t\t\n\t\t\t\ttext.css({'right':'-400px', 'opacity':0});\n\t\t\t\tselector.css({'top':top+'px', 'left':left+'px'});\n\t\t\t\t\n\t\t\t\tchvm.selectorCoords = {\"top\":top,\"left\":left};\n\t\t\t\t\n\t\t\t\tif ($window.innerWidth < chvm.breakPoint) scrollToLeft(chooser, left, 200);\n\t\t\t\t\n\t\t\t\t$timeout(function(){\n\t\t\t\t\ttext.css({'right':'15px', 'opacity':1});\t\t\t\t\n\t\t\t\t\tchvm.jean.data[attr] =\tid;\t\n\t\t\t\t}, 200);\n\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tchvm.jeanSet = function(attr, val){\n\t\t\t\tchvm.jean.data[attr] =\tval;\n\t\t\t}\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('chooser', chooser);\n\t\t\n  function chooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('fabricChooser', ['$window', function($window) {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      template: '<div class=\"fabric-chooser-container\" ng-include=\"viewUrl\"></div>',\n\t      controller: 'chooserCtrl as chvm',\n\t      scope : {\n\t        step : '=',\n\t        dataset: '=',\n\t\t\t\t\tactive: '='\n\t      },\n\t      \n\t      link: function($scope){\n\t\t      \n\t\t      $scope.breakPoint = 800;\n\t\t      \n\t\t      //Template on window resize\n\t\t      $window.onresize = function() {\n\t          changeTemplate();\n\t          $scope.$apply();\n\t        };\n\t        \n\t        changeTemplate();\n\t            \n\t        function changeTemplate() {\n\t          var screenWidth = $window.innerWidth;\n\t          if (screenWidth < $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-mobile.html\";\n\t          } else if (screenWidth >= $scope.breakPoint) {\n\t            $scope.viewUrl = \"/directives/choosers/fabric-chooser.template-desk.html\";\n\t          }\n\t        }\n\t\t      \n\t\t      \n\t\t      function positionChooser(){\n\t\t\t    \t//element.animate({scrollLeft: element.offset().left - 50}, \"slow\");\n\t\t\t    \t//var selector = angular.element(document.querySelector(\"#\"+attr+\"-selector\"));  \n\t\t      }\n\t\t      \n\t\t      \n\t\t      //Weight Filter\n\t\t      $scope.weightFilter = function(min, max){\n\t\t\t\t\t\treturn function(fabric){\n\t\t\t\t\t\t\tif (min && fabric.weight < min) return false;\n\t\t\t\t\t\t\tif (max && fabric.weight > max) return false;\n\t\t\t\t\t    return true;\n\t\t\t\t\t  }\n\t\t\t\t\t};\n\t      }\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('genderChooser', genderChooser);\n\t\t\n  function genderChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/gender-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      }\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('styleChooser', styleChooser);\n\t\t\n  function styleChooser () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/choosers/style-chooser.template.html',\n      controller: 'chooserCtrl as chvm',\n      scope : {\n        step : '=',\n        dataset: '=',\n        active: '='\n      },\n      link: function($scope){\n\t      //Weight Filter\n\t      $scope.checkGenderFilter = function(gender){\n\t\t\t\t\treturn function(style){\n\t\t\t\t\t\treturn (style['images_'+gender] ? true:false);\n\t\t\t\t  }\n\t\t\t\t};\n\t    }\n     \n\n    };\n  }\n\n})();","// Autogenerated file, do not modify directly\n\n(function() {\n\nconst configOverridesGenerated = {\n  \"REGION\": \"us-east-1\",\n  \"PROFILE_IMAGES_S3_BUCKET\": \"blue-delta-api-development-stack-userdatabucket-12z57hiicf3xy\",\n  \"API_ENDPOINT\": \"https://kd6f1omjzc.execute-api.us-east-1.amazonaws.com/development\",\n  \"USER_POOL_ID\": \"us-east-1_UvVeNoe5z\",\n  \"CLIENT_ID\": \"6hdrpk1j20qmjhfdiga31uia80\",\n  \"IDENTITY_POOL_ID\": \"us-east-1:60250bd7-bc76-4ab7-8813-2369461cb881\"\n};\n\nreturn configOverridesGenerated;\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('navigationCtrl', navigationCtrl);\n\n  navigationCtrl.$inject = ['$location','$route','popups', 'aws', '$window'];\n  function navigationCtrl($location, $route, popups, aws, $window) {\n    var vm = this;\n\t\t\n\t\tvm.drops={};\n\t\tvm.drops.acct=false;\n\t\tvm.mobileMenu = false;\n\t\t\n\t\tvm.isLoggedIn = JSON.parse($window.localStorage.isLoggedIn);\t\n\t\tvm.logout = function(){\t\t\t\n\t\t\taws.signCurrentUserOut();\n\t\t\tif ($location.path() == \"/\")\n\t\t\t\t$route.reload();\n\t\t}\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('navigation', navigation);\n\n  function navigation () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/navigation/navigation.template.html',\n      controller: 'navigationCtrl as navvm'\n    };\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('socialCtrl', socialCtrl)\n\t\n\t\tsocialCtrl.$inject = ['jean'];\n\n\t\t\n\t\tfunction socialCtrl(jean) {\n\t\n\t\t\tvar sovm = this;\n\t\t\tsovm.jean = jean;\n\t\t\t\n\t\t\tfunction jeanKeytoURL(key){\n\t\t\t\tswitch(key){\n\t\t\t\t\tcase \"gender\":\n\t\t      return \"g\";\n\t\t      break;\n\t\t      \n\t\t      case \"style\":\n\t\t      return \"s\";\n\t\t      break;\n\t\t      \n\t\t      case \"fabric\":\n\t\t      return \"f\";\n\t\t      break;\n\t\t      \n\t\t      case \"top_thread\":\n\t\t      return \"tt\";\n\t\t      break;\n\t\t      \n\t\t      case \"bottom_thread\":\n\t\t      return \"tb\";\n\t\t      break;\n\t\t      \n\t\t      case \"accent_thread\":\n\t\t      return \"ta\";\n\t\t      \n\t\t      default: return false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tsovm.jeanToUrl = function(){\n\t\t\t\tvar url = document.location.origin+\"/customizer/d\";\n\t\t\t\tfor (var property in sovm.jean.data) {\n\t\t\t    if (sovm.jean.data.hasOwnProperty(property)) {\n\t\t\t\t\t\tvar urlKey = jeanKeytoURL(property);\n\t\t\t\t\t\tif (urlKey) url += \":\"+urlKey+sovm.jean.data[property];\n\t\t\t    }\n\t\t\t\t}\t\t\t\t\n\t\t\t\turl += \"/copy\";\n\t\t\t\treturn url;\n\t\t\t}\n\t\t\t\n\t\t\tvar sharingUrls = {};\n\t\t\t\n\t\t\tvar socialTitle = \"Check out my custom jeans built with Blue Delta!\";\n\t\t\tvar socialDescription = \"Cras justo odio, dapibus ac facilisis in, egestas eget quam.\";\n\n\t\t\t//Facebook sharing URL\n\t\t\tsharingUrls.facebook = function(url, image){\n\t\t\t\tif (!url) return false;\n\t\t\t\tvar baseString = 'https://www.facebook.com/sharer/sharer.php?u='+url+'&description='+socialDescription+'&title='+socialTitle;\n\t\t\t\tif (image) baseString += '&images='+urlencode(image);\n\t\t\t\treturn baseString;\n\t\t\t}\n\t\t\t\n\t\t\t//Twitter sharing URL\n\t\t\tsharingUrls.twitter = function(url){\n\t\t\t\tif (!url) return false;\n\t\t\t\treturn 'http://twitter.com/home?status='+socialTitle+'-'+url;\n\t\t\t}\n\t\t\t\n\t\t\t//Email sharing URL\n\t\t\tsharingUrls.email = function(url){\n\t\t\t\treturn \"mailto:?&subject=\"+socialTitle+\"&body=\"+socialDescription+\" - \"+url;\n\t\t\t}\n\t\t\t\n\t\t\t//Pinterest sharing URL\n\t\t\tsharingUrls.pinterest = function (url, image){\n\t\t\t\tif(url || image) return false;\n\t\t\t\treturn 'https://pinterest.com/pin/create/button/?url='+url+'&media='+image+'&description='+socialTitle+'%0A'+socialDescription;\t\n\t\t\t}\n\n\t\t\tsovm.share = function(social){\n\t\t\t\tvar url = sharingUrls[social](sovm.jeanToUrl());\n\t\t\t\tif (url !== false){\n\t\t\t\t\tif (social=='email') window.open(url, '_self');\n\t\t\t\t\telse window.open(url, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');\n\t\t\t\t}\n\t\t\t\telse console.log(\"Error builiding social URL\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\n\t\t}\t\n\t\t\t\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('socialActions', [function() {\n    \t\n\t\t\treturn {\n\t    \t\n\t      restrict: 'EA',\n\t      replace:true,\n\t\t\t\ttemplateUrl: '/directives/social-actions/social-actions.template.html',\n\t      scope : {\n\t        jean : '=',\n\t        display: '='\n\t      },\n\t      controller: 'socialCtrl as sovm',\n\n\t      \n\t   };\n    \n    \n  }]);\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('sliderCtrl', sliderCtrl)\n\t\n\t\tsliderCtrl.$inject = ['$scope', 'preloader'];\n\n\t\tfunction sliderCtrl($scope, preloader) {\n\t\t\tvar slvm = this;\n\n\t\t\t\n\t\t\t$scope.imagesLoaded = false;\n\t\t\t\n\t\t\tpreloader.preloadImages( $scope.slides )\n\t\t\t.then(function() {\n\t\t\t\t$scope.imagesLoaded = true;\n\t\t\t},\n\t\t\tfunction() {\n\t\t\t\tconsole.log(\"error loading imgaes...\");\n\t\t\t});\n\t\t \t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t$scope.currentIndex = 0;\n\t\t\t\n\t\t\t$scope.setCurrentSlideIndex = function (index) {\n\t\t\t  $scope.currentIndex = index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.isCurrentSlideIndex = function (index) {\n\t\t\t  return $scope.currentIndex === index;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.nextSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex < $scope.slides.length - 1) ? ++$scope.currentIndex : 0;\n\t\t\t};\n\t\t\t\n\t\t\t$scope.prevSlide = function () {\n\t\t\t  $scope.currentIndex = ($scope.currentIndex > 0) ? --$scope.currentIndex : $scope.slides.length - 1;\n\t\t\t};\n\t\t\t\t\n\t\t}\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('slider', slider);\n\t\t\n  function slider () {\n    return {\n      restrict: 'EA',\n      templateUrl: '/directives/slider/slider.template.html',\n      controller: 'sliderCtrl as slvm',\n      scope : {\n        slides : '=',\n        imageClick : '&'\n      }\n    };\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('adminCtrl', adminCtrl);\n\n  adminCtrl.$inject = ['$location', 'meanData'];\n  function adminCtrl($location, meanData) {\n\t  \n\t  \n    var vm = this;\n\n    vm.user = {};\n    meanData.getOptions()\n      .success(function(data) {\n\t      console.log(\"admin.controller.jsln16:::\");\n        console.log(data);\n      })\n      .error(function (e) {\n        console.log(e);\n      });\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('closetCtrl', closetCtrl);\n\n  closetCtrl.$inject = ['$location', 'jean','popups', 'aws', 'bdAPI', '$scope', 'jsonData', 'messages'];\n  function closetCtrl($location, jean, popups, aws, bdAPI, $scope, jsonData, messages) {\n\t  \n\n\t  \n    var vm = this;   \n\t\t\n\t\tpopups.closeAll();\n\t\tvm.popups=popups.get();\n\n\t\tvm.messages=messages.get();\n\t\t\n\t\t//Set up Jean\n\t\tvm.jean = jean;\n\t\t\n\t\tvm.data=jsonData.getData();\n\t\tvm.jeans = vm.data.jeansList;\n\t\t\n\n\t\tvm.onload=function(){\n\t\t\t$scope.vm = vm;\t\n\t\t}\n\t\t\n\t\t\n\t\t//Edit User\n\t\tvm.userForm = {};\n\t\tvm.userForm.editing={};\n\t\tvm.userForm.feedback={\n\t\t\t\"type\":\"\",\n\t\t\t\"message\":\"\",\n\t\t}\n\t\t\n\n\t\tvm.userForm.cancel = function(field){\n\t\t\tconsole.log(field);\n\t\t\tvm.userForm.editing[field] = false;\n\t\t\tvm.user[field] = vm.userForm.data[field];\n\t\t}\n\t\t\n\t\t\n\t\t//Validation functions\n\t\tfunction validateEmail(email) {\n\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t    return re.test(email);\n\t\t}\n\t\t\n\t\tfunction validatePhoneNumber(inputtxt) {\n\t\t  var phoneno = /^\\+?([0-9]{2})\\)?[-. ]?([0-9]{4})[-. ]?([0-9]{4})$/;\n\t\t  return inputtxt.match(phoneno);\n\t\t}\n\t\t\n\t\tvm.userForm.validate = function(field, data){\n\t\t\t\n\t\t\tif (field == 'email'){\n\t\t\t\tif (validateEmail(data)) return true;\n\t\t\t\telse {\n\t\t\t\t\tmessages.set(\"Please enter a valid email address\", \"error\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\telse if (field == 'phoneNumber'){\n\t\t\t\tif (validatePhoneNumber(data)) return true;\n\t\t\t\telse {\n\t\t\t\t\tmessages.set(\"Please enter a valid phone number\", \"error\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\telse return true;\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\tvm.userForm.save = function(field){\n\t\t\tif (vm.userForm.validate(field, vm.user[field])){\n\t\t\t\t\n\t\t\t\tmessages.reset();\n\t\t\t\t\n\t\t\t\tbdAPI.usersUpdate(vm.user.identityId, vm.user).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tvm.userForm.editing[field] = false;\n\t\t\t\t\t\tvm.userForm.data[field] = vm.user[field]; \t\n\t\t\t\t\t\tmessages.set(\"User updated\", \"success\");\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\tmessages.set(err.message, \"error\");\n\t\t\t\t\t}\t\n\t\t\t\t)\n\t\t\t\t\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\t\n    var user = aws.getCurrentUserFromLocalStorage();\n    if (user){\n\t    bdAPI.defaultHeaders_['Authorization'] = user.idToken.getJwtToken();\n\t    var idTokenPayload = user.idToken.jwtToken.split('.')[1];\n\t\t\tvar userID = JSON.parse(atob(idTokenPayload)).sub;\t\n\t\t\tbdAPI.usersGet(userID).then(\n\t\t\t\tfunction(result){\n\t\t\t\t\tvm.user = result.data;\t\n\t\t\t\t\tvm.userForm.data = angular.copy(result.data);\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t}, \n\t\t\t\tfunction(err){console.log(err)} \n\t\t\t);\n    }else{\n\t    $location.path('/');\n\t\t}\n\t    \t\n\t    \t\n\n\t    \t\n\t\n\t\t\t\t\n\t\tvar logError = function(err){console.log(err)};\n\t\t\n\t\t\n\t\t\n\t\t\n\n\n\t\tvm.copyJean = function(){\n\t\t\tvm.jean = jean.createNew(vm.displayJean);\n\t\t\t$location.path('/customizer');\n\t\t}\n\t\t\n\t\tvm.displayJean={};\n\t\tvm.selectJean = function(jean){\n\t\t\tvm.popups.jeanProfile = true; \n\t\t\tvm.displayJean.data=jean\n\t\t}\n\t\t\n\t\n\t\t\n\t\t//Get User\n  }\n  \n\n\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('customizerCtrl', customizerCtrl);\n\n  customizerCtrl.$inject = ['$q','$filter','$timeout','$location', '$window', '$routeParams', 'bdAPI', 'jean', '$scope', 'popups', 'aws', 'jsonData', 'messages'];\n  function customizerCtrl($q, $filter, $timeout, $location, $window, $routeParams, bdAPI, jean, $scope, popups, aws, jsonData, messages) {\n    \n    var vm = this;\n\t\t\n\t\t//Set up shared messages service\n\t\tmessages.reset();\n\t\tvm.messages=messages.get();\n\t\n\t\t//Set up shared popups service\n\t\tpopups.closeAll();\n\t\tvm.popups = popups.get();\n\t\n\n\t\t//Detect Orientation\t\t\t\n\t\tfunction landscapeDetect() {\n\t\t  var ua = navigator.userAgent.toLowerCase();\n\t\t  var isAndroid = ua.indexOf(\"android\") > -1; // Detect Android devices\n\t\t  if (isAndroid) {\n\t\t    //window.orientation is different for iOS and Android\n\t\t    if (window.orientation == 0 || window.orientation == 180) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 90 || window.orientation == -90) { //Portrait Mode\n\t\t\t\t\treturn false;\n\t\t    }\n\t\t  }\n\t\t  else {\n\t\t    if (window.orientation == 90 || window.orientation == -90) { //Landscape Mode\n\t\t      return true;\n\t\t    }\n\t\t    else if (window.orientation == 0 || window.orientation == 180) { //Portrait Mode\n\t\t      return false;\n\t\t    }\n\t\t  }\n\t\t}\n    \n    vm.landscape=landscapeDetect();\n  \tvar supportsOrientationChange = \"onorientationchange\" in window,\n    orientationEvent = supportsOrientationChange ? \"orientationchange\" : \"resize\";\n\t\t\n\t\twindow.addEventListener(orientationEvent, function() {\t\n\t\t\t//Set a scope variable on orientation change. This will display a popup on the front end warning users that the customizer works best in protrait mode\n\t\t  vm.landscape=landscapeDetect();\n\t\t  $scope.$apply();\n\t\t}, false);\n\t\t\n\t\t\n\t\t\n\t\t//Set up Jean\n\t\tvm.jean = {\"data\":jean.setup()};\n\t\t\n\t\t\n    /*\n\t\t*\n\t\t* GET CUSTOMIZER DATA \n\t\t*\n\t\t*/\t\n\t\tvm.data = jsonData.getData();\n\t\t\n\t\t$scope.$watch(function() {\n\t\t\treturn vm.jean.data;\n\t\t}, function(current, original) {\n\t\t\tvm.updateActiveItem();\n\t\t}, true);\n\t\t\n\t\t$scope.$watch(function() {\n\t\t\treturn vm.data;\n\t\t}, function(current, original) {\n\t\t\tvm.updateActiveItem();\n\t\t}, true);\n\t\t\t\n\t\tvm.activeItem={};\n\t\tvm.updateActiveItem = function(){\n\t\t\tvar data = vm.data[vm.panel[vm.panelStep].dataKey];\n\t\t\tvar key = vm.jean.data[vm.panel[vm.panelStep].jeanKey];\n\t\t\tvar ret = $filter('filter')(data, {id: key});\n\t\t\tif (ret) ret = ret[0];\n\t\t\tvm.activeItem = ret||null;\n\t\t}\n\n\t\t\n\t\t//Build Control Panel Steps\n\t\tvm.panel = [];\n\t\t\n\t\t//Gender\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"gender-chooser\",\n\t\t\t\"dataKey\":\"genders\",\n\t\t\t\"title\":\"Gender\",\n\t\t\t\"jeanKey\":\"gender\"\n\t\t});\n\t\t\n\t\t//Style\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"style-chooser\",\n\t\t\t\"dataKey\":\"styles\",\n\t\t\t\"title\":\"Style\",\n\t\t\t\"jeanKey\":\"style\"\n\t\t});\n\t\t\n\t\t//Fabric\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"fabric-chooser\",\n\t\t\t\"dataKey\":\"fabrics\",\n\t\t\t\"title\":\"Fabric\",\n\t\t\t\"jeanKey\":\"fabric\"\n\t\t});\n\t\t\n\t\t//Top Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Top Thread\",\n\t\t\t\"jeanKey\":\"top_thread\"\n\t\t});\n\t\t\n\t\t//Bottom Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Bottom Thread\",\n\t\t\t\"jeanKey\":\"bottom_thread\"\n\t\t});\n\t\t\n\t\t//Accent Thread\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"threads\",\n\t\t\t\"title\":\"Accent Thread\",\n\t\t\t\"jeanKey\":\"accent_thread\"\n\t\t});\n\t\t\n\t\t//Overview\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"list\",\n\t\t\t\"title\":\"Overview\"\n\t\t});\n\t\t\n\t\t\n\t\t/*\n\t\tNot using hardware for now...\n\n\t\tvm.panel.push({\n\t\t\t\"panelTemplate\":\"chooser\",\n\t\t\t\"dataKey\":\"hardware\",\n\t\t\t\"title\":\"Hardware\",\n\t\t\t\"jeanKey\":\"hardware\"\n\t\t});\n\t\t*/\n\t\t\n\t\tvm.panelDir=\"next\";\t\t\n\t\tvm.panelStep = 0;\n\t\tvm.changeStep = function(step){\n\t\t\tif (step >= vm.panel.length) return false;\n\t\t\tif (step < 0) return false;\n\t\t\tif (step===undefined) return false;\n\t\t\telse vm.panelStep = step; \n\t\t\t\n\t\t\t//As long as we're not on the \"Overview\" Step, update active item...\n\t\t\tif (step+1 != vm.panel.length) vm.updateActiveItem();\n\t\t}\n\t\t\n\n\t\t\n\n\n\t\t\t\t\n\t\t/*\n\t\t*\n\t\t* Place Order - \n\t\t*\n\t\t*/\n\t\tvm.orderCallback = function(){\n\t\t\tvm.saveCallback(function(){\n\t\t\t\t$location.path('/order')\n\t\t\t});\n\t\t}\t\t\n\t\t\n\t\tvm.placeOrder=function(){\n\t\t\tif(!aws.isLoggedIn()){\n\t\t\t\tvm.authCallback = vm.orderCallback;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvm.saveCallback(function(){\n\t\t\t\t\t$location.path('/order')\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\n\t\t\n\t\t/*\n\t\t*\n\t\t* SAVE JEAN - Create thumbnail, save jean\n\t\t*\n\t\t*/\t\n\t\t\t\t\n  \tfunction loadImage(src, cntxt) {\n      return $q(function(resolve,reject) {\n        var image = new Image();\n        image.src = src;\n        image.onload = function() {\n          cntxt.drawImage(image,0,0,600,696);\n          resolve(image);\n        };\n        image.onerror = function(e) {\n          reject(e);\n        };\n      })\n    }\n    \n\t\tvm.createThumb = function(){\n\t  \tvar canvas = document.createElement('canvas');\n\t  \tcanvas.width=600;\n\t  \tcanvas.height=600;\n\t  \tvar cntxt = canvas.getContext('2d');\t\n\t  \tvar promises = [];\n    \n\t    var imagesElements = document.getElementsByClassName(\"zoomed-image\");\n\t    for(var i=0; i<imagesElements.length; i++){\n\t\t    var image = imagesElements[i];\t\n\t      promises.push(loadImage(image.src, cntxt));\n\t    }\n\n\t    return $q.all(promises).then(function(results) {\n\t      var dataUrl = canvas.toDataURL('image/jpeg');\n\t\t\t\treturn dataUrl;\n\t    });\t\n  \t}\n\t\t\t\t\n    vm.saveCallback = function(callback){\n\t    popups.closeAll();\n\t    vm.savingBar = true;\n\t    vm.createThumb().then( function(imageURL){\n\t\t    var userData = aws.getCurrentUserFromLocalStorage();\n\t\t\t\tif (userData){\n\t\t\t\t\tconsole.log(\"U:\"+userData);\n\t\t\t\t\taws.saveImageTos3(imageURL, userData).then(\n\t\t\t\t\t\tfunction(result){\n\t\t\t\t  \t\tvm.savingBar = false;\n\t\t\t\t\t\t\tjean.set('saved', true);\n\t\t\t\t  \t\tjean.set('saved_at',new Date());\n\t\t\t\t  \t\tjean.set('image',result);\n\t\t\t\t\t\t\tjean.save();\n\t\t\t\t  \t\tif (callback) callback(result);\n\t\t\t\t  \t}, function(err){console.log(err)}\n\t\t\t\t\t);\n\t\t\t\t}else{\n\t\t\t\t\t//Turn off saving bar and force login agian....\n\t\t\t\t\tvm.savingBar = false;\n\t\t\t\t\tvm.authCallback = vm.saveCallback;\n\t\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\t}\n\t    });\n    }\n    \n    vm.saveJean = function(){\n\t\t\tif(!aws.isLoggedIn()){\n\t\t\t\tvm.authCallback = vm.saveCallback;\n\t\t\t\tpopups.set('loginOrRegister',true);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse{\n\t\t  \tvm.saveCallback();\n    \t}\n  \t}\n    \n    \n    //init auth callback\n    vm.authCallback = vm.orderCallback;\n    \n    \n    \n    \n\n\n\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('loginFormCtrl', loginFormCtrl);\n\n  loginFormCtrl.$inject = ['$location', 'aws', 'messages', '$scope'];\n  \n  function loginFormCtrl($location, aws, messages, $scope) {\n    var logvm = this;\n    console.log($scope);\n    \n\t\tlogvm.messages=messages.get();\n\t\t\n\t\tlogvm.credentials = {\n      loginEmail : \"\",\n      loginPassword : \"\"\n    };\n\t\t\n\t\t//Login form validation\n\t\tlogvm.validateLoginForm = function(){\t\t\t\t\n\t\t\tfunction validateEmail(email) {\n\t\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t    return re.test(email);\n\t\t\t}\n\t\t\tif(!validateEmail(logvm.credentials.loginEmail)){\n\t\t\t\tmessages.set(\"Please enter a valid Email address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!logvm.credentials.loginPassword){\n\t\t\t\tmessages.set(\"Please enter a password\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\t\n\t\t}\n\t\t\n\t\t//Log user in and send errors to \"messages\"\n\t\tlogvm.login = function(email, password){\n\t\t\tconsole.log(\"loggingin\");\n\t\t\tmessages.reset();\n\t    if (logvm.validateLoginForm()){\n\t\t    console.log('valid');\n\t      aws.authenticateCognitoUser(email,password).then(\n\t\t\t\t\tfunction(result){\n\t\t\t\t\t\tif ($scope.callback) $scope.callback();\n\t\t\t\t\t\tif ($scope.redirect) $location.path($scope.redirect);\n\t\t\t\t\t\tif (!$scope.callback && $scope.redirect)\t$location.path('/closet');\n\t\t\t\t\t},\n\t\t\t\t\tfunction(err){\n\t\t\t\t\t\tif (err.message == \"Incorrect username or password.\") err.message = \"Incorrect Email address or password.\"\n\t\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t  }\n\t\t}\n\t\t\n\t\t//Log in via Facebook\n\t\tlogvm.loginFB = function(){\n\t\t\taws.authenticateViaFB().then(\n\t\t\t\tfunction(result){\n\t\t\t\t\t$location.path('/closet');\n\t\t\t\t},\n\t\t\t\tfunction(err){\n\t\t\t\t\tmessages.set(err.message,\"error\");\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('loginForm', loginForm);\n\t\t\n\n\t\n  function loginForm () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/login-form/login-form.template.html',\n      controller: 'loginFormCtrl as logvm',\n      scope : {\n\t\t\t\tredirect : \"=?\",\n\t      callback : \"=?\"\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerFormCtrl', registerFormCtrl);\n\n  registerFormCtrl.$inject = ['$location', 'aws', '$sce', 'messages'];\n  \n  function registerFormCtrl($location, aws, $sce, messages) {\n    var regvm = this;\n    \n\t\tregvm.messages=messages.get();\n\t\t\n\t\tregvm.credentials = {\n      name : \"\",\n      email : \"\",\n      password : \"\"\n    };\n\t\n\t\t//Validate Registration Form\n\t\tregvm.validateRegistrationForm = function () {\n\t\t\t\t\t\t\n\t\t\tfunction validatePassword(password){\n\t\t\t\t//console.log(regvm.credentials.password.length > 5);\n\t\t\t\t//contains numbers\n\t\t\t\t//console.log(regvm.credentials.password.search(/\\d/)>-1);\n\t\t\t\t//contains lowercase letters\n\t\t\t\t//console.log(regvm.credentials.password.search(/[a-z]/) > -1);\n\t\t\t\t//contains uppercase letters\n\t\t\t\t//console.log(regvm.credentials.password.search(/[A-Z]/) > -1);\n\t\t\t\t\n\t\t\t\t//RE to test all\n\t\t\t\tvar re = /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,50}$/;\n\t\t\t\treturn re.test(password);\n\t\t\t}\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\tfunction validateEmail(email) {\n\t\t    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\t    return re.test(email);\n\t\t\t}\n\n\t\t\t\n\t\t\tif (!regvm.credentials.email || !regvm.credentials.name || !regvm.credentials.password || !regvm.credentials.passwordConfirm){\n\t\t\t\tmessages.set(\"All fields are required\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif (!validatePassword(regvm.credentials.password)){\n\t\t\t\tmessages.set(\"A valid password must: <ul><li>Be between 6 and 50 characters</li><li>Contain at least one number</li><li>Contain at least one uppercase letter</li><li>Contain at least one lowercase letter</li><li>Contain at least one special character (\\\"!,@,#,$,%,^,&, or *\\\")</li>\");\t\n\t\t\t}\n\t\t\t\n\t\t\tif (regvm.credentials.password !== regvm.credentials.passwordConfirm){\n\t\t\t\tmessages.set(\"Password and Confirmation do not match\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\tif(!validateEmail(regvm.credentials.email)){\n\t\t\t\tmessages.set(\"Please Enter a valid E-mail address\", \"error\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\treturn true;\n\t\t\t\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t//Register User\n    regvm.registerUser = function () {\n\t    messages.reset();\n\t    \n\t    if (regvm.validateRegistrationForm()){\n\t      aws.signupForApplication(regvm.credentials.email, regvm.credentials.password).then(\n\t      \tfunction(){\n\t\t\t\t\t\tif ($scope.callback) $scope.callback();\n\t\t\t\t\t\tif ($scope.redirect) $location.path($scope.redirect);\n\t\t\t\t\t\tif (!$scope.callback && $scope.redirect)\t$location.path('/customizer');    \t\n\t\t      },   \n\t\t      function(err){\n\t\t\t\t    messages.set(err.message, \"error\");\n\t\t\t    }\n\t\t\t  );\n\t\t  }\n    };\t\n    \n    \n    \t\t\n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .directive('registerForm', registerForm);\n\t\t\n\n\t\n  function registerForm () {\n    return {\n      restrict: 'AE',\n      templateUrl: '/directives/register-form/register-form.template.html',\n      controller: 'registerFormCtrl as regvm',\n      scope : {\n\t\t\t\tredirect : \"=?\",\n\t      callback : \"=?\"\n      }\n    };\n    \n  }\n  \n    \n  \n  \n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('orderCtrl', orderCtrl);\n\n  orderCtrl.$inject = ['$window', '$location', 'jean','popups', '$filter', 'aws', 'bdAPI', '$scope', 'jsonData'];\n  function orderCtrl($window, $location, jean, popups, $filter, aws, bdAPI, $scope, jsonData) {\n\t  \n\n\t  \n    var vm = this;\n    vm.popups=popups.get();\n   \n\t\tvm.jean=jean.data;\n\t\tconsole.log(jean);\n\t\t\n\t\tvm.orderForm={};\n\t\tvm.orderForm.step=1;\n\t\t\n\t\tvm.orderForm.data = {}\n\t\tvm.chooseFitType = function(type){\n\t\t\tvm.orderForm.data.fitType = type;\n\t\t\t\n\t\t\tif (type == 2 && !vm.orderForm.data.tailor){\n\t\t\t\tvm.popups.tailors=true;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tvm.tailorLocations=[];\n\t\t\n\t\tvm.data=jsonData.getData();\n\t\tconsole.log(vm.data);\n\t\t\n\t\tvm.orderForm.nextStep = function(){\n\t\t\t\n\t\t\tconsole.log(\"running next step...\");\n\t\t\t\n\t\t\t//Step 1 to Step 2\n\t\t\tif (vm.orderForm.step==1){\n\t\t\t\t\n\t\t\t\t//Make sure we've got a fit type\n\t\t\t\tif (!vm.orderForm.data.fitType){\n\t\t\t\t\tconsole.log(\"no fit type\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//If we're using a tailor, make sure we've got a tailor\n\t\t\t\tif (vm.orderForm.data.fitType==2 && !vm.orderForm.data.tailor){\n\t\t\t\t\tconsole.log(\"no tailor\");\n\t\t\t\t\tvm.popups.tailors=true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvm.orderForm.step=2;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\n\n\t\twindow.onbeforeunload = function() {\n\t\t    return 'You have unsaved changes!';\n\t\t}\n\t\t\t\t\n\t\t\n\t\t\n\t\tvm.jeans = [];\n   /* \n    var user = aws.getCurrentUserFromLocalStorage();\n    if (user){\n\t    bdAPI.defaultHeaders_['Authorization'] = user.idToken.getJwtToken();\n\t    var idTokenPayload = user.idToken.jwtToken.split('.')[1];\n\t\t\tvar userID = JSON.parse(atob(idTokenPayload)).sub;\t\n\t\t\tbdAPI.usersGet(userID).then(\n\t\t\t\tfunction(result){\n\t\t\t\t\tvm.user = result.data;\t\n\t\t\t\t\t$scope.$apply();\n\t\t\t\t}, \n\t\t\t\tfunction(err){console.log(err)} \n\t\t\t);\n    }else{\n\t    $location.path('/');\n\t\t}\t\n\n\t\t*/\n\n\t\n\n\n\t\t//Get User\n  }\n  \n\n\n\n})();","(function () {\n\n  angular\n  .module('bdApp')\n  .controller('loginCtrl', loginCtrl);\n\n\tloginCtrl.$inject = ['messages'];\n  function loginCtrl(messages) {\n    var vm = this;\n    \n    messages.reset();\n    vm.messages = messages.get();\n    \n  }\n\n})();","(function () {\n\n  angular\n    .module('bdApp')\n    .controller('registerCtrl', registerCtrl);\n\n  registerCtrl.$inject = ['messages'];\n  function registerCtrl(messages) {\n    var vm = this;\n\n\t\tmessages.reset();\n    vm.messages = messages.get();\n    vm.formStep=1;\n    \t\t\n/*    \t\t\t\t\t\n\t\t//Confirm User with Registration Code\t\t\t\t\n    vm.confirmUser = function() {\n\t\t\tvm.resetMessage();\n\t\t\taws.confirmRegisteredUnauthenticatedUser(vm.credentials.email, vm.credentials.code).then(\n      \tfunction(result){\n\t\t\t\t\tvm.setMessage($sce.trustAsHtml(\"Your Account has been confirmed. <a href='/login'>Click here to login</a>\"), \"success\");\n\t      },   \n\t      function(err){\n\t\t      if (err.message == \"Missing required key 'ConfirmationCode' in params\") err.message = \"Please enter confirmation code\";\n\t\t\t    vm.setMessage(err.message, \"error\");\n\t\t    }\n\t\t  );\n    };\n    \n    //Resend Registration code to user via email\n    vm.resendCode = function(){\n\t    //This function throws an error in the SDK and no result... cannot implement promise for now\n\t    aws.resendConfirmationCode(vm.credentials.email);\n\t    //We're going to show a success message no matter what\n\t    //TODO: Implement corrected SDK and promise structure for this functino\n\t    vm.setMessage(\"A new confirmation code has been sent to \"+vm.credentials.email+\". Enter the code above to confirm your account\", \"success\");\n    };\n\n*/\n  }\n\n})();","(function() {\n  \n  angular\n    .module('bdApp')\n    .controller('homeCtrl', homeCtrl);\n\t\t\t\n\t\thomeCtrl.$inject = ['$scope','jean', '$animate'];\n\n\t\t\n    function homeCtrl ($scope, jean, $animate) {\n\t    \t    \t    \n\t    $scope.jean = jean.data;\n\t    \t\n    }\n\n})();"]}